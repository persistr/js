!function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e((function(e,t){const r=l({});class n extends r{transaction(){return new EE(this,...arguments)}queryCompiler(e,t){return new NE(this,e,t)}columnBuilder(){return new $E(this,...arguments)}columnCompiler(){return new xE(this,...arguments)}tableCompiler(){return new OE(this,...arguments)}schemaCompiler(){return new SE(this,...arguments)}viewCompiler(){return new kE(this,...arguments)}_driver(){return d({})}processResponse(e,t){const r=e.response;return e.output?e.output.call(t,r):"raw"===e.method?r:"SELECT"===r.command?"first"===e.method?r.rows[0]:"pluck"===e.method?Uy(r.rows,e.pluck):r.rows:"INSERT"===r.command||"UPDATE"===r.command||"DELETE"===r.command?r.rowCount:r}toPathForJson(e,t,r){return e.replace(/^(\$\.)/,"").split(".").map(function(e){return this.parameter(e,t,r)}.bind(this)).join(", ")}}Object.assign(n.prototype,{dialect:"redshift",driverName:"pg-redshift"}),e.exports=n})),r=e((function(e,t){const r=l({});e.exports=class extends r{constructor(...e){super(...e),this.driverName="pgnative",this.canCancelQuery=!0}_driver(){return d({}).native}_stream(e,t,r,n){if(!t.sql)throw new Error("The query is empty");const i=this;return new Promise((n,s)=>(r.on("error",s),r.on("end",n),i._query(e,t).then(e=>e.response).then(({rows:e})=>e.forEach(e=>r.write(e))).catch((function(e){r.emit("error",e)})).then((function(){r.end()}))))}async cancelQuery(e){try{return await this._wrappedCancelQueryCall(null,e)}catch(t){throw this.logger.warn("Connection Error: "+t),t}}_wrappedCancelQueryCall(e,t){return new Promise((function(e,r){t.native.cancel((function(t){t?r(t):e(!0)}))}))}}})),n=e((function(e,t){(function(t){const{BlobHelper:r,ReturningHelper:n,monkeyPatchConnection:s}=cE,o=i({}),{isString:a}=Jf,{outputQuery:u,unwrapRaw:l}=yy,{compileCallback:c}=ay;class h extends o{constructor(e){super(e),this.driver&&(t.env.UV_THREADPOOL_SIZE=t.env.UV_THREADPOOL_SIZE||1,t.env.UV_THREADPOOL_SIZE=parseInt(t.env.UV_THREADPOOL_SIZE)+this.driver.poolMax)}_driver(){const e=this,t=d({});return e.fetchAsString=[],this.config.fetchAsString&&Array.isArray(this.config.fetchAsString)&&this.config.fetchAsString.forEach((function(r){a(r)&&(r=r.toUpperCase(),t[r]&&("NUMBER"!==r&&"DATE"!==r&&"CLOB"!==r&&"BUFFER"!==r&&this.logger.warn('Only "date", "number", "clob" and "buffer" are supported for fetchAsString'),e.fetchAsString.push(t[r])))})),t}queryCompiler(e,t){return new hE(this,e,t)}tableCompiler(){return new dE(this,...arguments)}columnCompiler(){return new fE(this,...arguments)}viewBuilder(){return new gE(this,...arguments)}viewCompiler(){return new yE(this,...arguments)}formatter(e){return new Yg(this,e)}transaction(){return new wE(this,...arguments)}prepBindings(e){return Uy(e,e=>e instanceof r&&this.driver?{type:this.driver.BLOB,dir:this.driver.BIND_OUT}:e instanceof n&&this.driver?{type:this.driver.STRING,dir:this.driver.BIND_OUT}:"boolean"==typeof e?e?1:0:e)}parameter(e,t,n){return"function"==typeof e?u(c(e,void 0,this,n),!0,t,this):e instanceof r?(n.bindings.push(e.value),"?"):l(e,!0,t,this,n)||"?"}acquireRawConnection(){const e=this;return new Promise((function(t,r){const n=e.connectionSettings.externalAuth?{externalAuth:e.connectionSettings.externalAuth}:{user:e.connectionSettings.user,password:e.connectionSettings.password};var i;n.connectString=(i=e.connectionSettings).connectString?i.connectString:i.port?i.host+":"+i.port+"/"+i.database:i.host+"/"+i.database,e.connectionSettings.prefetchRowCount&&(n.prefetchRows=e.connectionSettings.prefetchRowCount),void 0!==e.connectionSettings.stmtCacheSize&&(n.stmtCacheSize=e.connectionSettings.stmtCacheSize),e.driver.fetchAsString=e.fetchAsString,e.driver.getConnection(n,(function(n,i){if(n)return r(n);s(i,e),t(i)}))}))}destroyRawConnection(e){return e.release()}_query(e,t){if(!t.sql)throw new Error("The query is empty");const n={autoCommit:!1};return"select"===t.method&&(n.resultSet=!0),e.executeAsync(t.sql,t.bindings,n).then((async function(n){let i=Wf(n.outBinds);if(t.response=n.rows||[],t.rowsAffected=n.rows?n.rows.rowsAffected:n.rowsAffected,"raw"===t.method&&i.length>0)return{response:i};if("update"===t.method){const e=t.rowsAffected.length||t.rowsAffected,r=[],n=[],s=t=>function(r,s){const o=s*e;n.push(i[t+o])};for(let i=0;i<e;i++)r.push(t.outBinding[0]),Tp(t.outBinding[0],s(i));i=n,t.outBinding=r}if(!t.returning&&0===i.length)return e.isTransaction||await e.commitAsync(),t;const s=[];let o=0;for(let e=0;e<t.outBinding.length;e++){const n=t.outBinding[e];o+=t.outBinding[e-1]?t.outBinding[e-1].length:0;for(let a=0;a<n.length;a++){const u=n[a];await new Promise((function(n,l){if(u instanceof r){const r=i[a+o];u.returning&&(t.response[e]=t.response[e]||{},t.response[e][u.columnName]=u.value),r.on("error",(function(e){l(e)})),r.on("finish",(function(){n()})),r.write(u.value),r.end()}else"ROWID"===t.outBinding[e][a]?(s.push(i[a+o]),n()):(t.response[e]=t.response[e]||{},t.response[e][u]=i[a+o],n())}))}}if(e.isTransaction)return t;if(await e.commitAsync(),t.returningSql){const r=await e.executeAsync(t.returningSql(),s,{resultSet:!0});t.response=r.rows}return t}))}processResponse(e,t){const{response:r}=e;if(e.output)return e.output.call(t,r);switch(e.method){case"select":return r;case"first":return r[0];case"pluck":return Uy(r,e.pluck);case"insert":case"del":case"update":case"counter":return e.returning&&!Sp(e.returning)?r:void 0!==e.rowsAffected?e.rowsAffected:1;default:return r}}processPassedConnection(e){s(e,this)}}h.prototype.driverName="oracledb",e.exports=h}).call(this,require("_process"))})),i=e((function(e,t){const{ReturningHelper:r}=Vw,{isConnectionError:n}=Vw;class i extends av{schemaCompiler(){return new Qw(this,...arguments)}columnBuilder(){return new Ww(this,...arguments)}columnCompiler(){return new Xw(this,...arguments)}tableCompiler(){return new nE(this,...arguments)}database(){return this.connectionSettings.database}positionBindings(e){let t=0;return e.replace(/\?/g,(function(){return":"+(t+=1)}))}_stream(e,t,r,i){if(!t.sql)throw new Error("The query is empty");return new Promise((function(s,o){r.on("error",t=>{n(t)&&(e.__knex__disposed=t),o(t)}),r.on("end",s);const a=e.queryStream(t.sql,t.bindings,i);a.pipe(r),a.on("error",(function(e){o(e),r.emit("error",e)}))}))}alias(e,t){return e+" "+t}parameter(e,t,n){return e instanceof r&&this.driver?e=new this.driver.OutParam(this.driver.OCCISTRING):"boolean"==typeof e&&(e=e?1:0),super.parameter(e,t,n)}}Object.assign(i.prototype,{dialect:"oracle",driverName:"oracle"}),e.exports=i})),s=e((function(e,t){const r=o({});class n extends r{transaction(){return new Bw(this,...arguments)}_driver(){return d({})}validateConnection(e){return e&&!e._fatalError&&!e._protocolError&&!e._closing&&!e.stream.destroyed}}Object.assign(n.prototype,{driverName:"mysql2"}),e.exports=n})),o=e((function(e,t){const{promisify:r}=require("util"),{makeEscape:n}=fc;class i extends av{_driver(){return d({})}queryCompiler(e,t){return new Ow(this,e,t)}schemaCompiler(){return new Sw(this,...arguments)}tableCompiler(){return new kw(this,...arguments)}viewCompiler(){return new Dw(this,...arguments)}viewBuilder(){return new Fw(this,...arguments)}columnCompiler(){return new Iw(this,...arguments)}transaction(){return new Nw(this,...arguments)}wrapIdentifierImpl(e){return"*"!==e?`\`${e.replace(/`/g,"``")}\``:"*"}acquireRawConnection(){return new Promise((e,t)=>{const r=this.driver.createConnection(this.connectionSettings);r.on("error",e=>{r.__knex__disposed=e}),r.connect(n=>{if(n)return r.removeAllListeners(),t(n);e(r)})})}async destroyRawConnection(e){try{const t=r(t=>e.end(t));return await t()}catch(t){e.__knex__disposed=t}finally{Ew(()=>e.removeAllListeners())}}validateConnection(e){return"connected"===e.state||"authenticated"===e.state}_stream(e,t,r,n){if(!t.sql)throw new Error("The query is empty");n=n||{};const i=Object.assign({sql:t.sql},t.options);return new Promise((s,o)=>{r.on("error",o),r.on("end",s);const a=e.query(i,t.bindings).stream(n);a.on("error",e=>{o(e),r.emit("error",e)}),a.pipe(r)})}_query(e,t){if(t&&"string"!=typeof t||(t={sql:t}),!t.sql)throw new Error("The query is empty");return new Promise((function(r,n){if(!t.sql)return void r();const i=Object.assign({sql:t.sql},t.options);e.query(i,t.bindings,(function(e,i,s){if(e)return n(e);t.response=[i,s],r(t)}))}))}processResponse(e,t){if(null==e)return;const{response:r}=e,{method:n}=e,i=r[0],s=r[1];if(e.output)return e.output.call(t,i,s);switch(n){case"select":return i;case"first":return i[0];case"pluck":return Uy(i,e.pluck);case"insert":return[i.insertId];case"del":case"update":case"counter":return i.affectedRows;default:return r}}async cancelQuery(e){const t=await this.acquireRawConnection();try{return await this._wrappedCancelQueryCall(t,e)}finally{await this.destroyRawConnection(t),t.__knex__disposed&&this.logger.warn("Connection Error: "+t.__knex__disposed)}}_wrappedCancelQueryCall(e,t){return this._query(e,{sql:"KILL QUERY ?",bindings:[t.threadId],options:{}})}}Object.assign(i.prototype,{dialect:"mysql",driverName:"mysql",_escapeBinding:n(),canCancelQuery:!0}),e.exports=i})),a=e((function(e,t){(function(t,r){const n=yf("knex:mssql"),i=-2147483648,s=2147483647,o=-9007199254740991,a=9007199254740991;class u extends av{constructor(e={}){super(e)}_generateConnection(){const e=this.connectionSettings;e.options=e.options||{};const t={authentication:{type:e.type||"default",options:{userName:e.userName||e.user,password:e.password,domain:e.domain,token:e.token,clientId:e.clientId,clientSecret:e.clientSecret,tenantId:e.tenantId,msiEndpoint:e.msiEndpoint}},server:e.server||e.host,options:{database:e.database,encrypt:e.encrypt||!1,port:e.port||1433,connectTimeout:e.connectionTimeout||e.timeout||15e3,requestTimeout:ew(e.requestTimeout)?15e3:e.requestTimeout,rowCollectionOnDone:!1,rowCollectionOnRequestCompletion:!1,useColumnNames:!1,tdsVersion:e.options.tdsVersion||"7_4",appName:e.options.appName||"knex",trustServerCertificate:!1,...e.options}};return t.options.instanceName&&delete t.options.port,isNaN(t.options.requestTimeout)&&(t.options.requestTimeout=15e3),t.options.requestTimeout===1/0&&(t.options.requestTimeout=0),t.options.requestTimeout<0&&(t.options.requestTimeout=0),e.debug&&(t.options.debug={packet:!0,token:!0,data:!0,payload:!0}),t}_driver(){return d({})}formatter(){return new tw(this,...arguments)}transaction(){return new nw(this,...arguments)}queryCompiler(){return new uw(this,...arguments)}schemaCompiler(){return new lw(this,...arguments)}tableCompiler(){return new dw(this,...arguments)}viewCompiler(){return new yw(this,...arguments)}queryBuilder(){return new ry(this)}columnCompiler(){return new gw(this,...arguments)}wrapIdentifierImpl(e){return"*"===e?"*":`[${e.replace(/[[\]]+/g,"")}]`}acquireRawConnection(){return new Promise((e,t)=>{n("connection::connection new connection requested");const r=this._driver(),i=Object.assign({},this._generateConnection()),s=new r.Connection(i);s.connect(r=>r?(n("connection::connect error: %s",r.message),t(r)):(n("connection::connect connected to server"),s.connected=!0,s.on("error",e=>{n("connection::error message=%s",e.message),s.__knex__disposed=e,s.connected=!1}),s.once("end",()=>{s.connected=!1,s.__knex__disposed="Connection to server was terminated.",n("connection::end connection ended.")}),e(s)))})}validateConnection(e){return e&&e.connected}destroyRawConnection(e){return n("connection::destroy"),new Promise(t=>{e.once("end",()=>{t()}),e.close()})}positionBindings(e){let t=-1;return e.replace(/\\?\?/g,e=>"\\?"===e?"?":"@p"+(t+=1))}_chomp(e){if("LoggedIn"===e.state.name){const t=this.requestQueue.pop();t&&(n("connection::query executing query, %d more in queue",this.requestQueue.length),e.execSql(t))}}_enqueueRequest(e,t){this.requestQueue.push(e),this._chomp(t)}_makeRequest(e,t){const r=this._driver(),i="string"==typeof e?e:e.sql;let s=0;if(!i)throw new Error("The query is empty");n("request::request sql=%s",i);const o=new r.Request(i,(e,r)=>{if(e)return n("request::error message=%s",e.message),t(e);n("request::callback rowCount=%d",s=r)});return o.on("prepared",()=>{n("request %s::request prepared",this.id)}),o.on("done",(e,t)=>{n("request::done rowCount=%d more=%s",e,t)}),o.on("doneProc",(e,t)=>{n("request::doneProc id=%s rowCount=%d more=%s",o.id,e,t)}),o.on("doneInProc",(e,t)=>{n("request::doneInProc id=%s rowCount=%d more=%s",o.id,e,t)}),o.once("requestCompleted",()=>(n("request::completed id=%s",o.id),t(null,s))),o.on("error",e=>(n("request::error id=%s message=%s",o.id,e.message),t(e))),o}_stream(e,t,r){return new Promise((n,i)=>{const s=this._makeRequest(t,e=>{if(e)return r.emit("error",e),i(e);n()});s.on("row",e=>{r.write(e.reduce((e,t)=>({...e,[t.metadata.colName]:t.value}),{}))}),s.on("error",e=>{r.emit("error",e),i(e)}),s.once("requestCompleted",()=>{r.end(),n()}),this._assignBindings(s,t.bindings),this._enqueueRequest(s,e)})}_assignBindings(e,t){if(Array.isArray(t))for(let r=0;r<t.length;r++){const n=t[r];this._setReqInput(e,r,n)}}_scaleForBinding(e){if(e%1==0)throw new Error(`The binding value ${e} must be a decimal number.`);return{scale:10}}_typeForBinding(e){const t=this._driver();switch(typeof e){case"string":return t.TYPES.NVarChar;case"boolean":return t.TYPES.Bit;case"number":if(e%1!=0)return t.TYPES.Float;if(e<i||e>s){if(e<o||e>a)throw new Error("Bigint must be safe integer or must be passed as string, saw "+e);return t.TYPES.BigInt}return t.TYPES.Int;default:return e instanceof Date?t.TYPES.DateTime:e instanceof r?t.TYPES.VarBinary:t.TYPES.NVarChar}}_query(e,r){return new Promise((i,s)=>{const o=[],a=this._makeRequest(r,(n,a)=>{if(n)return s(n);r.response=o,t.nextTick(()=>this._chomp(e)),i(r)});a.on("row",e=>{n("request::row"),o.push(e)}),this._assignBindings(a,r.bindings),this._enqueueRequest(a,e)})}_setReqInput(e,t,i){const s=this._typeForBinding(i),o="p".concat(t);let a;"number"==typeof i&&i%1!=0&&(a=this._scaleForBinding(i)),n("request::binding pos=%d type=%s value=%s",t,s.name,i),r.isBuffer(i)&&(a={length:"max"}),e.addParameter(o,s,i,a)}processResponse(e,t){if(null==e)return;let{response:r}=e;const{method:n}=e;if(e.output)return e.output.call(t,r);if(r=r.map(e=>e.reduce((e,t)=>{const r=t.metadata.colName;return e[r]?(Array.isArray(e[r])||(e[r]=[e[r]]),e[r].push(t.value)):e[r]=t.value,e},{})),e.output)return e.output.call(t,r);switch(n){case"select":return r;case"first":return r[0];case"pluck":return Uy(r,e.pluck);case"insert":case"del":case"update":case"counter":return e.returning&&"@@rowcount"===e.returning?r[0][""]:r;default:return r}}}Object.assign(u.prototype,{requestQueue:[],dialect:"mssql",driverName:"mssql"}),e.exports=u}).call(this,require("_process"),require("buffer").Buffer)})),u=e((function(e,t){const r=l({});class n extends r{transaction(){return new O_(this,...arguments)}queryCompiler(e,t){return new G_(this,e,t)}tableCompiler(){return new Y_(this,...arguments)}viewCompiler(){return new Z_(this,...arguments)}queryBuilder(){return new X_(this)}_parseVersion(e){return e.split(" ")[2]}async cancelQuery(e){try{return await this._wrappedCancelQueryCall(null,e)}catch(t){throw this.logger.warn("Connection Error: "+t),t}}_wrappedCancelQueryCall(e,t){if(0!==t.activeQuery.processID||0!==t.activeQuery.secretKey)return t.cancel(t,t.activeQuery)}toArrayPathFromJsonPath(e,t,r){return e.replace(/^(\$\.)/,"").replace(/\[([0-9]+)]/,".$1").split(".").map(function(e){return this.parameter(e,t,r)}.bind(this)).join(", ")}}Object.assign(n.prototype,{driverName:"cockroachdb"}),e.exports=n})),l=e((function(e,t){(function(t){const{promisify:r}=require("util"),{makeEscape:n}=fc,{isString:i}=Jf;class s extends av{constructor(e){super(e),e.returning&&(this.defaultReturning=e.returning),e.searchPath&&(this.searchPath=e.searchPath)}transaction(){return new O_(this,...arguments)}queryBuilder(){return new I_(this)}queryCompiler(e,t){return new R_(this,e,t)}columnCompiler(){return new P_(this,...arguments)}schemaCompiler(){return new Q_(this,...arguments)}tableCompiler(){return new V_(this,...arguments)}viewCompiler(){return new z_(this,...arguments)}viewBuilder(){return new H_(this,...arguments)}_driver(){return d({})}wrapIdentifierImpl(e){if("*"===e)return e;let t="";const r=e.match(/(.*?)(\[[0-9]+\])/);return r&&(e=r[1],t=r[2]),`"${e.replace(/"/g,'""')}"${t}`}_acquireOnlyConnection(){const e=new this.driver.Client(this.connectionSettings);return e.connect().then(()=>e)}acquireRawConnection(){const e=this;return this._acquireOnlyConnection().then((function(t){return t.on("error",e=>{t.__knex__disposed=e}),t.on("end",e=>{t.__knex__disposed=e||"Connection ended unexpectedly"}),e.version?t:e.checkVersion(t).then((function(r){return e.version=r,t}))})).then((async function(t){return await e.setSchemaSearchPath(t),t}))}async destroyRawConnection(e){return r(t=>e.end(t))()}checkVersion(e){return new Promise((t,r)=>{e.query("select version();",(e,n)=>{if(e)return r(e);t(this._parseVersion(n.rows[0].version))})})}_parseVersion(e){return/^PostgreSQL (.*?)( |$)/.exec(e)[1]}positionBindings(e){let t=0;return e.replace(/(\\*)(\?)/g,(function(e,r){return r.length%2?"?":"$"+ ++t}))}setSchemaSearchPath(e,t){let r=t||this.searchPath;if(!r)return Promise.resolve(!0);if(!Array.isArray(r)&&!i(r))throw new TypeError("knex: Expected searchPath to be Array/String, got: "+typeof r);if(i(r)){if(r.includes(",")){const e=`[${r.split(",").map(e=>`'${e}'`).join(", ")}]`;this.logger.warn(`Detected comma in searchPath "${r}".If you are trying to specify multiple schemas, use Array syntax: `+e)}r=[r]}return r=r.map(e=>`"${e}"`).join(","),new Promise((function(t,n){e.query("set search_path to "+r,(function(e){if(e)return n(e);t(!0)}))}))}_stream(e,r,n,i){if(!r.sql)throw new Error("The query is empty");const s=t.browser?void 0:d({}),o=r.sql;return new Promise((function(t,a){const u=e.query(new s(o,r.bindings,i));u.on("error",(function(e){a(e),n.emit("error",e)})),n.on("end",t),u.pipe(n)}))}_query(e,t){if(!t.sql)throw new Error("The query is empty");let r={text:t.sql,values:t.bindings||[]};return t.options&&(r=bg(r,t.options)),new Promise((function(n,i){e.query(r,(function(e,r){if(e)return i(e);t.response=r,n(t)}))}))}processResponse(e,t){const r=e.response;if(e.output)return e.output.call(t,r);if("raw"===e.method)return r;const{returning:n}=e;if("SELECT"===r.command)return"first"===e.method?r.rows[0]:"pluck"===e.method?Uy(r.rows,e.pluck):r.rows;if(n){const e=[];for(let t=0,n=r.rows.length;t<n;t++){const n=r.rows[t];e[t]=n}return e}return"UPDATE"===r.command||"DELETE"===r.command?r.rowCount:r}async cancelQuery(e){const t=await this.acquireRawConnection();try{return await this._wrappedCancelQueryCall(t,e)}finally{await this.destroyRawConnection(t).catch(e=>{this.logger.warn("Connection Error: "+e)})}}_wrappedCancelQueryCall(e,t){return this._query(e,{sql:"SELECT pg_cancel_backend($1);",bindings:[t.processID],options:{}})}toPathForJson(e){return e.match(/^{.*}$/)?e:"{"+e.replace(/^(\$\.)/,"").replace(".",",").replace(/\[([0-9]+)]/,",$1")+"}"}}Object.assign(s.prototype,{dialect:"postgresql",driverName:"pg",canCancelQuery:!0,_escapeBinding:n({escapeArray:(e,t)=>t(function e(t,r){let n="{";for(let i=0;i<t.length;i++){i>0&&(n+=",");const s=t[i];null==s?n+="NULL":Array.isArray(s)?n+=e(s,r):n+="number"==typeof s?s:JSON.stringify("string"==typeof s?s:r(s))}return n+"}"}(e,t)),escapeString(e){let t=!1,r="'";for(let n=0;n<e.length;n++){const i=e[n];"'"===i?r+=i+i:"\\"===i?(r+=i+i,t=!0):r+=i}return r+="'",!0===t&&(r="E"+r),r},escapeObject(e,t,r,n=[]){if(e&&"function"==typeof e.toPostgres){if(-1!==(n=n||[]).indexOf(e))throw new Error(`circular reference detected while preparing "${e}" for query`);return n.push(e),t(e.toPostgres(t),n)}return JSON.stringify(e)}})}),e.exports=s}).call(this,require("_process"))})),c=e((function(e,t){const r=h({});class n extends r{_driver(){return d({})}async acquireRawConnection(){return new this.driver(this.connectionSettings.filename)}async destroyRawConnection(e){return e.close()}async _query(e,t){if(!t.sql)throw new Error("The query is empty");if(!e)throw new Error("No connection provided");const r=e.prepare(t.sql),n=this._formatBindings(t.bindings);if(r.reader){const e=await r.all(n);return t.response=e,t}const i=await r.run(n);return t.response=i,t.context={lastID:i.lastInsertRowid,changes:i.changes},t}_formatBindings(e){return e?e.map(e=>e instanceof Date?e.valueOf():"boolean"==typeof e?Number(e):e):[]}}Object.assign(n.prototype,{driverName:"better-sqlite3"}),e.exports=n})),h=e((function(e,t){const{promisify:r}=require("util");class n extends av{constructor(e){super(e),void 0===e.useNullAsDefault&&this.logger.warn("sqlite does not support inserting default values. Set the `useNullAsDefault` flag to hide this warning. (see docs http://knexjs.org/#Builder-insert).")}_driver(){return d({})}schemaCompiler(){return new Iv(this,...arguments)}transaction(){return new Tv(this,...arguments)}queryCompiler(e,t){return new Av(this,e,t)}queryBuilder(){return new T_(this)}viewCompiler(e,t){return new Bv(this,e,t)}columnCompiler(){return new Pv(this,...arguments)}tableCompiler(){return new Fv(this,...arguments)}ddl(e,t,r){return new x_(this,e,t,r)}wrapIdentifierImpl(e){return"*"!==e?`\`${e.replace(/`/g,"``")}\``:"*"}acquireRawConnection(){return new Promise((e,t)=>{let r=this.driver.OPEN_READWRITE|this.driver.OPEN_CREATE;if(this.connectionSettings.flags){if(!Array.isArray(this.connectionSettings.flags))throw new Error("flags must be an array of strings");this.connectionSettings.flags.forEach(e=>{if(!e.startsWith("OPEN_")||!this.driver[e])throw new Error(`flag ${e} not supported by node-sqlite3`);r|=this.driver[e]})}const n=new this.driver.Database(this.connectionSettings.filename,r,r=>{if(r)return t(r);e(n)})})}async destroyRawConnection(e){return r(t=>e.close(t))()}_query(e,t){if(!t.sql)throw new Error("The query is empty");const{method:r}=t;let n;switch(r){case"insert":case"update":case"counter":case"del":n="run";break;default:n="all"}return new Promise((function(r,i){if(!e||!e[n])return i(new Error(`Error calling ${n} on connection.`));e[n](t.sql,t.bindings,(function(e,n){return e?i(e):(t.response=n,t.context=this,r(t))}))}))}_stream(e,t,r){if(!t.sql)throw new Error("The query is empty");const n=this;return new Promise((function(i,s){return r.on("error",s),r.on("end",i),n._query(e,t).then(e=>e.response).then(e=>e.forEach(e=>r.write(e))).catch((function(e){r.emit("error",e)})).then((function(){r.end()}))}))}processResponse(e,t){const r=e.context,{response:n,returning:i}=e;if(e.output)return e.output.call(t,n);switch(e.method){case"select":return n;case"first":return n[0];case"pluck":return Uy(n,e.pluck);case"insert":if(i){if(n)return n;this.logger.warn("node-sqlite3 does not currently support RETURNING clause")}return[r.lastID];case"del":case"update":case"counter":return r.changes;default:return n}}poolDefaults(){return Yd({min:1,max:1},super.poolDefaults())}formatter(e){return new Yg(this,e)}values(e,t,r){return Array.isArray(e)?Array.isArray(e[0])?`( values ${e.map(e=>`(${this.parameterize(e,void 0,t,r)})`).join(", ")})`:`(${this.parameterize(e,void 0,t,r)})`:e instanceof _y?`(${this.parameter(e,t,r)})`:this.parameter(e,t,r)}}Object.assign(n.prototype,{dialect:"sqlite3",driverName:"sqlite3"}),e.exports=n})),d=e((function(e,t){})),f=e((function(e,t){var r=1e3,n=6e4,i=60*n,s=24*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var a,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===l&&isFinite(e))return t.long?(a=e,(u=Math.abs(a))>=s?o(a,u,s,"day"):u>=i?o(a,u,i,"hour"):u>=n?o(a,u,n,"minute"):u>=r?o(a,u,r,"second"):a+" ms"):function(e){var t=Math.abs(e);return t>=s?Math.round(e/s)+"d":t>=i?Math.round(e/i)+"h":t>=n?Math.round(e/n)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}})),p=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=void 0;const r=m({}),n=y({}),i=E({});t.default=class{constructor(e,t,r){if(function({schema:e,opts:t,self:r},n,i){if(Array.isArray(n.keyword)?!n.keyword.includes(i):n.keyword!==i)throw new Error("ajv implementation error");const s=n.dependencies;if(null==s?void 0:s.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${i}: ${s.join(",")}`);if(n.validateSchema){if(!n.validateSchema(e[i])){const e="keyword value is invalid: "+r.errorsText(n.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}}(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=n.schemaRefOrVal(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",a(this.$data,e));else if(this.schemaCode=this.schemaValue,!function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e)}(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",co.default.errors))}result(e,t,r){this.gen.if(As.not(e)),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.result(e,void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(As._`${t} !== undefined && (${As.or(this.invalid$data(),e)})`)}error(e){(e?fo.reportExtraError:fo.reportError)(this,this.def.error)}$dataError(){fo.reportError(this,this.def.$dataError||fo.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');fo.resetErrorsCount(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=As.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=As.nil,t=As.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:i,def:s}=this;r.if(As.or(As._`${n} === undefined`,t)),e!==As.nil&&r.assign(e,!0),(i.length||s.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==As.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:n,def:i,it:s}=this;return As.or(function(){if(n.length){if(!(t instanceof As.Name))throw new Error("ajv implementation error");const e=Array.isArray(n)?n:[n];return As._`${r.checkDataTypes(e,t,s.opts.strict,r.DataType.Wrong)}`}return As.nil}(),function(){if(i.validateSchema){const r=e.scopeValue("validate$data",{ref:i.validateSchema});return As._`!${r}(${t})`}return As.nil}())}subschema(e,t){return i.applySubschema(this.it,e,t)}mergeEvaluated(e,t){const{it:r,gen:i}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=n.mergeEvaluated.props(i,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=n.mergeEvaluated.items(i,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,()=>this.mergeEvaluated(e,As.Name)),!0}};const s=/^\/(?:[^~]|~0|~1)*$/,o=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function a(e,{dataLevel:t,dataNames:r,dataPathArr:i}){let a,u;if(""===e)return co.default.rootData;if("/"===e[0]){if(!s.test(e))throw new Error("Invalid JSON-pointer: "+e);a=e,u=co.default.rootData}else{const n=o.exec(e);if(!n)throw new Error("Invalid JSON-pointer: "+e);const s=+n[1];if("#"===(a=n[2])){if(s>=t)throw new Error(h("property/index",s));return i[t-s]}if(s>t)throw new Error(h("data",s));if(u=r[t-s],!a)return u}let l=u;const c=a.split("/");for(const s of c)s&&(u=As._`${u}${As.getProperty(n.unescapeJsonPointer(s))}`,l=As._`${l} && ${u}`);return l;function h(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}t.getData=a})),m=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const r=y({});var n;function i(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(hs.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(n=t.DataType||(t.DataType={})),t.getSchemaTypes=function(e){const t=i(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=i,t.coerceAndCheckDataType=function(e,t){const{gen:r,data:i,opts:o}=e,u=function(e,t){return t?e.filter(e=>s.has(e)||"array"===t&&"array"===e):[]}(t,o.coerceTypes),c=t.length>0&&!(0===u.length&&1===t.length&&fs.schemaHasRulesForType(e,t[0]));if(c){const c=a(t,i,o.strict,n.Wrong);r.if(c,()=>{u.length?function(e,t,r){const{gen:n,data:i,opts:o}=e,u=n.let("dataType",As._`typeof ${i}`),c=n.let("coerced",As._`undefined`);"array"===o.coerceTypes&&n.if(As._`${u} == 'object' && Array.isArray(${i}) && ${i}.length == 1`,()=>n.assign(i,As._`${i}[0]`).assign(u,As._`typeof ${i}`).if(a(t,i,o.strict),()=>n.assign(c,i))),n.if(As._`${c} !== undefined`);for(const a of r)(s.has(a)||"array"===a&&"array"===o.coerceTypes)&&h(a);function h(e){switch(e){case"string":return void n.elseIf(As._`${u} == "number" || ${u} == "boolean"`).assign(c,As._`"" + ${i}`).elseIf(As._`${i} === null`).assign(c,As._`""`);case"number":return void n.elseIf(As._`${u} == "boolean" || ${i} === null
              || (${u} == "string" && ${i} && ${i} == +${i})`).assign(c,As._`+${i}`);case"integer":return void n.elseIf(As._`${u} === "boolean" || ${i} === null
              || (${u} === "string" && ${i} && ${i} == +${i} && !(${i} % 1))`).assign(c,As._`+${i}`);case"boolean":return void n.elseIf(As._`${i} === "false" || ${i} === 0 || ${i} === null`).assign(c,!1).elseIf(As._`${i} === "true" || ${i} === 1`).assign(c,!0);case"null":return n.elseIf(As._`${i} === "" || ${i} === 0 || ${i} === false`),void n.assign(c,null);case"array":n.elseIf(As._`${u} === "string" || ${u} === "number"
              || ${u} === "boolean" || ${i} === null`).assign(c,As._`[${i}]`)}}n.else(),l(e),n.endIf(),n.if(As._`${c} !== undefined`,()=>{n.assign(i,c),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(As._`${t} !== undefined`,()=>e.assign(As._`${t}[${r}]`,n))}(e,c)})}(e,t,u):l(e)})}return c};const s=new Set(["string","number","integer","boolean","null"]);function o(e,t,r,i=n.Correct){const s=i===n.Correct?As.operators.EQ:As.operators.NEQ;let o;switch(e){case"null":return As._`${t} ${s} null`;case"array":o=As._`Array.isArray(${t})`;break;case"object":o=As._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=a(As._`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=a();break;default:return As._`typeof ${t} ${s} ${e}`}return i===n.Correct?o:As.not(o);function a(e=As.nil){return As.and(As._`typeof ${t} == "number"`,e,r?As._`isFinite(${t})`:As.nil)}}function a(e,t,n,i){if(1===e.length)return o(e[0],t,n,i);let s;const a=r.toHash(e);if(a.array&&a.object){const e=As._`typeof ${t} != "object"`;s=a.null?e:As._`!${t} || ${e}`,delete a.null,delete a.array,delete a.object}else s=As.nil;a.number&&delete a.integer;for(const r in a)s=As.and(s,o(r,t,n,i));return s}t.checkDataType=o,t.checkDataTypes=a;const u={message:({schema:e})=>As.str`should be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?As._`{type: ${e}}`:As._`{type: ${t}}`};function l(e){const t=function(e){const{gen:t,data:n,schema:i}=e,s=r.schemaRefOrVal(e,i,"type");return{gen:t,keyword:"type",data:n,schema:i.type,schemaCode:s,schemaValue:s,parentSchema:i,params:{},it:e}}(e);fo.reportError(t,u)}t.reportTypeError=l})),y=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.func=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const r=g({});function n(e,t=e.schema){const{opts:n,self:i}=e;if(!n.strict)return;if("boolean"==typeof t)return;const s=i.RULES.keywords;for(const o in t)s[o]||r.checkStrictMode(e,`unknown keyword: "${o}"`)}function i(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function s(e){return"number"==typeof e?""+e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function o(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function a({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:n}){return(i,s,o,a)=>{const u=void 0===o?s:o instanceof As.Name?(s instanceof As.Name?e(i,s,o):t(i,s,o),o):s instanceof As.Name?(t(i,o,s),s):r(s,o);return a!==As.Name||u instanceof As.Name?u:n(i,u)}}function u(e,t){if(!0===t)return e.var("props",!0);const r=e.var("props",As._`{}`);return void 0!==t&&l(e,r,t),r}function l(e,t,r){Object.keys(r).forEach(r=>e.assign(As._`${t}${As.getProperty(r)}`,!0))}t.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(n(e,t),!i(t,e.self.RULES.all))},t.checkUnknownRules=n,t.schemaHasRules=i,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},t.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,n,i){if(!i){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return As._`${r}`}return As._`${e}${t}${As.getProperty(n)}`},t.unescapeFragment=function(e){return o(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(s(e))},t.escapeJsonPointer=s,t.unescapeJsonPointer=o,t.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},t.mergeEvaluated={props:a({mergeNames:(e,t,r)=>e.if(As._`${r} !== true && ${t} !== undefined`,()=>{e.if(As._`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,As._`${r} || {}`).code(As._`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if(As._`${r} !== true`,()=>{!0===t?e.assign(r,!0):(e.assign(r,As._`${r} || {}`),l(e,r,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:u}),items:a({mergeNames:(e,t,r)=>e.if(As._`${r} !== true && ${t} !== undefined`,()=>e.assign(r,As._`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if(As._`${r} !== true`,()=>e.assign(r,!0===t||As._`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=u,t.setEvaluated=l,t.func=function(e,t){return e.scopeValue("func",{ref:t,code:t.code})}})),g=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.schemaCxtHasRules=t.subschemaCode=t.validateFunctionCode=void 0;const r=m({}),n=b({}),i=v({}),s=y({});function o({gen:e,validateName:t,schema:r,schemaEnv:n,opts:i},s){i.code.es5?e.func(t,As._`${co.default.data}, ${co.default.valCxt}`,n.$async,()=>{e.code(As._`"use strict"; ${a(r,i)}`),function(e,t){e.if(co.default.valCxt,()=>{e.var(co.default.dataPath,As._`${co.default.valCxt}.${co.default.dataPath}`),e.var(co.default.parentData,As._`${co.default.valCxt}.${co.default.parentData}`),e.var(co.default.parentDataProperty,As._`${co.default.valCxt}.${co.default.parentDataProperty}`),e.var(co.default.rootData,As._`${co.default.valCxt}.${co.default.rootData}`),t.dynamicRef&&e.var(co.default.dynamicAnchors,As._`${co.default.valCxt}.${co.default.dynamicAnchors}`)},()=>{e.var(co.default.dataPath,As._`""`),e.var(co.default.parentData,As._`undefined`),e.var(co.default.parentDataProperty,As._`undefined`),e.var(co.default.rootData,co.default.data),t.dynamicRef&&e.var(co.default.dynamicAnchors,As._`{}`)})}(e,i),e.code(s)}):e.func(t,As._`${co.default.data}, ${function(e){return As._`{${co.default.dataPath}="", ${co.default.parentData}, ${co.default.parentDataProperty}, ${co.default.rootData}=${co.default.data}${e.dynamicRef?As._`, ${co.default.dynamicAnchors}={}`:As.nil}}={}`}(i)}`,n.$async,()=>e.code(a(r,i)).code(s))}function a(e,t){return"object"==typeof e&&e.$id&&(t.code.source||t.code.process)?As._`/*# sourceURL=${e.$id} */`:As.nil}function u({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function l(e){return"boolean"!=typeof e.schema}function c(e){s.checkUnknownRules(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:i}=e;t.$ref&&n.ignoreKeywordsWithRef&&s.schemaHasRulesButRef(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function h(e,t){if(e.opts.jtd)return n.schemaKeywords(e,[],!1,t);const i=r.getSchemaTypes(e.schema),s=r.coerceAndCheckDataType(e,i);n.schemaKeywords(e,i,!s,t)}function d({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:i}){const s=r.$comment;if(!0===i.$comment)e.code(As._`${co.default.self}.logger.log(${s})`);else if("function"==typeof i.$comment){const r=As.str`${n}/$comment`,i=e.scopeValue("root",{ref:t.root});e.code(As._`${co.default.self}.opts.$comment(${s}, ${r}, ${i}.schema)`)}}function f(e,t,r=e.opts.strict){if(r){if(t="strict mode: "+t,!0===r)throw new Error(t);e.self.logger.warn(t)}}t.validateFunctionCode=function(e){l(e)&&(c(e),u(e))?function(e){const{schema:t,opts:r,gen:n}=e;o(e,()=>{r.$comment&&t.$comment&&d(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strict&&f(e,"default is ignored in the schema root")}(e),n.let(co.default.vErrors,null),n.let(co.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",As._`${r}.evaluated`),t.if(As._`${e.evaluated}.dynamicProps`,()=>t.assign(As._`${e.evaluated}.props`,As._`undefined`)),t.if(As._`${e.evaluated}.dynamicItems`,()=>t.assign(As._`${e.evaluated}.items`,As._`undefined`))}(e),h(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:i,opts:s}=e;r.$async?t.if(As._`${co.default.errors} === 0`,()=>t.return(co.default.data),()=>t.throw(As._`new ${i}(${co.default.vErrors})`)):(t.assign(As._`${n}.errors`,co.default.vErrors),s.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof As.Name&&e.assign(As._`${t}.props`,r),n instanceof As.Name&&e.assign(As._`${t}.items`,n)}(e),t.return(As._`${co.default.errors} === 0`))}(e)})}(e):o(e,()=>vo.topBoolOrEmptySchema(e))},t.subschemaCode=function(e,t){l(e)&&(c(e),u(e))?function(e,t){const{schema:r,gen:n,opts:s}=e;s.$comment&&r.$comment&&d(e),function(e){e.schema.$id&&(e.baseId=i.resolveUrl(e.baseId,e.schema.$id))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=n.const("_errs",co.default.errors);h(e,o),n.var(t,As._`${o} === ${co.default.errors}`)}(e,t):vo.boolOrEmptySchema(e,t)},t.schemaCxtHasRules=u,t.checkStrictMode=f})),v=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const r=y({}),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!s(e):!!t&&function e(t){let i=0;for(const s in t){if("$ref"===s)return 1/0;if(i++,!n.has(s)&&("object"==typeof t[s]&&r.eachItem(t[s],t=>i+=e(t)),i===1/0))return 1/0}return i}(e)<=t)};const i=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function s(e){for(const t in e){if(i.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(s))return!0;if("object"==typeof r&&s(r))return!0}return!1}function o(e="",t){return!1!==t&&(e=l(e)),a($o.parse(e))}function a(e){return $o.serialize(e).split("#")[0]+"#"}t.getFullPath=o,t._getFullPath=a;const u=/#\/?$/;function l(e){return e?e.replace(u,""):""}t.normalizeId=l,t.resolveUrl=function(e,t){return t=l(t),$o.resolve(e,t)};const c=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e){if("boolean"==typeof e)return{};const t=l(e.$id),r={"":t},n=o(t,!1),i={},s=new Set;return Eo(e,{allKeys:!0},(e,t,o,h)=>{if(void 0===h)return;const d=n+t;let f=r[h];function p(t){if(t=l(f?$o.resolve(f,t):t),s.has(t))throw u(t);s.add(t);let r=this.refs[t];return"string"==typeof r&&(r=this.refs[r]),"object"==typeof r?a(e,r.schema,t):t!==l(d)&&("#"===t[0]?(a(e,i[t],t),i[t]=e):this.refs[t]=d),t}function m(e){if("string"==typeof e){if(!c.test(e))throw new Error(`invalid anchor "${e}"`);p.call(this,"#"+e)}}"string"==typeof e.$id&&(f=p.call(this,e.$id)),m.call(this,e.$anchor),m.call(this,e.$dynamicAnchor),r[t]=f}),i;function a(e,t,r){if(void 0!==t&&!wo(e,t))throw u(r)}function u(e){return new Error(`reference "${e}" resolves to more than one schema`)}}})),b=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schemaKeywords=void 0;const r=m({}),n=C({}),i=_({}),s=y({}),o=g({});function a(e,t){const{gen:r,schema:s,opts:{useDefaults:o}}=e;o&&n.assignDefaults(e,t.type),r.block(()=>{for(const r of t.rules)fs.shouldUseRule(s,r)&&i.keywordCode(e,r.keyword,r.definition,t.type)})}function u(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function l(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,o.checkStrictMode(e,t,e.opts.strictTypes)}t.schemaKeywords=function(e,t,n,o){const{gen:c,schema:h,data:d,allErrors:f,opts:p,self:m}=e,{RULES:y}=m;function g(i){fs.shouldUseGroup(h,i)&&(i.type?(c.if(r.checkDataType(i.type,d,p.strict)),a(e,i),1===t.length&&t[0]===i.type&&n&&(c.else(),r.reportTypeError(e)),c.endIf()):a(e,i),f||c.if(As._`${co.default.errors} === ${o||0}`))}!h.$ref||!p.ignoreKeywordsWithRef&&s.schemaHasRulesButRef(h,y)?(p.jtd||function(e,t){!e.schemaEnv.meta&&e.opts.strictTypes&&(function(e,t){t.length&&(e.dataTypes.length?(t.forEach(t=>{u(e.dataTypes,t)||l(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(e=>u(t,e))):e.dataTypes=t)}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&l(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){const r=e.self.RULES.all;for(const n in r){const i=r[n];if("object"==typeof i&&fs.shouldUseRule(e.schema,i)){const{type:r}=i.definition;r.length&&!r.some(e=>{return n=e,(r=t).includes(n)||"number"===n&&r.includes("integer");var r,n})&&l(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),c.block(()=>{for(const e of y.rules)g(e);g(y.post)})):c.block(()=>i.keywordCode(e,"$ref",y.all.$ref.definition))}})),_=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keywordCode=void 0;const r=p({}),n=w({});function i(e,t){var r;const{gen:i,keyword:a,schema:u,parentSchema:l,$data:c,it:h}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(h,t);const d=!c&&t.compile?t.compile.call(h.self,u,l,h):t.validate,f=o(i,a,d),p=i.let("valid");function m(r=(t.async?As._`await `:As.nil)){const s=h.opts.passContext?co.default.this:co.default.self,o=!("compile"in t&&!c||!1===t.schema);i.assign(p,As._`${r}${n.callValidateCode(e,f,s,o)}`,t.modifying)}function y(e){var r;i.if(As.not(null!==(r=t.valid)&&void 0!==r?r:p),e)}e.block$data(p,(function(){if(!1===t.errors)m(),t.modifying&&s(e),y(()=>e.error());else{const r=t.async?function(){const e=i.let("ruleErrs",null);return i.try(()=>m(As._`await `),t=>i.assign(p,!1).if(As._`${t} instanceof ${h.ValidationError}`,()=>i.assign(e,As._`${t}.errors`),()=>i.throw(t))),e}():function(){const e=As._`${f}.errors`;return i.assign(e,null),m(As.nil),e}();t.modifying&&s(e),y(()=>function(e,t){const{gen:r}=e;r.if(As._`Array.isArray(${t})`,()=>{r.assign(co.default.vErrors,As._`${co.default.vErrors} === null ? ${t} : ${co.default.vErrors}.concat(${t})`).assign(co.default.errors,As._`${co.default.vErrors}.length`),fo.extendErrors(e)},()=>e.error())}(e,r))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:p)}function s(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,()=>t.assign(r,As._`${n.parentData}[${n.parentDataProperty}]`))}function o(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:As.stringify(r)})}t.keywordCode=function(e,t,n,s){const a=new r.default(e,n,t);"code"in n?n.code(a,s):a.$data&&n.validate?i(a,n):"macro"in n?function(e,t){const{gen:r,keyword:n,schema:i,parentSchema:s,it:a}=e,u=t.macro.call(a.self,i,s,a),l=o(r,n,u);!1!==a.opts.validateSchema&&a.self.validateSchema(u,!0);const c=r.name("valid");e.subschema({schema:u,schemaPath:As.nil,errSchemaPath:`${a.errSchemaPath}/${n}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))}(a,n):(n.compile||n.validate)&&i(a,n)}})),w=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const r=y({}),n=E({});function i(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:As._`Object.prototype.hasOwnProperty`})}function s(e,t,r){return As._`${i(e)}.call(${t}, ${r})`}function o(e,t,r,n){const i=As._`${t}${As.getProperty(r)} === undefined`;return n?As.or(i,As.not(s(e,t,r))):i}function a(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}t.checkReportMissingProp=function(e,t){const{gen:r,data:n,it:i}=e;r.if(o(r,n,t,i.opts.ownProperties),()=>{e.setParams({missingProperty:As._`${t}`},!0),e.error()})},t.checkMissingProp=function({gen:e,data:t,it:{opts:r}},n,i){return As.or(...n.map(n=>As.and(o(e,t,n,r.ownProperties),As._`${i} = ${n}`)))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.hasPropFunc=i,t.isOwnProperty=s,t.propertyInData=function(e,t,r,n){const i=As._`${t}${As.getProperty(r)} !== undefined`;return n?As._`${i} && ${s(e,t,r)}`:i},t.noPropertyInData=o,t.allSchemaProperties=a,t.schemaProperties=function(e,t){return a(t).filter(n=>!r.alwaysValidSchema(e,t[n]))},t.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:i,errorPath:s},it:o},a,u,l){const c=l?As._`${e}, ${t}, ${n}${i}`:t,h=[[co.default.dataPath,As.strConcat(co.default.dataPath,s)],[co.default.parentData,o.parentData],[co.default.parentDataProperty,o.parentDataProperty],[co.default.rootData,co.default.rootData]];o.opts.dynamicRef&&h.push([co.default.dynamicAnchors,co.default.dynamicAnchors]);const d=As._`${c}, ${r.object(...h)}`;return u!==As.nil?As._`${a}.call(${u}, ${d})`:As._`${a}(${d})`},t.usePattern=function(e,t){return e.scopeValue("pattern",{key:t,ref:new RegExp(t,"u"),code:As._`new RegExp(${t}, "u")`})},t.validateArray=function(e){const{gen:t,data:r,keyword:i,it:s}=e,o=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return a(()=>t.assign(e,!1)),e}return t.var(o,!0),a(()=>t.break()),o;function a(s){const a=t.const("len",As._`${r}.length`);t.forRange("i",0,a,r=>{e.subschema({keyword:i,dataProp:r,dataPropType:n.Type.Num},o),t.if(As.not(o),s)})}},t.validateUnion=function(e){const{gen:t,schema:n,keyword:i,it:s}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(e=>r.alwaysValidSchema(s,e))&&!s.opts.unevaluated)return;const o=t.let("valid",!1),a=t.name("_valid");t.block(()=>n.forEach((r,n)=>{const s=e.subschema({keyword:i,schemaProp:n,compositeRule:!0},a);t.assign(o,As._`${o} || ${a}`),e.mergeValidEvaluated(s,a)||t.if(As.not(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}})),E=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applySubschema=t.Type=void 0;const r=g({}),n=y({});var i;!function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(i=t.Type||(t.Type={})),t.applySubschema=function(e,t,s){const o=function(e,{keyword:t,schemaProp:r,schema:i,schemaPath:s,errSchemaPath:o,topSchemaRef:a}){if(void 0!==t&&void 0!==i)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const i=e.schema[t];return void 0===r?{schema:i,schemaPath:As._`${e.schemaPath}${As.getProperty(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:i[r],schemaPath:As._`${e.schemaPath}${As.getProperty(t)}${As.getProperty(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${n.escapeFragment(r)}`}}if(void 0!==i){if(void 0===s||void 0===o||void 0===a)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:i,schemaPath:s,topSchemaRef:a,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}(e,t);!function(e,t,{dataProp:r,dataPropType:s,data:o,dataTypes:a,propertyName:u}){if(void 0!==o&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:l}=t;if(void 0!==r){const{errorPath:o,dataPathArr:a,opts:u}=t;c(l.let("data",As._`${t.data}${As.getProperty(r)}`,!0)),e.errorPath=As.str`${o}${function(e,t,r){if(e instanceof As.Name){const n=t===i.Num;return r?n?As._`"[" + ${e} + "]"`:As._`"['" + ${e} + "']"`:n?As._`"/" + ${e}`:As._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?As.getProperty(e).toString():"/"+n.escapeJsonPointer(e)}(r,s,u.jsPropertySyntax)}`,e.parentDataProperty=As._`${r}`,e.dataPathArr=[...a,e.parentDataProperty]}if(void 0!==o){c(o instanceof As.Name?o:l.let("data",o,!0)),void 0!==u&&(e.propertyName=u)}function c(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}a&&(e.dataTypes=a)}(o,e,t),function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:i,allErrors:s}){void 0!==n&&(e.compositeRule=n),void 0!==i&&(e.createErrors=i),void 0!==s&&(e.allErrors=s),e.jtdDiscriminator=t,e.jtdMetadata=r}(o,t);const a={...e,...o,items:void 0,props:void 0};return r.subschemaCode(a,s),a}})),C=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const r=g({});function n(e,t,n){const{gen:i,compositeRule:s,data:o,opts:a}=e;if(void 0===n)return;const u=As._`${o}${As.getProperty(t)}`;if(s)return void r.checkStrictMode(e,"default is ignored for: "+u);let l=As._`${u} === undefined`;"empty"===a.useDefaults&&(l=As._`${l} || ${u} === null || ${u} === ""`),i.if(l,As._`${u} = ${As.stringify(n)}`)}t.assignDefaults=function(e,t){const{properties:r,items:i}=e.schema;if("object"===t&&r)for(const s in r)n(e,s,r[s].default);else"array"===t&&Array.isArray(i)&&i.forEach((t,r)=>n(e,r,t.default))}})),N=e((function(e,t){(function(t){e.exports=c;var r=(Ii.Minimatch,Hi),n=require("events").EventEmitter,i=require("path"),s=$({}),o=Wi.setopts,a=Wi.ownProp,u=(require("util"),Wi.childrenIgnored),l=Wi.isIgnored;function c(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return s(e,t)}return new d(e,t,r)}c.sync=s;var h=c.GlobSync=s.GlobSync;function d(e,r,n){if("function"==typeof r&&(n=r,r=null),r&&r.sync){if(n)throw new TypeError("callback provided to sync glob");return new h(e,r)}if(!(this instanceof d))return new d(e,r,n);o(this,e,r),this._didRealPath=!1;var i=this.minimatch.set.length;this.matches=new Array(i),"function"==typeof n&&(n=Ki(n),this.on("error",n),this.on("end",(function(e){n(null,e)})));var s=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===i)return l();for(var a=!0,u=0;u<i;u++)this._process(this.minimatch.set[u],u,!1,l);function l(){--s._processing,s._processing<=0&&(a?t.nextTick((function(){s._finish()})):s._finish())}a=!1}c.glob=c,c.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}({},t);r.noprocess=!0;var n=new d(e,r).minimatch.set;if(!e)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},c.Glob=d,r(d,n),d.prototype._finish=function(){if(!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Wi.finish(this),this.emit("end",this.found)}},d.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--e&&t._finish()}},d.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),i=this,s=n.length;if(0===s)return t();var o=this.matches[e]=Object.create(null);n.forEach((function(r,n){r=i._makeAbs(r),yi.realpath(r,i.realpathCache,(function(n,a){n?"stat"===n.syscall?o[r]=!0:i.emit("error",n):o[a]=!0,0==--s&&(i.matches[e]=o,t())}))}))},d.prototype._mark=function(e){return Wi.mark(this,e)},d.prototype._makeAbs=function(e){return Wi.makeAbs(this,e)},d.prototype.abort=function(){this.aborted=!0,this.emit("abort")},d.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},d.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);for(this._processQueue.length=0,t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},d.prototype._process=function(e,t,r,n){if(!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,r,n]);else{for(var i,s=0;"string"==typeof e[s];)s++;switch(s){case e.length:return void this._processSimple(e.join("/"),t,n);case 0:i=null;break;default:i=e.slice(0,s).join("/")}var o,a=e.slice(s);null===i?o=".":Qi(i)||Qi(e.join("/"))?(i&&Qi(i)||(i="/"+i),o=i):o=i;var l=this._makeAbs(o);if(u(this,o))return n();a[0]===Ii.GLOBSTAR?this._processGlobStar(i,o,l,a,t,r,n):this._processReaddir(i,o,l,a,t,r,n)}},d.prototype._processReaddir=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,(function(u,l){return a._processReaddir2(e,t,r,n,i,s,l,o)}))},d.prototype._processReaddir2=function(e,t,r,n,s,o,a,u){if(!a)return u();for(var l=n[0],c=!!this.minimatch.negate,h=l._glob,d=this.dot||"."===h.charAt(0),f=[],p=0;p<a.length;p++)("."!==(y=a[p]).charAt(0)||d)&&(c&&!e?!y.match(l):y.match(l))&&f.push(y);var m=f.length;if(0===m)return u();if(1===n.length&&!this.mark&&!this.stat){for(this.matches[s]||(this.matches[s]=Object.create(null)),p=0;p<m;p++){var y=f[p];e&&(y="/"!==e?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=i.join(this.root,y)),this._emitMatch(s,y)}return u()}for(n.shift(),p=0;p<m;p++)y=f[p],e&&(y="/"!==e?e+"/"+y:e+y),this._process([y].concat(n),s,o,u);u()},d.prototype._emitMatch=function(e,t){if(!this.aborted&&!l(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var r=Qi(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}},d.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,n=Zi("lstat\0"+e,(function(n,i){if(n&&"ENOENT"===n.code)return t();var s=i&&i.isSymbolicLink();r.symlinks[e]=s,s||!i||i.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())}));n&&r.fs.lstat(e,n)}},d.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=Zi("readdir\0"+e+"\0"+t,r))){if(t&&!a(this.symlinks,e))return this._readdirInGlobStar(e,r);if(a(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}this.fs.readdir(e,function(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}(this,e,r))}},d.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}},d.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},d.prototype._processGlobStar=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,(function(u,l){a._processGlobStar2(e,t,r,n,i,s,l,o)}))},d.prototype._processGlobStar2=function(e,t,r,n,i,s,o,a){if(!o)return a();var u=n.slice(1),l=e?[e]:[],c=l.concat(u);this._process(c,i,!1,a);var h=this.symlinks[r],d=o.length;if(h&&s)return a();for(var f=0;f<d;f++)if("."!==o[f].charAt(0)||this.dot){var p=l.concat(o[f],u);this._process(p,i,!0,a);var m=l.concat(o[f],n);this._process(m,i,!0,a)}a()},d.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,(function(i,s){n._processSimple2(e,t,i,s,r)}))},d.prototype._processSimple2=function(e,r,n,s,o){if(this.matches[r]||(this.matches[r]=Object.create(null)),!s)return o();if(e&&Qi(e)&&!this.nomount){var a=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=i.join(this.root,e):(e=i.resolve(this.root,e),a&&(e+="/"))}"win32"===t.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(r,e),o()},d.prototype._stat=function(e,t){var r=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&a(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return t(null,i);if(n&&"FILE"===i)return t()}var s=this.statCache[r];if(void 0!==s){if(!1===s)return t(null,s);var o=s.isDirectory()?"DIR":"FILE";return n&&"FILE"===o?t():t(null,o,s)}var u=this,l=Zi("stat\0"+r,(function(n,i){if(i&&i.isSymbolicLink())return u.fs.stat(r,(function(n,s){n?u._stat2(e,r,null,i,t):u._stat2(e,r,n,s,t)}));u._stat2(e,r,n,i,t)}));l&&u.fs.lstat(r,l)},d.prototype._stat2=function(e,t,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,i();var s="/"===e.slice(-1);if(this.statCache[t]=n,"/"===t.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,s&&"FILE"===o?i():i(null,o,n)}}).call(this,require("_process"))})),$=e((function(e,t){(function(t){e.exports=a,a.GlobSync=u;var r=(Ii.Minimatch,N({}).Glob,require("util"),require("path")),n=Wi.setopts,i=Wi.ownProp,s=Wi.childrenIgnored,o=Wi.isIgnored;function a(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new u(e,t).found}function u(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof u))return new u(e,t);if(n(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1);this._finish()}u.prototype._finish=function(){if(this.realpath){var e=this;this.matches.forEach((function(t,r){var n=e.matches[r]=Object.create(null);for(var i in t)try{i=e._makeAbs(i),n[yi.realpathSync(i,e.realpathCache)]=!0}catch(s){if("stat"!==s.syscall)throw s;n[e._makeAbs(i)]=!0}}))}Wi.finish(this)},u.prototype._process=function(e,t,r){for(var n,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:n=null;break;default:n=e.slice(0,i).join("/")}var o,a=e.slice(i);null===n?o=".":Qi(n)||Qi(e.join("/"))?(n&&Qi(n)||(n="/"+n),o=n):o=n;var u=this._makeAbs(o);s(this,o)||(a[0]===Ii.GLOBSTAR?this._processGlobStar(n,o,u,a,t,r):this._processReaddir(n,o,u,a,t,r))},u.prototype._processReaddir=function(e,t,n,i,s,o){var a=this._readdir(n,o);if(a){for(var u=i[0],l=!!this.minimatch.negate,c=u._glob,h=this.dot||"."===c.charAt(0),d=[],f=0;f<a.length;f++)("."!==(y=a[f]).charAt(0)||h)&&(l&&!e?!y.match(u):y.match(u))&&d.push(y);var p=d.length;if(0!==p)if(1!==i.length||this.mark||this.stat)for(i.shift(),f=0;f<p;f++){var m;y=d[f],m=e?[e,y]:[y],this._process(m.concat(i),s,o)}else{this.matches[s]||(this.matches[s]=Object.create(null));for(f=0;f<p;f++){var y=d[f];e&&(y="/"!==e.slice(-1)?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=r.join(this.root,y)),this._emitMatch(s,y)}}}},u.prototype._emitMatch=function(e,t){if(!o(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},u.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=this.fs.lstatSync(e)}catch(i){if("ENOENT"===i.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[e]=n,n||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},u.prototype._readdir=function(e,t){if(t&&!i(this.symlinks,e))return this._readdirInGlobStar(e);if(i(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(n){return this._readdirError(e,n),null}},u.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t},u.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},u.prototype._processGlobStar=function(e,t,r,n,i,s){var o=this._readdir(r,s);if(o){var a=n.slice(1),u=e?[e]:[],l=u.concat(a);this._process(l,i,!1);var c=o.length;if(!this.symlinks[r]||!s)for(var h=0;h<c;h++)if("."!==o[h].charAt(0)||this.dot){var d=u.concat(o[h],a);this._process(d,i,!0);var f=u.concat(o[h],n);this._process(f,i,!0)}}},u.prototype._processSimple=function(e,n){var i=this._stat(e);if(this.matches[n]||(this.matches[n]=Object.create(null)),i){if(e&&Qi(e)&&!this.nomount){var s=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=r.join(this.root,e):(e=r.resolve(this.root,e),s&&(e+="/"))}"win32"===t.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(n,e)}},u.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&i(this.cache,t)){var n=this.cache[t];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var s=this.statCache[t];if(!s){var o;try{o=this.fs.lstatSync(t)}catch(a){if(a&&("ENOENT"===a.code||"ENOTDIR"===a.code))return this.statCache[t]=!1,!1}if(o&&o.isSymbolicLink())try{s=this.fs.statSync(t)}catch(a){s=o}else s=o}return this.statCache[t]=s,n=!0,s&&(n=s.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||n,(!r||"FILE"!==n)&&n},u.prototype._mark=function(e){return Wi.mark(this,e)},u.prototype._makeAbs=function(e){return Wi.makeAbs(this,e)}}).call(this,require("_process"))})),x=class extends Error{constructor(e,t){super(e+(t?" caused by: "+t:"")),this.error=t,this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}},T={ConnectionRefused:class extends x{constructor(e){super("Connection refused to Persistr Server"+(e?" at "+e:""))}},Fetch:class extends x{constructor(e){super(e)}},InternalError:class extends x{constructor(e){super(e?"Internal error\nWhat went wrong:\n"+e.message:"Internal error")}},InvalidBearerToken:class extends x{constructor({bearer:e}){super("Invalid bearer token: "+e)}},InvalidCredentials:class extends x{constructor(){super("Invalid credentials")}},PersistrError:x,StatusCode:class extends x{constructor(e,t,r,n){let i=n;try{const e=JSON.parse(n);e&&e.error&&(i=""+e.error)}catch(error){}super(i),this.url=e,this.statusCode=t,this.statusText=r,this.responseText=n}},UnexpectedError:class extends x{constructor(e){super(e)}},UnsupportedFilter:class extends x{constructor({filter:e,on:t}){super(`Unsupported filter '${e}' on ${t}`)}},handle:function(e){return e().catch(e=>{if(e instanceof T.PersistrError)throw e;if(e&&e.error&&"ECONNREFUSED"===e.error.code)throw new T.ConnectionRefused;throw e})}},O=T;(function(e){!function(){"use strict";(function(t){return(t instanceof e?t:e.from(t.toString(),"binary")).toString("base64")})}()}).call(this,require("buffer").Buffer);var S={},k="undefined"!=typeof self?self:this,j=function(){function e(){this.fetch=!1,this.DOMException=k.DOMException}return e.prototype=k,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(Zv){return!1}}(),s="FormData"in e,o="ArrayBuffer"in e;if(o)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function m(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():o&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,r,n=f(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=p(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=c(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=c(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),h(e)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var r,n,i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),v.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];w.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(N){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function C(e,r){return new Promise((function(n,s){var o=new b(e,r);if(o.signal&&o.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new w(i,r))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new t.DOMException("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",u)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}C.polyfill=!0,e.fetch||(e.fetch=C,e.Headers=d,e.Request=b,e.Response=w),t.Headers=d,t.Request=b,t.Response=w,t.fetch=C,Object.defineProperty(t,"__esModule",{value:!0})}({})}(j),j.fetch.ponyfill=!0,delete j.fetch.polyfill;var A=j;function R(e){return Number.isInteger(e)&&e>=0}function I(e){this.name="ArgumentError",this.message=e}(S=A.fetch).default=A.fetch,S.fetch=A.fetch,S.Headers=A.Headers,S.Request=A.Request,S.Response=A.Response;!function(e,t){if(t=t||{},"function"!=typeof e)throw new I("fetch must be a function");if("object"!=typeof t)throw new I("defaults must be an object");if(void 0!==t.retries&&!R(t.retries))throw new I("retries must be a positive integer");if(void 0!==t.retryDelay&&!R(t.retryDelay)&&"function"!=typeof t.retryDelay)throw new I("retryDelay must be a positive integer or a function returning a positive integer");if(void 0!==t.retryOn&&!Array.isArray(t.retryOn)&&"function"!=typeof t.retryOn)throw new I("retryOn property expects an array or function");t=Object.assign({retries:3,retryDelay:1e3,retryOn:[]},t)}(S=S,{retryOn:[503],retries:3,retryDelay:function(e,t,r){return Math.pow(7,e+1)}});var P={};function q(){this.jobs=Array.prototype.slice.call(arguments),this.running=!1}q.prototype={add:function(e){return e&&(arguments.length>1?this.jobs=this.jobs.concat(Array.prototype.slice.call(arguments)):this.jobs.push(e)),this},run:function(e){return this.add(e),this.running||this.start(),this},start:function(){this.running=!0,this.next(!1)},success:function(){this.next(!1)},fail:function(e){e=e||"Job failed",this.next(e)},next:function(e){if(this.jobs.length){var t=this.jobs.shift();try{t(e,this)}catch(Zv){this.next(Zv)}}else this.running=!1}},P=q;var L=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e},M={},D=Object.prototype.hasOwnProperty;function F(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(Zv){return null}}M.stringify=function(e,t){t=t||"";var r,n,i=[];for(n in"string"!=typeof t&&(t="?"),e)if(D.call(e,n)){if((r=e[n])||null!=r&&!isNaN(r)||(r=""),n=encodeURIComponent(n),r=encodeURIComponent(r),null===n||null===r)continue;i.push(n+"="+r)}return i.length?t+i.join("&"):""},M.parse=function(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);){var i=F(t[1]),s=F(t[2]);null===i||null===s||i in n||(n[i]=s)}return n};var U={};(function(e){"use strict";var t=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,r=/[\n\r\t]/g,n=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/:\d+$/,s=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,o=/^[a-zA-Z]:/;function a(e){return(e||"").toString().replace(t,"")}var u=[["#","hash"],["?","query"],function(e,t){return h(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],l={hash:1,query:1};function c(t){var r,i=("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{}).location||{},s={},o=typeof(t=t||i);if("blob:"===t.protocol)s=new f(unescape(t.pathname),{});else if("string"===o)for(r in s=new f(t,{}),l)delete s[r];else if("object"===o){for(r in t)r in l||(s[r]=t[r]);void 0===s.slashes&&(s.slashes=n.test(t.href))}return s}function h(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function d(e,t){e=(e=a(e)).replace(r,""),t=t||{};var n,i=s.exec(e),o=i[1]?i[1].toLowerCase():"",u=!!i[2],l=!!i[3],c=0;return u?l?(n=i[2]+i[3]+i[4],c=i[2].length+i[3].length):(n=i[2]+i[4],c=i[2].length):l?(n=i[3]+i[4],c=i[3].length):n=i[4],"file:"===o?c>=2&&(n=n.slice(2)):h(o)?n=i[4]:o?u&&(n=n.slice(2)):c>=2&&h(t.protocol)&&(n=i[4]),{protocol:o,slashes:u||h(o),slashesCount:c,rest:n}}function f(e,t,n){if(e=(e=a(e)).replace(r,""),!(this instanceof f))return new f(e,t,n);var i,s,l,p,m,y,g=u.slice(),v=typeof t,b=this,_=0;for("object"!==v&&"string"!==v&&(n=t,t=null),n&&"function"!=typeof n&&(n=M.parse),i=!(s=d(e||"",t=c(t))).protocol&&!s.slashes,b.slashes=s.slashes||i&&t.slashes,b.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||o.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!h(b.protocol)))&&(g[3]=[/(.*)/,"pathname"]);_<g.length;_++)"function"!=typeof(p=g[_])?(l=p[0],y=p[1],l!=l?b[y]=e:"string"==typeof l?~(m="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof p[2]?(b[y]=e.slice(0,m),e=e.slice(m+p[2])):(b[y]=e.slice(m),e=e.slice(0,m))):(m=l.exec(e))&&(b[y]=m[1],e=e.slice(0,m.index)),b[y]=b[y]||i&&p[3]&&t[y]||"",p[4]&&(b[y]=b[y].toLowerCase())):e=p(e,b);n&&(b.query=n(b.query)),i&&t.slashes&&"/"!==b.pathname.charAt(0)&&(""!==b.pathname||""!==t.pathname)&&(b.pathname=function(e,t){if(""===e)return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,i=r[n-1],s=!1,o=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),o++):o&&(0===n&&(s=!0),r.splice(n,1),o--);return s&&r.unshift(""),"."!==i&&".."!==i||r.push(""),r.join("/")}(b.pathname,t.pathname)),"/"!==b.pathname.charAt(0)&&h(b.protocol)&&(b.pathname="/"+b.pathname),L(b.port,b.protocol)||(b.host=b.hostname,b.port=""),b.username=b.password="",b.auth&&(~(m=b.auth.indexOf(":"))?(b.username=b.auth.slice(0,m),b.username=encodeURIComponent(decodeURIComponent(b.username)),b.password=b.auth.slice(m+1),b.password=encodeURIComponent(decodeURIComponent(b.password))):b.username=encodeURIComponent(decodeURIComponent(b.auth)),b.auth=b.password?b.username+":"+b.password:b.username),b.origin="file:"!==b.protocol&&h(b.protocol)&&b.host?b.protocol+"//"+b.host:"null",b.href=b.toString()}f.prototype={set:function(e,t,r){var n=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||M.parse)(t)),n[e]=t;break;case"port":n[e]=t,L(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,i.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";n[e]=t.charAt(0)!==s?s+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var o=t.indexOf(":");~o?(n.username=t.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var a=0;a<u.length;a++){var l=u[a];l[4]&&(n[l[1]]=n[l[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin="file:"!==n.protocol&&h(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(e){e&&"function"==typeof e||(e=M.stringify);var t,r=this,n=r.host,s=r.protocol;s&&":"!==s.charAt(s.length-1)&&(s+=":");var o=s+(r.protocol&&r.slashes||h(r.protocol)?"//":"");return r.username?(o+=r.username,r.password&&(o+=":"+r.password),o+="@"):r.password?(o+=":"+r.password,o+="@"):"file:"!==r.protocol&&h(r.protocol)&&!n&&"/"!==r.pathname&&(o+="@"),(":"===n[n.length-1]||i.test(r.hostname)&&!r.port)&&(n+=":"),o+=n+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(o+=r.hash),o}},f.extractProtocol=d,f.location=c,f.trimLeft=a,f.qs=M,U=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var B={};function V(e){return"string"==typeof e&&(e=U(e)),e.protocol&&e.hostname?(e.protocol+"//"+e.host).toLowerCase():"null"}V.same=function(e,t){return V(e)===V(t)},B=V;var z={};(function(e,t){var r=require("url").parse,n=require("events"),i=require("https"),s=require("http"),o=require("util"),a=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],u=[239,187,191];function l(n,o){var d=l.CONNECTING;Object.defineProperty(this,"readyState",{get:function(){return d}}),Object.defineProperty(this,"url",{get:function(){return n}});var f,p=this;function m(e){d!==l.CLOSED&&(d=l.CONNECTING,E("error",new c("error",{message:e})),_&&(n=_,_=null),setTimeout((function(){d===l.CONNECTING&&w()}),p.reconnectInterval))}p.reconnectInterval=1e3;var y="";o&&o.headers&&o.headers["Last-Event-ID"]&&(y=o.headers["Last-Event-ID"],delete o.headers["Last-Event-ID"]);var g=!1,v="",b="",_=null;function w(){var h=r(n),v="https:"===h.protocol;if(h.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},y&&(h.headers["Last-Event-ID"]=y),o&&o.headers)for(var b in o.headers){var N=o.headers[b];N&&(h.headers[b]=N)}if(h.rejectUnauthorized=!(o&&!o.rejectUnauthorized),o&&o.proxy){var $=r(o.proxy);v="https:"===$.protocol,h.protocol=v?"https:":"http:",h.path=n,h.headers.Host=h.host,h.hostname=$.hostname,h.host=$.host,h.port=$.port}if(o&&o.https)for(var x in o.https)if(-1!==a.indexOf(x)){var T=o.https[x];void 0!==T&&(h[x]=T)}o&&void 0!==o.withCredentials&&(h.withCredentials=o.withCredentials),(f=(v?i:s).request(h,(function(r){if(500===r.statusCode||502===r.statusCode||503===r.statusCode||504===r.statusCode)return E("error",new c("error",{status:r.statusCode,message:r.statusMessage})),void m();if(301===r.statusCode||307===r.statusCode)return r.headers.location?(307===r.statusCode&&(_=n),n=r.headers.location,void e.nextTick(w)):void E("error",new c("error",{status:r.statusCode,message:r.statusMessage}));if(200!==r.statusCode)return E("error",new c("error",{status:r.statusCode,message:r.statusMessage})),p.close();d=l.OPEN,r.on("close",(function(){r.removeAllListeners("close"),r.removeAllListeners("end"),m()})),r.on("end",(function(){r.removeAllListeners("close"),r.removeAllListeners("end"),m()})),E("open",new c("open"));var i,s=!0;r.on("data",(function(e){i=i?t.concat([i,e]):e,s&&function(e){return u.every((function(t,r){return e[r]===t}))}(i)&&(i=i.slice(u.length)),s=!1;for(var r=0,n=i.length;r<n;){g&&(10===i[r]&&++r,g=!1);for(var o,a=-1,l=-1,c=r;a<0&&c<n;++c)58===(o=i[c])?l<0&&(l=c-r):13===o?(g=!0,a=c-r):10===o&&(a=c-r);if(a<0)break;C(i,r,l,a),r+=a+1}r===n?i=void 0:r>0&&(i=i.slice(r))}))}))).on("error",(function(e){m(e.message)})),f.setNoDelay&&f.setNoDelay(!0),f.end()}function E(){p.listeners(arguments[0]).length>0&&p.emit.apply(p,arguments)}function C(e,t,r,i){if(0===i){if(v.length>0){var s=b||"message";E(s,new h(s,{data:v.slice(0,-1),lastEventId:y,origin:B(n)})),v=""}b=void 0}else if(r>0){var o,a=r<0,u=e.slice(t,t+(a?i:r)).toString();t+=o=a?i:32!==e[t+r+1]?r+1:r+2;var l=i-o,c=e.slice(t,t+l).toString();if("data"===u)v+=c+"\n";else if("event"===u)b=c;else if("id"===u)y=c;else if("retry"===u){var d=parseInt(c,10);Number.isNaN(d)||(p.reconnectInterval=d)}}}w(),this._close=function(){d!==l.CLOSED&&(d=l.CLOSED,f.abort&&f.abort(),f.xhr&&f.xhr.abort&&f.xhr.abort())}}function c(e,t){if(Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)for(var r in t)t.hasOwnProperty(r)&&Object.defineProperty(this,r,{writable:!1,value:t[r],enumerable:!0})}function h(e,t){for(var r in Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)t.hasOwnProperty(r)&&Object.defineProperty(this,r,{writable:!1,value:t[r],enumerable:!0})}z=l,o.inherits(l,n.EventEmitter),l.prototype.constructor=l,["open","error","message"].forEach((function(e){Object.defineProperty(l.prototype,"on"+e,{get:function(){var t=this.listeners(e)[0];return t?t._listener?t._listener:t:void 0},set:function(t){this.removeAllListeners(e),this.addEventListener(e,t)}})})),Object.defineProperty(l,"CONNECTING",{enumerable:!0,value:0}),Object.defineProperty(l,"OPEN",{enumerable:!0,value:1}),Object.defineProperty(l,"CLOSED",{enumerable:!0,value:2}),l.prototype.CONNECTING=0,l.prototype.OPEN=1,l.prototype.CLOSED=2,l.prototype.close=function(){this._close()},l.prototype.addEventListener=function(e,t){"function"==typeof t&&(t._listener=t,this.on(e,t))},l.prototype.dispatchEvent=function(e){if(!e.type)throw new Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(e.type,e.detail)},l.prototype.removeEventListener=function(e,t){"function"==typeof t&&(t._listener=void 0,this.removeListener(e,t))}}).call(this,require("_process"),require("buffer").Buffer);var H={exports:{}};(function(e,t,r){!function(e){if("object"==typeof H.exports)H.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;"undefined"!=typeof window?r=window:void 0!==t?r=t:"undefined"!=typeof self&&(r=self),r.Promise=e()}}((function(){return function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var u="function"==typeof _dereq_&&_dereq_;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof _dereq_&&_dereq_,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";t.exports=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}e.any=function(e){return r(e)},e.prototype.any=function(){return r(this)}}},{}],2:[function(t,r,n){"use strict";var i;try{throw new Error}catch(Zv){i=Zv}var s=t("./schedule"),o=t("./queue");function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=s}function u(e){for(;e.length()>0;)l(e)}function l(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var r=e.shift(),n=e.shift();t.call(r,n)}}a.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(t,r){r?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},a.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(Zv){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},a.prototype.invokeLater=function(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()},a.prototype.invoke=function(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()},a.prototype.settlePromises=function(e){this._normalQueue._pushOne(e),this._queueTick()},a.prototype._drainQueues=function(){u(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,u(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},r.exports=a,r.exports.firstLineError=i},{"./queue":26,"./schedule":29}],3:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){var i=!1,s=function(e,t){this._reject(t)},o=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(s,s,null,this,e)},a=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(s){i||(i=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var l=r(s),c=new e(t);c._propagateFrom(this,1);var h=this._target();if(c._setBoundTo(l),l instanceof e){var d={promiseRejectionQueued:!1,promise:c,target:h,bindingPromise:l};h._then(t,o,void 0,c,d),l._then(a,u,void 0,c,d),c._setOnCancel(l)}else c._resolveCallback(h);return c},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,r){return e.resolve(r).bind(t)}}},{}],4:[function(e,t,r){"use strict";var n;"undefined"!=typeof Promise&&(n=Promise);var i=e("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=n)}catch(Zv){}return i},t.exports=i},{"./promise":22}],5:[function(e,t,r){"use strict";var n=Object.create;if(n){var i=n(null),s=n(null);i[" size"]=s[" size"]=0}t.exports=function(t){var r=e("./util"),n=r.canEvaluate;function i(e){return function(e,n){var i;if(null!=e&&(i=e[n]),"function"!=typeof i){var s="Object "+r.classString(e)+" has no method '"+r.toString(n)+"'";throw new t.TypeError(s)}return i}(e,this.pop()).apply(e,this)}function s(e){return e[this]}function o(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}r.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(i,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=o;else if(n){var r=(void 0)(e);t=null!==r?r:s}else t=s;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,r){"use strict";t.exports=function(t,r,n,i){var s=e("./util"),o=s.tryCatch,a=s.errorObj,u=t._async;t.prototype.break=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null==r||!r._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(s.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=o(e).call(this._boundValue());n===a&&(this._attachExtraTrace(n.e),u.throwLater(n.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util"),n=e("./es5").keys,i=r.tryCatch,s=r.errorObj;return function(e,o,a){return function(u){var l=a._boundValue();e:for(var c=0;c<e.length;++c){var h=e[c];if(h===Error||null!=h&&h.prototype instanceof Error){if(u instanceof h)return i(o).call(l,u)}else if("function"==typeof h){var d=i(h).call(l,u);if(d===s)return d;if(d)return i(o).call(l,u)}else if(r.isObject(u)){for(var f=n(h),p=0;p<f.length;++p){var m=f[p];if(h[m]!=u[m])continue e}return i(o).call(l,u)}}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t,r){"use strict";t.exports=function(e){var t=!1,r=[];function n(){this._trace=new n.CapturedTrace(i())}function i(){var e=r.length-1;if(e>=0)return r[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},n.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},n.CapturedTrace=null,n.create=function(){if(t)return new n},n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var r=e.prototype._pushContext,s=e.prototype._popContext,o=e._peekContext,a=e.prototype._peekContext,u=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=r,e.prototype._popContext=s,e._peekContext=o,e.prototype._peekContext=a,e.prototype._promiseCreated=u,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},n}},{}],9:[function(t,r,n){"use strict";r.exports=function(r,n,i,s){var o,a,u,l,c=r._async,h=t("./errors").Warning,d=t("./util"),f=t("./es5"),p=d.canAttachTrace,m=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,y=/\((?:timers\.js):\d+:\d+\)/,g=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,v=null,b=null,_=!1,w=!(0==d.env("BLUEBIRD_DEBUG")),E=!(0==d.env("BLUEBIRD_WARNINGS")||!w&&!d.env("BLUEBIRD_WARNINGS")),C=!(0==d.env("BLUEBIRD_LONG_STACK_TRACES")||!w&&!d.env("BLUEBIRD_LONG_STACK_TRACES")),N=0!=d.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(E||!!d.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var e=[];function t(){for(var t=0;t<e.length;++t)e[t]._notifyUnhandledRejection();n()}function n(){e.length=0}l=function(r){e.push(r),setTimeout(t,1)},f.defineProperty(r,"_unhandledRejectionCheck",{value:t}),f.defineProperty(r,"_unhandledRejectionClear",{value:n})}(),r.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},r.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),l(this))},r.prototype._notifyUnhandledRejectionIsHandled=function(){J("rejectionHandled",o,void 0,this)},r.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},r.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},r.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),J("unhandledRejection",a,e,this)}},r.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},r.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},r.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},r.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},r.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},r.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},r.prototype._warn=function(e,t,r){return z(e,t,r||this)},r.onPossiblyUnhandledRejection=function(e){var t=r._getContext();a=d.contextBind(t,e)},r.onUnhandledRejectionHandled=function(e){var t=r._getContext();o=d.contextBind(t,e)};var $=function(){};r.longStackTraces=function(){if(c.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!re.longStackTraces&&G()){var e=r.prototype._captureStackTrace,t=r.prototype._attachExtraTrace,i=r.prototype._dereferenceTrace;re.longStackTraces=!0,$=function(){if(c.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");r.prototype._captureStackTrace=e,r.prototype._attachExtraTrace=t,r.prototype._dereferenceTrace=i,n.deactivateLongStackTraces(),re.longStackTraces=!1},r.prototype._captureStackTrace=U,r.prototype._attachExtraTrace=B,r.prototype._dereferenceTrace=V,n.activateLongStackTraces()}},r.hasLongStackTraces=function(){return re.longStackTraces&&G()};var x={unhandledrejection:{before:function(){var e=d.global.onunhandledrejection;return d.global.onunhandledrejection=null,e},after:function(e){d.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=d.global.onrejectionhandled;return d.global.onrejectionhandled=null,e},after:function(e){d.global.onrejectionhandled=e}}},T=function(){var e=function(e,t){if(!e)return!d.global.dispatchEvent(t);var r;try{return r=e.before(),!d.global.dispatchEvent(t)}finally{e.after(r)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new CustomEvent(t,{detail:r,cancelable:!0});return f.defineProperty(n,"promise",{value:r.promise}),f.defineProperty(n,"reason",{value:r.reason}),e(x[t],n)}}return"function"==typeof Event?(t=new Event("CustomEvent"),d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new Event(t,{cancelable:!0});return n.detail=r,f.defineProperty(n,"promise",{value:r.promise}),f.defineProperty(n,"reason",{value:r.reason}),e(x[t],n)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!0,r),e(x[t],n)})}catch(Zv){}return function(){return!1}}(),O=d.isNode?function(){return e.emit.apply(e,arguments)}:d.global?function(e){var t="on"+e.toLowerCase(),r=d.global[t];return!!r&&(r.apply(d.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function S(e,t){return{promise:t}}var k={promiseCreated:S,promiseFulfilled:S,promiseRejected:S,promiseResolved:S,promiseCancelled:S,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:S},j=function(e){var t=!1;try{t=O.apply(null,arguments)}catch(Zv){c.throwLater(Zv),t=!0}var r=!1;try{r=T(e,k[e].apply(null,arguments))}catch(Zv){c.throwLater(Zv),r=!0}return r||t};function A(){return!1}function R(e,t,r){var n=this;try{e(t,r,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+d.toString(e));n._attachCancellationCallback(e)}))}catch(Zv){return Zv}}function I(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?d.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function P(){return this._onCancelField}function q(e){this._onCancelField=e}function L(){this._cancellationParent=void 0,this._onCancelField=void 0}function M(e,t){if(0!=(1&t)){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}r.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?r.longStackTraces():!e.longStackTraces&&r.hasLongStackTraces()&&$()),"warnings"in e){var t=e.warnings;re.warnings=!!t,N=re.warnings,d.isObject(t)&&"wForgottenReturn"in t&&(N=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!re.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");r.prototype._clearCancellationData=L,r.prototype._propagateFrom=M,r.prototype._onCancel=P,r.prototype._setOnCancel=q,r.prototype._attachCancellationCallback=I,r.prototype._execute=R,D=M,re.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!re.monitoring?(re.monitoring=!0,r.prototype._fireEvent=j):!e.monitoring&&re.monitoring&&(re.monitoring=!1,r.prototype._fireEvent=A)),"asyncHooks"in e&&d.nodeSupportsAsyncResource){var n=re.asyncHooks,o=!!e.asyncHooks;n!==o&&(re.asyncHooks=o,o?i():s())}return r},r.prototype._fireEvent=A,r.prototype._execute=function(e,t,r){try{e(t,r)}catch(Zv){return Zv}},r.prototype._onCancel=function(){},r.prototype._setOnCancel=function(e){},r.prototype._attachCancellationCallback=function(e){},r.prototype._captureStackTrace=function(){},r.prototype._attachExtraTrace=function(){},r.prototype._dereferenceTrace=function(){},r.prototype._clearCancellationData=function(){},r.prototype._propagateFrom=function(e,t){};var D=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function F(){var e=this._boundTo;return void 0!==e&&e instanceof r?e.isFulfilled()?e.value():void 0:e}function U(){this._trace=new ee(this._peekContext())}function B(e,t){if(p(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=Q(e);d.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),d.notEnumerableProp(e,"__stackCleaned__",!0)}}}function V(){this._trace=void 0}function z(e,t,n){if(re.warnings){var i,s=new h(e);if(t)n._attachExtraTrace(s);else if(re.longStackTraces&&(i=r._peekContext()))i.attachExtraTrace(s);else{var o=Q(s);s.stack=o.message+"\n"+o.stack.join("\n")}j("warning",s)||W(s,"",!0)}}function H(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],i="    (No stack trace)"===n||v.test(n),s=i&&Y(n);i&&!s&&(_&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function Q(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var n=t[r];if("    (No stack trace)"===n||v.test(n))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:H(t)}}function W(e,t,r){if("undefined"!=typeof console){var n;if(d.isObject(e)){var i=e.stack;n=t+b(i,e)}else n=t+String(e);"function"==typeof u?u(n,r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}}function J(e,t,r,n){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(n):t(r,n))}catch(Zv){c.throwLater(Zv)}"unhandledRejection"===e?j(e,r,n)||i||W(r,"Unhandled rejection "):j(e,n)}function K(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():d.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(Zv){}0===t.length&&(t="(empty array)")}return"(<"+function(e){return e.length<41?e:e.substr(0,38)+"..."}(t)+">, no stack trace)"}function G(){return"function"==typeof te}var Y=function(){return!1},Z=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function X(e){var t=e.match(Z);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function ee(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);te(this,ee),t>32&&this.uncycle()}d.inherits(ee,Error),n.CapturedTrace=ee,ee.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],r={},n=0,i=this;void 0!==i;++n)t.push(i),i=i._parent;for(n=(e=this._length=n)-1;n>=0;--n){var s=t[n].stack;void 0===r[s]&&(r[s]=n)}for(n=0;n<e;++n){var o=r[t[n].stack];if(void 0!==o&&o!==n){o>0&&(t[o-1]._parent=void 0,t[o-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var a=n>0?t[n-1]:this;o<e-1?(a._parent=t[o+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,l=n-2;l>=0;--l)t[l]._length=u,u++;return}}}},ee.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=Q(e),r=t.message,n=[t.stack],i=this;void 0!==i;)n.push(H(i.stack.split("\n"))),i=i._parent;!function(e){for(var t=e[0],r=1;r<e.length;++r){for(var n=e[r],i=t.length-1,s=t[i],o=-1,a=n.length-1;a>=0;--a)if(n[a]===s){o=a;break}for(a=o;a>=0;--a){var u=n[a];if(t[i]!==u)break;t.pop(),i--}t=n}}(n),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(n),d.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,n)),d.notEnumerableProp(e,"__stackCleaned__",!0)}};var te=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():K(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,v=e,b=t;var r=Error.captureStackTrace;return Y=function(e){return m.test(e)},function(e,t){Error.stackTraceLimit+=6,r(e,t),Error.stackTraceLimit-=6}}var n,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return v=/@/,b=t,_=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(Zv){n="stack"in Zv}return"stack"in i||!n||"number"!=typeof Error.stackTraceLimit?(b=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?K(t):t.toString()},null):(v=e,b=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(Zv){e.stack=Zv.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(u=function(e){console.warn(e)},d.isNode&&e.stderr.isTTY?u=function(e,t){var r=t?"\x1b[33m":"\x1b[31m";console.warn(r+e+"\x1b[0m\n")}:d.isNode||"string"!=typeof(new Error).stack||(u=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var re={warnings:E,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return C&&r.longStackTraces(),{asyncHooks:function(){return re.asyncHooks},longStackTraces:function(){return re.longStackTraces},warnings:function(){return re.warnings},cancellation:function(){return re.cancellation},monitoring:function(){return re.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return F},checkForgottenReturns:function(e,t,r,n,i){if(void 0===e&&null!==t&&N){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&n._bitField))return;r&&(r+=" ");var s="",o="";if(t._trace){for(var a=t._trace.stack.split("\n"),u=H(a),l=u.length-1;l>=0;--l){var c=u[l];if(!y.test(c)){var h=c.match(g);h&&(s="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(u.length>0){var d=u[0];for(l=0;l<a.length;++l)if(a[l]===d){l>0&&(o="\n"+a[l-1]);break}}}var f="a promise was created in a "+r+"handler "+s+"but was not returned from it, see http://goo.gl/rRqMUw"+o;n._warn(f,!0,t)}},setBounds:function(e,t){if(G()){for(var r,n,i=(e.stack||"").split("\n"),s=(t.stack||"").split("\n"),o=-1,a=-1,u=0;u<i.length;++u)if(l=X(i[u])){r=l.fileName,o=l.line;break}for(u=0;u<s.length;++u){var l;if(l=X(s[u])){n=l.fileName,a=l.line;break}}o<0||a<0||!r||!n||r!==n||o>=a||(Y=function(e){if(m.test(e))return!0;var t=X(e);return!!(t&&t.fileName===r&&o<=t.line&&t.line<=a)})}},warn:z,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),z(r)},CapturedTrace:ee,fireDomEvent:T,fireGlobalEvent:O}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,t,r){"use strict";t.exports=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,(function(){throw t}))},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var n=arguments[1];return n instanceof e&&n.suppressUnhandledRejections(),this.caught(r,(function(){return n}))}}},{}],11:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.reduce,n=e.all;function i(){return n(this)}e.prototype.each=function(e){return r(this,e,t,0)._then(i,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,n){return r(e,n,t,0)._then(i,void 0,void 0,e,void 0)},e.mapSeries=function(e,n){return r(e,n,t,t)}}},{}],12:[function(e,t,r){"use strict";var n,i,s=e("./es5"),o=s.freeze,a=e("./util"),u=a.inherits,l=a.notEnumerableProp;function c(e,t){function r(n){if(!(this instanceof r))return new r(n);l(this,"message","string"==typeof n?n:t),l(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(r,Error),r}var h=c("Warning","warning"),d=c("CancellationError","cancellation error"),f=c("TimeoutError","timeout error"),p=c("AggregateError","aggregate error");try{n=TypeError,i=RangeError}catch(Zv){n=c("TypeError","type error"),i=c("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<m.length;++y)"function"==typeof Array.prototype[m[y]]&&(p.prototype[m[y]]=Array.prototype[m[y]]);s.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var g=0;function v(e){if(!(this instanceof v))return new v(e);l(this,"name","OperationalError"),l(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(l(this,"message",e.message),l(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}p.prototype.toString=function(){var e=Array(4*g+1).join(" "),t="\n"+e+"AggregateError of:\n";g++,e=Array(4*g+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",i=n.split("\n"),s=0;s<i.length;++s)i[s]=e+i[s];t+=(n=i.join("\n"))+"\n"}return g--,t},u(v,Error);var b=Error.__BluebirdErrorTypes__;b||(b=o({CancellationError:d,TimeoutError:f,OperationalError:v,RejectionError:v,AggregateError:p}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:n,RangeError:i,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:h}},{"./es5":13,"./util":36}],13:[function(e,t,r){var n=function(){"use strict";return void 0===this}();if(n)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!(r&&!r.writable&&!r.set)}};else{var i={}.hasOwnProperty,s={}.toString,o={}.constructor.prototype,a=function(e){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t};t.exports={isArray:function(e){try{return"[object Array]"===s.call(e)}catch(Zv){return!1}},keys:a,names:a,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(Zv){return o}},isES5:n,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.map;e.prototype.filter=function(e,n){return r(this,e,n,t)},e.filter=function(e,n,i){return r(e,n,i,t)}}},{}],15:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=e("./util"),s=t.CancellationError,o=i.errorObj,a=e("./catch_filter")(n);function u(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function l(e){this.finallyHandler=e}function c(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function h(){return f.call(this,this.promise._target()._settledValue())}function d(e){if(!c(this,e))return o.e=e,o}function f(e){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),e);if(u===n)return u;if(void 0!==u){i._setReturnedNonUndefined();var f=r(u,i);if(f instanceof t){if(null!=this.cancelPromise){if(f._isCancelled()){var p=new s("late cancellation observer");return i._attachExtraTrace(p),o.e=p,o}f.isPending()&&f._attachCancellationCallback(new l(this))}return f._then(h,d,void 0,this,void 0)}}}return i.isRejected()?(c(this),o.e=e,o):(c(this),e)}return u.prototype.isFinallyHandler=function(){return 0===this.type},l.prototype._resultCancelled=function(){c(this.finallyHandler)},t.prototype._passThrough=function(e,t,r,n){return"function"!=typeof e?this.then():this._then(r,n,void 0,new u(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,f,f)},t.prototype.tap=function(e){return this._passThrough(e,1,f)},t.prototype.tapCatch=function(e){var r=arguments.length;if(1===r)return this._passThrough(e,1,void 0,f);var n,s=new Array(r-1),o=0;for(n=0;n<r-1;++n){var u=arguments[n];if(!i.isObject(u))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+i.classString(u)));s[o++]=u}s.length=o;var l=arguments[n];return this._passThrough(a(s,l,this),1,void 0,f)},u}},{"./catch_filter":7,"./util":36}],16:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./errors").TypeError,u=e("./util"),l=u.errorObj,c=u.tryCatch,h=[];function d(e,r,i,s){if(o.cancellation()){var a=new t(n),u=this._finallyPromise=new t(n);this._promise=a.lastly((function(){return u})),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new t(n))._captureStackTrace();this._stack=s,this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(d,s),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=c(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),e=c(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},d.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=c(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=c(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(e){var r=this._promise;if(e===l)return this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(e.e,!1);var n=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(n);var s=i(n,this._promise);if(s instanceof t||null!==(s=function(e,r,n){for(var s=0;s<r.length;++s){n._pushContext();var o=c(r[s])(e);if(n._popContext(),o===l){n._pushContext();var a=t.reject(l.e);return n._popContext(),a}var u=i(o,n);if(u instanceof t)return u}return null}(s,this._yieldHandlers,this._promise))){var o=(s=s._target())._bitField;0==(50397184&o)?(this._yieldedPromise=s,s._proxy(this,null)):0!=(33554432&o)?t._async.invoke(this._promiseFulfilled,this,s._value()):0!=(16777216&o)?t._async.invoke(this._promiseRejected,this,s._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,n=d,i=(new Error).stack;return function(){var t=e.apply(this,arguments),s=new n(void 0,void 0,r,i),o=s.promise();return s._generator=t,s._promiseFulfilled(void 0),o}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new a("expecting a function but got "+u.classString(e));h.push(e)},t.spawn=function(e){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return r("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new d(e,this),i=n.promise();return n._run(t.spawn),i}}},{"./errors":12,"./util":36}],17:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s){var o=e("./util");o.canEvaluate,o.tryCatch,o.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var n=[].slice.call(arguments);e&&n.pop();var i=new r(n).promise();return void 0!==e?i.spread(e):i}}},{"./util":36}],18:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./util"),u=a.tryCatch,l=a.errorObj,c=t._async;function h(e,r,n,i){this.constructor$(e),this._promise._captureStackTrace();var o=t._getContext();if(this._callback=a.contextBind(o,r),this._preservedValues=i===s?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],c.invoke(this._asyncInit,this,void 0),a.isArray(e))for(var u=0;u<e.length;++u){var l=e[u];l instanceof t&&l.suppressUnhandledRejections()}}function d(e,r,i,s){if("function"!=typeof r)return n("expecting a function but got "+a.classString(r));var o=0;if(void 0!==i){if("object"!=typeof i||null===i)return t.reject(new TypeError("options argument must be an object but it is "+a.classString(i)));if("number"!=typeof i.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(i.concurrency)));o=i.concurrency}return new h(e,r,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,s).promise()}a.inherits(h,r),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(e,r){var n=this._values,s=this.length(),a=this._preservedValues,c=this._limit;if(r<0){if(n[r=-1*r-1]=e,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return n[r]=e,this._queue.push(r),!1;null!==a&&(a[r]=e);var h=this._promise,d=this._callback,f=h._boundValue();h._pushContext();var p=u(d).call(f,e,r,s),m=h._popContext();if(o.checkForgottenReturns(p,m,null!==a?"Promise.filter":"Promise.map",h),p===l)return this._reject(p.e),!0;var y=i(p,this._promise);if(y instanceof t){var g=(y=y._target())._bitField;if(0==(50397184&g))return c>=1&&this._inFlight++,n[r]=y,y._proxy(this,-1*(r+1)),!1;if(0==(33554432&g))return 0!=(16777216&g)?(this._reject(y._reason()),!0):(this._cancel(),!0);p=y._value()}n[r]=p}return++this._totalResolved>=s&&(null!==a?this._filter(n,a):this._resolve(n),!0)},h.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(r[n],n)}},h.prototype._filter=function(e,t){for(var r=t.length,n=new Array(r),i=0,s=0;s<r;++s)e[s]&&(n[i++]=t[s]);n.length=i,this._resolve(n)},h.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return d(this,e,t,null)},t.map=function(e,t,r,n){return d(e,t,r,n)}}},{"./util":36}],19:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s){var o=e("./util"),a=o.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+o.classString(e));return function(){var n=new t(r);n._captureStackTrace(),n._pushContext();var i=a(e).apply(this,arguments),o=n._popContext();return s.checkForgottenReturns(i,o,"Promise.method",n),n._resolveFromSyncValue(i),n}},t.attempt=t.try=function(e){if("function"!=typeof e)return i("expecting a function but got "+o.classString(e));var n,u=new t(r);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){s.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],c=arguments[2];n=o.isArray(l)?a(e).apply(c,l):a(e).call(c,l)}else n=a(e)();var h=u._popContext();return s.checkForgottenReturns(n,h,"Promise.try",u),u._resolveFromSyncValue(n),u},t.prototype._resolveFromSyncValue=function(e){e===o.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,r){"use strict";var n=e("./util"),i=n.maybeWrapAsError,s=e("./errors").OperationalError,o=e("./es5"),a=/^(?:name|message|stack|cause)$/;function u(e){var t;if(function(e){return e instanceof Error&&o.getPrototypeOf(e)===Error.prototype}(e)){(t=new s(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var r=o.keys(e),i=0;i<r.length;++i){var u=r[i];a.test(u)||(t[u]=e[u])}return t}return n.markAsOriginatingFromRejection(e),e}t.exports=function(e,t){return function(r,n){if(null!==e){if(r){var s=u(i(r));e._attachExtraTrace(s),e._reject(s)}else if(t){var o=[].slice.call(arguments,1);e._fulfill(o)}else e._fulfill(n);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util"),n=t._async,i=r.tryCatch,s=r.errorObj;function o(e,t){if(!r.isArray(e))return a.call(this,e,t);var o=i(t).apply(this._boundValue(),[null].concat(e));o===s&&n.throwLater(o.e)}function a(e,t){var r=this._boundValue(),o=void 0===e?i(t).call(r,null):i(t).call(r,null,e);o===s&&n.throwLater(o.e)}function u(e,t){if(!e){var r=new Error(e+"");r.cause=e,e=r}var o=i(t).call(this._boundValue(),e);o===s&&n.throwLater(o.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var r=a;void 0!==t&&Object(t).spread&&(r=o),this._then(r,u,void 0,this,e)}return this}}},{"./util":36}],22:[function(t,r,n){"use strict";r.exports=function(){var n=function(){return new v("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},i=function(){return new R.PromiseInspection(this._target())},s=function(e){return R.reject(new v(e))};function o(){}var a={},u=t("./util");u.setReflectHandler(i);var l=function(){var t=e.domain;return void 0===t?null:t},c=function(){return{domain:l(),async:null}},h=u.isNode&&u.nodeSupportsAsyncResource?t("async_hooks").AsyncResource:null,d=function(){return{domain:l(),async:new h("Bluebird::Promise")}},f=u.isNode?c:function(){return null};u.notEnumerableProp(R,"_getContext",f);var p=t("./es5"),m=t("./async"),y=new m;p.defineProperty(R,"_async",{value:y});var g=t("./errors"),v=R.TypeError=g.TypeError;R.RangeError=g.RangeError;var b=R.CancellationError=g.CancellationError;R.TimeoutError=g.TimeoutError,R.OperationalError=g.OperationalError,R.RejectionError=g.OperationalError,R.AggregateError=g.AggregateError;var _=function(){},w={},E={},C=t("./thenables")(R,_),N=t("./promise_array")(R,_,C,s,o),$=t("./context")(R),x=$.create,T=t("./debuggability")(R,$,(function(){f=d,u.notEnumerableProp(R,"_getContext",d)}),(function(){f=c,u.notEnumerableProp(R,"_getContext",c)})),O=(T.CapturedTrace,t("./finally")(R,C,E)),S=t("./catch_filter")(E),k=t("./nodeback"),j=u.errorObj,A=u.tryCatch;function R(e){e!==_&&function(e,t){if(null==e||e.constructor!==R)throw new v("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new v("expecting a function but got "+u.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function I(e){this.promise._resolveCallback(e)}function P(e){this.promise._rejectCallback(e,!1)}function q(e){var t=new R(_);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return R.prototype.toString=function(){return"[object Promise]"},R.prototype.caught=R.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,n=new Array(t-1),i=0;for(r=0;r<t-1;++r){var o=arguments[r];if(!u.isObject(o))return s("Catch statement predicate: expecting an object but got "+u.classString(o));n[i++]=o}if(n.length=i,"function"!=typeof(e=arguments[r]))throw new v("The last argument to .catch() must be a function, got "+u.toString(e));return this.then(void 0,S(n,e,this))}return this.then(void 0,e)},R.prototype.reflect=function(){return this._then(i,i,void 0,this,void 0)},R.prototype.then=function(e,t){if(T.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+u.classString(e);arguments.length>1&&(r+=", "+u.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},R.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},R.prototype.spread=function(e){return"function"!=typeof e?s("expecting a function but got "+u.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},R.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},R.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new N(this).promise()},R.prototype.error=function(e){return this.caught(u.originatesFromRejection,e)},R.getNewLibraryCopy=r.exports,R.is=function(e){return e instanceof R},R.fromNode=R.fromCallback=function(e){var t=new R(_);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=A(e)(k(t,r));return n===j&&t._rejectCallback(n.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},R.all=function(e){return new N(e).promise()},R.cast=function(e){var t=C(e);return t instanceof R||((t=new R(_))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},R.resolve=R.fulfilled=R.cast,R.reject=R.rejected=function(e){var t=new R(_);return t._captureStackTrace(),t._rejectCallback(e,!0),t},R.setScheduler=function(e){if("function"!=typeof e)throw new v("expecting a function but got "+u.classString(e));return y.setScheduler(e)},R.prototype._then=function(e,t,r,n,i){var s=void 0!==i,o=s?i:new R(_),a=this._target(),l=a._bitField;s||(o._propagateFrom(this,3),o._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&l)?this._boundValue():a===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,o));var c=f();if(0!=(50397184&l)){var h,d,p=a._settlePromiseCtx;0!=(33554432&l)?(d=a._rejectionHandler0,h=e):0!=(16777216&l)?(d=a._fulfillmentHandler0,h=t,a._unsetRejectionIsUnhandled()):(p=a._settlePromiseLateCancellationObserver,d=new b("late cancellation observer"),a._attachExtraTrace(d),h=t),y.invoke(p,a,{handler:u.contextBind(c,h),promise:o,receiver:n,value:d})}else a._addCallbacks(e,t,o,n,c);return o},R.prototype._length=function(){return 65535&this._bitField},R.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},R.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},R.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},R.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},R.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},R.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},R.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},R.prototype._isFinal=function(){return(4194304&this._bitField)>0},R.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},R.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},R.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},R.prototype._setAsyncGuaranteed=function(){if(!y.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},R.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},R.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==a)return void 0===t&&this._isBound()?this._boundValue():t},R.prototype._promiseAt=function(e){return this[4*e-4+2]},R.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},R.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},R.prototype._boundValue=function(){},R.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,r=e._rejectionHandler0,n=e._promise0,i=e._receiverAt(0);void 0===i&&(i=a),this._addCallbacks(t,r,n,i,null)},R.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),i=e._promiseAt(t),s=e._receiverAt(t);void 0===s&&(s=a),this._addCallbacks(r,n,i,s,null)},R.prototype._addCallbacks=function(e,t,r,n,i){var s=this._length();if(s>=65531&&(s=0,this._setLength(0)),0===s)this._promise0=r,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=u.contextBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=u.contextBind(i,t));else{var o=4*s-4;this[o+2]=r,this[o+3]=n,"function"==typeof e&&(this[o+0]=u.contextBind(i,e)),"function"==typeof t&&(this[o+1]=u.contextBind(i,t))}return this._setLength(s+1),s},R.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},R.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(n(),!1);var r=C(e,this);if(!(r instanceof R))return this._fulfill(e);t&&this._propagateFrom(r,2);var i=r._target();if(i!==this){var s=i._bitField;if(0==(50397184&s)){var o=this._length();o>0&&i._migrateCallback0(this);for(var a=1;a<o;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&s))this._fulfill(i._value());else if(0!=(16777216&s))this._reject(i._reason());else{var u=new b("late cancellation observer");i._attachExtraTrace(u),this._reject(u)}}else this._reject(n())}},R.prototype._rejectCallback=function(e,t,r){var n=u.ensureErrorObject(e),i=n===e;if(!i&&!r&&T.warnings()){var s="a promise was rejected with a non-error: "+u.classString(e);this._warn(s,!0)}this._attachExtraTrace(n,!!t&&i),this._reject(e)},R.prototype._resolveFromExecutor=function(e){if(e!==_){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,n=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,r)}));r=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)}},R.prototype._settlePromiseFromHandler=function(e,t,r,n){var i=n._bitField;if(0==(65536&i)){var s;n._pushContext(),t===w?r&&"number"==typeof r.length?s=A(e).apply(this._boundValue(),r):(s=j).e=new v("cannot .spread() a non-array: "+u.classString(r)):s=A(e).call(t,r);var o=n._popContext();0==(65536&(i=n._bitField))&&(s===E?n._reject(r):s===j?n._rejectCallback(s.e,!1):(T.checkForgottenReturns(s,o,"",n,this),n._resolveCallback(s)))}},R.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},R.prototype._followee=function(){return this._rejectionHandler0},R.prototype._setFollowee=function(e){this._rejectionHandler0=e},R.prototype._settlePromise=function(e,t,r,n){var s=e instanceof R,a=this._bitField,u=0!=(134217728&a);0!=(65536&a)?(s&&e._invokeInternalOnCancel(),r instanceof O&&r.isFinallyHandler()?(r.cancelPromise=e,A(t).call(r,n)===j&&e._reject(j.e)):t===i?e._fulfill(i.call(r)):r instanceof o?r._promiseCancelled(e):s||e instanceof N?e._cancel():r.cancel()):"function"==typeof t?s?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,n,e)):t.call(r,n,e):r instanceof o?r._isResolved()||(0!=(33554432&a)?r._promiseFulfilled(n,e):r._promiseRejected(n,e)):s&&(u&&e._setAsyncGuaranteed(),0!=(33554432&a)?e._fulfill(n):e._reject(n))},R.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,n=e.receiver,i=e.value;"function"==typeof t?r instanceof R?this._settlePromiseFromHandler(t,n,i,r):t.call(n,i,r):r instanceof R&&r._reject(i)},R.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},R.prototype._settlePromise0=function(e,t,r){var n=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,i,t)},R.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},R.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!=(134217728&t)?this._settlePromises():y.settlePromises(this),this._dereferenceTrace())}},R.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return y.fatalError(e,u.isNode);(65535&t)>0?y.settlePromises(this):this._ensurePossibleRejectionHandled()}},R.prototype._fulfillPromises=function(e,t){for(var r=1;r<e;r++){var n=this._fulfillmentHandlerAt(r),i=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,s,t)}},R.prototype._rejectPromises=function(e,t){for(var r=1;r<e;r++){var n=this._rejectionHandlerAt(r),i=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,s,t)}},R.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},R.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&p.defineProperty(R.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),R.defer=R.pending=function(){return T.deprecated("Promise.defer","new Promise"),{promise:new R(_),resolve:I,reject:P}},u.notEnumerableProp(R,"_makeSelfResolutionError",n),t("./method")(R,_,C,s,T),t("./bind")(R,_,C,T),t("./cancel")(R,N,s,T),t("./direct_resolve")(R),t("./synchronous_inspection")(R),t("./join")(R,N,C,_,y),R.Promise=R,R.version="3.7.2",t("./call_get.js")(R),t("./generators.js")(R,s,_,C,o,T),t("./map.js")(R,N,s,C,_,T),t("./nodeify.js")(R),t("./promisify.js")(R,_),t("./props.js")(R,N,C,s),t("./race.js")(R,_,C,s),t("./reduce.js")(R,N,s,C,_,T),t("./settle.js")(R,N,T),t("./some.js")(R,N,s),t("./timers.js")(R,_,T),t("./using.js")(R,s,C,x,_,T),t("./any.js")(R),t("./each.js")(R,_),t("./filter.js")(R,_),u.toFastProperties(R),u.toFastProperties(R.prototype),q({a:1}),q({b:2}),q({c:3}),q(1),q((function(){})),q(void 0),q(!1),q(new R(_)),T.setBounds(m.firstLineError,u.lastLineError),R}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s){var o=e("./util");function a(e){var n=this._promise=new t(r);e instanceof t&&(n._propagateFrom(e,3),e.suppressUnhandledRejections()),n._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return o.isArray,o.inherits(a,s),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function e(r,s){var a=n(this._values,this._promise);if(a instanceof t){var u=(a=a._target())._bitField;if(this._values=a,0==(50397184&u))return this._promise._setAsyncGuaranteed(),a._then(e,this._reject,void 0,this,s);if(0==(33554432&u))return 0!=(16777216&u)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=o.asArray(a)))0!==a.length?this._iterate(a):-5===s?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(s));else{var l=i("expecting an array or an iterable object but got "+o.classString(a)).reason();this._promise._rejectCallback(l,!1)}},a.prototype._iterate=function(e){var r=this.getActualLength(e.length);this._length=r,this._values=this.shouldCopyValues()?new Array(r):this._values;for(var i=this._promise,s=!1,o=null,a=0;a<r;++a){var u=n(e[a],i);o=u instanceof t?(u=u._target())._bitField:null,s?null!==o&&u.suppressUnhandledRejections():null!==o?0==(50397184&o)?(u._proxy(this,a),this._values[a]=u):s=0!=(33554432&o)?this._promiseFulfilled(u._value(),a):0!=(16777216&o)?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):s=this._promiseFulfilled(u,a)}s||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},a.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var r=0;r<e.length;++r)e[r]instanceof t&&e[r].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},{"./util":36}],24:[function(e,t,r){"use strict";t.exports=function(t,r){var n={},i=e("./util"),s=e("./nodeback"),o=i.withAppended,a=i.maybeWrapAsError,u=i.canEvaluate,l=e("./errors").TypeError,c={__isPromisified__:!0},h=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),d=function(e){return i.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function f(e){return!h.test(e)}function p(e){try{return!0===e.__isPromisified__}catch(Zv){return!1}}function m(e,t,r){var n=i.getDataPropertyOrDefault(e,t+r,c);return!!n&&p(n)}var y=u?void 0:function(e,u,l,c,h,d){var f=function(){return this}(),p=e;function m(){var i=u;u===n&&(i=this);var l=new t(r);l._captureStackTrace();var c="string"==typeof p&&this!==f?this[p]:e,h=s(l,d);try{c.apply(i,o(arguments,h))}catch(Zv){l._rejectCallback(a(Zv),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof p&&(e=c),i.notEnumerableProp(m,"__isPromisified__",!0),m};function g(e,t,r,s,o){for(var a=new RegExp(function(e){return e.replace(/([$])/,"\\$")}(t)+"$"),u=function(e,t,r,n){for(var s=i.inheritedDataKeys(e),o=[],a=0;a<s.length;++a){var u=s[a],c=e[u],h=n===d||d(u);"function"!=typeof c||p(c)||m(e,u,t)||!n(u,c,e,h)||o.push(u,c)}return function(e,t,r){for(var n=0;n<e.length;n+=2){var i=e[n];if(r.test(i))for(var s=i.replace(r,""),o=0;o<e.length;o+=2)if(e[o]===s)throw new l("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(o,t,r),o}(e,t,a,r),c=0,h=u.length;c<h;c+=2){var f=u[c],g=u[c+1],v=f+t;if(s===y)e[v]=y(f,n,f,g,t,o);else{var b=s(g,(function(){return y(f,n,f,g,t,o)}));i.notEnumerableProp(b,"__isPromisified__",!0),e[v]=b}}return i.toFastProperties(e),e}t.promisify=function(e,t){if("function"!=typeof e)throw new l("expecting a function but got "+i.classString(e));if(p(e))return e;var r,s,o,a=(r=e,s=void 0===(t=Object(t)).context?n:t.context,o=!!t.multiArgs,y(r,s,void 0,r,null,o));return i.copyDescriptors(e,a,f),a},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new l("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,n=t.suffix;"string"!=typeof n&&(n="Async");var s=t.filter;"function"!=typeof s&&(s=d);var o=t.promisifier;if("function"!=typeof o&&(o=y),!i.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=i.inheritedDataKeys(e),u=0;u<a.length;++u){var c=e[a[u]];"constructor"!==a[u]&&i.isClass(c)&&(g(c.prototype,n,s,o,r),g(c,n,s,o,r))}return g(e,n,s,o,r)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,r){"use strict";t.exports=function(t,r,n,i){var s,o=e("./util"),a=o.isObject,u=e("./es5");"function"==typeof Map&&(s=Map);var l=function(){var e=0,t=0;function r(r,n){this[e]=r,this[e+t]=n,e++}return function(n){t=n.size,e=0;var i=new Array(2*n.size);return n.forEach(r,i),i}}();function c(e){var t,r=!1;if(void 0!==s&&e instanceof s)t=l(e),r=!0;else{var n=u.keys(e),i=n.length;t=new Array(2*i);for(var o=0;o<i;++o){var a=n[o];t[o]=e[a],t[o+i]=a}}this.constructor$(t),this._isMap=r,this._init$(void 0,r?-6:-3)}function h(e){var r,s=n(e);return a(s)?(r=s instanceof t?s._then(t.props,void 0,void 0,void 0,void 0):new c(s).promise(),s instanceof t&&r._propagateFrom(s,2),r):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}o.inherits(c,r),c.prototype._init=function(){},c.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var r;if(this._isMap)r=function(e){for(var t=new s,r=e.length/2|0,n=0;n<r;++n){var i=e[r+n],o=e[n];t.set(i,o)}return t}(this._values);else{r={};for(var n=this.length(),i=0,o=this.length();i<o;++i)r[this._values[i+n]]=this._values[i]}return this._resolve(r),!0}return!1},c.prototype.shouldCopyValues=function(){return!1},c.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return h(this)},t.props=function(e){return h(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,r){"use strict";function n(e){this._capacity=e,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(e){return this._capacity<e},n.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},n.prototype.push=function(e,t,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(r);var i=this._front+n-3;this._checkCapacity(n);var s=this._capacity-1;this[i+0&s]=e,this[i+1&s]=t,this[i+2&s]=r,this._length=n},n.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,n,i){for(var s=0;s<i;++s)r[s+n]=e[s+0],e[s+0]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=n},{}],27:[function(e,t,r){"use strict";t.exports=function(t,r,n,i){var s=e("./util");function o(e,a){var u,l=n(e);if(l instanceof t)return(u=l).then((function(e){return o(e,u)}));if(null===(e=s.asArray(e)))return i("expecting an array or an iterable object but got "+s.classString(e));var c=new t(r);void 0!==a&&c._propagateFrom(a,3);for(var h=c._fulfill,d=c._reject,f=0,p=e.length;f<p;++f){var m=e[f];(void 0!==m||f in e)&&t.cast(m)._then(h,d,void 0,c,null)}return c}t.race=function(e){return o(e,void 0)},t.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./util"),u=a.tryCatch;function l(e,r,n,i){this.constructor$(e);var o=t._getContext();this._fn=a.contextBind(o,r),void 0!==n&&(n=t.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=i===s?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function h(e,t,r,i){return"function"!=typeof t?n("expecting a function but got "+a.classString(t)):new l(e,t,r,i).promise()}function d(e){this.accum=e,this.array._gotAccum(e);var r=i(this.value,this.array._promise);return r instanceof t?(this.array._currentCancellable=r,r._then(f,void 0,void 0,this,void 0)):f.call(this,r)}function f(e){var r,n=this.array,i=n._promise,s=u(n._fn);i._pushContext(),(r=void 0!==n._eachValues?s.call(i._boundValue(),e,this.index,this.length):s.call(i._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(n._currentCancellable=r);var a=i._popContext();return o.checkForgottenReturns(r,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),r}a.inherits(l,r),l.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==s&&this._eachValues.push(e)},l.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},l.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},l.prototype._iterate=function(e){var r,n;this._values=e;var i=e.length;void 0!==this._initialValue?(r=this._initialValue,n=0):(r=t.resolve(e[0]),n=1),this._currentCancellable=r;for(var s=n;s<i;++s){var o=e[s];o instanceof t&&o.suppressUnhandledRejections()}if(!r.isRejected())for(;n<i;++n){var a={accum:null,value:e[n],index:n,length:i,array:this};r=r._then(d,void 0,void 0,a,void 0),0==(127&n)&&r._setNoAsyncGuarantee()}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(c,c,void 0,r,this)},t.prototype.reduce=function(e,t){return h(this,e,t,null)},t.reduce=function(e,t,r,n){return h(e,t,r,n)}}},{"./util":36}],29:[function(n,i,s){"use strict";var o,a,u,l,c,h=n("./util"),d=h.getNativePromise();if(h.isNode&&"undefined"==typeof MutationObserver){var f=t.setImmediate,p=e.nextTick;o=h.isRecentNode?function(e){f.call(t,e)}:function(t){p.call(e,t)}}else if("function"==typeof d&&"function"==typeof d.resolve){var m=d.resolve();o=function(e){m.then(e)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?void 0!==r?function(e){r(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(a=document.createElement("div"),u={attributes:!0},l=!1,c=document.createElement("div"),new MutationObserver((function(){a.classList.toggle("foo"),l=!1})).observe(c,u),function(e){var t=new MutationObserver((function(){t.disconnect(),e()}));t.observe(a,u),l||(l=!0,c.classList.toggle("foo"))});i.exports=o},{"./util":36}],30:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=t.PromiseInspection;function s(e){this.constructor$(e)}e("./util").inherits(s,r),s.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseFulfilled=function(e,t){var r=new i;return r._bitField=33554432,r._settledValueField=e,this._promiseResolved(t,r)},s.prototype._promiseRejected=function(e,t){var r=new i;return r._bitField=16777216,r._settledValueField=e,this._promiseResolved(t,r)},t.settle=function(e){return n.deprecated(".settle()",".reflect()"),new s(e).promise()},t.allSettled=function(e){return new s(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=e("./util"),s=e("./errors").RangeError,o=e("./errors").AggregateError,a=i.isArray,u={};function l(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(e,t){if((0|t)!==t||t<0)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var r=new l(e),i=r.promise();return r.setHowMany(t),r.init(),i}i.inherits(l,r),l.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=a(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(e){this._howMany=e},l.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},l.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new o,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(e){this._values.push(e)},l.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return c(e,t)},t.prototype.some=function(e){return c(this,e)},t._SomePromiseArray=l}},{"./errors":12,"./util":36}],32:[function(e,t,r){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},s=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},o=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return o.call(this._target())},e.prototype.isRejected=function(){return s.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,r){"use strict";t.exports=function(t,r){var n=e("./util"),i=n.errorObj,s=n.isObject,o={}.hasOwnProperty;return function(e,a){if(s(e)){if(e instanceof t)return e;var u=function(e){try{return function(e){return e.then}(e)}catch(Zv){return i.e=Zv,i}}(e);if(u===i){a&&a._pushContext();var l=t.reject(u.e);return a&&a._popContext(),l}if("function"==typeof u)return function(e){try{return o.call(e,"_promise0")}catch(Zv){return!1}}(e)?(l=new t(r),e._then(l._fulfill,l._reject,void 0,l,null),l):function(e,s,o){var a=new t(r),u=a;o&&o._pushContext(),a._captureStackTrace(),o&&o._popContext();var l=!0,c=n.tryCatch(s).call(e,(function(e){a&&(a._resolveCallback(e),a=null)}),(function(e){a&&(a._rejectCallback(e,l,!0),a=null)}));return l=!1,a&&c===i&&(a._rejectCallback(c.e,!0,!0),a=null),u}(e,u,a)}return e}}},{"./util":36}],34:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=e("./util"),s=t.TimeoutError;function o(e){this.handle=e}o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(e){return u(+this).thenReturn(e)},u=t.delay=function(e,i){var s,u;return void 0!==i?(s=t.resolve(i)._then(a,null,null,e,void 0),n.cancellation()&&i instanceof t&&s._setOnCancel(i)):(s=new t(r),u=setTimeout((function(){s._fulfill()}),+e),n.cancellation()&&s._setOnCancel(new o(u)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};function l(e){return clearTimeout(this.handle),e}function c(e){throw clearTimeout(this.handle),e}t.prototype.delay=function(e){return u(e,this)},t.prototype.timeout=function(e,t){var r,a;e=+e;var u=new o(setTimeout((function(){r.isPending()&&function(e,t,r){var n;n="string"!=typeof t?t instanceof Error?t:new s("operation timed out"):new s(t),i.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._reject(n),null!=r&&r.cancel()}(r,t,a)}),e));return n.cancellation()?(a=this.then(),(r=a._then(l,c,void 0,u,void 0))._setOnCancel(u)):r=this._then(l,c,void 0,u,void 0),r}}},{"./util":36}],35:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./util"),u=e("./errors").TypeError,l=e("./util").inherits,c=a.errorObj,h=a.tryCatch,d={};function f(e){setTimeout((function(){throw e}),0)}function p(e,r){var i=0,o=e.length,a=new t(s);return function s(){if(i>=o)return a._fulfill();var u=function(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(e[i++]);if(u instanceof t&&u._isDisposable()){try{u=n(u._getDisposer().tryDispose(r),e.promise)}catch(Zv){return f(Zv)}if(u instanceof t)return u._then(s,f,null,null,null)}s()}(),a}function m(e,t,r){this._data=e,this._promise=t,this._context=r}function y(e,t,r){this.constructor$(e,t,r)}function g(e){return m.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function v(e){this.length=e,this.promise=null,this[e-1]=null}m.prototype.data=function(){return this._data},m.prototype.promise=function(){return this._promise},m.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},m.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=t!==d?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},m.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},l(y,m),y.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},v.prototype._resultCancelled=function(){for(var e=this.length,r=0;r<e;++r){var n=this[r];n instanceof t&&n.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return r("you must pass at least 2 arguments to Promise.using");var i,s=arguments[e-1];if("function"!=typeof s)return r("expecting a function but got "+a.classString(s));var u=!0;2===e&&Array.isArray(arguments[0])?(e=(i=arguments[0]).length,u=!1):(i=arguments,e--);for(var l=new v(e),d=0;d<e;++d){var f=i[d];if(m.isDisposer(f)){var y=f;(f=f.promise())._setDisposable(y)}else{var b=n(f);b instanceof t&&(f=b._then(g,null,null,{resources:l,index:d},void 0))}l[d]=f}var _=new Array(l.length);for(d=0;d<_.length;++d)_[d]=t.resolve(l[d]).reflect();var w=t.all(_).then((function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return c.e=r.error(),c;if(!r.isFulfilled())return void w.cancel();e[t]=r.value()}E._pushContext(),s=h(s);var n=u?s.apply(void 0,e):s(e),i=E._popContext();return o.checkForgottenReturns(n,i,"Promise.using",E),n})),E=w.lastly((function(){var e=new t.PromiseInspection(w);return p(l,e)}));return l.promise=E,E._setOnCancel(l),E},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new y(e,this,i());throw new u}}},{"./errors":12,"./util":36}],36:[function(r,n,i){"use strict";var s,o=r("./es5"),a="undefined"==typeof navigator,u={e:{}},l="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==this?this:null;function c(){try{var e=s;return s=null,e.apply(this,arguments)}catch(Zv){return u.e=Zv,u}}function h(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function d(e,t,r){if(h(e))return e;var n={value:r,configurable:!0,enumerable:!1,writable:!0};return o.defineProperty(e,t,n),e}var f=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(o.isES5){var r=Object.getOwnPropertyNames;return function(e){for(var n=[],i=Object.create(null);null!=e&&!t(e);){var s;try{s=r(e)}catch(Zv){return n}for(var a=0;a<s.length;++a){var u=s[a];if(!i[u]){i[u]=!0;var l=Object.getOwnPropertyDescriptor(e,u);null!=l&&null==l.get&&null==l.set&&n.push(u)}}e=o.getPrototypeOf(e)}return n}}var n={}.hasOwnProperty;return function(r){if(t(r))return[];var i=[];e:for(var s in r)if(n.call(r,s))i.push(s);else{for(var o=0;o<e.length;++o)if(n.call(e[o],s))continue e;i.push(s)}return i}}(),p=/this\s*\.\s*\S+\s*=/;var m=/^[a-z$_][a-z$_0-9]*$/i;function y(e){try{return e+""}catch(Zv){return"[no string representation]"}}function g(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function v(e){return g(e)&&o.propertyIsWritable(e,"stack")}var b="stack"in new Error?function(e){return v(e)?e:new Error(y(e))}:function(e){if(v(e))return e;try{throw new Error(y(e))}catch(t){return t}};function _(e){return{}.toString.call(e)}var w=function(e){return o.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var E="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],n=e[Symbol.iterator]();!(t=n.next()).done;)r.push(t.value);return r};w=function(e){return o.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?E(e):null}}var C,N=void 0!==e&&"[object process]"===_(e).toLowerCase(),$=void 0!==e&&void 0!==e.env;var x,T={setReflectHandler:function(e){C=e},isClass:function(e){try{if("function"==typeof e){var t=o.names(e.prototype),r=o.isES5&&t.length>1,n=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=p.test(e+"")&&o.names(e).length>0;if(r||n||i)return!0}return!1}catch(Zv){return!1}},isIdentifier:function(e){return m.test(e)},inheritedDataKeys:f,getDataPropertyOrDefault:function(e,t,r){if(!o.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var n=Object.getOwnPropertyDescriptor(e,t);return null!=n?null==n.get&&null==n.set?n.value:r:void 0},thrower:function(e){throw e},isArray:o.isArray,asArray:w,notEnumerableProp:d,isPrimitive:h,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:g,canEvaluate:a,errorObj:u,tryCatch:function(e){return s=e,c},inherits:function(e,t){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}return n.prototype=t.prototype,e.prototype=new n,e.prototype},withAppended:function(e,t){var r,n=e.length,i=new Array(n+1);for(r=0;r<n;++r)i[r]=e[r];return i[r]=t,i},maybeWrapAsError:function(e){return h(e)?new Error(y(e)):e},toFastProperties:function(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.foo}return n(),n(),e},filledRange:function(e,t,r){for(var n=new Array(e),i=0;i<e;++i)n[i]=t+i+r;return n},toString:y,canAttachTrace:v,ensureErrorObject:b,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{d(e,"isOperational",!0)}catch(t){}},classString:_,copyDescriptors:function(e,t,r){for(var n=o.names(e),i=0;i<n.length;++i){var s=n[i];if(r(s))try{o.defineProperty(t,s,o.getDescriptor(e,s))}catch(a){}}},isNode:N,hasEnvVariables:$,env:function(t){return $?e.env[t]:void 0},global:l,getNativePromise:function(){if("function"==typeof Promise)try{if("[object Promise]"===_(new Promise((function(){}))))return Promise}catch(Zv){}},contextBind:function(e,t){if(null===e||"function"!=typeof t||t===C)return t;null!==e.domain&&(t=e.domain.bind(t));var r=e.async;if(null!==r){var n=t;t=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=n,e[1]=this,r.runInAsyncScope.apply(r,e)}}return t}};T.isRecentNode=T.isNode&&(e.versions&&e.versions.node?x=e.versions.node.split(".").map(Number):e.version&&(x=e.version.split(".").map(Number)),0===x[0]&&x[1]>10||x[0]>0),T.nodeSupportsAsyncResource=T.isNode&&function(){var e=!1;try{e="function"==typeof r("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(Zv){e=!1}return e}(),T.isNode&&T.toFastProperties(e);try{throw new Error}catch(Zv){T.lastLineError=Zv}n.exports=T},{"./es5":13,async_hooks:void 0}]},{},[4])(4)})),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("timers").setImmediate);(H=H.exports).config({cancellation:!0});var Q={};function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function J(e,t,r){return t&&W(e.prototype,t),r&&W(e,r),e}function K(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t,r){return(Z=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(Zv){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&Y(i,r.prototype),i}).apply(null,arguments)}function X(e){var t="function"==typeof Map?new Map:void 0;return(X=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Z(e,arguments,G(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Y(n,e)})(e)}Object.defineProperty(Q,"__esModule",{value:!0});var ee=function(e){function t(){return e.apply(this,arguments)||this}return K(t,e),t}(X(Error)),te=function(e){function t(t){return e.call(this,"Invalid DateTime: "+t.toMessage())||this}return K(t,e),t}(ee),re=function(e){function t(t){return e.call(this,"Invalid Interval: "+t.toMessage())||this}return K(t,e),t}(ee),ne=function(e){function t(t){return e.call(this,"Invalid Duration: "+t.toMessage())||this}return K(t,e),t}(ee),ie=function(e){function t(){return e.apply(this,arguments)||this}return K(t,e),t}(ee),se=function(e){function t(t){return e.call(this,"Invalid unit "+t)||this}return K(t,e),t}(ee),oe=function(e){function t(){return e.apply(this,arguments)||this}return K(t,e),t}(ee),ae=function(e){function t(){return e.call(this,"Zone is an abstract class")||this}return K(t,e),t}(ee),ue="numeric",le="short",ce="long",he={year:ue,month:ue,day:ue},de={year:ue,month:le,day:ue},fe={year:ue,month:ce,day:ue},pe={year:ue,month:ce,day:ue,weekday:ce},me={hour:ue,minute:ue},ye={hour:ue,minute:ue,second:ue},ge={hour:ue,minute:ue,second:ue,timeZoneName:le},ve={hour:ue,minute:ue,second:ue,timeZoneName:ce},be={hour:ue,minute:ue,hour12:!1},_e={hour:ue,minute:ue,second:ue,hour12:!1},we={hour:ue,minute:ue,second:ue,hour12:!1,timeZoneName:le},Ee={hour:ue,minute:ue,second:ue,hour12:!1,timeZoneName:ce},Ce={year:ue,month:ue,day:ue,hour:ue,minute:ue},Ne={year:ue,month:ue,day:ue,hour:ue,minute:ue,second:ue},$e={year:ue,month:le,day:ue,hour:ue,minute:ue},xe={year:ue,month:le,day:ue,hour:ue,minute:ue,second:ue},Te={year:ue,month:le,day:ue,weekday:le,hour:ue,minute:ue},Oe={year:ue,month:ce,day:ue,hour:ue,minute:ue,timeZoneName:le},Se={year:ue,month:ce,day:ue,hour:ue,minute:ue,second:ue,timeZoneName:le},ke={year:ue,month:ce,day:ue,weekday:ce,hour:ue,minute:ue,timeZoneName:ce},je={year:ue,month:ce,day:ue,weekday:ce,hour:ue,minute:ue,second:ue,timeZoneName:ce};function Ae(e){return void 0===e}function Re(e){return"number"==typeof e}function Ie(e){return"number"==typeof e&&e%1==0}function Pe(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(Zv){return!1}}function qe(){return!Ae(Intl.DateTimeFormat.prototype.formatToParts)}function Le(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(Zv){return!1}}function Me(e,t,r){if(0!==e.length)return e.reduce((function(e,n){var i=[t(n),n];return e&&r(e[0],i[0])===e[0]?e:i}),null)[1]}function De(e,t){return t.reduce((function(t,r){return t[r]=e[r],t}),{})}function Fe(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ue(e,t,r){return Ie(e)&&e>=t&&e<=r}function Be(e,t){return void 0===t&&(t=2),e.toString().length<t?("0".repeat(t)+e).slice(-t):e.toString()}function Ve(e){return Ae(e)||null===e||""===e?void 0:parseInt(e,10)}function ze(e){if(!Ae(e)&&null!==e&&""!==e){var t=1e3*parseFloat("0."+e);return Math.floor(t)}}function He(e,t,r){void 0===r&&(r=!1);var n=Math.pow(10,t);return(r?Math.trunc:Math.round)(e*n)/n}function Qe(e){return e%4==0&&(e%100!=0||e%400==0)}function We(e){return Qe(e)?366:365}function Je(e,t){var r,n=(r=t-1)-12*Math.floor(r/12)+1;return 2===n?Qe(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function Ke(e){var t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t)).setUTCFullYear(t.getUTCFullYear()-1900),+t}function Ge(e){var t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,r=e-1,n=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7;return 4===t||3===n?53:52}function Ye(e){return e>99?e:e>60?1900+e:2e3+e}function Ze(e,t,r,n){void 0===n&&(n=null);var i=new Date(e),s={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);var o=Object.assign({timeZoneName:t},s),a=Pe();if(a&&qe()){var u=new Intl.DateTimeFormat(r,o).formatToParts(i).find((function(e){return"timezonename"===e.type.toLowerCase()}));return u?u.value:null}if(a){var l=new Intl.DateTimeFormat(r,s).format(i);return new Intl.DateTimeFormat(r,o).format(i).substring(l.length).replace(/^[, \u200e]+/,"")}return null}function Xe(e,t){var r=parseInt(e,10);Number.isNaN(r)&&(r=0);var n=parseInt(t,10)||0;return 60*r+(r<0||Object.is(r,-0)?-n:n)}function et(e){var t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new oe("Invalid unit value "+e);return t}function tt(e,t,r){var n={};for(var i in e)if(Fe(e,i)){if(r.indexOf(i)>=0)continue;var s=e[i];if(null==s)continue;n[t(i)]=et(s)}return n}function rt(e,t){var r=Math.trunc(e/60),n=Math.abs(e%60),i=r>=0&&!Object.is(r,-0)?"+":"-",s=""+i+Math.abs(r);switch(t){case"short":return""+i+Be(Math.abs(r),2)+":"+Be(n,2);case"narrow":return n>0?s+":"+n:s;case"techie":return""+i+Be(Math.abs(r),2)+Be(n,2);default:throw new RangeError("Value format "+t+" is out of range for property format")}}function nt(e){return De(e,["hour","minute","second","millisecond"])}var it=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function st(e){return JSON.stringify(e,Object.keys(e).sort())}var ot=["January","February","March","April","May","June","July","August","September","October","November","December"],at=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ut=["J","F","M","A","M","J","J","A","S","O","N","D"];function lt(e){switch(e){case"narrow":return ut;case"short":return at;case"long":return ot;case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var ct=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ht=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],dt=["M","T","W","T","F","S","S"];function ft(e){switch(e){case"narrow":return dt;case"short":return ht;case"long":return ct;case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var pt=["AM","PM"],mt=["Before Christ","Anno Domini"],yt=["BC","AD"],gt=["B","A"];function vt(e){switch(e){case"narrow":return gt;case"short":return yt;case"long":return mt;default:return null}}function bt(e,t){var r="",n=e,i=Array.isArray(n),s=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(s>=n.length)break;o=n[s++]}else{if((s=n.next()).done)break;o=s.value}var a=o;a.literal?r+=a.val:r+=t(a.val)}return r}var _t={D:he,DD:de,DDD:fe,DDDD:pe,t:me,tt:ye,ttt:ge,tttt:ve,T:be,TT:_e,TTT:we,TTTT:Ee,f:Ce,ff:$e,fff:Oe,ffff:ke,F:Ne,FF:xe,FFF:Se,FFFF:je},wt=function(){function e(e,t){this.opts=t,this.loc=e,this.systemLoc=null}e.create=function(t,r){return void 0===r&&(r={}),new e(t,r)},e.parseFormat=function(e){for(var t=null,r="",n=!1,i=[],s=0;s<e.length;s++){var o=e.charAt(s);"'"===o?(r.length>0&&i.push({literal:n,val:r}),t=null,r="",n=!n):n||o===t?r+=o:(r.length>0&&i.push({literal:!1,val:r}),r=o,t=o)}return r.length>0&&i.push({literal:n,val:r}),i},e.macroTokenToFormatOpts=function(e){return _t[e]};var t=e.prototype;return t.formatWithSystemDefault=function(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTime=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTimeParts=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).formatToParts()},t.resolvedOptions=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).resolvedOptions()},t.num=function(e,t){if(void 0===t&&(t=0),this.opts.forceSimple)return Be(e,t);var r=Object.assign({},this.opts);return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)},t.formatDateTimeFromString=function(t,r){var n=this,i="en"===this.loc.listingMode(),s=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&qe(),o=function(e,r){return n.loc.extract(t,e,r)},a=function(e){return t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):""},u=function(e,r){return i?function(e,t){return lt(t)[e.month-1]}(t,e):o(r?{month:e}:{month:e,day:"numeric"},"month")},l=function(e,r){return i?function(e,t){return ft(t)[e.weekday-1]}(t,e):o(r?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},c=function(e){return i?function(e,t){return vt(t)[e.year<0?0:1]}(t,e):o({era:e},"era")};return bt(e.parseFormat(r),(function(r){switch(r){case"S":return n.num(t.millisecond);case"u":case"SSS":return n.num(t.millisecond,3);case"s":return n.num(t.second);case"ss":return n.num(t.second,2);case"m":return n.num(t.minute);case"mm":return n.num(t.minute,2);case"h":return n.num(t.hour%12==0?12:t.hour%12);case"hh":return n.num(t.hour%12==0?12:t.hour%12,2);case"H":return n.num(t.hour);case"HH":return n.num(t.hour,2);case"Z":return a({format:"narrow",allowZ:n.opts.allowZ});case"ZZ":return a({format:"short",allowZ:n.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:!1});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:n.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:n.loc.locale});case"z":return t.zoneName;case"a":return i?function(e){return pt[e.hour<12?0:1]}(t):o({hour:"numeric",hour12:!0},"dayperiod");case"d":return s?o({day:"numeric"},"day"):n.num(t.day);case"dd":return s?o({day:"2-digit"},"day"):n.num(t.day,2);case"c":return n.num(t.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"E":return n.num(t.weekday);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return s?o({month:"numeric",day:"numeric"},"month"):n.num(t.month);case"LL":return s?o({month:"2-digit",day:"numeric"},"month"):n.num(t.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return s?o({month:"numeric"},"month"):n.num(t.month);case"MM":return s?o({month:"2-digit"},"month"):n.num(t.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return s?o({year:"numeric"},"year"):n.num(t.year);case"yy":return s?o({year:"2-digit"},"year"):n.num(t.year.toString().slice(-2),2);case"yyyy":return s?o({year:"numeric"},"year"):n.num(t.year,4);case"yyyyyy":return s?o({year:"numeric"},"year"):n.num(t.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return n.num(t.weekYear.toString().slice(-2),2);case"kkkk":return n.num(t.weekYear,4);case"W":return n.num(t.weekNumber);case"WW":return n.num(t.weekNumber,2);case"o":return n.num(t.ordinal);case"ooo":return n.num(t.ordinal,3);case"q":return n.num(t.quarter);case"qq":return n.num(t.quarter,2);case"X":return n.num(Math.floor(t.ts/1e3));case"x":return n.num(t.ts);default:return function(r){var i=e.macroTokenToFormatOpts(r);return i?n.formatWithSystemDefault(t,i):r}(r)}}))},t.formatDurationFromString=function(t,r){var n,i=this,s=function(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},o=e.parseFormat(r),a=o.reduce((function(e,t){var r=t.literal,n=t.val;return r?e:e.concat(n)}),[]),u=t.shiftTo.apply(t,a.map(s).filter((function(e){return e})));return bt(o,(n=u,function(e){var t=s(e);return t?i.num(n.get(t),e.length):e}))},e}(),Et=function(){function e(e,t){this.reason=e,this.explanation=t}return e.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},e}(),Ct=function(){function e(){}var t=e.prototype;return t.offsetName=function(e,t){throw new ae},t.formatOffset=function(e,t){throw new ae},t.offset=function(e){throw new ae},t.equals=function(e){throw new ae},J(e,[{key:"type",get:function(){throw new ae}},{key:"name",get:function(){throw new ae}},{key:"universal",get:function(){throw new ae}},{key:"isValid",get:function(){throw new ae}}]),e}(),Nt=null,$t=function(e){function t(){return e.apply(this,arguments)||this}K(t,e);var r=t.prototype;return r.offsetName=function(e,t){return Ze(e,t.format,t.locale)},r.formatOffset=function(e,t){return rt(this.offset(e),t)},r.offset=function(e){return-new Date(e).getTimezoneOffset()},r.equals=function(e){return"local"===e.type},J(t,[{key:"type",get:function(){return"local"}},{key:"name",get:function(){return Pe()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return null===Nt&&(Nt=new t),Nt}}]),t}(Ct),xt=RegExp("^"+it.source+"$"),Tt={},Ot={year:0,month:1,day:2,hour:3,minute:4,second:5},St={},kt=function(e){function t(r){var n;return(n=e.call(this)||this).zoneName=r,n.valid=t.isValidZone(r),n}K(t,e),t.create=function(e){return St[e]||(St[e]=new t(e)),St[e]},t.resetCache=function(){St={},Tt={}},t.isValidSpecifier=function(e){return!(!e||!e.match(xt))},t.isValidZone=function(e){try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(Zv){return!1}},t.parseGMTOffset=function(e){if(e){var t=e.match(/^Etc\/GMT([+-]\d{1,2})$/i);if(t)return-60*parseInt(t[1])}return null};var r=t.prototype;return r.offsetName=function(e,t){return Ze(e,t.format,t.locale,this.name)},r.formatOffset=function(e,t){return rt(this.offset(e),t)},r.offset=function(e){var t,r=new Date(e),n=(t=this.name,Tt[t]||(Tt[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),Tt[t]),i=n.formatToParts?function(e,t){for(var r=e.formatToParts(t),n=[],i=0;i<r.length;i++){var s=r[i],o=s.type,a=s.value,u=Ot[o];Ae(u)||(n[u]=parseInt(a,10))}return n}(n,r):function(e,t){var r=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r),i=n[1],s=n[2];return[n[3],i,s,n[4],n[5],n[6]]}(n,r),s=i[0],o=i[1],a=i[2],u=i[3],l=Ke({year:s,month:o,day:a,hour:24===u?0:u,minute:i[4],second:i[5],millisecond:0}),c=r.valueOf();return(l-(c-=c%1e3))/6e4},r.equals=function(e){return"iana"===e.type&&e.name===this.name},J(t,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),t}(Ct),jt=null,At=function(e){function t(t){var r;return(r=e.call(this)||this).fixed=t,r}K(t,e),t.instance=function(e){return 0===e?t.utcInstance:new t(e)},t.parseSpecifier=function(e){if(e){var r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new t(Xe(r[1],r[2]))}return null},J(t,null,[{key:"utcInstance",get:function(){return null===jt&&(jt=new t(0)),jt}}]);var r=t.prototype;return r.offsetName=function(){return this.name},r.formatOffset=function(e,t){return rt(this.fixed,t)},r.offset=function(){return this.fixed},r.equals=function(e){return"fixed"===e.type&&e.fixed===this.fixed},J(t,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+rt(this.fixed,"narrow")}},{key:"universal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}]),t}(Ct),Rt=function(e){function t(t){var r;return(r=e.call(this)||this).zoneName=t,r}K(t,e);var r=t.prototype;return r.offsetName=function(){return null},r.formatOffset=function(){return""},r.offset=function(){return NaN},r.equals=function(){return!1},J(t,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),t}(Ct);function It(e,t){var r;if(Ae(e)||null===e)return t;if(e instanceof Ct)return e;if("string"==typeof e){var n=e.toLowerCase();return"local"===n?t:"utc"===n||"gmt"===n?At.utcInstance:null!=(r=kt.parseGMTOffset(e))?At.instance(r):kt.isValidSpecifier(n)?kt.create(e):At.parseSpecifier(n)||new Rt(e)}return Re(e)?At.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new Rt(e)}var Pt=function(){return Date.now()},qt=null,Lt=null,Mt=null,Dt=null,Ft=!1,Ut=function(){function e(){}return e.resetCaches=function(){Yt.resetCache(),kt.resetCache()},J(e,null,[{key:"now",get:function(){return Pt},set:function(e){Pt=e}},{key:"defaultZoneName",get:function(){return e.defaultZone.name},set:function(e){qt=e?It(e):null}},{key:"defaultZone",get:function(){return qt||$t.instance}},{key:"defaultLocale",get:function(){return Lt},set:function(e){Lt=e}},{key:"defaultNumberingSystem",get:function(){return Mt},set:function(e){Mt=e}},{key:"defaultOutputCalendar",get:function(){return Dt},set:function(e){Dt=e}},{key:"throwOnInvalid",get:function(){return Ft},set:function(e){Ft=e}}]),e}(),Bt={};function Vt(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=Bt[r];return n||(n=new Intl.DateTimeFormat(e,t),Bt[r]=n),n}var zt={},Ht={},Qt=null;function Wt(e,t,r,n,i){var s=e.listingMode(r);return"error"===s?null:"en"===s?n(t):i(t)}var Jt=function(){function e(e,t,r){if(this.padTo=r.padTo||0,this.floor=r.floor||!1,!t&&Pe()){var n={useGrouping:!1};r.padTo>0&&(n.minimumIntegerDigits=r.padTo),this.inf=function(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=zt[r];return n||(n=new Intl.NumberFormat(e,t),zt[r]=n),n}(e,n)}}return e.prototype.format=function(e){if(this.inf){var t=this.floor?Math.floor(e):e;return this.inf.format(t)}return Be(this.floor?Math.floor(e):He(e,3),this.padTo)},e}(),Kt=function(){function e(e,t,r){var n;if(this.opts=r,this.hasIntl=Pe(),e.zone.universal&&this.hasIntl?(n="UTC",r.timeZoneName?this.dt=e:this.dt=0===e.offset?e:zn.fromMillis(e.ts+60*e.offset*1e3)):"local"===e.zone.type?this.dt=e:(this.dt=e,n=e.zone.name),this.hasIntl){var i=Object.assign({},this.opts);n&&(i.timeZone=n),this.dtf=Vt(t,i)}}var t=e.prototype;return t.format=function(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());var e=function(e){switch(st(De(e,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case st(he):return"M/d/yyyy";case st(de):return"LLL d, yyyy";case st(fe):return"LLLL d, yyyy";case st(pe):return"EEEE, LLLL d, yyyy";case st(me):return"h:mm a";case st(ye):return"h:mm:ss a";case st(ge):case st(ve):return"h:mm a";case st(be):return"HH:mm";case st(_e):return"HH:mm:ss";case st(we):case st(Ee):return"HH:mm";case st(Ce):return"M/d/yyyy, h:mm a";case st($e):return"LLL d, yyyy, h:mm a";case st(Oe):return"LLLL d, yyyy, h:mm a";case st(ke):return"EEEE, LLLL d, yyyy, h:mm a";case st(Ne):return"M/d/yyyy, h:mm:ss a";case st(xe):return"LLL d, yyyy, h:mm:ss a";case st(Te):return"EEE, d LLL yyyy, h:mm a";case st(Se):return"LLLL d, yyyy, h:mm:ss a";case st(je):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return"EEEE, LLLL d, yyyy, h:mm a"}}(this.opts),t=Yt.create("en-US");return wt.create(t).formatDateTimeFromString(this.dt,e)},t.formatToParts=function(){return this.hasIntl&&qe()?this.dtf.formatToParts(this.dt.toJSDate()):[]},t.resolvedOptions=function(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}},e}(),Gt=function(){function e(e,t,r){this.opts=Object.assign({style:"long"},r),!t&&Le()&&(this.rtf=function(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=Ht[r];return n||(n=new Intl.RelativeTimeFormat(e,t),Ht[r]=n),n}(e,r))}var t=e.prototype;return t.format=function(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,r,n){void 0===r&&(r="always"),void 0===n&&(n=!1);var i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===r&&s){var o="days"===e;switch(t){case 1:return o?"tomorrow":"next "+i[e][0];case-1:return o?"yesterday":"last "+i[e][0];case 0:return o?"today":"this "+i[e][0]}}var a=Object.is(t,-0)||t<0,u=Math.abs(t),l=1===u,c=i[e],h=n?l?c[1]:c[2]||c[1]:l?i[e][0]:e;return a?u+" "+h+" ago":"in "+u+" "+h}(t,e,this.opts.numeric,"long"!==this.opts.style)},t.formatToParts=function(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]},e}(),Yt=function(){function e(e,t,r,n){var i=function(e){var t=e.indexOf("-u-");if(-1===t)return[e];var r,n=e.substring(0,t);try{r=Vt(e).resolvedOptions()}catch(Zv){r=Vt(n).resolvedOptions()}var i=r;return[n,i.numberingSystem,i.calendar]}(e),s=i[0],o=i[1],a=i[2];this.locale=s,this.numberingSystem=t||o||null,this.outputCalendar=r||a||null,this.intl=function(e,t,r){return Pe()?r||t?(e+="-u",r&&(e+="-ca-"+r),t&&(e+="-nu-"+t),e):e:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}e.fromOpts=function(t){return e.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)},e.create=function(t,r,n,i){void 0===i&&(i=!1);var s=t||Ut.defaultLocale;return new e(s||(i?"en-US":function(){if(Qt)return Qt;if(Pe()){var e=(new Intl.DateTimeFormat).resolvedOptions().locale;return Qt=e&&"und"!==e?e:"en-US"}return Qt="en-US"}()),r||Ut.defaultNumberingSystem,n||Ut.defaultOutputCalendar,s)},e.resetCache=function(){Qt=null,Bt={},zt={},Ht={}},e.fromObject=function(t){var r=void 0===t?{}:t,n=r.locale,i=r.numberingSystem,s=r.outputCalendar;return e.create(n,i,s)};var t=e.prototype;return t.listingMode=function(e){void 0===e&&(e=!0);var t=Pe()&&qe(),r=this.isEnglish(),n=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return t||r&&n||e?!t||r&&n?"en":"intl":"error"},t.clone=function(t){return t&&0!==Object.getOwnPropertyNames(t).length?e.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this},t.redefaultToEN=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!0}))},t.redefaultToSystem=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!1}))},t.months=function(e,t,r){var n=this;return void 0===t&&(t=!1),void 0===r&&(r=!0),Wt(this,e,r,lt,(function(){var r=t?{month:e,day:"numeric"}:{month:e},i=t?"format":"standalone";return n.monthsCache[i][e]||(n.monthsCache[i][e]=function(e){for(var t=[],r=1;r<=12;r++){var n=zn.utc(2016,r,1);t.push(e(n))}return t}((function(e){return n.extract(e,r,"month")}))),n.monthsCache[i][e]}))},t.weekdays=function(e,t,r){var n=this;return void 0===t&&(t=!1),void 0===r&&(r=!0),Wt(this,e,r,ft,(function(){var r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=t?"format":"standalone";return n.weekdaysCache[i][e]||(n.weekdaysCache[i][e]=function(e){for(var t=[],r=1;r<=7;r++){var n=zn.utc(2016,11,13+r);t.push(e(n))}return t}((function(e){return n.extract(e,r,"weekday")}))),n.weekdaysCache[i][e]}))},t.meridiems=function(e){var t=this;return void 0===e&&(e=!0),Wt(this,void 0,e,(function(){return pt}),(function(){if(!t.meridiemCache){var e={hour:"numeric",hour12:!0};t.meridiemCache=[zn.utc(2016,11,13,9),zn.utc(2016,11,13,19)].map((function(r){return t.extract(r,e,"dayperiod")}))}return t.meridiemCache}))},t.eras=function(e,t){var r=this;return void 0===t&&(t=!0),Wt(this,e,t,vt,(function(){var t={era:e};return r.eraCache[e]||(r.eraCache[e]=[zn.utc(-40,1,1),zn.utc(2017,1,1)].map((function(e){return r.extract(e,t,"era")}))),r.eraCache[e]}))},t.extract=function(e,t,r){var n=this.dtFormatter(e,t).formatToParts().find((function(e){return e.type.toLowerCase()===r}));return n?n.value:null},t.numberFormatter=function(e){return void 0===e&&(e={}),new Jt(this.intl,e.forceSimple||this.fastNumbers,e)},t.dtFormatter=function(e,t){return void 0===t&&(t={}),new Kt(e,this.intl,t)},t.relFormatter=function(e){return void 0===e&&(e={}),new Gt(this.intl,this.isEnglish(),e)},t.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||Pe()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},t.equals=function(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar},J(e,[{key:"fastNumbers",get:function(){return null==this.fastNumbersCached&&(this.fastNumbersCached=(!this.numberingSystem||"latn"===this.numberingSystem)&&("latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||Pe()&&"latn"===new Intl.DateTimeFormat(this.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),e}();function Zt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return e+t.source}),"");return RegExp("^"+n+"$")}function Xt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce((function(t,r){var n=t[0],i=t[1],s=t[2],o=r(e,s),a=o[0],u=o[1],l=o[2];return[Object.assign(n,a),i||u,l]}),[{},null,1]).slice(0,2)}}function er(e){if(null==e)return[null,null];for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,s=r;i<s.length;i++){var o=s[i],a=o[0],u=o[1],l=a.exec(e);if(l)return u(l)}return[null,null]}function tr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r){var n,i={};for(n=0;n<t.length;n++)i[t[n]]=Ve(e[r+n]);return[i,null,r+n]}}var rr=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,nr=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,9}))?)?)?/,ir=RegExp(""+nr.source+rr.source+"?"),sr=RegExp("(?:T"+ir.source+")?"),or=tr("weekYear","weekNumber","weekDay"),ar=tr("year","ordinal"),ur=RegExp(nr.source+" ?(?:"+rr.source+"|("+it.source+"))?"),lr=RegExp("(?: "+ur.source+")?");function cr(e,t,r){var n=e[t];return Ae(n)?r:Ve(n)}function hr(e,t){return[{year:cr(e,t),month:cr(e,t+1,1),day:cr(e,t+2,1)},null,t+3]}function dr(e,t){return[{hour:cr(e,t,0),minute:cr(e,t+1,0),second:cr(e,t+2,0),millisecond:ze(e[t+3])},null,t+4]}function fr(e,t){var r=!e[t]&&!e[t+1],n=Xe(e[t+1],e[t+2]);return[{},r?null:At.instance(n),t+3]}function pr(e,t){return[{},e[t]?kt.create(e[t]):null,t+1]}var mr=/^P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})(?:[.,](-?\d{1,9}))?S)?)?)$/;function yr(e){var t=e[1],r=e[2],n=e[3],i=e[4],s=e[5],o=e[6],a=e[7],u=e[8];return[{years:Ve(t),months:Ve(r),weeks:Ve(n),days:Ve(i),hours:Ve(s),minutes:Ve(o),seconds:Ve(a),milliseconds:ze(u)}]}var gr={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function vr(e,t,r,n,i,s,o){var a={year:2===t.length?Ye(Ve(t)):Ve(t),month:at.indexOf(r)+1,day:Ve(n),hour:Ve(i),minute:Ve(s)};return o&&(a.second=Ve(o)),e&&(a.weekday=e.length>3?ct.indexOf(e)+1:ht.indexOf(e)+1),a}var br=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function _r(e){var t,r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],l=e[8],c=e[9],h=e[10],d=e[11],f=vr(r,s,i,n,o,a,u);return t=l?gr[l]:c?0:Xe(h,d),[f,new At(t)]}var wr=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Er=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Cr=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Nr(e){var t=e[1],r=e[2],n=e[3];return[vr(t,e[4],n,r,e[5],e[6],e[7]),At.utcInstance]}function $r(e){var t=e[1],r=e[2],n=e[3],i=e[4],s=e[5],o=e[6];return[vr(t,e[7],r,n,i,s,o),At.utcInstance]}var xr=Zt(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,sr),Tr=Zt(/(\d{4})-?W(\d\d)(?:-?(\d))?/,sr),Or=Zt(/(\d{4})-?(\d{3})/,sr),Sr=Zt(ir),kr=Xt(hr,dr,fr),jr=Xt(or,dr,fr),Ar=Xt(ar,dr),Rr=Xt(dr,fr),Ir=Zt(/(\d{4})-(\d\d)-(\d\d)/,lr),Pr=Zt(ur),qr=Xt(hr,dr,fr,pr),Lr=Xt(dr,fr,pr),Mr={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},Dr=Object.assign({years:{months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},Mr),Fr=Object.assign({years:{months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},Mr),Ur=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Br=Ur.slice(0).reverse();function Vr(e,t,r){void 0===r&&(r=!1);var n={values:r?t.values:Object.assign({},e.values,t.values||{}),loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy};return new Qr(n)}function zr(e,t,r,n,i){var s,o=e[i][r],a=t[r]/o,u=Math.sign(a)!==Math.sign(n[i])&&0!==n[i]&&Math.abs(a)<=1?(s=a)<0?Math.floor(s):Math.ceil(s):Math.trunc(a);n[i]+=u,t[r]-=u*o}function Hr(e,t){Br.reduce((function(r,n){return Ae(t[n])?r:(r&&zr(e,t,r,t,n),n)}),null)}var Qr=function(){function e(e){var t="longterm"===e.conversionAccuracy||!1;this.values=e.values,this.loc=e.loc||Yt.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?Fr:Dr,this.isLuxonDuration=!0}e.fromMillis=function(t,r){return e.fromObject(Object.assign({milliseconds:t},r))},e.fromObject=function(t){if(null==t||"object"!=typeof t)throw new oe("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new e({values:tt(t,e.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:Yt.fromObject(t),conversionAccuracy:t.conversionAccuracy})},e.fromISO=function(t,r){var n=er(t,[mr,yr])[0];if(n){var i=Object.assign(n,r);return e.fromObject(i)}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new oe("need to specify a reason the Duration is invalid");var n=t instanceof Et?t:new Et(t,r);if(Ut.throwOnInvalid)throw new ne(n);return new e({invalid:n})},e.normalizeUnit=function(e){var t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new se(e);return t},e.isDuration=function(e){return e&&e.isLuxonDuration||!1};var t=e.prototype;return t.toFormat=function(e,t){void 0===t&&(t={});var r=Object.assign({},t,{floor:!1!==t.round&&!1!==t.floor});return this.isValid?wt.create(this.loc,r).formatDurationFromString(this,e):"Invalid Duration"},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.values);return e.includeConfig&&(t.conversionAccuracy=this.conversionAccuracy,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toISO=function(){if(!this.isValid)return null;var e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=He(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e},t.toJSON=function(){return this.toISO()},t.toString=function(){return this.toISO()},t.valueOf=function(){return this.as("milliseconds")},t.plus=function(e){if(!this.isValid)return this;for(var t=Wr(e),r={},n=0,i=Ur;n<i.length;n++){var s=i[n];(Fe(t.values,s)||Fe(this.values,s))&&(r[s]=t.get(s)+this.get(s))}return Vr(this,{values:r},!0)},t.minus=function(e){if(!this.isValid)return this;var t=Wr(e);return this.plus(t.negate())},t.mapUnits=function(e){if(!this.isValid)return this;for(var t={},r=0,n=Object.keys(this.values);r<n.length;r++){var i=n[r];t[i]=et(e(this.values[i],i))}return Vr(this,{values:t},!0)},t.get=function(t){return this[e.normalizeUnit(t)]},t.set=function(t){return this.isValid?Vr(this,{values:Object.assign(this.values,tt(t,e.normalizeUnit,[]))}):this},t.reconfigure=function(e){var t=void 0===e?{}:e,r=t.locale,n=t.numberingSystem,i=t.conversionAccuracy,s={loc:this.loc.clone({locale:r,numberingSystem:n})};return i&&(s.conversionAccuracy=i),Vr(this,s)},t.as=function(e){return this.isValid?this.shiftTo(e).get(e):NaN},t.normalize=function(){if(!this.isValid)return this;var e=this.toObject();return Hr(this.matrix,e),Vr(this,{values:e},!0)},t.shiftTo=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!this.isValid)return this;if(0===r.length)return this;r=r.map((function(t){return e.normalizeUnit(t)}));var i,s={},o={},a=this.toObject();Hr(this.matrix,a);for(var u=0,l=Ur;u<l.length;u++){var c=l[u];if(r.indexOf(c)>=0){i=c;var h=0;for(var d in o)h+=this.matrix[d][c]*o[d],o[d]=0;Re(a[c])&&(h+=a[c]);var f=Math.trunc(h);for(var p in s[c]=f,o[c]=h-f,a)Ur.indexOf(p)>Ur.indexOf(c)&&zr(this.matrix,a,p,s,c)}else Re(a[c])&&(o[c]=a[c])}for(var m in o)0!==o[m]&&(s[i]+=m===i?o[m]:o[m]/this.matrix[i][m]);return Vr(this,{values:s},!0).normalize()},t.negate=function(){if(!this.isValid)return this;for(var e={},t=0,r=Object.keys(this.values);t<r.length;t++){var n=r[t];e[n]=-this.values[n]}return Vr(this,{values:e},!0)},t.equals=function(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(var t=0,r=Ur;t<r.length;t++){var n=r[t];if(this.values[n]!==e.values[n])return!1}return!0},J(e,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}();function Wr(e){if(Re(e))return Qr.fromMillis(e);if(Qr.isDuration(e))return e;if("object"==typeof e)return Qr.fromObject(e);throw new oe("Unknown duration argument "+e+" of type "+typeof e)}var Jr="Invalid Interval";function Kr(e,t){return e&&e.isValid?t&&t.isValid?t<e?Gr.invalid("end before start","The end of an interval must be after its start, but you had start="+e.toISO()+" and end="+t.toISO()):null:Gr.invalid("missing or invalid end"):Gr.invalid("missing or invalid start")}var Gr=function(){function e(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new oe("need to specify a reason the Interval is invalid");var n=t instanceof Et?t:new Et(t,r);if(Ut.throwOnInvalid)throw new re(n);return new e({invalid:n})},e.fromDateTimes=function(t,r){var n=Hn(t),i=Hn(r),s=Kr(n,i);return null==s?new e({start:n,end:i}):s},e.after=function(t,r){var n=Wr(r),i=Hn(t);return e.fromDateTimes(i,i.plus(n))},e.before=function(t,r){var n=Wr(r),i=Hn(t);return e.fromDateTimes(i.minus(n),i)},e.fromISO=function(t,r){var n=(t||"").split("/",2),i=n[0],s=n[1];if(i&&s){var o=zn.fromISO(i,r),a=zn.fromISO(s,r);if(o.isValid&&a.isValid)return e.fromDateTimes(o,a);if(o.isValid){var u=Qr.fromISO(s,r);if(u.isValid)return e.after(o,u)}else if(a.isValid){var l=Qr.fromISO(i,r);if(l.isValid)return e.before(a,l)}}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed asISO 8601")},e.isInterval=function(e){return e&&e.isLuxonInterval||!1};var t=e.prototype;return t.length=function(e){return void 0===e&&(e="milliseconds"),this.isValid?this.toDuration.apply(this,[e]).get(e):NaN},t.count=function(e){if(void 0===e&&(e="milliseconds"),!this.isValid)return NaN;var t=this.start.startOf(e),r=this.end.startOf(e);return Math.floor(r.diff(t,e).get(e))+1},t.hasSame=function(e){return!!this.isValid&&this.e.minus(1).hasSame(this.s,e)},t.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},t.isAfter=function(e){return!!this.isValid&&this.s>e},t.isBefore=function(e){return!!this.isValid&&this.e<=e},t.contains=function(e){return!!this.isValid&&this.s<=e&&this.e>e},t.set=function(t){var r=void 0===t?{}:t,n=r.start,i=r.end;return this.isValid?e.fromDateTimes(n||this.s,i||this.e):this},t.splitAt=function(){var t=this;if(!this.isValid)return[];for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];for(var s=n.map(Hn).filter((function(e){return t.contains(e)})).sort(),o=[],a=this.s,u=0;a<this.e;){var l=s[u]||this.e,c=+l>+this.e?this.e:l;o.push(e.fromDateTimes(a,c)),a=c,u+=1}return o},t.splitBy=function(t){var r=Wr(t);if(!this.isValid||!r.isValid||0===r.as("milliseconds"))return[];for(var n,i,s=this.s,o=[];s<this.e;)i=+(n=s.plus(r))>+this.e?this.e:n,o.push(e.fromDateTimes(s,i)),s=i;return o},t.divideEqually=function(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]},t.overlaps=function(e){return this.e>e.s&&this.s<e.e},t.abutsStart=function(e){return!!this.isValid&&+this.e==+e.s},t.abutsEnd=function(e){return!!this.isValid&&+e.e==+this.s},t.engulfs=function(e){return!!this.isValid&&this.s<=e.s&&this.e>=e.e},t.equals=function(e){return!(!this.isValid||!e.isValid)&&this.s.equals(e.s)&&this.e.equals(e.e)},t.intersection=function(t){if(!this.isValid)return this;var r=this.s>t.s?this.s:t.s,n=this.e<t.e?this.e:t.e;return r>n?null:e.fromDateTimes(r,n)},t.union=function(t){if(!this.isValid)return this;var r=this.s<t.s?this.s:t.s,n=this.e>t.e?this.e:t.e;return e.fromDateTimes(r,n)},e.merge=function(e){var t=e.sort((function(e,t){return e.s-t.s})).reduce((function(e,t){var r=e[0],n=e[1];return n?n.overlaps(t)||n.abutsStart(t)?[r,n.union(t)]:[r.concat([n]),t]:[r,t]}),[[],null]),r=t[0],n=t[1];return n&&r.push(n),r},e.xor=function(t){var r,n=null,i=0,s=[],o=t.map((function(e){return[{time:e.s,type:"s"},{time:e.e,type:"e"}]})),a=(r=Array.prototype).concat.apply(r,o).sort((function(e,t){return e.time-t.time})),u=Array.isArray(a),l=0;for(a=u?a:a[Symbol.iterator]();;){var c;if(u){if(l>=a.length)break;c=a[l++]}else{if((l=a.next()).done)break;c=l.value}var h=c;1===(i+="s"===h.type?1:-1)?n=h.time:(n&&+n!=+h.time&&s.push(e.fromDateTimes(n,h.time)),n=null)}return e.merge(s)},t.difference=function(){for(var t=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.xor([this].concat(n)).map((function(e){return t.intersection(e)})).filter((function(e){return e&&!e.isEmpty()}))},t.toString=function(){return this.isValid?"["+this.s.toISO()+" \u2013 "+this.e.toISO()+")":Jr},t.toISO=function(e){return this.isValid?this.s.toISO(e)+"/"+this.e.toISO(e):Jr},t.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():Jr},t.toISOTime=function(e){return this.isValid?this.s.toISOTime(e)+"/"+this.e.toISOTime(e):Jr},t.toFormat=function(e,t){var r=(void 0===t?{}:t).separator,n=void 0===r?" \u2013 ":r;return this.isValid?""+this.s.toFormat(e)+n+this.e.toFormat(e):Jr},t.toDuration=function(e,t){return this.isValid?this.e.diff(this.s,e,t):Qr.invalid(this.invalidReason)},t.mapEndpoints=function(t){return e.fromDateTimes(t(this.s),t(this.e))},J(e,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}(),Yr=function(){function e(){}return e.hasDST=function(e){void 0===e&&(e=Ut.defaultZone);var t=zn.local().setZone(e).set({month:12});return!e.universal&&t.offset!==t.set({month:6}).offset},e.isValidIANAZone=function(e){return kt.isValidSpecifier(e)&&kt.isValidZone(e)},e.normalizeZone=function(e){return It(e,Ut.defaultZone)},e.months=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.outputCalendar,u=void 0===a?"gregory":a;return Yt.create(i,o,u).months(e)},e.monthsFormat=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.outputCalendar,u=void 0===a?"gregory":a;return Yt.create(i,o,u).months(e,!0)},e.weekdays=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s;return Yt.create(i,o,null).weekdays(e)},e.weekdaysFormat=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s;return Yt.create(i,o,null).weekdays(e,!0)},e.meridiems=function(e){var t=(void 0===e?{}:e).locale,r=void 0===t?null:t;return Yt.create(r).meridiems()},e.eras=function(e,t){void 0===e&&(e="short");var r=(void 0===t?{}:t).locale,n=void 0===r?null:r;return Yt.create(n,null,"gregory").eras(e)},e.features=function(){var e=!1,t=!1,r=!1,n=!1;if(Pe()){e=!0,t=qe(),n=Le();try{r="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(Zv){r=!1}}return{intl:e,intlTokens:t,zones:r,relative:n}},e}();function Zr(e,t){var r=function(e){return e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()},n=r(t)-r(e);return Math.floor(Qr.fromMillis(n).as("days"))}var Xr={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},en={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},tn=Xr.hanidec.replace(/[\[|\]]/g,"").split("");function rn(e,t){var r=e.numberingSystem;return void 0===t&&(t=""),new RegExp(""+Xr[r||"latn"]+t)}function nn(e,t){return void 0===t&&(t=function(e){return e}),{regex:e,deser:function(e){var r=e[0];return t(function(e){var t=parseInt(e,10);if(isNaN(t)){t="";for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(-1!==e[r].search(Xr.hanidec))t+=tn.indexOf(e[r]);else for(var i in en){var s=en[i],o=s[0],a=s[1];n>=o&&n<=a&&(t+=n-o)}}return parseInt(t,10)}return t}(r))}}}function sn(e){return e.replace(/\./,"\\.?")}function on(e){return e.replace(/\./,"").toLowerCase()}function an(e,t){return null===e?null:{regex:RegExp(e.map(sn).join("|")),deser:function(r){var n=r[0];return e.findIndex((function(e){return on(n)===on(e)}))+t}}}function un(e,t){return{regex:e,deser:function(e){return Xe(e[1],e[2])},groups:t}}function ln(e){return{regex:e,deser:function(e){return e[0]}}}var cn={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}},hn=null;function dn(e,t,r){var n=function(e,t){var r;return(r=Array.prototype).concat.apply(r,e.map((function(e){return function(e,t){if(e.literal)return e;var r=wt.macroTokenToFormatOpts(e.val);if(!r)return e;var n=wt.create(t,r).formatDateTimeParts((hn||(hn=zn.fromMillis(1555555555555)),hn)).map((function(e){return function(e,t,r){var n=e.type,i=e.value;if("literal"===n)return{literal:!0,val:i};var s=r[n],o=cn[n];return"object"==typeof o&&(o=o[s]),o?{literal:!1,val:o}:void 0}(e,0,r)}));return n.includes(void 0)?e:n}(e,t)})))}(wt.parseFormat(r),e),i=n.map((function(t){return r=t,i=rn(n=e),s=rn(n,"{2}"),o=rn(n,"{3}"),a=rn(n,"{4}"),u=rn(n,"{6}"),l=rn(n,"{1,2}"),c=rn(n,"{1,3}"),h=rn(n,"{1,6}"),d=rn(n,"{1,9}"),f=rn(n,"{2,4}"),p=rn(n,"{4,6}"),m=function(e){return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:function(e){return e[0]},literal:!0};var t},(y=function(e){if(r.literal)return m(e);switch(e.val){case"G":return an(n.eras("short",!1),0);case"GG":return an(n.eras("long",!1),0);case"y":return nn(h);case"yy":return nn(f,Ye);case"yyyy":return nn(a);case"yyyyy":return nn(p);case"yyyyyy":return nn(u);case"M":return nn(l);case"MM":return nn(s);case"MMM":return an(n.months("short",!0,!1),1);case"MMMM":return an(n.months("long",!0,!1),1);case"L":return nn(l);case"LL":return nn(s);case"LLL":return an(n.months("short",!1,!1),1);case"LLLL":return an(n.months("long",!1,!1),1);case"d":return nn(l);case"dd":return nn(s);case"o":return nn(c);case"ooo":return nn(o);case"HH":return nn(s);case"H":return nn(l);case"hh":return nn(s);case"h":return nn(l);case"mm":return nn(s);case"m":case"q":return nn(l);case"qq":return nn(s);case"s":return nn(l);case"ss":return nn(s);case"S":return nn(c);case"SSS":return nn(o);case"u":return ln(d);case"a":return an(n.meridiems(),0);case"kkkk":return nn(a);case"kk":return nn(f,Ye);case"W":return nn(l);case"WW":return nn(s);case"E":case"c":return nn(i);case"EEE":return an(n.weekdays("short",!1,!1),1);case"EEEE":return an(n.weekdays("long",!1,!1),1);case"ccc":return an(n.weekdays("short",!0,!1),1);case"cccc":return an(n.weekdays("long",!0,!1),1);case"Z":case"ZZ":return un(new RegExp("([+-]"+l.source+")(?::("+s.source+"))?"),2);case"ZZZ":return un(new RegExp("([+-]"+l.source+")("+s.source+")?"),2);case"z":return ln(/[a-z_+-/]{1,256}?/i);default:return m(e)}}(r)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"}).token=r,y;var r,n,i,s,o,a,u,l,c,h,d,f,p,m,y})),s=i.find((function(e){return e.invalidReason}));if(s)return{input:t,tokens:n,invalidReason:s.invalidReason};var o=function(e){return["^"+e.map((function(e){return e.regex})).reduce((function(e,t){return e+"("+t.source+")"}),"")+"$",e]}(i),a=o[0],u=o[1],l=RegExp(a,"i"),c=function(e,t,r){var n=e.match(t);if(n){var i={},s=1;for(var o in r)if(Fe(r,o)){var a=r[o],u=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(n.slice(s,s+u))),s+=u}return[n,i]}return[n,{}]}(t,l,u),h=c[0],d=c[1],f=d?function(e){var t;return t=Ae(e.Z)?Ae(e.z)?null:kt.create(e.z):new At(e.Z),Ae(e.q)||(e.M=3*(e.q-1)+1),Ae(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),Ae(e.u)||(e.S=ze(e.u)),[Object.keys(e).reduce((function(t,r){var n=function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(r);return n&&(t[n]=e[r]),t}),{}),t]}(d):[null,null];return{input:t,tokens:n,regex:l,rawMatches:h,matches:d,result:f[0],zone:f[1]}}var fn=[0,31,59,90,120,151,181,212,243,273,304,334],pn=[0,31,60,91,121,152,182,213,244,274,305,335];function mn(e,t){return new Et("unit out of range","you specified "+t+" (of type "+typeof t+") as a "+e+", which is invalid")}function yn(e,t,r){var n=new Date(Date.UTC(e,t-1,r)).getUTCDay();return 0===n?7:n}function gn(e,t,r){return r+(Qe(e)?pn:fn)[t-1]}function vn(e,t){var r=Qe(e)?pn:fn,n=r.findIndex((function(e){return e<t}));return{month:n+1,day:t-r[n]}}function bn(e){var t,r=e.year,n=e.month,i=e.day,s=gn(r,n,i),o=yn(r,n,i),a=Math.floor((s-o+10)/7);return a<1?a=Ge(t=r-1):a>Ge(r)?(t=r+1,a=1):t=r,Object.assign({weekYear:t,weekNumber:a,weekday:o},nt(e))}function _n(e){var t,r=e.weekYear,n=e.weekNumber,i=e.weekday,s=yn(r,1,4),o=We(r),a=7*n+i-s-3;a<1?a+=We(t=r-1):a>o?(t=r+1,a-=We(r)):t=r;var u=vn(t,a),l=u.month,c=u.day;return Object.assign({year:t,month:l,day:c},nt(e))}function wn(e){var t=e.year,r=gn(t,e.month,e.day);return Object.assign({year:t,ordinal:r},nt(e))}function En(e){var t=e.year,r=vn(t,e.ordinal),n=r.month,i=r.day;return Object.assign({year:t,month:n,day:i},nt(e))}function Cn(e){var t=Ie(e.year),r=Ue(e.month,1,12),n=Ue(e.day,1,Je(e.year,e.month));return t?r?!n&&mn("day",e.day):mn("month",e.month):mn("year",e.year)}function Nn(e){var t=e.hour,r=e.minute,n=e.second,i=e.millisecond,s=Ue(t,0,23)||24===t&&0===r&&0===n&&0===i,o=Ue(r,0,59),a=Ue(n,0,59),u=Ue(i,0,999);return s?o?a?!u&&mn("millisecond",i):mn("second",n):mn("minute",r):mn("hour",t)}function $n(e){return new Et("unsupported zone",'the zone "'+e.name+'" is not supported')}function xn(e){return null===e.weekData&&(e.weekData=bn(e.c)),e.weekData}function Tn(e,t){var r={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new zn(Object.assign({},r,t,{old:r}))}function On(e,t,r){var n=e-60*t*1e3,i=r.offset(n);if(t===i)return[n,t];n-=60*(i-t)*1e3;var s=r.offset(n);return i===s?[n,i]:[e-60*Math.min(i,s)*1e3,Math.max(i,s)]}function Sn(e,t){var r=new Date(e+=60*t*1e3);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function kn(e,t,r){return On(Ke(e),t,r)}function jn(e,t){var r,n=Object.keys(t.values);-1===n.indexOf("milliseconds")&&n.push("milliseconds"),t=(r=t).shiftTo.apply(r,n);var i=e.o,s=e.c.year+t.years,o=e.c.month+t.months+3*t.quarters,a=Object.assign({},e.c,{year:s,month:o,day:Math.min(e.c.day,Je(s,o))+t.days+7*t.weeks}),u=Qr.fromObject({hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),l=On(Ke(a),i,e.zone),c=l[0],h=l[1];return 0!==u&&(c+=u,h=e.zone.offset(c)),{ts:c,o:h}}function An(e,t,r,n,i){var s=r.setZone,o=r.zone;if(e&&0!==Object.keys(e).length){var a=t||o,u=zn.fromObject(Object.assign(e,r,{zone:a,setZone:void 0}));return s?u:u.setZone(o)}return zn.invalid(new Et("unparsable",'the input "'+i+"\" can't be parsed as "+n))}function Rn(e,t){return e.isValid?wt.create(Yt.create("en-US"),{allowZ:!0,forceSimple:!0}).formatDateTimeFromString(e,t):null}function In(e,t){var r=t.suppressSeconds,n=void 0!==r&&r,i=t.suppressMilliseconds,s=void 0!==i&&i,o=t.includeOffset,a=t.includeZone,u=void 0!==a&&a,l=t.spaceZone,c=void 0!==l&&l,h="HH:mm";return n&&0===e.second&&0===e.millisecond||(h+=":ss",s&&0===e.millisecond||(h+=".SSS")),(u||o)&&c&&(h+=" "),u?h+="z":o&&(h+="ZZ"),Rn(e,h)}var Pn={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},qn={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ln={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Mn=["year","month","day","hour","minute","second","millisecond"],Dn=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Fn=["year","ordinal","hour","minute","second","millisecond"];function Un(e){var t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new se(e);return t}function Bn(e,t){for(var r=0,n=Mn;r<n.length;r++){var i=n[r];Ae(e[i])&&(e[i]=Pn[i])}var s=Cn(e)||Nn(e);if(s)return zn.invalid(s);var o=Ut.now(),a=kn(e,t.offset(o),t),u=a[0],l=a[1];return new zn({ts:u,zone:t,o:l})}function Vn(e,t,r){var n=!!Ae(r.round)||r.round,i=function(e,i){return e=He(e,n||r.calendary?0:2,!0),t.loc.clone(r).relFormatter(r).format(e,i)},s=function(n){return r.calendary?t.hasSame(e,n)?0:t.startOf(n).diff(e.startOf(n),n).get(n):t.diff(e,n).get(n)};if(r.unit)return i(s(r.unit),r.unit);var o=r.units,a=Array.isArray(o),u=0;for(o=a?o:o[Symbol.iterator]();;){var l;if(a){if(u>=o.length)break;l=o[u++]}else{if((u=o.next()).done)break;l=u.value}var c=l,h=s(c);if(Math.abs(h)>=1)return i(h,c)}return i(0,r.units[r.units.length-1])}var zn=function(){function e(e){var t=e.zone||Ut.defaultZone,r=e.invalid||(Number.isNaN(e.ts)?new Et("invalid input"):null)||(t.isValid?null:$n(t));this.ts=Ae(e.ts)?Ut.now():e.ts;var n=null,i=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t)){var s=[e.old.c,e.old.o];n=s[0],i=s[1]}else n=Sn(this.ts,t.offset(this.ts)),n=(r=Number.isNaN(n.year)?new Et("invalid input"):null)?null:n,i=r?null:t.offset(this.ts);this._zone=t,this.loc=e.loc||Yt.create(),this.invalid=r,this.weekData=null,this.c=n,this.o=i,this.isLuxonDateTime=!0}e.local=function(t,r,n,i,s,o,a){return Ae(t)?new e({ts:Ut.now()}):Bn({year:t,month:r,day:n,hour:i,minute:s,second:o,millisecond:a},Ut.defaultZone)},e.utc=function(t,r,n,i,s,o,a){return Ae(t)?new e({ts:Ut.now(),zone:At.utcInstance}):Bn({year:t,month:r,day:n,hour:i,minute:s,second:o,millisecond:a},At.utcInstance)},e.fromJSDate=function(t,r){void 0===r&&(r={});var n,i=(n=t,"[object Date]"===Object.prototype.toString.call(n)?t.valueOf():NaN);if(Number.isNaN(i))return e.invalid("invalid input");var s=It(r.zone,Ut.defaultZone);return s.isValid?new e({ts:i,zone:s,loc:Yt.fromObject(r)}):e.invalid($n(s))},e.fromMillis=function(t,r){if(void 0===r&&(r={}),Re(t))return t<-864e13||t>864e13?e.invalid("Timestamp out of range"):new e({ts:t,zone:It(r.zone,Ut.defaultZone),loc:Yt.fromObject(r)});throw new oe("fromMillis requires a numerical input")},e.fromSeconds=function(t,r){if(void 0===r&&(r={}),Re(t))return new e({ts:1e3*t,zone:It(r.zone,Ut.defaultZone),loc:Yt.fromObject(r)});throw new oe("fromSeconds requires a numerical input")},e.fromObject=function(t){var r=It(t.zone,Ut.defaultZone);if(!r.isValid)return e.invalid($n(r));var n=Ut.now(),i=r.offset(n),s=tt(t,Un,["zone","locale","outputCalendar","numberingSystem"]),o=!Ae(s.ordinal),a=!Ae(s.year),u=!Ae(s.month)||!Ae(s.day),l=a||u,c=s.weekYear||s.weekNumber,h=Yt.fromObject(t);if((l||o)&&c)throw new ie("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&o)throw new ie("Can't mix ordinal dates with month/day");var d,f,p=c||s.weekday&&!l,m=Sn(n,i);p?(d=Dn,f=qn,m=bn(m)):o?(d=Fn,f=Ln,m=wn(m)):(d=Mn,f=Pn);var y=!1,g=d,v=Array.isArray(g),b=0;for(g=v?g:g[Symbol.iterator]();;){var _;if(v){if(b>=g.length)break;_=g[b++]}else{if((b=g.next()).done)break;_=b.value}var w=_;Ae(s[w])?s[w]=y?f[w]:m[w]:y=!0}var E=(p?function(e){var t=Ie(e.weekYear),r=Ue(e.weekNumber,1,Ge(e.weekYear)),n=Ue(e.weekday,1,7);return t?r?!n&&mn("weekday",e.weekday):mn("week",e.week):mn("weekYear",e.weekYear)}(s):o?function(e){var t=Ie(e.year),r=Ue(e.ordinal,1,We(e.year));return t?!r&&mn("ordinal",e.ordinal):mn("year",e.year)}(s):Cn(s))||Nn(s);if(E)return e.invalid(E);var C=kn(p?_n(s):o?En(s):s,i,r),N=new e({ts:C[0],zone:r,o:C[1],loc:h});return s.weekday&&l&&t.weekday!==N.weekday?e.invalid("mismatched weekday","you can't specify both a weekday of "+s.weekday+" and a date of "+N.toISO()):N},e.fromISO=function(e,t){void 0===t&&(t={});var r=er(e,[xr,kr],[Tr,jr],[Or,Ar],[Sr,Rr]);return An(r[0],r[1],t,"ISO 8601",e)},e.fromRFC2822=function(e,t){void 0===t&&(t={});var r=er(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[br,_r]);return An(r[0],r[1],t,"RFC 2822",e)},e.fromHTTP=function(e,t){void 0===t&&(t={});var r=er(e,[wr,Nr],[Er,Nr],[Cr,$r]);return An(r[0],r[1],t,"HTTP",t)},e.fromFormat=function(t,r,n){if(void 0===n&&(n={}),Ae(t)||Ae(r))throw new oe("fromFormat requires an input string and a format");var i=n,s=i.locale,o=void 0===s?null:s,a=i.numberingSystem,u=void 0===a?null:a,l=function(e,t,r){var n=dn(e,t,r);return[n.result,n.zone,n.invalidReason]}(Yt.fromOpts({locale:o,numberingSystem:u,defaultToEN:!0}),t,r),c=l[0],h=l[1],d=l[2];return d?e.invalid(d):An(c,h,n,"format "+r,t)},e.fromString=function(t,r,n){return void 0===n&&(n={}),e.fromFormat(t,r,n)},e.fromSQL=function(e,t){void 0===t&&(t={});var r=er(e,[Ir,qr],[Pr,Lr]);return An(r[0],r[1],t,"SQL",e)},e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new oe("need to specify a reason the DateTime is invalid");var n=t instanceof Et?t:new Et(t,r);if(Ut.throwOnInvalid)throw new te(n);return new e({invalid:n})},e.isDateTime=function(e){return e&&e.isLuxonDateTime||!1};var t=e.prototype;return t.get=function(e){return this[e]},t.resolvedLocaleOpts=function(e){void 0===e&&(e={});var t=wt.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t.locale,numberingSystem:t.numberingSystem,outputCalendar:t.calendar}},t.toUTC=function(e,t){return void 0===e&&(e=0),void 0===t&&(t={}),this.setZone(At.instance(e),t)},t.toLocal=function(){return this.setZone(Ut.defaultZone)},t.setZone=function(t,r){var n=void 0===r?{}:r,i=n.keepLocalTime,s=void 0!==i&&i,o=n.keepCalendarTime,a=void 0!==o&&o;if((t=It(t,Ut.defaultZone)).equals(this.zone))return this;if(t.isValid){var u=this.ts;if(s||a){var l=this.o-t.offset(this.ts);u=kn(this.toObject(),l,t)[0]}return Tn(this,{ts:u,zone:t})}return e.invalid($n(t))},t.reconfigure=function(e){var t=void 0===e?{}:e,r=t.locale,n=t.numberingSystem,i=t.outputCalendar;return Tn(this,{loc:this.loc.clone({locale:r,numberingSystem:n,outputCalendar:i})})},t.setLocale=function(e){return this.reconfigure({locale:e})},t.set=function(e){if(!this.isValid)return this;var t,r=tt(e,Un,[]);Ae(r.weekYear)&&Ae(r.weekNumber)&&Ae(r.weekday)?Ae(r.ordinal)?(t=Object.assign(this.toObject(),r),Ae(r.day)&&(t.day=Math.min(Je(t.year,t.month),t.day))):t=En(Object.assign(wn(this.c),r)):t=_n(Object.assign(bn(this.c),r));var n=kn(t,this.o,this.zone);return Tn(this,{ts:n[0],o:n[1]})},t.plus=function(e){return this.isValid?Tn(this,jn(this,Wr(e))):this},t.minus=function(e){return this.isValid?Tn(this,jn(this,Wr(e).negate())):this},t.startOf=function(e){if(!this.isValid)return this;var t={},r=Qr.normalizeUnit(e);switch(r){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===r&&(t.weekday=1),"quarters"===r){var n=Math.ceil(this.month/3);t.month=3*(n-1)+1}return this.set(t)},t.endOf=function(e){var t;return this.isValid?this.plus((t={},t[e]=1,t)).startOf(e).minus(1):this},t.toFormat=function(e,t){return void 0===t&&(t={}),this.isValid?wt.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):"Invalid DateTime"},t.toLocaleString=function(e){return void 0===e&&(e=he),this.isValid?wt.create(this.loc.clone(e),e).formatDateTime(this):"Invalid DateTime"},t.toLocaleParts=function(e){return void 0===e&&(e={}),this.isValid?wt.create(this.loc.clone(e),e).formatDateTimeParts(this):[]},t.toISO=function(e){return void 0===e&&(e={}),this.isValid?this.toISODate()+"T"+this.toISOTime(e):null},t.toISODate=function(){var e="yyyy-MM-dd";return this.year>9999&&(e="+"+e),Rn(this,e)},t.toISOWeekDate=function(){return Rn(this,"kkkk-'W'WW-c")},t.toISOTime=function(e){var t=void 0===e?{}:e,r=t.suppressMilliseconds,n=void 0!==r&&r,i=t.suppressSeconds,s=void 0!==i&&i,o=t.includeOffset;return In(this,{suppressSeconds:s,suppressMilliseconds:n,includeOffset:void 0===o||o})},t.toRFC2822=function(){return Rn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ")},t.toHTTP=function(){return Rn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},t.toSQLDate=function(){return Rn(this,"yyyy-MM-dd")},t.toSQLTime=function(e){var t=void 0===e?{}:e,r=t.includeOffset,n=void 0===r||r,i=t.includeZone;return In(this,{includeOffset:n,includeZone:void 0!==i&&i,spaceZone:!0})},t.toSQL=function(e){return void 0===e&&(e={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(e):null},t.toString=function(){return this.isValid?this.toISO():"Invalid DateTime"},t.valueOf=function(){return this.toMillis()},t.toMillis=function(){return this.isValid?this.ts:NaN},t.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},t.toJSON=function(){return this.toISO()},t.toBSON=function(){return this.toJSDate()},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.c);return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},t.diff=function(e,t,r){if(void 0===t&&(t="milliseconds"),void 0===r&&(r={}),!this.isValid||!e.isValid)return Qr.invalid(this.invalid||e.invalid,"created by diffing an invalid DateTime");var n,i=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},r),s=(n=t,Array.isArray(n)?n:[n]).map(Qr.normalizeUnit),o=e.valueOf()>this.valueOf(),a=function(e,t,r,n){var i,s=function(e,t,r){for(var n,i,s={},o=0,a=[["years",function(e,t){return t.year-e.year}],["months",function(e,t){return t.month-e.month+12*(t.year-e.year)}],["weeks",function(e,t){var r=Zr(e,t);return(r-r%7)/7}],["days",Zr]];o<a.length;o++){var u=a[o],l=u[0],c=u[1];if(r.indexOf(l)>=0){var h;n=l;var d,f=c(e,t);(i=e.plus(((h={})[l]=f,h)))>t?(e=e.plus(((d={})[l]=f-1,d)),f-=1):e=i,s[l]=f}}return[e,s,i,n]}(e,t,r),o=s[0],a=s[1],u=s[2],l=s[3],c=t-o,h=r.filter((function(e){return["hours","minutes","seconds","milliseconds"].indexOf(e)>=0}));0===h.length&&(u<t&&(u=o.plus(((i={})[l]=1,i))),u!==o&&(a[l]=(a[l]||0)+c/(u-o)));var d,f=Qr.fromObject(Object.assign(a,n));return h.length>0?(d=Qr.fromMillis(c,n)).shiftTo.apply(d,h).plus(f):f}(o?this:e,o?e:this,s,i);return o?a.negate():a},t.diffNow=function(t,r){return void 0===t&&(t="milliseconds"),void 0===r&&(r={}),this.diff(e.local(),t,r)},t.until=function(e){return this.isValid?Gr.fromDateTimes(this,e):this},t.hasSame=function(e,t){if(!this.isValid)return!1;if("millisecond"===t)return this.valueOf()===e.valueOf();var r=e.valueOf();return this.startOf(t)<=r&&r<=this.endOf(t)},t.equals=function(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)},t.toRelative=function(t){if(void 0===t&&(t={}),!this.isValid)return null;var r=t.base||e.fromObject({zone:this.zone}),n=t.padding?this<r?-t.padding:t.padding:0;return Vn(r,this.plus(n),Object.assign(t,{numeric:"always",units:["years","months","days","hours","minutes","seconds"]}))},t.toRelativeCalendar=function(t){return void 0===t&&(t={}),this.isValid?Vn(t.base||e.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},e.min=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every(e.isDateTime))throw new oe("min requires all arguments be DateTimes");return Me(r,(function(e){return e.valueOf()}),Math.min)},e.max=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every(e.isDateTime))throw new oe("max requires all arguments be DateTimes");return Me(r,(function(e){return e.valueOf()}),Math.max)},e.fromFormatExplain=function(e,t,r){void 0===r&&(r={});var n=r,i=n.locale,s=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o;return dn(Yt.fromOpts({locale:s,numberingSystem:a,defaultToEN:!0}),e,t)},e.fromStringExplain=function(t,r,n){return void 0===n&&(n={}),e.fromFormatExplain(t,r,n)},J(e,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?xn(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?xn(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?xn(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?wn(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?Yr.months("short",{locale:this.locale})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?Yr.months("long",{locale:this.locale})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?Yr.weekdays("short",{locale:this.locale})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?Yr.weekdays("long",{locale:this.locale})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.universal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return Qe(this.year)}},{key:"daysInMonth",get:function(){return Je(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?We(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?Ge(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return he}},{key:"DATE_MED",get:function(){return de}},{key:"DATE_FULL",get:function(){return fe}},{key:"DATE_HUGE",get:function(){return pe}},{key:"TIME_SIMPLE",get:function(){return me}},{key:"TIME_WITH_SECONDS",get:function(){return ye}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return ge}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return ve}},{key:"TIME_24_SIMPLE",get:function(){return be}},{key:"TIME_24_WITH_SECONDS",get:function(){return _e}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return we}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return Ee}},{key:"DATETIME_SHORT",get:function(){return Ce}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return Ne}},{key:"DATETIME_MED",get:function(){return $e}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return xe}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return Te}},{key:"DATETIME_FULL",get:function(){return Oe}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return Se}},{key:"DATETIME_HUGE",get:function(){return ke}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return je}}]),e}();function Hn(e){if(zn.isDateTime(e))return e;if(e&&e.valueOf&&Re(e.valueOf()))return zn.fromJSDate(e);if(e&&"object"==typeof e)return zn.fromObject(e);throw new oe("Unknown datetime argument: "+e+", of type "+typeof e)}Q.DateTime=zn,Q.Duration=Qr,Q.FixedOffsetZone=At,Q.IANAZone=kt,Q.Info=Yr,Q.Interval=Gr,Q.InvalidZone=Rt,Q.LocalZone=$t,Q.Settings=Ut,Q.Zone=Ct;var Qn={},Wn="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(Wn){var Jn=new Uint8Array(16);Qn=function(){return Wn(Jn),Jn}}else{var Kn=new Array(16);Qn=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),Kn[t]=e>>>((3&t)<<3)&255;return Kn}}for(var Gn=[],Yn=0;Yn<256;++Yn)Gn[Yn]=(Yn+256).toString(16).substr(1);var Zn=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||Qn)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[n+s]=i[s];return t||function(e,t){var r=t||0,n=Gn;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}(i)};const{DateTime:Xn}=Q;const{DateTime:ei}=Q;var ti=class{constructor(e){this.db=e,this.types={}}async register(e,t,r){const n=this.db;this.types[e]={type:{...t,name:e},toolbox:r},n.events({types:t.events}).each(async e=>{let i=await n.object(e.meta.stream).read()||{};i=await t.on(r,i,e)||{},await n.object(e.meta.stream,{...i,_last:e.meta}).write()})}async create(e){const t=this.db,r=this.types[e],n=r.type;let i={_type:n,id:Zn()};return n.commands.forEach(e=>{i[e]=async function(n){let i=await this._type.do({...r.toolbox,db:t},this,e,n);return i.meta.stream=this.id,await t.stream(this.id).event(i.meta.type,i.data).append()}}),await t.object(i.id,i).write(),i}async get(e,t){const r=await this.db.object(e).read();if(t&&t.plain){let e={...r};return delete e._type,delete e._last,e}const n=this.db,i=this.types[r._type.name],s=i.type;return r._type=s,s.commands.forEach(e=>{r[e]=async function(t){let r=await this._type.do({...i.toolbox,db:n},this,e,t);return r.meta.stream=this.id,await n.stream(this.id).event(r.meta.type,r.data).append()}}),r}};function ri(e){return"reaction_"+e.replace(/[^a-zA-Z0-9]+/gi,"")}var ni=class{constructor(e){this.db=e,this.registrations={},this.cancellations={}}async register(e,t,r){this.db,this.registrations[e]={type:t,toolbox:r},await this.resume(e)}async get(e,t){const r=this.registrations[e],n=r.type;let i=await this.db.object(ri(e)).read()||n.context;n.get&&(i=await n.get({...r.toolbox,db:this.db},i,t));let s={...i};return delete s._type,delete s._last,s}async pause(e){this.registrations[e].type;const t=this.cancellations[e];t&&(t.cancel(),delete this.cancellations[e])}async resume(e){const t=this.registrations[e],r=t.type;if(this.cancellations[e])return;const n=this.db;let i=await n.object(ri(e)).read()||r.context,s={types:r.events};i&&i._last&&i._last.stream&&i._last.id&&(s.after=`${i._last.stream}.${i._last.id}`),this.cancellations[e]={cancel:()=>{}},n.events(s).each(i=>{(async i=>{let s=await n.object(ri(e)).read()||r.context;s=await r.on({...t.toolbox,db:n},s,i)||s,await n.object(ri(e),{...s,_last:i.meta}).write()})(i)},this.cancellations[e])}};function ii(e){return"view_"+e.replace(/[^a-zA-Z0-9]+/gi,"")}var si=class{constructor(e){this.db=e,this.registrations={},this.cancellations={}}async register(e,t,r){this.db,this.registrations[e]={type:t,toolbox:r},t.extends||await this.resume(e)}async get(e,t){const r=this.registrations[e],n=r.type;if(n.extends){let e=await this.get(n.extends,t);return await n.get({...r.toolbox,db:this.db},e,t)}let i=await this.db.object(ii(e)).read()||n.default;n.get&&(i=await n.get({...r.toolbox,db:this.db},i,t));let s={...i};return delete s._type,delete s._last,s}async refresh(e){this.registrations[e].type.extends||(this.pause(e),this.rewind(e),this.resume(e))}async rewind(e){this.registrations[e].type.extends||await this.db.object(ii(e)).destroy()}async pause(e){if(this.registrations[e].type.extends)return;const t=this.cancellations[e];t&&(t.cancel(),delete this.cancellations[e])}async resume(e){const t=this.registrations[e],r=t.type;if(r.extends)return;if(this.cancellations[e])return;const n=this.db;let i=await n.object(ii(e)).read()||r.default,s={types:r.events};i&&i._last&&i._last.stream&&i._last.id&&(s.after=`${i._last.stream}.${i._last.id}`),this.cancellations[e]={cancel:()=>{}},n.events(s).each(async i=>{let s=await n.object(ii(e)).read()||r.default;s=await r.on({...t.toolbox,db:n},s,i)||s,await n.object(ii(e),{...s,_last:i.meta}).write()},this.cancellations[e])}};function oi(e){var t=this;if(t instanceof oi||(t=new oi),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}function ai(e,t){e.tail=new li(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function ui(e,t){e.head=new li(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function li(e,t,r,n){if(!(this instanceof li))return new li(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}oi.Node=li,oi.create=oi,oi.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null},oi.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},oi.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},oi.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)ai(this,arguments[e]);return this.length},oi.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)ui(this,arguments[e]);return this.length},oi.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},oi.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},oi.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},oi.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},oi.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},oi.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},oi.prototype.map=function(e,t){t=t||this;for(var r=new oi,n=this.head;null!==n;)r.push(e.call(t,n.value,this)),n=n.next;return r},oi.prototype.mapReverse=function(e,t){t=t||this;for(var r=new oi,n=this.tail;null!==n;)r.push(e.call(t,n.value,this)),n=n.prev;return r},oi.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},oi.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},oi.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},oi.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},oi.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new oi;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;for(;null!==i&&n<t;n++,i=i.next)r.push(i.value);return r},oi.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new oi;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;null!==i&&n>t;n--)i=i.prev;for(;null!==i&&n>e;n--,i=i.prev)r.push(i.value);return r},oi.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{!function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}(oi)}catch(fN){}Symbol("max"),Symbol("length"),Symbol("lengthCalculator"),Symbol("allowStale"),Symbol("maxAge"),Symbol("dispose"),Symbol("noDisposeOnSet"),Symbol("lruList"),Symbol("cache"),Symbol("updateAgeOnGet");var ci=class{constructor({stream:e,id:t,type:r,data:n}){this.stream=e,this.id=t,this.type=r,this.data=n}get store(){return this.account.store}get account(){return this.db.account}get db(){return this.ns.db}get ns(){return this.stream.ns}async destroy(){return await this.store.events.destroy({db:this.db.name,ns:this.ns.name,stream:this.stream.id,event:this.id})}async read(){return await this.store.events.read({db:this.db.name,ns:this.ns.name,stream:this.stream.id,event:this.id})}async append(){return await this.stream.events().write(this.type,this.data)}};H.config({cancellation:!0});var hi=class{constructor({db:e,cursor:t,ns:r,stream:n,from:i,after:s,to:o,until:a,types:u,filters:l,limit:c}){this._db=e,this.cursor=t,this._ns=r,this.stream=n,this.from=i,this.after=s,this.to=o,this.until=a,this.types=u,this.filters=l||[],this.limit=c,this.shouldRead=!0}get store(){return this.account.store}get account(){return this.db.account}get db(){return this._db||this.ns.db}get ns(){return this._ns||(this.stream?this.stream.ns:void 0)}filter(e){return this.filters.push(e),this}group(e){return this.groupby=e,this.until||(this.until="caught-up"),this}rollup(e){return this.rollupto=e,this}async write(e){var t,r;return 1===arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof String)&&(e={meta:{type:arguments[0]},data:{}}),2===arguments.length&&(e={meta:{type:arguments[0]},data:{...arguments[1]}}),await this.store.events.write({data:e.data,meta:{db:this.db.name,ns:null!==(t=null===(r=this.ns)||void 0===r?void 0:r.name)&&void 0!==t?t:"",stream:this.stream.id,...Object.keys(e.meta).filter(e=>"type"===e||"id"===e).reduce((t,r)=>({...t,[r]:e.meta[r]}),{})}})}async each(e,t){let r={db:this.db.name,cursor:this.cursor?this.cursor.name:void 0,ns:this.ns?this.ns.name:void 0,stream:this.stream?this.stream.id:void 0,from:this.from,after:this.after,to:this.to,until:this.until,types:this.types,filters:this.filters,groupby:this.groupby,rollupto:this.rollupto,limit:this.groupby?void 0:this.limit};Object.keys(r).forEach(e=>{void 0!==r[e]&&0!==r[e].length||delete r[e]}),await this.store.events.find({...r,callback:e,cancellation:t})}},di=class{constructor(e,t,r){this.id=e||Zn(),this.ns=t,r&&(this.created=r.created,this.modified=r.modified,this.size=r.size,this.annotation=r.annotation)}get store(){return this.account.store}get account(){return this.db.account}get db(){return this.ns.db}events(e){return new hi({...e,stream:this})}event(e,t){return new ci({stream:this,id:e,type:e,data:t})}async annotate(e){return this.store.annotations.write({db:this.db.name,ns:this.ns.name,stream:this.id,annotation:e})}annotation(){return new class{constructor(e){this.stream=e}get store(){return this.account.store}get account(){return this.db.account}get db(){return this.ns.db}get ns(){return this.stream.ns}async destroy(){return this.store.annotations.destroy({db:this.db.name,ns:this.ns.name,stream:this.stream.id})}async read(){return this.store.annotations.read({db:this.db.name,ns:this.ns.name,stream:this.stream.id})}}(this)}async destroy(){return this.store.annotations.destroy({db:this.db.name,ns:this.ns.name,stream:this.id})}},fi=class{constructor({db:e,ns:t}){this._db=e,this.ns=t}get store(){return this.account.store}get account(){return this.db.account}get db(){var e;return this._db||(null===(e=this.ns)||void 0===e?void 0:e.db)}stream(e,t){return(void 0!==t.ns?this.db.ns(t.ns):this.ns).stream(e,t)}async each(e){var t;const r=this.store.streams.find({db:this.db.name,ns:null===(t=this.ns)||void 0===t?void 0:t.name});for(const n of r)await e(this.stream(n.id,n))}async all(){var e;return this.store.streams.find({db:this.db.name,ns:null===(e=this.ns)||void 0===e?void 0:e.name})}},pi=class{constructor(e,t){this.name=e,this.db=t}get store(){return this.account.store}get account(){return this.db.account}streams(){return new fi({ns:this})}stream(e,t){return new di(e,this,t)}events(e){return"string"==typeof e&&(e={types:[e]}),new hi({...e,ns:this})}async create(){return await this.store.namespaces.create({db:this.db.name,ns:this.name}),this}async destroy(){await this.store.namespaces.destroy({db:this.db.name,ns:this.name})}async truncate(){await this.store.namespaces.truncate({db:this.db.name,ns:this.name})}async rename(e){return await this.store.namespaces.rename({db:this.db.name,ns:this.name,to:e}),this.name=e,this}async export(){return await this.streams().each(e=>this.stream(e.id).export()),this}},mi={};(function(e){var t=require("path"),r="win32"===e.platform,n=require("fs"),i=e.env.NODE_DEBUG&&/fs/.test(e.env.NODE_DEBUG);if(t.normalize,r)var s=/(.*?)(?:[\/\\]+|$)/g;else s=/(.*?)(?:[\/]+|$)/g;if(r)var o=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else o=/^[\/]*/;mi.realpathSync=function(e,i){if(e=t.resolve(e),i&&Object.prototype.hasOwnProperty.call(i,e))return i[e];var a,u,l,c,h=e,d={},f={};function p(){var t=o.exec(e);a=t[0].length,u=t[0],l=t[0],c="",r&&!f[l]&&(n.lstatSync(l),f[l]=!0)}for(p();a<e.length;){s.lastIndex=a;var m=s.exec(e);if(c=u,u+=m[0],l=c+m[1],a=s.lastIndex,!(f[l]||i&&i[l]===l)){var y;if(i&&Object.prototype.hasOwnProperty.call(i,l))y=i[l];else{var g=n.lstatSync(l);if(!g.isSymbolicLink()){f[l]=!0,i&&(i[l]=l);continue}var v=null;if(!r){var b=g.dev.toString(32)+":"+g.ino.toString(32);d.hasOwnProperty(b)&&(v=d[b])}null===v&&(n.statSync(l),v=n.readlinkSync(l)),y=t.resolve(c,v),i&&(i[l]=y),r||(d[b]=v)}e=t.resolve(y,e.slice(a)),p()}}return i&&(i[h]=e),e},mi.realpath=function(a,u,l){if("function"!=typeof l&&(l=function(t){return"function"==typeof t?t:function(){var t;if(i){var r=new Error;t=function(e){e&&(r.message=e.message,n(e=r))}}else t=n;return t;function n(t){if(t){if(e.throwDeprecation)throw t;if(!e.noDeprecation){var r="fs: missing callback "+(t.stack||t.message);e.traceDeprecation?console.trace(r):console.error(r)}}}}()}(u),u=null),a=t.resolve(a),u&&Object.prototype.hasOwnProperty.call(u,a))return e.nextTick(l.bind(null,null,u[a]));var c,h,d,f,p=a,m={},y={};function g(){var t=o.exec(a);c=t[0].length,h=t[0],d=t[0],f="",r&&!y[d]?n.lstat(d,(function(e){if(e)return l(e);y[d]=!0,v()})):e.nextTick(v)}function v(){if(c>=a.length)return u&&(u[p]=a),l(null,a);s.lastIndex=c;var t=s.exec(a);return f=h,h+=t[0],d=f+t[1],c=s.lastIndex,y[d]||u&&u[d]===d?e.nextTick(v):u&&Object.prototype.hasOwnProperty.call(u,d)?w(u[d]):n.lstat(d,b)}function b(t,i){if(t)return l(t);if(!i.isSymbolicLink())return y[d]=!0,u&&(u[d]=d),e.nextTick(v);if(!r){var s=i.dev.toString(32)+":"+i.ino.toString(32);if(m.hasOwnProperty(s))return _(null,m[s],d)}n.stat(d,(function(e){if(e)return l(e);n.readlink(d,(function(e,t){r||(m[s]=t),_(e,t)}))}))}function _(e,r,n){if(e)return l(e);var i=t.resolve(f,r);u&&(u[n]=i),w(i)}function w(e){a=t.resolve(e,a.slice(c)),g()}g()}}).call(this,require("_process"));var yi={};(function(e){yi=a,a.realpath=a,a.sync=u,a.realpathSync=u,a.monkeypatch=function(){t.realpath=a,t.realpathSync=u},a.unmonkeypatch=function(){t.realpath=r,t.realpathSync=n};var t=require("fs"),r=t.realpath,n=t.realpathSync,i=e.version,s=/^v[0-5]\./.test(i);function o(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function a(e,t,n){if(s)return r(e,t,n);"function"==typeof t&&(n=t,t=null),r(e,t,(function(r,i){o(r)?mi.realpath(e,t,n):n(r,i)}))}function u(e,t){if(s)return n(e,t);try{return n(e,t)}catch(fN){if(o(fN))return mi.realpathSync(e,t);throw fN}}}).call(this,require("_process"));var gi=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},vi={};function bi(e,t,r){e instanceof RegExp&&(e=_i(e,r)),t instanceof RegExp&&(t=_i(t,r));var n=wi(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function _i(e,t){var r=t.match(e);return r?r[0]:null}function wi(e,t,r){var n,i,s,o,a,u=r.indexOf(e),l=r.indexOf(t,u+1),c=u;if(u>=0&&l>0){for(n=[],s=r.length;c>=0&&!a;)c==u?(n.push(c),u=r.indexOf(e,c+1)):1==n.length?a=[n.pop(),l]:((i=n.pop())<s&&(s=i,o=l),l=r.indexOf(t,c+1)),c=u<l&&u>=0?u:l;n.length&&(a=[s,o])}return a}vi=bi,bi.range=wi;var Ei=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),function e(t,r){var n=[],i=vi("{","}",t);if(!i||/\$$/.test(i.pre))return[t];var s,o=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),u=o||a,l=i.body.indexOf(",")>=0;if(!u&&!l)return i.post.match(/,.*\}/)?(t=i.pre+"{"+i.body+$i+i.post,e(t)):[t];if(u)s=i.body.split(/\.\./);else if(1===(s=function e(t){if(!t)return[""];var r=[],n=vi("{","}",t);if(!n)return t.split(",");var i=n.pre,s=n.body,o=n.post,a=i.split(",");a[a.length-1]+="{"+s+"}";var u=e(o);return o.length&&(a[a.length-1]+=u.shift(),a.push.apply(a,u)),r.push.apply(r,a),r}(i.body)).length&&1===(s=e(s[0],!1).map(ki)).length){return(d=i.post.length?e(i.post,!1):[""]).map((function(e){return i.pre+s[0]+e}))}var c,h=i.pre,d=i.post.length?e(i.post,!1):[""];if(u){var f=Oi(s[0]),p=Oi(s[1]),m=Math.max(s[0].length,s[1].length),y=3==s.length?Math.abs(Oi(s[2])):1,g=Ai;p<f&&(y*=-1,g=Ri);var v=s.some(ji);c=[];for(var b=f;g(b,p);b+=y){var _;if(a)"\\"===(_=String.fromCharCode(b))&&(_="");else if(_=String(b),v){var w=m-_.length;if(w>0){var E=new Array(w+1).join("0");_=b<0?"-"+E+_.slice(1):E+_}}c.push(_)}}else c=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=t(e[n],n);gi(i)?r.push.apply(r,i):r.push(i)}return r}(s,(function(t){return e(t,!1)}));for(var C=0;C<c.length;C++)for(var N=0;N<d.length;N++){var $=h+c[C]+d[N];(!r||u||$)&&n.push($)}return n}(function(e){return e.split("\\\\").join(Ci).split("\\{").join(Ni).split("\\}").join($i).split("\\,").join(xi).split("\\.").join(Ti)}(e),!0).map(Si)):[]},Ci="\0SLASH"+Math.random()+"\0",Ni="\0OPEN"+Math.random()+"\0",$i="\0CLOSE"+Math.random()+"\0",xi="\0COMMA"+Math.random()+"\0",Ti="\0PERIOD"+Math.random()+"\0";function Oi(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Si(e){return e.split(Ci).join("\\").split(Ni).join("{").split($i).join("}").split(xi).join(",").split(Ti).join(".")}function ki(e){return"{"+e+"}"}function ji(e){return/^-?0\d/.test(e)}function Ai(e,t){return e<=t}function Ri(e,t){return e>=t}var Ii={};Ii=Ui,Ui.Minimatch=Bi;var Pi={sep:"/"};try{Pi=require("path")}catch(fN){}var qi=Ui.GLOBSTAR=Bi.GLOBSTAR={},Li={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Mi="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),Di=/\/+/;function Fi(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach((function(e){r[e]=t[e]})),Object.keys(e).forEach((function(t){r[t]=e[t]})),r}function Ui(e,t,r){if("string"!=typeof t)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new Bi(t,r).match(e))}function Bi(e,t){if(!(this instanceof Bi))return new Bi(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==Pi.sep&&(e=e.split(Pi.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function Vi(e,t){if(t||(t=this instanceof Bi?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:Ei(e)}Ui.filter=function(e,t){return t=t||{},function(r,n,i){return Ui(r,e,t)}},Ui.defaults=function(e){if(!e||!Object.keys(e).length)return Ui;var t=Ui,r=function(r,n,i){return t.minimatch(r,n,Fi(e,i))};return r.Minimatch=function(r,n){return new t.Minimatch(r,Fi(e,n))},r},Bi.defaults=function(e){return e&&Object.keys(e).length?Ui.defaults(e).Minimatch:Bi},Bi.prototype.debug=function(){},Bi.prototype.make=function(){if(!this._made){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,r),r=this.globParts=r.map((function(e){return e.split(Di)})),this.debug(this.pattern,r),r=r.map((function(e,t,r){return e.map(this.parse,this)}),this),this.debug(this.pattern,r),r=r.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,r),this.set=r}else this.empty=!0;else this.comment=!0}},Bi.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=0;if(!this.options.nonegate){for(var n=0,i=e.length;n<i&&"!"===e.charAt(n);n++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}},Ui.braceExpand=function(e,t){return Vi(e,t)},Bi.prototype.braceExpand=Vi,Bi.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===e)return qi;if(""===e)return"";var n,i="",s=!!r.nocase,o=!1,a=[],u=[],l=!1,c=-1,h=-1,d="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",f=this;function p(){if(n){switch(n){case"*":i+="[^/]*?",s=!0;break;case"?":i+="[^/]",s=!0;break;default:i+="\\"+n}f.debug("clearStateChar %j %j",n,i),n=!1}}for(var m,y=0,g=e.length;y<g&&(m=e.charAt(y));y++)if(this.debug("%s\t%s %s %j",e,y,i,m),o&&Mi[m])i+="\\"+m,o=!1;else switch(m){case"/":return!1;case"\\":p(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,y,i,m),l){this.debug("  in class"),"!"===m&&y===h+1&&(m="^"),i+=m;continue}f.debug("call clearStateChar %j",n),p(),n=m,r.noext&&p();continue;case"(":if(l){i+="(";continue}if(!n){i+="\\(";continue}a.push({type:n,start:y-1,reStart:i.length,open:Li[n].open,close:Li[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(l||!a.length){i+="\\)";continue}p(),s=!0;var v=a.pop();i+=v.close,"!"===v.type&&u.push(v),v.reEnd=i.length;continue;case"|":if(l||!a.length||o){i+="\\|",o=!1;continue}p(),i+="|";continue;case"[":if(p(),l){i+="\\"+m;continue}l=!0,h=y,c=i.length,i+=m;continue;case"]":if(y===h+1||!l){i+="\\"+m,o=!1;continue}if(l){var b=e.substring(h+1,y);try{RegExp("["+b+"]")}catch(fN){var _=this.parse(b,zi);i=i.substr(0,c)+"\\["+_[0]+"\\]",s=s||_[1],l=!1;continue}}s=!0,l=!1,i+=m;continue;default:p(),o?o=!1:!Mi[m]||"^"===m&&l||(i+="\\"),i+=m}for(l&&(b=e.substr(h+1),_=this.parse(b,zi),i=i.substr(0,c)+"\\["+_[0],s=s||_[1]),v=a.pop();v;v=a.pop()){var w=i.slice(v.reStart+v.open.length);this.debug("setting tail",i,v),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,r){return r||(r="\\"),t+t+r+"|"})),this.debug("tail=%j\n   %s",w,w,v,i);var E="*"===v.type?"[^/]*?":"?"===v.type?"[^/]":"\\"+v.type;s=!0,i=i.slice(0,v.reStart)+E+"\\("+w}p(),o&&(i+="\\\\");var C=!1;switch(i.charAt(0)){case".":case"[":case"(":C=!0}for(var N=u.length-1;N>-1;N--){var $=u[N],x=i.slice(0,$.reStart),T=i.slice($.reStart,$.reEnd-8),O=i.slice($.reEnd-8,$.reEnd),S=i.slice($.reEnd);O+=S;var k=x.split("(").length-1,j=S;for(y=0;y<k;y++)j=j.replace(/\)[+*?]?/,"");var A="";""===(S=j)&&t!==zi&&(A="$"),i=x+T+S+A+O}if(""!==i&&s&&(i="(?=.)"+i),C&&(i=d+i),t===zi)return[i,s];if(!s)return e.replace(/\\(.)/g,"$1");var R=r.nocase?"i":"";try{var I=new RegExp("^"+i+"$",R)}catch(fN){return new RegExp("$.")}return I._glob=e,I._src=i,I};var zi={};Ui.makeRe=function(e,t){return new Bi(e,t||{}).makeRe()},Bi.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",i=e.map((function(e){return e.map((function(e){return e===qi?r:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(s){this.regexp=!1}return this.regexp},Ui.match=function(e,t,r){var n=new Bi(t,r=r||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},Bi.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r=this.options;"/"!==Pi.sep&&(e=e.split(Pi.sep).join("/")),e=e.split(Di),this.debug(this.pattern,"split",e);var n,i,s=this.set;for(this.debug(this.pattern,"set",s),i=e.length-1;i>=0&&!(n=e[i]);i--);for(i=0;i<s.length;i++){var o=s[i],a=e;if(r.matchBase&&1===o.length&&(a=[n]),this.matchOne(a,o,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},Bi.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,s=0,o=e.length,a=t.length;i<o&&s<a;i++,s++){this.debug("matchOne loop");var u,l=t[s],c=e[i];if(this.debug(t,l,c),!1===l)return!1;if(l===qi){this.debug("GLOBSTAR",[t,l,c]);var h=i,d=s+1;if(d===a){for(this.debug("** at the end");i<o;i++)if("."===e[i]||".."===e[i]||!n.dot&&"."===e[i].charAt(0))return!1;return!0}for(;h<o;){var f=e[h];if(this.debug("\nglobstar while",e,h,t,d,f),this.matchOne(e.slice(h),t.slice(d),r))return this.debug("globstar found match!",h,o,f),!0;if("."===f||".."===f||!n.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,h,t,d);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",e,h,t,d),h!==o))}if("string"==typeof l?(u=n.nocase?c.toLowerCase()===l.toLowerCase():c===l,this.debug("string match",l,c,u)):(u=c.match(l),this.debug("pattern match",l,c,u)),!u)return!1}if(i===o&&s===a)return!0;if(i===o)return r;if(s===a)return i===o-1&&""===e[i];throw new Error("wtf?")};var Hi={};Hi="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var Qi={};(function(e){"use strict";function t(e){return"/"===e.charAt(0)}function r(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),r=t[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(t[2]||n)}(Qi="win32"===e.platform?r:t).posix=t,Qi.win32=r}).call(this,require("_process"));var Wi={};(function(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Wi.setopts=function(s,u,l){if(l||(l={}),l.matchBase&&-1===u.indexOf("/")){if(l.noglobstar)throw new Error("base matching requires globstar");u="**/"+u}s.silent=!!l.silent,s.pattern=u,s.strict=!1!==l.strict,s.realpath=!!l.realpath,s.realpathCache=l.realpathCache||Object.create(null),s.follow=!!l.follow,s.dot=!!l.dot,s.mark=!!l.mark,s.nodir=!!l.nodir,s.nodir&&(s.mark=!0),s.sync=!!l.sync,s.nounique=!!l.nounique,s.nonull=!!l.nonull,s.nosort=!!l.nosort,s.nocase=!!l.nocase,s.stat=!!l.stat,s.noprocess=!!l.noprocess,s.absolute=!!l.absolute,s.fs=l.fs||r,s.maxLength=l.maxLength||1/0,s.cache=l.cache||Object.create(null),s.statCache=l.statCache||Object.create(null),s.symlinks=l.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(o))}(s,l),s.changedCwd=!1;var c=e.cwd();t(l,"cwd")?(s.cwd=n.resolve(l.cwd),s.changedCwd=s.cwd!==c):s.cwd=c,s.root=l.root||n.resolve(s.cwd,"/"),s.root=n.resolve(s.root),"win32"===e.platform&&(s.root=s.root.replace(/\\/g,"/")),s.cwdAbs=Qi(s.cwd)?s.cwd:a(s,s.cwd),"win32"===e.platform&&(s.cwdAbs=s.cwdAbs.replace(/\\/g,"/")),s.nomount=!!l.nomount,l.nonegate=!0,l.nocomment=!0,s.minimatch=new i(u,l),s.options=s.minimatch.options},Wi.ownProp=t,Wi.makeAbs=a,Wi.finish=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var o=e.matches[n];if(o&&0!==Object.keys(o).length){var l=Object.keys(o);t?r.push.apply(r,l):l.forEach((function(e){r[e]=!0}))}else if(e.nonull){var c=e.minimatch.globSet[n];t?r.push(c):r[c]=!0}}if(t||(r=Object.keys(r)),e.nosort||(r=r.sort(s)),e.mark){for(n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter((function(t){var r=!/\/$/.test(t),n=e.cache[t]||e.cache[a(e,t)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r})))}e.ignore.length&&(r=r.filter((function(t){return!u(e,t)}))),e.found=r},Wi.mark=function(e,t){var r=a(e,t),n=e.cache[r],i=t;if(n){var s="DIR"===n||Array.isArray(n),o="/"===t.slice(-1);if(s&&!o?i+="/":!s&&o&&(i=i.slice(0,-1)),i!==t){var u=a(e,i);e.statCache[u]=e.statCache[r],e.cache[u]=e.cache[r]}}return i},Wi.isIgnored=u,Wi.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var r=require("fs"),n=require("path"),i=Ii.Minimatch;function s(e,t){return e.localeCompare(t,"en")}function o(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new i(r,{dot:!0})}return{matcher:new i(e,{dot:!0}),gmatcher:t}}function a(t,r){var i=r;return i="/"===r.charAt(0)?n.join(t.root,r):Qi(r)||""===r?r:t.changedCwd?n.resolve(t.cwd,r):n.resolve(r),"win32"===e.platform&&(i=i.replace(/\\/g,"/")),i}function u(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}}).call(this,require("_process"));var Ji=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach((function(e){n[e]=i[e]})),n}},Ki={};function Gi(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Yi(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}(Ki=Ji(Gi)).strict=Ji(Yi),Gi.proto=Gi((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Gi(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Yi(this)},configurable:!0})}));var Zi={};(function(e){var t=Object.create(null);Zi=Ji((function(r,n){return t[r]?(t[r].push(n),null):(t[r]=[n],function(r){return Ki((function n(){var i=t[r],s=i.length,o=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}(arguments);try{for(var a=0;a<s;a++)i[a].apply(null,o)}finally{i.length>s?(i.splice(0,s),e.nextTick((function(){n.apply(null,o)}))):delete t[r]}}))}(r))}))}).call(this,require("_process"));const Xi=fi,es=N({}),ts=require("path");class rs{constructor(e,t){this.name=e,this.account=t,this.objects=new ti(this),this.reactions=new ni(this),this.views=new si(this)}get connection(){return this.account.connection}get store(){return this.account.store}use(e){return new rs(e,this.account)}namespaces(){return new class{constructor(e){this.db=e}get store(){return this.account.store}get account(){return this.db.account}namespace(e){return this.ns(e)}ns(e){return new pi(e,this.db)}async each(e){const t=this.store.namespaces.find({db:this.db.name});for(const r of t)await e(this.ns(r.id))}async all(){return this.store.namespaces.find({db:this.db.name})}}(this)}namespace(e){return this.ns(e)}ns(e){return new pi(e,this)}streams(e){return e.ns&&(e.ns=this.ns(e.ns)),new Xi({...e,db:this})}events(e){return new hi({...e,db:this})}stream(e){return this.ns("").stream(e)}object(e,t){return new class{constructor(e,t,r){this.db=e,this.id=t,this.data=r}get store(){return this.account.store}get account(){return this.db.account}async write(){return this.store.objects.write({db:this.db.name,id:this.id,data:this.data})}async read(){return this.store.objects.read({db:this.db.name,id:this.id})}async destroy(){return this.store.objects.destroy({db:this.db.name,id:this.id})}}(this,e,t)}async domain({folder:e,tools:t,objects:r,views:n,reactions:i}){this.objects=new ti(this),this.reactions=new ni(this),this.views=new si(this);const s={...t,db:this};function o(t,r,n,i){return e?es.sync(t,{...i,cwd:ts.resolve(r,n)}).map(e=>{const t={...ts.parse(e),relpath:e,abspath:ts.resolve(r,n,e)};return t.id=[t.dir.replace("/","."),t.name].join(".").replace(/^\./,""),t}):[]}for(const a of o("**/*.js",e,"objects",{ignore:["**/commands/*","**/events/*"]}))this.objects.register(a.id.replace(/\.index$/,""),require(a.abspath),s);for(const[a,u]of Object.entries(null!=r?r:{}))this.objects.register(a,u,s);for(const a of o("**/*.js",e,"views",{}))this.views.register(a.id,require(a.abspath),s);for(const[a,u]of Object.entries(null!=n?n:{}))this.views.register(a,u,s);for(const a of o("**/*.js",e,"reactions",{}))this.reactions.register(a.id,require(a.abspath),s);for(const[a,u]of Object.entries(null!=i?i:{}))this.reactions.register(a,u,s)}async exists(){let e=void 0;try{e=await this.store.databases.find({name:this.name})}catch(error){e=void 0}return null!=e}async notExists(){return!await this.exists()}async create(){const e=await this.account.profile();return await this.store.databases.create({name:this.name,account:e.id}),this}async createIfNotExists(){return await this.notExists()&&await this.create(),this}async destroy(){await this.store.databases.destroy({db:this.name})}async rename(e){return await this.store.databases.rename({db:this.name,to:e}),this.name=e,this}async grant({role:e,email:t}){return await this.store.accounts.grant({db:this.name,role:e,email:t}),this}async revoke({email:e}){return await this.store.accounts.revoke({db:this.name,email:e}),this}}var ns=rs,is=class{constructor(e){this.account=e}get store(){return this.account.store}async each(e){const t=await this.store.databases.find();for(const r of t)await e(r)}async all(){return await this.store.databases.find()}},ss=class{constructor(e,t){this.connection=e,this.name=null==t?void 0:t.name,this.username=null==t?void 0:t.username}get store(){return this.connection.store}db(e){return new ns(e,this)}databases(){return new is(this)}async exists({password:e}){let t=void 0;try{t=await this.store.accounts.find({username:this.username,password:e})}catch(error){t=void 0}return null!=t}async notExists({password:e}){return!await this.exists({password:e})}async create({password:e}){var t;return await this.store.accounts.create({name:null!==(t=this.name)&&void 0!==t?t:"",username:this.username,password:e}),this}async createIfNotExists({password:e}){return await this.notExists({password:e})&&await this.create({password:e}),this}async destroy(){return await this.store.accounts.destroy({username:this.username}),this}async activate(){return await this.store.accounts.activate({username:this.username}),this}async deactivate(){return await this.store.accounts.deactivate({username:this.username}),this}async profile(){return await this.store.accounts.find({username:this.username})}},os=class extends Error{constructor(e,t){super(e),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor),this.status=t||500}};const as=require("fs");var us={PersistrError:os,register:function(e){return as.readdirSync(e).forEach(t=>{if(as.statSync(`${e}/${t}`).isDirectory())return register(`${e}/${t}`);const r=""+t;if("index.js"!==r&&r.endsWith(".js")){var n=require(`${e}/${t}`);us[n.name]=n}}),us},handle:function(e){return async function(t,r,n){try{await e(t,r,n)}catch(error){r.headersSent&&r.get("content-type").includes("text/event-stream")?(console.error(error.message+"\t"+error.stack),r.write(`event: error\ndata: ${JSON.stringify({message:error.message,name:error.name,status:error.status})}\n\n`)):error instanceof us.PersistrError?(console.error(error.message+"\t"+error.stack),r.status(error.status).json({error:error.message})):(console.error(error.message+"\t"+error.stack),r.status(500).json({error:"Internal service error",internal:error.message,stack:error.stack}))}}},json:function(e,t,r,n){e?r.status(400).json({error:"Invalid JSON body in request: "+t.originalUrl,internal:e.message,stack:e.stack}):n()}},ls=us,cs={};(function(e){cs=ls.register(e)}).call(this,"/node_modules/@persistr/server-crypto/src/errors");var hs={};Object.defineProperty(hs,"__esModule",{value:!0}),hs.getRules=hs.isJSONType=void 0;const ds=new Set(["string","number","integer","boolean","null","object","array"]);hs.isJSONType=function(e){return"string"==typeof e&&ds.has(e)},hs.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var fs={};function ps(e,t){return t.rules.some(t=>ms(e,t))}function ms(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(fs,"__esModule",{value:!0}),fs.shouldUseRule=fs.shouldUseGroup=fs.schemaHasRulesForType=void 0,fs.schemaHasRulesForType=function({schema:e,self:t},r){const n=t.RULES.types[r];return n&&!0!==n&&ps(e,n)},fs.shouldUseGroup=ps,fs.shouldUseRule=ms;var ys={};Object.defineProperty(ys,"__esModule",{value:!0}),ys.getProperty=ys.safeStringify=ys.stringify=ys.strConcat=ys.addCodeArg=ys.str=ys._=ys.nil=ys._Code=ys.Name=ys.IDENTIFIER=ys._CodeOrName=void 0;class gs{}ys._CodeOrName=gs,ys.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class vs extends gs{constructor(e){if(super(),!ys.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}ys.Name=vs;class bs extends gs{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof vs&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function _s(e,...t){const r=[e[0]];let n=0;for(;n<t.length;)Cs(r,t[n]),r.push(e[++n]);return new bs(r)}ys._Code=bs,ys.nil=new bs(""),ys._=_s;const ws=new bs("+");function Es(e,...t){const r=[$s(e[0])];let n=0;for(;n<t.length;)r.push(ws),Cs(r,t[n]),r.push(ws,$s(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===ws){const r=Ns(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new bs(r)}function Cs(e,t){var r;t instanceof bs?e.push(...t._items):t instanceof vs?e.push(t):e.push("number"==typeof(r=t)||"boolean"==typeof r||null===r?r:$s(Array.isArray(r)?r.join(","):r))}function Ns(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof vs||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof vs?void 0:`"${e}${t.slice(1)}`}function $s(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ys.str=Es,ys.addCodeArg=Cs,ys.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:Es`${e}${t}`},ys.stringify=function(e){return new bs($s(e))},ys.safeStringify=$s,ys.getProperty=function(e){return"string"==typeof e&&ys.IDENTIFIER.test(e)?new bs("."+e):_s`[${e}]`};var xs,Ts={};Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.ValueScope=Ts.ValueScopeName=Ts.Scope=Ts.varKinds=Ts.UsedValueState=void 0;class Os extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"}(xs=Ts.UsedValueState||(Ts.UsedValueState={})),Ts.varKinds={const:new ys.Name("const"),let:new ys.Name("let"),var:new ys.Name("var")};class Ss{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof ys.Name?e:this.name(e)}name(e){return new ys.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}Ts.Scope=Ss;class ks extends ys.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:r}){this.value=e,this.scopePath=ys._`.${new ys.Name(t)}[${r}]`}}Ts.ValueScopeName=ks;const js=ys._`\n`;Ts.ValueScope=class extends Ss{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?js:ys.nil}}get(){return this._scope}name(e){return new ks(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:i}=n,s=null!==(r=t.key)&&void 0!==r?r:t.ref;let o=this._values[i];if(o){const e=o.get(s);if(e)return e}else o=this._values[i]=new Map;o.set(s,n);const a=this._scope[i]||(this._scope[i]=[]),u=a.length;return a[u]=t.ref,n.setValue(t,{property:i,itemIndex:u}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error(`CodeGen: name "${t}" has no value`);return ys._`${e}${t.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(e,t,r={},n){let i=ys.nil;for(const s in e){const o=e[s];if(!o)continue;const a=r[s]=r[s]||new Map;o.forEach(e=>{if(a.has(e))return;a.set(e,xs.Started);let r=t(e);if(r){const t=this.opts.es5?Ts.varKinds.var:Ts.varKinds.const;i=ys._`${i}${t} ${e} = ${r};${this.opts._n}`}else{if(!(r=null==n?void 0:n(e)))throw new Os(e);i=ys._`${i}${r}${this.opts._n}`}a.set(e,xs.Completed)})}return i}};var As={};Object.defineProperty(As,"__esModule",{value:!0}),As.or=As.and=As.not=As.CodeGen=As.operators=As.varKinds=As.ValueScopeName=As.ValueScope=As.Scope=As.Name=As.stringify=As.getProperty=As.nil=As.strConcat=As.str=As._=void 0,Object.defineProperty(As,"_",{enumerable:!0,get:function(){return ys._}}),Object.defineProperty(As,"str",{enumerable:!0,get:function(){return ys.str}}),Object.defineProperty(As,"strConcat",{enumerable:!0,get:function(){return ys.strConcat}}),Object.defineProperty(As,"nil",{enumerable:!0,get:function(){return ys.nil}}),Object.defineProperty(As,"getProperty",{enumerable:!0,get:function(){return ys.getProperty}}),Object.defineProperty(As,"stringify",{enumerable:!0,get:function(){return ys.stringify}}),Object.defineProperty(As,"Name",{enumerable:!0,get:function(){return ys.Name}}),Object.defineProperty(As,"Scope",{enumerable:!0,get:function(){return Ts.Scope}}),Object.defineProperty(As,"ValueScope",{enumerable:!0,get:function(){return Ts.ValueScope}}),Object.defineProperty(As,"ValueScopeName",{enumerable:!0,get:function(){return Ts.ValueScopeName}}),Object.defineProperty(As,"varKinds",{enumerable:!0,get:function(){return Ts.varKinds}}),As.operators={GT:new ys._Code(">"),GTE:new ys._Code(">="),LT:new ys._Code("<"),LTE:new ys._Code("<="),EQ:new ys._Code("==="),NEQ:new ys._Code("!=="),NOT:new ys._Code("!"),OR:new ys._Code("||"),AND:new ys._Code("&&"),ADD:new ys._Code("+")};class Rs{optimizeNodes(){return this}optimizeNames(e,t){return this}}class Is extends Rs{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const r=e?Ts.varKinds.var:this.varKind,n=void 0===this.rhs?"":" = "+this.rhs;return`${r} ${this.name}${n};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=no(this.rhs,e,t)),this}get names(){return this.rhs instanceof ys._CodeOrName?this.rhs.names:{}}}class Ps extends Rs{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof ys.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=no(this.rhs,e,t),this}get names(){return ro(this.lhs instanceof ys.Name?{}:{...this.lhs.names},this.rhs)}}class qs extends Ps{constructor(e,t,r,n){super(e,r,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class Ls extends Rs{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return this.label+":"+e}}class Ms extends Rs{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?" "+this.label:""};`+e}}class Ds extends Rs{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class Fs extends Rs{constructor(e){super(),this.code=e}render({_n:e}){return this.code+";"+e}optimizeNodes(){return""+this.code?this:void 0}optimizeNames(e,t){return this.code=no(this.code,e,t),this}get names(){return this.code instanceof ys._CodeOrName?this.code.names:{}}}class Us extends Rs{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const i=r[n];i.optimizeNames(e,t)||(io(e,i.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>to(e,t.names),{})}}class Bs extends Us{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class Vs extends Us{}class zs extends Bs{}zs.kind="else";class Hs extends Bs{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new zs(e):e}return t?!1===e?t instanceof Hs?t:t.nodes:this.nodes.length?this:new Hs(so(e),t instanceof Hs?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=no(this.condition,e,t),this}get names(){const e=super.names;return ro(e,this.condition),this.else&&to(e,this.else.names),e}}Hs.kind="if";class Qs extends Bs{}Qs.kind="for";class Ws extends Qs{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=no(this.iteration,e,t),this}get names(){return to(super.names,this.iteration.names)}}class Js extends Qs{constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?Ts.varKinds.var:this.varKind,{name:r,from:n,to:i}=this;return`for(${t} ${r}=${n}; ${r}<${i}; ${r}++)`+super.render(e)}get names(){const e=ro(super.names,this.from);return ro(e,this.to)}}class Ks extends Qs{constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=no(this.iterable,e,t),this}get names(){return to(super.names,this.iterable.names)}}class Gs extends Bs{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}Gs.kind="func";class Ys extends Us{render(e){return"return "+super.render(e)}}Ys.kind="return";class Zs extends Bs{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&to(e,this.catch.names),this.finally&&to(e,this.finally.names),e}}class Xs extends Bs{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}Xs.kind="catch";class eo extends Bs{render(e){return"finally"+super.render(e)}}function to(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function ro(e,t){return t instanceof ys._CodeOrName?to(e,t.names):e}function no(e,t,r){return e instanceof ys.Name?i(e):(n=e)instanceof ys._Code&&n._items.some(e=>e instanceof ys.Name&&1===t[e.str]&&void 0!==r[e.str])?new ys._Code(e._items.reduce((e,t)=>(t instanceof ys.Name&&(t=i(t)),t instanceof ys._Code?e.push(...t._items):e.push(t),e),[])):e;var n;function i(e){const n=r[e.str];return void 0===n||1!==t[e.str]?e:(delete t[e.str],n)}}function io(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function so(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:ys._`!${lo(e)}`}eo.kind="finally",As.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new Ts.Scope({parent:e}),this._nodes=[new Vs]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const i=this._scope.toName(t);return void 0!==r&&n&&(this._constants[i.str]=r),this._leafNode(new Is(e,i,r)),i}const(e,t,r){return this._def(Ts.varKinds.const,e,t,r)}let(e,t,r){return this._def(Ts.varKinds.let,e,t,r)}var(e,t,r){return this._def(Ts.varKinds.var,e,t,r)}assign(e,t,r){return this._leafNode(new Ps(e,t,r))}add(e,t){return this._leafNode(new qs(e,As.operators.ADD,t))}code(e){return"function"==typeof e?e():e!==ys.nil&&this._leafNode(new Fs(e)),this}object(...e){const t=["{"];for(const[r,n]of e)t.length>1&&t.push(","),t.push(r),(r!==n||this.opts.es5)&&(t.push(":"),ys.addCodeArg(t,n));return t.push("}"),new ys._Code(t)}if(e,t,r){if(this._blockNode(new Hs(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Hs(e))}else(){return this._elseNode(new zs)}endIf(){return this._endBlockNode(Hs,zs)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new Ws(e),t)}forRange(e,t,r,n,i=(this.opts.es5?Ts.varKinds.var:Ts.varKinds.let)){const s=this._scope.toName(e);return this._for(new Js(i,s,t,r),()=>n(s))}forOf(e,t,r,n=Ts.varKinds.const){const i=this._scope.toName(e);if(this.opts.es5){const e=t instanceof ys.Name?t:this.var("_arr",t);return this.forRange("_i",0,ys._`${e}.length`,t=>{this.var(i,ys._`${e}[${t}]`),r(i)})}return this._for(new Ks("of",n,i,t),()=>r(i))}forIn(e,t,r,n=(this.opts.es5?Ts.varKinds.var:Ts.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,ys._`Object.keys(${t})`,r);const i=this._scope.toName(e);return this._for(new Ks("in",n,i,t),()=>r(i))}endFor(){return this._endBlockNode(Qs)}label(e){return this._leafNode(new Ls(e))}break(e){return this._leafNode(new Ms(e))}return(e){const t=new Ys;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Ys)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new Zs;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new Xs(e),t(e)}return r&&(this._currNode=n.finally=new eo,this.code(r)),this._endBlockNode(Xs,eo)}throw(e){return this._leafNode(new Ds(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=ys.nil,r,n){return this._blockNode(new Gs(e,t,r)),n&&this.code(n).endFunc(),this}endFunc(){return this._endBlockNode(Gs)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof Hs))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},As.not=so;const oo=uo(As.operators.AND);As.and=function(...e){return e.reduce(oo)};const ao=uo(As.operators.OR);function uo(e){return(t,r)=>t===ys.nil?r:r===ys.nil?t:ys._`${lo(t)} ${e} ${lo(r)}`}function lo(e){return e instanceof ys.Name?e:ys._`(${e})`}As.or=function(...e){return e.reduce(ao)};var co={};Object.defineProperty(co,"__esModule",{value:!0});const ho={data:new As.Name("data"),valCxt:new As.Name("valCxt"),dataPath:new As.Name("dataPath"),parentData:new As.Name("parentData"),parentDataProperty:new As.Name("parentDataProperty"),rootData:new As.Name("rootData"),dynamicAnchors:new As.Name("dynamicAnchors"),vErrors:new As.Name("vErrors"),errors:new As.Name("errors"),this:new As.Name("this"),self:new As.Name("self"),scope:new As.Name("scope"),json:new As.Name("json"),jsonPos:new As.Name("jsonPos"),jsonLen:new As.Name("jsonLen"),jsonPart:new As.Name("jsonPart")};co.default=ho;var fo={};function po(e,t){const r=e.const("err",t);e.if(As._`${co.default.vErrors} === null`,()=>e.assign(co.default.vErrors,As._`[${r}]`),As._`${co.default.vErrors}.push(${r})`),e.code(As._`${co.default.errors}++`)}function mo(e,t){const{gen:r,validateName:n,schemaEnv:i}=e;i.$async?r.throw(As._`new ${e.ValidationError}(${t})`):(r.assign(As._`${n}.errors`,t),r.return(!1))}Object.defineProperty(fo,"__esModule",{value:!0}),fo.extendErrors=fo.resetErrorsCount=fo.reportExtraError=fo.reportError=fo.keyword$DataError=fo.keywordError=void 0,fo.keywordError={message:({keyword:e})=>As.str`should pass "${e}" keyword validation`},fo.keyword$DataError={message:({keyword:e,schemaType:t})=>t?As.str`"${e}" keyword must be ${t} ($data)`:As.str`"${e}" keyword is invalid ($data)`},fo.reportError=function(e,t=fo.keywordError,r){const{it:n}=e,{gen:i,compositeRule:s,allErrors:o}=n,a=go(e,t);(null!=r?r:s||o)?po(i,a):mo(n,As._`[${a}]`)},fo.reportExtraError=function(e,t=fo.keywordError){const{it:r}=e,{gen:n,compositeRule:i,allErrors:s}=r;po(n,go(e,t)),i||s||mo(r,co.default.vErrors)},fo.resetErrorsCount=function(e,t){e.assign(co.default.errors,t),e.if(As._`${co.default.vErrors} !== null`,()=>e.if(t,()=>e.assign(As._`${co.default.vErrors}.length`,t),()=>e.assign(co.default.vErrors,null)))},fo.extendErrors=function({gen:e,keyword:t,schemaValue:r,data:n,errsCount:i,it:s}){if(void 0===i)throw new Error("ajv implementation error");const o=e.name("err");e.forRange("i",i,co.default.errors,i=>{e.const(o,As._`${co.default.vErrors}[${i}]`),e.if(As._`${o}.dataPath === undefined`,()=>e.assign(As._`${o}.dataPath`,As.strConcat(co.default.dataPath,s.errorPath))),e.assign(As._`${o}.schemaPath`,As.str`${s.errSchemaPath}/${t}`),s.opts.verbose&&(e.assign(As._`${o}.schema`,r),e.assign(As._`${o}.data`,n))})};const yo={keyword:new As.Name("keyword"),schemaPath:new As.Name("schemaPath"),params:new As.Name("params"),propertyName:new As.Name("propertyName"),message:new As.Name("message"),schema:new As.Name("schema"),parentSchema:new As.Name("parentSchema"),instancePath:new As.Name("instancePath")};function go(e,t){const{createErrors:r,opts:n}=e.it;return!1===r?As._`{}`:(n.jtd&&!n.ajvErrors?function(e,{message:t}){const{gen:r,keyword:n,it:i}=e,{errorPath:s,errSchemaPath:o,opts:a}=i,u=[[yo.instancePath,As.strConcat(co.default.dataPath,s)],[yo.schemaPath,As.str`${o}/${n}`]];return a.messages&&u.push([yo.message,"function"==typeof t?t(e):t]),r.object(...u)}:function(e,t){const{gen:r,keyword:n,data:i,schemaValue:s,it:o}=e,{topSchemaRef:a,schemaPath:u,errorPath:l,errSchemaPath:c,propertyName:h,opts:d}=o,{params:f,message:p}=t,m=[[yo.keyword,n],[co.default.dataPath,As.strConcat(co.default.dataPath,l)],[yo.schemaPath,As.str`${c}/${n}`],[yo.params,"function"==typeof f?f(e):f||As._`{}`]];return h&&m.push([yo.propertyName,h]),d.messages&&m.push([yo.message,"function"==typeof p?p(e):p]),d.verbose&&m.push([yo.schema,s],[yo.parentSchema,As._`${a}${u}`],[co.default.data,i]),r.object(...m)})(e,t)}var vo={};Object.defineProperty(vo,"__esModule",{value:!0}),vo.boolOrEmptySchema=vo.topBoolOrEmptySchema=void 0;const bo={message:"boolean schema is false"};function _o(e,t){const{gen:r,data:n}=e,i={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};fo.reportError(i,bo,t)}vo.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?_o(e,!1):"object"==typeof r&&!0===r.$async?t.return(co.default.data):(t.assign(As._`${n}.errors`,null),t.return(!0))},vo.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),_o(e)):r.var(t,!0)};var wo=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;0!=i--;){var o=s[i];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r},Eo={},Co=Eo=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,n,i,s,o,a,u,l,c){if(i&&"object"==typeof i&&!Array.isArray(i)){for(var h in r(i,s,o,a,u,l,c),i){var d=i[h];if(Array.isArray(d)){if(h in Co.arrayKeywords)for(var f=0;f<d.length;f++)e(t,r,n,d[f],s+"/"+h+"/"+f,o,s,h,i,f)}else if(h in Co.propsKeywords){if(d&&"object"==typeof d)for(var p in d)e(t,r,n,d[p],s+"/"+h+"/"+p.replace(/~/g,"~0").replace(/\//g,"~1"),o,s,h,i,p)}else(h in Co.keywords||t.allKeys&&!(h in Co.skipKeywords))&&e(t,r,n,d,s+"/"+h,o,s,h,i)}n(i,s,o,a,u,l,c)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};Co.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},Co.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},Co.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},Co.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};var No,$o={exports:{}};No=function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function s(e){var n=t("[0-9]","[A-Fa-f]"),i=r(r("%[EFef]"+n+"%"+n+n+"%"+n+n)+"|"+r("%[89A-Fa-f]"+n+"%"+n+n)+"|"+r("%"+n+n)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",s),a=e?"[\\uE000-\\uF8FF]":"[]",u=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),l=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),c=r(r(i+"|"+t(u,s,"[\\:]"))+"*"),h=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),d=r(h+"\\."+h+"\\."+h+"\\."+h),f=r(n+"{1,4}"),p=r(r(f+"\\:"+f)+"|"+d),m=r(r(f+"\\:")+"{6}"+p),y=r("\\:\\:"+r(f+"\\:")+"{5}"+p),g=r(r(f)+"?\\:\\:"+r(f+"\\:")+"{4}"+p),v=r(r(r(f+"\\:")+"{0,1}"+f)+"?\\:\\:"+r(f+"\\:")+"{3}"+p),b=r(r(r(f+"\\:")+"{0,2}"+f)+"?\\:\\:"+r(f+"\\:")+"{2}"+p),_=r(r(r(f+"\\:")+"{0,3}"+f)+"?\\:\\:"+f+"\\:"+p),w=r(r(r(f+"\\:")+"{0,4}"+f)+"?\\:\\:"+p),E=r(r(r(f+"\\:")+"{0,5}"+f)+"?\\:\\:"+f),C=r(r(r(f+"\\:")+"{0,6}"+f)+"?\\:\\:"),N=r([m,y,g,v,b,_,w,E,C].join("|")),$=r(r(u+"|"+i)+"+"),x=(r(N+"\\%25"+$),r(N+r("\\%25|\\%(?!"+n+"{2})")+$)),T=r("[vV]"+n+"+\\."+t(u,s,"[\\:]")+"+"),O=r("\\["+r(x+"|"+N+"|"+T)+"\\]"),S=r(r(i+"|"+t(u,s))+"*"),k=r(O+"|"+d+"(?!"+S+")|"+S),j=r("[0-9]*"),A=r(r(c+"@")+"?"+k+r("\\:"+j)+"?"),R=r(i+"|"+t(u,s,"[\\:\\@]")),I=r(R+"*"),P=r(R+"+"),q=r(r(i+"|"+t(u,s,"[\\@]"))+"+"),L=r(r("\\/"+I)+"*"),M=r("\\/"+r(P+L)+"?"),D=r(q+L),F=r(P+L),U="(?!"+R+")",B=(r(L+"|"+M+"|"+D+"|"+F+"|"+U),r(r(R+"|"+t("[\\/\\?]",a))+"*")),V=r(r(R+"|[\\/\\?]")+"*"),z=r(r("\\/\\/"+A+L)+"|"+M+"|"+F+"|"+U),H=r(l+"\\:"+z+r("\\?"+B)+"?"+r("\\#"+V)+"?"),Q=r(r("\\/\\/"+A+L)+"|"+M+"|"+D+"|"+U),W=r(Q+r("\\?"+B)+"?"+r("\\#"+V)+"?");return r(H+"|"+W),r(l+"\\:"+z+r("\\?"+B)+"?"),r(r("\\/\\/("+r("("+c+")@")+"?("+k+")"+r("\\:("+j+")")+"?)")+"?("+L+"|"+M+"|"+F+"|"+U+")"),r("\\?("+B+")"),r("\\#("+V+")"),r(r("\\/\\/("+r("("+c+")@")+"?("+k+")"+r("\\:("+j+")")+"?)")+"?("+L+"|"+M+"|"+D+"|"+U+")"),r("\\?("+B+")"),r("\\#("+V+")"),r(r("\\/\\/("+r("("+c+")@")+"?("+k+")"+r("\\:("+j+")")+"?)")+"?("+L+"|"+M+"|"+F+"|"+U+")"),r("\\?("+B+")"),r("\\#("+V+")"),r("("+c+")@"),r("\\:("+j+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]",a),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,s),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,o),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+d+")$"),IPV6ADDRESS:new RegExp("^\\[?("+N+")"+r(r("\\%25|\\%(?!"+n+"{2})")+"("+$+")")+"?\\]?$")}}var o=s(!1),a=s(!0),u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(u){i=!0,s=u}finally{try{!n&&a.return&&a.return()}finally{if(i)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=2147483647,c=/^xn--/,h=/[^\0-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function y(e){throw new RangeError(f[e])}function g(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}((e=e.replace(d,".")).split("."),t).join(".");return n+i}function v(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var s=e.charCodeAt(r++);56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),r--)}else t.push(i)}return t}var b=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},_=function(e,t,r){var n=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;n+=36)e=p(e/35);return p(n+36*e/(e+38))},w=function(e){var t,r=[],n=e.length,i=0,s=128,o=72,a=e.lastIndexOf("-");a<0&&(a=0);for(var u=0;u<a;++u)e.charCodeAt(u)>=128&&y("not-basic"),r.push(e.charCodeAt(u));for(var c=a>0?a+1:0;c<n;){for(var h=i,d=1,f=36;;f+=36){c>=n&&y("invalid-input");var m=(t=e.charCodeAt(c++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>p((l-i)/d))&&y("overflow"),i+=m*d;var g=f<=o?1:f>=o+26?26:f-o;if(m<g)break;var v=36-g;d>p(l/v)&&y("overflow"),d*=v}var b=r.length+1;o=_(i-h,b,0==h),p(i/b)>l-s&&y("overflow"),s+=p(i/b),i%=b,r.splice(i++,0,s)}return String.fromCodePoint.apply(String,r)},E=function(e){var t=[],r=(e=v(e)).length,n=128,i=0,s=72,o=!0,a=!1,u=void 0;try{for(var c,h=e[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var d=c.value;d<128&&t.push(m(d))}}catch(F){a=!0,u=F}finally{try{!o&&h.return&&h.return()}finally{if(a)throw u}}var f=t.length,g=f;for(f&&t.push("-");g<r;){var w=l,E=!0,C=!1,N=void 0;try{for(var $,x=e[Symbol.iterator]();!(E=($=x.next()).done);E=!0){var T=$.value;T>=n&&T<w&&(w=T)}}catch(F){C=!0,N=F}finally{try{!E&&x.return&&x.return()}finally{if(C)throw N}}var O=g+1;w-n>p((l-i)/O)&&y("overflow"),i+=(w-n)*O,n=w;var S=!0,k=!1,j=void 0;try{for(var A,R=e[Symbol.iterator]();!(S=(A=R.next()).done);S=!0){var I=A.value;if(I<n&&++i>l&&y("overflow"),I==n){for(var P=i,q=36;;q+=36){var L=q<=s?1:q>=s+26?26:q-s;if(P<L)break;var M=P-L,D=36-L;t.push(m(b(L+M%D,0))),P=p(M/D)}t.push(m(b(P,0))),s=_(i,O,g==f),i=0,++g}}}catch(F){k=!0,j=F}finally{try{!S&&R.return&&R.return()}finally{if(k)throw j}}++i,++n}return t.join("")},C=function(e){return g(e,(function(e){return h.test(e)?"xn--"+E(e):e}))},N=function(e){return g(e,(function(e){return c.test(e)?w(e.slice(4).toLowerCase()):e}))},$={};function x(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function T(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var s=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&s)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var o=parseInt(e.substr(r+4,2),16),a=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function O(e,t){function r(e){var r=T(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,x).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,x).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,x).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,x).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,x).replace(t.PCT_ENCODED,i)),e}function S(e){return e.replace(/^0*(.*)/,"$1")||"0"}function k(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=u(r,2)[1];return n?n.split(".").map(S).join("."):e}function j(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=u(r,3),i=n[1],s=n[2];if(i){for(var o=i.toLowerCase().split("::").reverse(),a=u(o,2),l=a[0],c=a[1],h=c?c.split(":").map(S):[],d=l.split(":").map(S),f=t.IPV4ADDRESS.test(d[d.length-1]),p=f?7:8,m=d.length-p,y=Array(p),g=0;g<p;++g)y[g]=h[g]||d[m+g]||"";f&&(y[p-1]=k(y[p-1],t));var v=y.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(v&&v.length>1){var _=y.slice(0,v.index),w=y.slice(v.index+v.length);b=_.join(":")+"::"+w.join(":")}else b=y.join(":");return s&&(b+="%"+s),b}return e}var A=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,R=void 0==="".match(/(){0}/)[1];function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?a:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(A);if(i){R?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=j(k(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var s=$[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||s&&s.unicodeSupport)O(r,n);else{if(r.host&&(t.domainHost||s&&s.domainHost))try{r.host=C(r.host.replace(n.PCT_ENCODED,T).toLowerCase())}catch(Zv){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+Zv}O(r,o)}s&&s.parse&&s.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}var P=/^\.\.?\//,q=/^\/\.(\/|$)/,L=/^\/\.\.(\/|$)/,M=/^\/?(?:.|\n)*?(?=\/|$)/;function D(e){for(var t=[];e.length;)if(e.match(P))e=e.replace(P,"");else if(e.match(q))e=e.replace(q,"/");else if(e.match(L))e=e.replace(L,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(M);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?a:o,n=[],i=$[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?N(e.host):C(e.host.replace(r.PCT_ENCODED,T).toLowerCase())}catch(Zv){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+Zv}O(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var s=function(e,t){var r=!1!==t.iri?a:o,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(j(k(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}(e,t);if(void 0!==s&&("suffix"!==t.reference&&n.push("//"),n.push(s),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var u=e.path;t.absolutePath||i&&i.absolutePath||(u=D(u)),void 0===s&&(u=u.replace(/^\/\//,"/%2F")),n.push(u)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function U(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(e=I(F(e,r),r),t=I(F(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(n.scheme=t.scheme,n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=D(t.path||""),n.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=D(t.path||""),n.query=t.query):(t.path?("/"===t.path.charAt(0)?n.path=D(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?n.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:n.path=t.path:n.path="/"+t.path,n.path=D(n.path)),n.query=t.query):(n.path=e.path,void 0!==t.query?n.query=t.query:n.query=e.query),n.userinfo=e.userinfo,n.host=e.host,n.port=e.port),n.scheme=e.scheme),n.fragment=t.fragment,n}function B(e,t){return e&&e.toString().replace(t&&t.iri?a.PCT_ENCODED:o.PCT_ENCODED,T)}var V={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},z={scheme:"https",domainHost:V.domainHost,parse:V.parse,serialize:V.serialize};function H(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var Q={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=H(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(H(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=u(r,2),i=n[0],s=n[1];e.path=i&&"/"!==i?i:void 0,e.query=s,e.resourceName=void 0}return e.fragment=void 0,e}},W={scheme:"wss",domainHost:Q.domainHost,parse:Q.parse,serialize:Q.serialize},J={},K="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",G="[0-9A-Fa-f]",Y=r(r("%[EFef][0-9A-Fa-f]%"+G+G+"%"+G+G)+"|"+r("%[89A-Fa-f][0-9A-Fa-f]%"+G+G)+"|"+r("%"+G+G)),Z=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),X=new RegExp(K,"g"),ee=new RegExp(Y,"g"),te=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Z),"g"),re=new RegExp(t("[^]",K,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),ne=re;function ie(e){var t=T(e);return t.match(X)?t:e}var se={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,s={},o=r.query.split("&"),a=0,u=o.length;a<u;++a){var l=o[a].split("=");switch(l[0]){case"to":for(var c=l[1].split(","),h=0,d=c.length;h<d;++h)n.push(c[h]);break;case"subject":r.subject=B(l[1],t);break;case"body":r.body=B(l[1],t);break;default:i=!0,s[B(l[0],t)]=B(l[1],t)}}i&&(r.headers=s)}r.query=void 0;for(var f=0,p=n.length;f<p;++f){var m=n[f].split("@");if(m[0]=B(m[0]),t.unicodeSupport)m[1]=B(m[1],t).toLowerCase();else try{m[1]=C(B(m[1],t).toLowerCase())}catch(Zv){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+Zv}n[f]=m.join("@")}return r},serialize:function(e,t){var r,n=e,s=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(s){for(var o=0,a=s.length;o<a;++o){var u=String(s[o]),l=u.lastIndexOf("@"),c=u.slice(0,l).replace(ee,ie).replace(ee,i).replace(te,x),h=u.slice(l+1);try{h=t.iri?N(h):C(B(h,t).toLowerCase())}catch(Zv){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+Zv}s[o]=c+"@"+h}n.path=s.join(",")}var d=e.headers=e.headers||{};e.subject&&(d.subject=e.subject),e.body&&(d.body=e.body);var f=[];for(var p in d)d[p]!==J[p]&&f.push(p.replace(ee,ie).replace(ee,i).replace(re,x)+"="+d[p].replace(ee,ie).replace(ee,i).replace(ne,x));return f.length&&(n.query=f.join("&")),n}},oe=/^([^\:]+)\:(.*)/,ae={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(oe),n=e;if(r){var i=t.scheme||n.scheme||"urn",s=r[1].toLowerCase(),o=r[2],a=i+":"+(t.nid||s),u=$[a];n.nid=s,n.nss=o,n.path=void 0,u&&(n=u.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),s=$[i];s&&(e=s.serialize(e,t));var o=e,a=e.nss;return o.path=(n||t.nid)+":"+a,o}},ue=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,le={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ue)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};$[V.scheme]=V,$[z.scheme]=z,$[Q.scheme]=Q,$[W.scheme]=W,$[se.scheme]=se,$[ae.scheme]=ae,$[le.scheme]=le,e.SCHEMES=$,e.pctEncChar=x,e.pctDecChars=T,e.parse=I,e.removeDotSegments=D,e.serialize=F,e.resolveComponents=U,e.resolve=function(e,t,r){var n=function(e,t){var r={scheme:"null"};if(t)for(var n in t)r[n]=t[n];return r}(0,r);return F(U(I(e,n),I(t,n),n,!0),n)},e.normalize=function(e,t){return"string"==typeof e?e=F(I(e,t),t):"object"===n(e)&&(e=I(F(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=F(I(e,r),r):"object"===n(e)&&(e=F(e,r)),"string"==typeof t?t=F(I(t,r),r):"object"===n(t)&&(t=F(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?a.ESCAPE:o.ESCAPE,x)},e.unescapeComponent=B,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof $o.exports?No($o.exports):"function"==typeof define&&define.amd?define(["exports"],No):No(this.URI=this.URI||{}),$o=$o.exports;var xo={};Object.defineProperty(xo,"__esModule",{value:!0}),xo.MissingRefError=xo.ValidationError=void 0;const To=v({});class Oo extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}xo.ValidationError=Oo;class So extends Error{constructor(e,t,r){super(r||`can't resolve reference ${t} from id ${e}`),this.missingRef=To.resolveUrl(e,t),this.missingSchema=To.normalizeId(To.getFullPath(this.missingRef))}}xo.MissingRefError=So,xo={ValidationError:Oo,MissingRefError:So};var ko={};Object.defineProperty(ko,"__esModule",{value:!0}),ko.resolveSchema=ko.getCompilingSchema=ko.resolveRef=ko.compileSchema=ko.SchemaEnv=void 0;const jo=v({}),Ao=y({}),Ro=g({});class Io{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:jo.normalizeId(null==r?void 0:r.$id),this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function Po(e){const t=qo.call(this,e);if(t)return t;const r=jo.getFullPath(e.root.baseId),{es5:n,lines:i}=this.opts.code,{ownProperties:s}=this.opts,o=new As.CodeGen(this.scope,{es5:n,lines:i,ownProperties:s});let a;e.$async&&(a=o.scopeValue("Error",{ref:xo.ValidationError,code:As._`require("ajv/dist/compile/error_classes").ValidationError`}));const u=o.scopeName("validate");e.validateName=u;const l={gen:o,allErrors:this.opts.allErrors,data:co.default.data,parentData:co.default.parentData,parentDataProperty:co.default.parentDataProperty,dataNames:[co.default.data],dataPathArr:[As.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:As.stringify(e.schema)}:{ref:e.schema}),validateName:u,ValidationError:a,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:As.nil,errSchemaPath:this.opts.jtd?"":"#",errorPath:As._`""`,opts:this.opts,self:this};let c;try{this._compilations.add(e),Ro.validateFunctionCode(l),o.optimize(this.opts.code.optimize);const t=o.toString();c=`${o.scopeRefs(co.default.scope)}return ${t}`,this.opts.code.process&&(c=this.opts.code.process(c,e));const r=new Function(""+co.default.self,""+co.default.scope,c)(this,this.scope.get());if(this.scope.value(u,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:u,validateCode:t,scopeValues:o._values}),this.opts.unevaluated){const{props:e,items:t}=l;r.evaluated={props:e instanceof As.Name?void 0:e,items:t instanceof As.Name?void 0:t,dynamicProps:e instanceof As.Name,dynamicItems:t instanceof As.Name},r.source&&(r.source.evaluated=As.stringify(r.evaluated))}return e.validate=r,e}catch(Zv){throw delete e.validate,delete e.validateName,c&&this.logger.error("Error compiling schema, function code:",c),Zv}finally{this._compilations.delete(e)}}function qo(e){for(const n of this._compilations)if(r=e,(t=n).schema===r.schema&&t.root===r.root&&t.baseId===r.baseId)return n;var t,r}function Lo(e,t){const r=$o.parse(t),n=jo._getFullPath(r);let i=jo.getFullPath(e.baseId);if(Object.keys(e.schema).length>0&&n===i)return Do.call(this,r,e);const s=jo.normalizeId(n),o=this.refs[s]||this.schemas[s];if("string"==typeof o){const t=Lo.call(this,e,o);if("object"!=typeof(null==t?void 0:t.schema))return;return Do.call(this,r,t)}if("object"==typeof(null==o?void 0:o.schema)){if(o.validate||Po.call(this,o),s===jo.normalizeId(t)){const{schema:t}=o;return t.$id&&(i=jo.resolveUrl(i,t.$id)),new Io({schema:t,root:e,baseId:i})}return Do.call(this,r,o)}}ko.SchemaEnv=Io,ko.compileSchema=Po,ko.resolveRef=function(e,t,r){var n;r=jo.resolveUrl(t,r);const i=e.refs[r];if(i)return i;let s=function(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||Lo.call(this,e,t)}.call(this,e,r);if(void 0===s){const i=null===(n=e.localRefs)||void 0===n?void 0:n[r];i&&(s=new Io({schema:i,root:e,baseId:t}))}return void 0!==s?e.refs[r]=function(e){return jo.inlineRef(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Po.call(this,e)}.call(this,s):void 0},ko.getCompilingSchema=qo,ko.resolveSchema=Lo;const Mo=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Do(e,{baseId:t,schema:r,root:n}){var i;if("/"!==(null===(i=e.fragment)||void 0===i?void 0:i[0]))return;for(const o of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;if(void 0===(r=r[Ao.unescapeFragment(o)]))return;!Mo.has(o)&&"object"==typeof r&&r.$id&&(t=jo.resolveUrl(t,r.$id))}let s;if("boolean"!=typeof r&&r.$ref&&!Ao.schemaHasRulesButRef(r,this.RULES)){const e=jo.resolveUrl(t,r.$ref);s=Lo.call(this,n,e)}return(s=s||new Io({schema:r,root:n,baseId:t})).schema!==s.root.schema?s:void 0}var Fo={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1},Uo={};Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.CodeGen=Uo.Name=Uo.nil=Uo.stringify=Uo.str=Uo._=Uo.KeywordCxt=void 0;const Bo=p({});Uo.KeywordCxt=Bo.default,Object.defineProperty(Uo,"_",{enumerable:!0,get:function(){return As._}}),Object.defineProperty(Uo,"str",{enumerable:!0,get:function(){return As.str}}),Object.defineProperty(Uo,"stringify",{enumerable:!0,get:function(){return As.stringify}}),Object.defineProperty(Uo,"nil",{enumerable:!0,get:function(){return As.nil}}),Object.defineProperty(Uo,"Name",{enumerable:!0,get:function(){return As.Name}}),Object.defineProperty(Uo,"CodeGen",{enumerable:!0,get:function(){return As.CodeGen}});const Vo=v({}),zo=m({}),Ho=y({}),Qo=["removeAdditional","useDefaults","coerceTypes"],Wo=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Jo={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",schemaId:"JSON Schema draft-04 is not supported in Ajv v7.",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",strictNumbers:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key."},Ko={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function Go(e){var t,r,n,i,s,o,a,u,l,c,h,d;const f=null===(t=e.strict)||void 0===t||t,p=!!f&&"log",m=null===(r=e.code)||void 0===r?void 0:r.optimize,y=!0===m||void 0===m?1:m||0;return{strict:f,strictTypes:null!==(n=e.strictTypes)&&void 0!==n?n:p,strictTuples:null!==(i=e.strictTuples)&&void 0!==i?i:p,code:e.code?{...e.code,optimize:y}:{optimize:y},loopRequired:null!==(s=e.loopRequired)&&void 0!==s?s:1/0,loopEnum:null!==(o=e.loopEnum)&&void 0!==o?o:1/0,meta:null===(a=e.meta)||void 0===a||a,messages:null===(u=e.messages)||void 0===u||u,inlineRefs:null===(l=e.inlineRefs)||void 0===l||l,addUsedSchema:null===(c=e.addUsedSchema)||void 0===c||c,validateSchema:null===(h=e.validateSchema)||void 0===h||h,validateFormats:null===(d=e.validateFormats)||void 0===d||d}}class Yo{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...Go(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new As.ValueScope({scope:{},prefixes:Wo,es5:t,lines:r}),this.logger=function(e){if(!1===e)return ea;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=hs.getRules(),Zo.call(this,Jo,e,"NOT SUPPORTED"),Zo.call(this,Ko,e,"DEPRECATED","warn"),this._metaOpts=function(){const e={...this.opts};for(const t of Qo)delete e[t];return e}.call(this),e.formats&&function(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&function(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),function(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t}=this.opts;t&&e&&this.addMetaSchema(Fo,Fo.$id,!1)}defaultMeta(){const{meta:e}=this.opts;return this.opts.defaultMeta="object"==typeof e?e.$id||e:void 0}validate(e,t){let r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,n){await i.call(this,e.$schema);const s=this._addSchema(e,n);return s.validate||async function e(n){try{return this._compileSchemaEnv(n)}catch(Zv){if(!(Zv instanceof xo.MissingRefError))throw Zv;return function({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}.call(this,Zv),await async function(e){const n=await async function(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}.call(this,e);this.refs[e]||await i.call(this,n.$schema),this.refs[e]||this.addSchema(n,e,t)}.call(this,Zv.missingSchema),e.call(this,n)}}.call(this,s)}async function i(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let i;if("object"==typeof e&&void 0!==(i=e.$id)&&"string"!=typeof i)throw new Error("schema id must be string");return t=Vo.normalizeId(t||i),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(void 0!==(r=e.$schema)&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this.opts.defaultMeta||this.defaultMeta()))return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=Xo.call(this,e));)e=t;if(void 0===t){const r=new ko.SchemaEnv({schema:{}});if(!(t=ko.resolveSchema.call(this,r,e)))return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=Xo.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e.$id;return r&&(r=Vo.normalizeId(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(function(e,t){const{RULES:r}=this;if(Ho.eachItem(e,e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!ta.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}.call(this,r,t),!t)return Ho.eachItem(r,e=>ra.call(this,e)),this;(function(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=ia(t)),e.validateSchema=this.compile(t,!0))}).call(this,t);const n={...t,type:zo.getJSONTypes(t.type),schemaType:zo.getJSONTypes(t.schemaType)};return Ho.eachItem(r,0===n.type.length?e=>ra.call(this,e,n):e=>n.type.forEach(t=>ra.call(this,e,n,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.dataPath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let i=e;for(const e of t)i=i[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,s=i[e];n&&s&&(i[e]=ia(s))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];t&&!t.test(r)||("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r=this.opts.validateSchema,n=this.opts.addUsedSchema){if("object"!=typeof e){if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let i=this._cache.get(e);if(void 0!==i)return i;const s=Vo.getSchemaRefs.call(this,e);i=new ko.SchemaEnv({schema:e,meta:t,localRefs:s}),this._cache.set(i.schema,i);const o=i.baseId;return n&&!o.startsWith("#")&&(o&&this._checkUnique(o),this.refs[o]=i),r&&this.validateSchema(e,!0),i}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):ko.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{ko.compileSchema.call(this,e)}finally{this.opts=t}}}function Zo(e,t,r,n="error"){for(const i in e){const s=i;s in t&&this.logger[n](`${r}: option ${i}. ${e[s]}`)}}function Xo(e){return e=Vo.normalizeId(e),this.schemas[e]||this.refs[e]}Uo.default=Yo,Yo.ValidationError=xo.ValidationError,Yo.MissingRefError=xo.MissingRefError;const ea={log(){},warn(){},error(){}},ta=/^[a-z_$][a-z0-9_$:-]*$/i;function ra(e,t,r){var n;const i=null==t?void 0:t.post;if(r&&i)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:s}=this;let o=i?s.post:s.rules.find(({type:e})=>e===r);if(o||(o={type:r,rules:[]},s.rules.push(o)),s.keywords[e]=!0,!t)return;const a={keyword:e,definition:{...t,type:zo.getJSONTypes(t.type),schemaType:zo.getJSONTypes(t.schemaType)}};t.before?function(e,t,r){const n=e.rules.findIndex(e=>e.keyword===r);n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}.call(this,o,a,t.before):o.rules.push(a),s.all[e]=a,null===(n=t.implements)||void 0===n||n.forEach(e=>this.addKeyword(e))}const na={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ia(e){return{anyOf:[e,na]}}var sa={};Object.defineProperty(sa,"__esModule",{value:!0});const oa={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};sa.default=oa;var aa={};Object.defineProperty(aa,"__esModule",{value:!0}),aa.callRef=aa.getValidate=void 0;const ua=w({}),la=y({}),ca={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:i,schemaEnv:s,validateName:o,opts:a,self:u}=n;if("#"===r||"#/"===r)return function(){if(s===s.root)return da(e,o,s,s.$async);const r=t.scopeValue("root",{ref:s.root});return da(e,As._`${r}.validate`,s.root,s.root.$async)}();const l=ko.resolveRef.call(u,s.root,i,r);if(void 0===l)throw new xo.MissingRefError(i,r);return l instanceof ko.SchemaEnv?function(t){const r=ha(e,t);da(e,r,t,t.$async)}(l):function(n){const i=t.scopeValue("schema",!0===a.code.source?{ref:n,code:As.stringify(n)}:{ref:n}),s=t.name("valid"),o=e.subschema({schema:n,dataTypes:[],schemaPath:As.nil,topSchemaRef:i,errSchemaPath:r},s);e.mergeEvaluated(o),e.ok(s)}(l)}};function ha(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):As._`${r.scopeValue("wrapper",{ref:t})}.validate`}function da(e,t,r,n){const{gen:i,it:s}=e,{allErrors:o,schemaEnv:a,opts:u}=s,l=u.passContext?co.default.this:As.nil;function c(e){const t=As._`${e}.errors`;i.assign(co.default.vErrors,As._`${co.default.vErrors} === null ? ${t} : ${co.default.vErrors}.concat(${t})`),i.assign(co.default.errors,As._`${co.default.vErrors}.length`)}function h(e){var t;if(!s.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==s.props)if(n&&!n.dynamicProps)void 0!==n.props&&(s.props=la.mergeEvaluated.props(i,n.props,s.props));else{const t=i.var("props",As._`${e}.evaluated.props`);s.props=la.mergeEvaluated.props(i,t,s.props,As.Name)}if(!0!==s.items)if(n&&!n.dynamicItems)void 0!==n.items&&(s.items=la.mergeEvaluated.items(i,n.items,s.items));else{const t=i.var("items",As._`${e}.evaluated.items`);s.items=la.mergeEvaluated.items(i,t,s.items,As.Name)}}n?function(){if(!a.$async)throw new Error("async schema referenced by sync schema");const r=i.let("valid");i.try(()=>{i.code(As._`await ${ua.callValidateCode(e,t,l)}`),h(t),o||i.assign(r,!0)},e=>{i.if(As._`!(${e} instanceof ${s.ValidationError})`,()=>i.throw(e)),c(e),o||i.assign(r,!1)}),e.ok(r)}():e.result(ua.callValidateCode(e,t,l),()=>h(t),()=>c(t))}aa.getValidate=ha,aa.callRef=da,aa.default=ca;var fa={};Object.defineProperty(fa,"__esModule",{value:!0});const pa=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",sa.default,aa.default];fa.default=pa;var ma={};Object.defineProperty(ma,"__esModule",{value:!0});const ya=As.operators,ga={maximum:{okStr:"<=",ok:ya.LTE,fail:ya.GT},minimum:{okStr:">=",ok:ya.GTE,fail:ya.LT},exclusiveMaximum:{okStr:"<",ok:ya.LT,fail:ya.GTE},exclusiveMinimum:{okStr:">",ok:ya.GT,fail:ya.LTE}},va={message:({keyword:e,schemaCode:t})=>As.str`should be ${ga[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>As._`{comparison: ${ga[e].okStr}, limit: ${t}}`},ba={keyword:Object.keys(ga),type:"number",schemaType:"number",$data:!0,error:va,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data(As._`${r} ${ga[t].fail} ${n} || isNaN(${r})`)}};ma.default=ba;var _a={};Object.defineProperty(_a,"__esModule",{value:!0});const wa={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>As.str`should be multiple of ${e}`,params:({schemaCode:e})=>As._`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:n,it:i}=e,s=i.opts.multipleOfPrecision,o=t.let("res"),a=s?As._`Math.abs(Math.round(${o}) - ${o}) > 1e-${s}`:As._`${o} !== parseInt(${o})`;e.fail$data(As._`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};_a.default=wa;var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.default=function(e){const t=e.length;let r,n=0,i=0;for(;i<t;)n++,(r=e.charCodeAt(i++))>=55296&&r<=56319&&i<t&&56320==(64512&(r=e.charCodeAt(i)))&&i++;return n};var Ca={};Object.defineProperty(Ca,"__esModule",{value:!0});const Na={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxLength"===e?"more":"fewer";return As.str`should NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>As._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n,it:i}=e,s="maxLength"===t?As.operators.GT:As.operators.LT;let o;if(!1===i.opts.unicode)o=As._`${r}.length`;else{const t=e.gen.scopeValue("func",{ref:Ea.default,code:As._`require("ajv/dist/compile/ucs2length").default`});o=As._`${t}(${r})`}e.fail$data(As._`${o} ${s} ${n}`)}};Ca.default=Na;var $a={};Object.defineProperty($a,"__esModule",{value:!0});const xa=w({}),Ta={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>As.str`should match pattern "${e}"`,params:({schemaCode:e})=>As._`{pattern: ${e}}`},code(e){const{gen:t,data:r,$data:n,schema:i,schemaCode:s}=e,o=n?As._`(new RegExp(${s}, "u"))`:xa.usePattern(t,i);e.fail$data(As._`!${o}.test(${r})`)}};$a.default=Ta;var Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});const Sa={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxProperties"===e?"more":"fewer";return As.str`should NOT have ${r} than ${t} items`},params:({schemaCode:e})=>As._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxProperties"===t?As.operators.GT:As.operators.LT;e.fail$data(As._`Object.keys(${r}).length ${i} ${n}`)}};Oa.default=Sa;var ka={};Object.defineProperty(ka,"__esModule",{value:!0});const ja=w({}),Aa=g({}),Ra={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>As.str`should have required property '${e}'`,params:({params:{missingProperty:e}})=>As._`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:n,data:i,$data:s,it:o}=e,{opts:a}=o;if(!s&&0===r.length)return;const u=r.length>=a.loopRequired;if(o.allErrors?function(){if(u||s)e.block$data(As.nil,l);else for(const t of r)ja.checkReportMissingProp(e,t)}():function(){const o=t.let("missing");if(u||s){const r=t.let("valid",!0);e.block$data(r,()=>function(r,s){e.setParams({missingProperty:r}),t.forOf(r,n,()=>{t.assign(s,ja.propertyInData(t,i,r,a.ownProperties)),t.if(As.not(s),()=>{e.error(),t.break()})},As.nil)}(o,r)),e.ok(r)}else t.if(ja.checkMissingProp(e,r,o)),ja.reportMissingProp(e,o),t.else()}(),a.strictRequired){const t=e.parentSchema.properties,{definedProperties:n}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!n.has(e)){const t=`required property "${e}" is not defined at "${o.schemaEnv.baseId+o.errSchemaPath}" (strictRequired)`;Aa.checkStrictMode(o,t,o.opts.strictRequired)}}function l(){t.forOf("prop",n,r=>{e.setParams({missingProperty:r}),t.if(ja.noPropertyInData(t,i,r,a.ownProperties),()=>e.error())})}}};ka.default=Ra;var Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});const Pa={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxItems"===e?"more":"fewer";return As.str`should NOT have ${r} than ${t} items`},params:({schemaCode:e})=>As._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxItems"===t?As.operators.GT:As.operators.LT;e.fail$data(As._`${r}.length ${i} ${n}`)}};Ia.default=Pa;var qa={};Object.defineProperty(qa,"__esModule",{value:!0});const La=m({}),Ma={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>As.str`should NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>As._`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:n,schema:i,parentSchema:s,schemaCode:o,it:a}=e;if(!n&&!i)return;const u=t.let("valid"),l=s.items?La.getSchemaTypes(s.items):[];e.block$data(u,(function(){const n=t.let("i",As._`${r}.length`),i=t.let("j");e.setParams({i:n,j:i}),t.assign(u,!0),t.if(As._`${n} > 1`,()=>(l.length>0&&!l.some(e=>"object"===e||"array"===e)?function(n,i){const s=t.name("item"),o=La.checkDataTypes(l,s,a.opts.strict,La.DataType.Wrong),c=t.const("indices",As._`{}`);t.for(As._`;${n}--;`,()=>{t.let(s,As._`${r}[${n}]`),t.if(o,As._`continue`),l.length>1&&t.if(As._`typeof ${s} == "string"`,As._`${s} += "_"`),t.if(As._`typeof ${c}[${s}] == "number"`,()=>{t.assign(i,As._`${c}[${s}]`),e.error(),t.assign(u,!1).break()}).code(As._`${c}[${s}] = ${n}`)})}:function(n,i){const s=e.gen.scopeValue("func",{ref:wo,code:As._`require("ajv/dist/compile/equal")`}),o=t.name("outer");t.label(o).for(As._`;${n}--;`,()=>t.for(As._`${i} = ${n}; ${i}--;`,()=>t.if(As._`${s}(${r}[${n}], ${r}[${i}])`,()=>{e.error(),t.assign(u,!1).break(o)})))})(n,i))}),As._`${o} === false`),e.ok(u)}};qa.default=Ma;var Da={};Object.defineProperty(Da,"__esModule",{value:!0});const Fa={keyword:"const",$data:!0,error:{message:"should be equal to constant",params:({schemaCode:e})=>As._`{allowedValue: ${e}}`},code(e){const t=e.gen.scopeValue("func",{ref:wo,code:As._`require("ajv/dist/compile/equal")`});e.fail$data(As._`!${t}(${e.data}, ${e.schemaCode})`)}};Da.default=Fa;var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});const Ba={keyword:"enum",schemaType:"array",$data:!0,error:{message:"should be equal to one of the allowed values",params:({schemaCode:e})=>As._`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:n,schema:i,schemaCode:s,it:o}=e;if(!n&&0===i.length)throw new Error("enum must have non-empty array");const a=i.length>=o.opts.loopEnum,u=e.gen.scopeValue("func",{ref:wo,code:As._`require("ajv/dist/compile/equal")`});let l;if(a||n)l=t.let("valid"),e.block$data(l,(function(){t.assign(l,!1),t.forOf("v",s,e=>t.if(As._`${u}(${r}, ${e})`,()=>t.assign(l,!0).break()))}));else{if(!Array.isArray(i))throw new Error("ajv implementation error");const e=t.const("vSchema",s);l=As.or(...i.map((t,n)=>function(e,t){const n=i[t];return n&&"object"==typeof n?As._`${u}(${r}, ${e}[${t}])`:As._`${r} === ${n}`}(e,n)))}e.pass(l)}};Ua.default=Ba;var Va={};Object.defineProperty(Va,"__esModule",{value:!0});const za=[ma.default,_a.default,Ca.default,$a.default,Oa.default,ka.default,Ia.default,qa.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Da.default,Ua.default];Va.default=za;var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0});const Qa=E({}),Wa=y({}),Ja=g({}),Ka={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>As.str`should NOT have more than ${e} items`,params:({params:{len:e}})=>As._`{limit: ${e}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:s}=e,{items:o}=n;if(!Array.isArray(o))return void Ja.checkStrictMode(s,'"additionalItems" is ignored when "items" is not an array of schemas');s.items=!0;const a=t.const("len",As._`${i}.length`);if(!1===r)e.setParams({len:o.length}),e.pass(As._`${a} <= ${o.length}`);else if("object"==typeof r&&!Wa.alwaysValidSchema(s,r)){const r=t.var("valid",As._`${a} <= ${o.length}`);t.if(As.not(r),()=>function(r){t.forRange("i",o.length,a,n=>{e.subschema({keyword:"additionalItems",dataProp:n,dataPropType:Qa.Type.Num},r),s.allErrors||t.if(As.not(r),()=>t.break())})}(r)),e.ok(r)}}};Ha.default=Ka;var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});const Ya=y({}),Za=g({}),Xa=w({}),eu={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{gen:t,schema:r,it:n}=e;if(Array.isArray(r))n.opts.unevaluated&&r.length&&!0!==n.items&&(n.items=Ya.mergeEvaluated.items(t,r.length,n.items)),function(r){const{parentSchema:i,data:s}=e;if(n.opts.strictTuples&&!function(e,t){return e===t.minItems&&(e===t.maxItems||!1===t.additionalItems)}(r.length,i)){const e=`"items" is ${r.length}-tuple, but minItems or maxItems/additionalItems are not specified or different`;Za.checkStrictMode(n,e,n.opts.strictTuples)}const o=t.name("valid"),a=t.const("len",As._`${s}.length`);r.forEach((r,i)=>{Ya.alwaysValidSchema(n,r)||(t.if(As._`${a} > ${i}`,()=>e.subschema({keyword:"items",schemaProp:i,dataProp:i},o)),e.ok(o))})}(r);else{if(n.items=!0,Ya.alwaysValidSchema(n,r))return;e.ok(Xa.validateArray(e))}}};Ga.default=eu;var tu={};Object.defineProperty(tu,"__esModule",{value:!0});const ru=E({}),nu=y({}),iu=g({}),su={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?As.str`should contain at least ${e} valid item(s)`:As.str`should contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?As._`{minContains: ${e}}`:As._`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:s}=e;let o,a;const{minContains:u,maxContains:l}=n;s.opts.next?(o=void 0===u?1:u,a=l):o=1;const c=t.const("len",As._`${i}.length`);if(e.setParams({min:o,max:a}),void 0===a&&0===o)return void iu.checkStrictMode(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==a&&o>a)return iu.checkStrictMode(s,'"minContains" > "maxContains" is always invalid'),void e.fail();if(nu.alwaysValidSchema(s,r)){let t=As._`${c} >= ${o}`;return void 0!==a&&(t=As._`${t} && ${c} <= ${a}`),void e.pass(t)}s.items=!0;const h=t.name("valid");if(void 0===a&&1===o)d(h,()=>t.if(h,()=>t.break()));else{t.let(h,!1);const e=t.name("_valid"),r=t.let("count",0);d(e,()=>t.if(e,()=>function(e){t.code(As._`${e}++`),void 0===a?t.if(As._`${e} >= ${o}`,()=>t.assign(h,!0).break()):(t.if(As._`${e} > ${a}`,()=>t.assign(h,!1).break()),1===o?t.assign(h,!0):t.if(As._`${e} >= ${o}`,()=>t.assign(h,!0)))}(r)))}function d(r,n){t.forRange("i",0,c,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:ru.Type.Num,compositeRule:!0},r),n()})}e.result(h,()=>e.reset())}};tu.default=su;var ou={};Object.defineProperty(ou,"__esModule",{value:!0}),ou.validateSchemaDeps=ou.validatePropertyDeps=ou.error=void 0;const au=y({}),uu=w({});ou.error={message:({params:{property:e,depsCount:t,deps:r}})=>{const n=1===t?"property":"properties";return As.str`should have ${n} ${r} when property ${e} is present`},params:({params:{property:e,depsCount:t,deps:r,missingProperty:n}})=>As._`{property: ${e},
    missingProperty: ${n},
    depsCount: ${t},
    deps: ${r}}`};const lu={keyword:"dependencies",type:"object",schemaType:"object",error:ou.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e){if("__proto__"===n)continue;(Array.isArray(e[n])?t:r)[n]=e[n]}return[t,r]}(e);cu(e,t),hu(e,r)}};function cu(e,t=e.schema){const{gen:r,data:n,it:i}=e;if(0===Object.keys(t).length)return;const s=r.let("missing");for(const o in t){const a=t[o];if(0===a.length)continue;const u=uu.propertyInData(r,n,o,i.opts.ownProperties);e.setParams({property:o,depsCount:a.length,deps:a.join(", ")}),i.allErrors?r.if(u,()=>{for(const t of a)uu.checkReportMissingProp(e,t)}):(r.if(As._`${u} && (${uu.checkMissingProp(e,a,s)})`),uu.reportMissingProp(e,s),r.else())}}function hu(e,t=e.schema){const{gen:r,data:n,keyword:i,it:s}=e,o=r.name("valid");for(const a in t)au.alwaysValidSchema(s,t[a])||(r.if(uu.propertyInData(r,n,a,s.opts.ownProperties),()=>{const t=e.subschema({keyword:i,schemaProp:a},o);e.mergeValidEvaluated(t,o)},()=>r.var(o,!0)),e.ok(o))}ou.validatePropertyDeps=cu,ou.validateSchemaDeps=hu,ou.default=lu;var du={};Object.defineProperty(du,"__esModule",{value:!0});const fu=y({}),pu={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:({params:e})=>As.str`property name '${e.propertyName}' is invalid`,params:({params:e})=>As._`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:n,it:i}=e;if(fu.alwaysValidSchema(i,r))return;const s=t.name("valid");t.forIn("key",n,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},s),t.if(As.not(s),()=>{e.error(!0),i.allErrors||t.break()})}),e.ok(s)}};du.default=pu;var mu={};Object.defineProperty(mu,"__esModule",{value:!0});const yu=w({}),gu=E({}),vu=y({}),bu={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"should NOT have additional properties",params:({params:e})=>As._`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:i,errsCount:s,it:o}=e;if(!s)throw new Error("ajv implementation error");const{allErrors:a,opts:u}=o;if(o.props=!0,"all"!==u.removeAdditional&&vu.alwaysValidSchema(o,r))return;const l=yu.allSchemaProperties(n.properties),c=yu.allSchemaProperties(n.patternProperties);function h(e){t.code(As._`delete ${i}[${e}]`)}function d(n){if("all"===u.removeAdditional||u.removeAdditional&&!1===r)h(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(a||t.break());if("object"==typeof r&&!vu.alwaysValidSchema(o,r)){const r=t.name("valid");"failing"===u.removeAdditional?(f(n,r,!1),t.if(As.not(r),()=>{e.reset(),h(n)})):(f(n,r),a||t.if(As.not(r),()=>t.break()))}}}function f(t,r,n){const i={keyword:"additionalProperties",dataProp:t,dataPropType:gu.Type.Str};!1===n&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,r)}t.forIn("key",i,e=>{l.length||c.length?t.if(function(e){let r;if(l.length>8){const i=vu.schemaRefOrVal(o,n.properties,"properties");r=yu.isOwnProperty(t,i,e)}else r=l.length?As.or(...l.map(t=>As._`${e} === ${t}`)):As.nil;return c.length&&(r=As.or(r,...c.map(r=>As._`${yu.usePattern(t,r)}.test(${e})`))),As.not(r)}(e),()=>d(e)):d(e)}),e.ok(As._`${s} === ${co.default.errors}`)}};mu.default=bu;var _u={};Object.defineProperty(_u,"__esModule",{value:!0});const wu=p({}),Eu=w({}),Cu=y({}),Nu={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:s}=e;"all"===s.opts.removeAdditional&&void 0===n.additionalProperties&&mu.default.code(new wu.default(s,mu.default,"additionalProperties"));const o=Eu.allSchemaProperties(r);for(const h of o)s.definedProperties.add(h);s.opts.unevaluated&&o.length&&!0!==s.props&&(s.props=Cu.mergeEvaluated.props(t,Cu.toHash(o),s.props));const a=o.filter(e=>!Cu.alwaysValidSchema(s,r[e]));if(0===a.length)return;const u=t.name("valid");for(const h of a)l(h)?c(h):(t.if(Eu.propertyInData(t,i,h,s.opts.ownProperties)),c(h),s.allErrors||t.else().var(u,!0),t.endIf()),e.it.definedProperties.add(h),e.ok(u);function l(e){return s.opts.useDefaults&&!s.compositeRule&&void 0!==r[e].default}function c(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},u)}}};_u.default=Nu;var $u={};Object.defineProperty($u,"__esModule",{value:!0});const xu=w({}),Tu=E({}),Ou=g({}),Su=y({}),ku={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:i,it:s}=e,{opts:o}=s,a=xu.schemaProperties(s,r);if(0===a.length)return;const u=o.strict&&!o.allowMatchingProperties&&i.properties,l=t.name("valid");!0===s.props||s.props instanceof As.Name||(s.props=Su.evaluatedPropsToName(t,s.props));const{props:c}=s;function h(e){for(const t in u)new RegExp(e).test(t)&&Ou.checkStrictMode(s,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function d(r){t.forIn("key",n,n=>{t.if(As._`${xu.usePattern(t,r)}.test(${n})`,()=>{e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:n,dataPropType:Tu.Type.Str},l),s.opts.unevaluated&&!0!==c?t.assign(As._`${c}[${n}]`,!0):s.allErrors||t.if(As.not(l),()=>t.break())})})}!function(){for(const e of a)u&&h(e),s.allErrors?d(e):(t.var(l,!0),d(e),t.if(l))}()}};$u.default=ku;var ju={};Object.defineProperty(ju,"__esModule",{value:!0});const Au=y({}),Ru={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if(Au.alwaysValidSchema(n,r))return void e.fail();const i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.result(i,()=>e.error(),()=>e.reset())},error:{message:"should NOT be valid"}};ju.default=Ru;var Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});const Pu={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:w({}).validateUnion,error:{message:"should match some schema in anyOf"}};Iu.default=Pu;var qu={};Object.defineProperty(qu,"__esModule",{value:!0});const Lu=y({}),Mu={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"should match exactly one schema in oneOf",params:({params:e})=>As._`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const i=r,s=t.let("valid",!1),o=t.let("passing",null),a=t.name("_valid");e.setParams({passing:o}),t.block((function(){i.forEach((r,i)=>{let u;Lu.alwaysValidSchema(n,r)?t.var(a,!0):u=e.subschema({keyword:"oneOf",schemaProp:i,compositeRule:!0},a),i>0&&t.if(As._`${a} && ${s}`).assign(s,!1).assign(o,As._`[${o}, ${i}]`).else(),t.if(a,()=>{t.assign(s,!0),t.assign(o,i),u&&e.mergeEvaluated(u,As.Name)})})})),e.result(s,()=>e.reset(),()=>e.error(!0))}};qu.default=Mu;var Du={};Object.defineProperty(Du,"__esModule",{value:!0});const Fu=y({}),Uu={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const i=t.name("valid");r.forEach((t,r)=>{if(Fu.alwaysValidSchema(n,t))return;const s=e.subschema({keyword:"allOf",schemaProp:r},i);e.ok(i),e.mergeEvaluated(s)})}};Du.default=Uu;var Bu={};Object.defineProperty(Bu,"__esModule",{value:!0});const Vu=y({}),zu=g({}),Hu={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>As.str`should match "${e.ifClause}" schema`,params:({params:e})=>As._`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:n}=e;void 0===r.then&&void 0===r.else&&zu.checkStrictMode(n,'"if" without "then" and "else" is ignored');const i=Qu(n,"then"),s=Qu(n,"else");if(!i&&!s)return;const o=t.let("valid",!0),a=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);e.mergeEvaluated(t)}(),e.reset(),i&&s){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(a,u("then",r),u("else",r))}else i?t.if(a,u("then")):t.if(As.not(a),u("else"));function u(r,n){return()=>{const i=e.subschema({keyword:r},a);t.assign(o,a),e.mergeValidEvaluated(i,o),n?t.assign(n,As._`${r}`):e.setParams({ifClause:r})}}e.pass(o,()=>e.error(!0))}};function Qu(e,t){const r=e.schema[t];return void 0!==r&&!Vu.alwaysValidSchema(e,r)}Bu.default=Hu;var Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});const Ju=g({}),Ku={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&Ju.checkStrictMode(r,`"${e}" without "if" is ignored`)}};Wu.default=Ku;var Gu={};Object.defineProperty(Gu,"__esModule",{value:!0});const Yu=[ju.default,Iu.default,qu.default,Du.default,Bu.default,Wu.default,Ha.default,Ga.default,tu.default,du.default,mu.default,ou.default,_u.default,$u.default];Gu.default=Yu;var Zu={};Object.defineProperty(Zu,"__esModule",{value:!0});const Xu={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>As.str`should match format "${e}"`,params:({schemaCode:e})=>As._`{format: ${e}}`},code(e,t){const{gen:r,data:n,$data:i,schema:s,schemaCode:o,it:a}=e,{opts:u,errSchemaPath:l,schemaEnv:c,self:h}=a;u.validateFormats&&(i?function(){const i=r.scopeValue("formats",{ref:h.formats,code:u.code.formats}),s=r.const("fDef",As._`${i}[${o}]`),a=r.let("fType"),l=r.let("format");r.if(As._`typeof ${s} == "object" && !(${s} instanceof RegExp)`,()=>r.assign(a,As._`${s}.type || "string"`).assign(l,As._`${s}.validate`),()=>r.assign(a,As._`"string"`).assign(l,s)),e.fail$data(As.or(!1===u.strict?As.nil:As._`${o} && !${l}`,function(){const e=c.$async?As._`(${s}.async ? await ${l}(${n}) : ${l}(${n}))`:As._`${l}(${n})`,r=As._`(typeof ${l} == "function" ? ${e} : ${l}.test(${n}))`;return As._`${l} && ${l} !== true && ${a} === ${t} && !${r}`}()))}():function(){const i=h.formats[s];if(!i)return void function(){if(!1!==u.strict)throw new Error(e());function e(){return`unknown format "${s}" ignored in schema at path "${l}"`}h.logger.warn(e())}();if(!0===i)return;const[o,a,d]=function(e){const t=r.scopeValue("formats",{key:s,ref:e,code:u.code.formats?As._`${u.code.formats}${As.getProperty(s)}`:void 0});return"object"!=typeof e||e instanceof RegExp?["string",e,t]:[e.type||"string",e.validate,As._`${t}.validate`]}(i);o===t&&e.pass(function(){if("object"==typeof i&&!(i instanceof RegExp)&&i.async){if(!c.$async)throw new Error("async format in sync schema");return As._`await ${d}(${n})`}return"function"==typeof a?As._`${d}(${n})`:As._`${d}.test(${n})`}())}())}};Zu.default=Xu;var el={};Object.defineProperty(el,"__esModule",{value:!0});const tl=[Zu.default];el.default=tl;var rl={};Object.defineProperty(rl,"__esModule",{value:!0}),rl.contentVocabulary=rl.metadataVocabulary=void 0,rl.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],rl.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];var nl={};Object.defineProperty(nl,"__esModule",{value:!0});const il=[fa.default,Va.default,Gu.default,el.default,rl.metadataVocabulary,rl.contentVocabulary];nl.default=il;var sl={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},ol={};Object.defineProperty(ol,"__esModule",{value:!0}),ol.CodeGen=ol.Name=ol.nil=ol.stringify=ol.str=ol._=ol.KeywordCxt=void 0;const al=p({});ol.KeywordCxt=al.default,Object.defineProperty(ol,"_",{enumerable:!0,get:function(){return As._}}),Object.defineProperty(ol,"str",{enumerable:!0,get:function(){return As.str}}),Object.defineProperty(ol,"stringify",{enumerable:!0,get:function(){return As.stringify}}),Object.defineProperty(ol,"nil",{enumerable:!0,get:function(){return As.nil}}),Object.defineProperty(ol,"Name",{enumerable:!0,get:function(){return As.Name}}),Object.defineProperty(ol,"CodeGen",{enumerable:!0,get:function(){return As.CodeGen}});const ul=["/properties"],ll="http://json-schema.org/draft-07/schema";ol.default=class extends Uo.default{_addVocabularies(){super._addVocabularies(),nl.default.forEach(e=>this.addVocabulary(e))}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(sl,ul):sl;this.addMetaSchema(e,ll,!1),this.refs["http://json-schema.org/schema"]=ll}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(ll)?ll:void 0)}};var cl={};function hl(e,t){return{validate:e,compare:t}}Object.defineProperty(cl,"__esModule",{value:!0}),cl.formatNames=cl.fastFormats=cl.fullFormats=void 0,cl.fullFormats={date:hl(pl,ml),time:hl(gl,vl),"date-time":hl((function(e){const t=e.split(bl);return 2===t.length&&pl(t[0])&&gl(t[1],!0)}),_l),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return wl.test(e)&&El.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(Cl.test(e))return!1;try{return new RegExp(e),!0}catch(Zv){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/},cl.fastFormats={...cl.fullFormats,date:hl(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,ml),time:hl(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,vl),"date-time":hl(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,_l),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},cl.formatNames=Object.keys(cl.fullFormats);const dl=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,fl=[0,31,28,31,30,31,30,31,31,30,31,30,31];function pl(e){const t=dl.exec(e);if(!t)return!1;const r=+t[1],n=+t[2],i=+t[3];return n>=1&&n<=12&&i>=1&&i<=(2===n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:fl[n])}function ml(e,t){if(e&&t)return e>t?1:e<t?-1:0}const yl=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function gl(e,t){const r=yl.exec(e);if(!r)return!1;const n=+r[1],i=+r[2],s=+r[3],o=r[5];return(n<=23&&i<=59&&s<=59||23===n&&59===i&&60===s)&&(!t||""!==o)}function vl(e,t){if(!e||!t)return;const r=yl.exec(e),n=yl.exec(t);return r&&n?(e=r[1]+r[2]+r[3]+(r[4]||""))>(t=n[1]+n[2]+n[3]+(n[4]||""))?1:e<t?-1:0:void 0}const bl=/t|\s/i;function _l(e,t){if(!e||!t)return;const[r,n]=e.split(bl),[i,s]=t.split(bl),o=ml(r,i);return void 0!==o?o||vl(n,s):void 0}const wl=/\/|:/,El=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Cl=/[^\\]\\Z/;var Nl={};Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.formatLimitDefinition=void 0;const $l=p({}),xl=As.operators,Tl={formatMaximum:{okStr:"<=",ok:xl.LTE,fail:xl.GT},formatMinimum:{okStr:">=",ok:xl.GTE,fail:xl.LT},formatExclusiveMaximum:{okStr:"<",ok:xl.LT,fail:xl.GTE},formatExclusiveMinimum:{okStr:">",ok:xl.GT,fail:xl.LTE}},Ol={message:({keyword:e,schemaCode:t})=>As.str`should be ${Tl[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>As._`{comparison: ${Tl[e].okStr}, limit: ${t}}`};Nl.formatLimitDefinition={keyword:Object.keys(Tl),type:"string",schemaType:"string",$data:!0,error:Ol,code(e){const{gen:t,data:r,schemaCode:n,keyword:i,it:s}=e,{opts:o,self:a}=s;if(!o.validateFormats)return;const u=new $l.default(s,a.RULES.all.format.definition,"format");function l(e){return As._`${e}.compare(${r}, ${n}) ${Tl[i].fail} 0`}u.$data?function(){const r=t.scopeValue("formats",{ref:a.formats,code:o.code.formats}),n=t.const("fmt",As._`${r}[${u.schemaCode}]`);e.fail$data(As.or(As._`typeof ${n} != "object"`,As._`${n} instanceof RegExp`,As._`typeof ${n}.compare != "function"`,l(n)))}():function(){const r=u.schema,n=a.formats[r];if(!n||!0===n)return;if("object"!=typeof n||n instanceof RegExp||"function"!=typeof n.compare)throw new Error(`"${i}": format "${r}" does not define "compare" function`);const s=t.scopeValue("formats",{key:r,ref:n,code:o.code.formats?As._`${o.code.formats}${As.getProperty(r)}`:void 0});e.fail$data(l(s))}()},dependencies:["format"]},Nl.default=e=>(e.addKeyword(Nl.formatLimitDefinition),e);var Sl={};Object.defineProperty(Sl,"__esModule",{value:!0});const kl=new As.Name("fullFormats"),jl=new As.Name("fastFormats"),Al=(e,t={keywords:!0})=>{if(Array.isArray(t))return Rl(e,t,cl.fullFormats,kl),e;const[r,n]="fast"===t.mode?[cl.fastFormats,jl]:[cl.fullFormats,kl];return Rl(e,t.formats||cl.formatNames,r,n),t.keywords&&Nl.default(e),e};function Rl(e,t,r,n){var i,s;null!==(i=(s=e.opts.code).formats)&&void 0!==i||(s.formats=As._`require("ajv-formats/dist/formats").${n}`);for(const o of t)e.addFormat(o,r[o])}Al.get=(e,t="full")=>{const r=("fast"===t?cl.fastFormats:cl.fullFormats)[e];if(!r)throw new Error(`Unknown format "${e}"`);return r},Sl.default=Al,(Sl=Al).default=Al;const Il=ol.default,Pl=require("fs"),ql=require("path"),Ll=new Il({strict:!0});Sl(Ll);var Ml={register:function(e,t){t||(t="");const r=ql.join(e,t);return Pl.readdirSync(r).forEach(t=>{const n=""+t;if("."===n||".."===n)return Ml;if(Pl.statSync(`${r}/${t}`).isDirectory())return Ml.register(e,ql.relative(e,`${r}/${t}`));if(!n.endsWith(".schema.json"))return Ml;let i=ql.relative(e,r)+"/"+n.replace(/\..*$/,""),s=JSON.parse(Pl.readFileSync(`${r}/${t}`,"utf8"));Ll.addSchema(s,i)}),Ml},is:function(e){return{valid:function(t){try{var r=Ll.validate(t,e);return r||console.error(Ll.errorsText()),r}catch(error){return console.error(error.message+"\t"+error.stack),!1}}}},validate:function(e){return function(t,r,n){try{if(!Ll.validate(e,t.body))throw new ls.InvalidRequestBody(t.originalUrl,Ll.errorsText())}catch(error){return void(error instanceof ls.ServiceError?r.status(error.status).json({error:error.message}):(console.error(error.message+"\t"+error.stack),r.status(500).json({error:"Internal service error",internal:error.message,stack:error.stack})))}n()}}},Dl=Ml,Fl={};(function(e){Fl=Dl.register(e)}).call(this,"/node_modules/@persistr/server-crypto/src/schemas");var Ul={};(function(e){const t="Could not extract parameters from DER signature";function r(e,t,r){let n=0;for(;t+n<r&&0===e[t+n];)n++;return e[t+n]>=128?--n:n}Ul.derToConcat=(r,n)=>{let i=0;if(48!==r[i++])throw new Error(t);let s=r[i++];if(129===s&&(s=r[i++]),s>r.length-i||2!==r[i++])throw new Error(t);let o=r[i++];if(o>r.length-i-2||o>n+1)throw new Error(t);let a=i;if(i+=o,2!==r[i++])throw new Error(t);let u=r[i++];if(u!==r.length-i||u>n+1)throw new Error(t);let l=i;if((i+=u)!==r.length)throw new Error(t);let c=n-o,h=n-u,d=e.allocUnsafe(c+o+h+u);for(i=0;i<c;i++)d[i]=0;let f=Math.max(-c,0);r.copy(d,i,a+f,a+o);for(let e=i=n;i<e+h;i++)d[i]=0;let p=Math.max(-h,0);return r.copy(d,i,l+p,l+u),d},Ul.concatToDer=(t,n)=>{let i=r(t,0,n),s=r(t,n,t.length),o=n-i,a=n-s,u=o+a+4,l=u<128,c=e.allocUnsafe((l?2:3)+u),h=0;return c[h++]=48,l?c[h++]=u:(c[h++]=129,c[h++]=255&u),c[h++]=2,c[h++]=o,i<0?(c[h++]=0,h+=t.copy(c,h,0,n)):h+=t.copy(c,h,i,n),c[h++]=2,c[h++]=a,s<0?(c[h++]=0,t.copy(c,h,n)):t.copy(c,h,n+s),c}}).call(this,require("buffer").Buffer);var Bl={};function Vl(e,t,r){if(!r){if(e)throw e;return t}r(e,t)}Bl.buf2b64url=e=>e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Bl.responder=Vl,Bl.payloadVerifications=(e,t)=>{if(e.audList){if(void 0===e.payload.aud)return e.error={message:"Missing aud claim in payload"},Vl(null,e,t);if(!e.audList.includes(e.payload.aud))return e.error={message:"Mismatching aud claim in payload"},Vl(null,e,t)}if(e.issList){if(void 0===e.payload.iss)return e.error={message:"Missing iss claim in payload"},Vl(null,e,t);if(!e.issList.includes(e.payload.iss))return e.error={message:"Mismatching iss claim in payload"},Vl(null,e,t)}let r=Number(e.payload.iat);if(!r)return e.error={message:"Missing or invalid iat claim in payload"},Vl(null,e,t);let n=Number(e.payload.exp);if(e.lifetime){let t=r+e.lifetime;(!n||t<n)&&(n=t)}return n&&Date.now()>1e3*n?(e.expired=n,Vl(null,e,t)):(e.valid=!0,Vl(null,e,t))};var zl={};(function(e){const t=require("crypto"),{responder:r,buf2b64url:n,payloadVerifications:i}=Bl,s=/^(HS|RS|ES)(256|384|512)$/;function o(r,i,s){if("string"==typeof s)s=e.from(s,"base64");else if(!(s instanceof e))throw new TypeError("Key must be a buffer or a base64 string");let o=i>>3;if(s.length<o)throw new TypeError(`Key length must be at least ${o} bytes`);let a=t.createHmac("SHA"+i,s);return`${r}.${n(a.update(r).digest())}`}function a(r,n,i,s){if("string"==typeof s)s=e.from(s,"base64");else if(!(s instanceof e))throw new TypeError("Key must be a buffer or a base64 string");let o=i>>3;if(s.length<o)throw new TypeError(`Key length must be at least ${o} bytes`);let a=t.createHmac("SHA"+i,s);return a.update(r),t.timingSafeEqual(a.digest(),e.from(n,"base64"))}function u(r,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----"))throw new TypeError("Key must be a PEM formatted RSA private key");let o=t.createSign("SHA"+i);return`${r}.${n(o.update(r).sign(s))}`}function l(r,n,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----")&&!s.includes("CERTIFICATE-----"))throw new TypeError("Key must be a PEM formatted RSA public key");let o=t.createVerify("SHA"+i);return o.update(r),o.verify(s,n,"base64")}function c(r,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----"))throw new TypeError("Key must be a PEM formatted EC private key");let o=t.createSign("SHA"+i);o.update(r);let a=32;return 384===i?a=48:512===i&&(a=66),`${r}.${n(Ul.derToConcat(o.sign(s),a))}`}function h(r,n,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----")&&!s.includes("CERTIFICATE-----"))throw new TypeError("Key must be a PEM formatted EC public key");let o=32;if(384===i?o=48:512===i&&(o=66),(n=e.from(n,"base64")).length!==o<<1)return!1;let a=t.createVerify("SHA"+i);return a.update(r),a.verify(s,Ul.concatToDer(n,o))}zl.generate=(t,i,...a)=>{let l,h,d={alg:t};if(a[0].constructor!==Object)l=a[0],h="function"==typeof a[1]?a[1]:void 0;else if(d.kid=a[1],l=a[0][a[1]],h="function"==typeof a[2]?a[2]:void 0,!l)return r(new TypeError("Invalid key identifier"),null,h);let f,p="string"==typeof t?t.match(s):null;if(!p)return r(new TypeError("Unrecognized algorithm"),null,h);f="HS"===p[1]?o:"RS"===p[1]?u:c,i.iat=Math.floor(Date.now()/1e3);let m,y=n(e.from(JSON.stringify(d))),g=n(e.from(JSON.stringify(i)));try{m=f(`${y}.${g}`,+p[2],l)}catch(error){return r(error,null,h)}return r(null,m,h)},zl.verify=(e,t,n)=>{if(e.error)return r(null,e,n);if("string"!=typeof e.header.alg)return e.error={message:"Missing or invalid alg claim in header"},r(null,e,n);let o=e.header.alg.match(s);if(!o)return e.error={message:"Unrecognized algorithm "+e.header.alg},r(null,e,n);if(e.algList&&!e.algList.includes(e.header.alg))return e.error={message:"Unwanted algorithm "+e.header.alg},r(null,e,n);let u,c,d=`${e.parts[0]}.${e.parts[1]}`;u="HS"===o[1]?a:"RS"===o[1]?l:h;try{c=u(d,e.parts[2],+o[2],t)}catch(error){return e.error={message:"Could not verify integrity. "+error.message},r(null,e,n)}return c?i(e,n):(e.error={message:"Integrity check failed"},r(null,e,n))}}).call(this,require("buffer").Buffer);var Hl={};(function(e){const t=require("crypto"),{responder:r,buf2b64url:n,payloadVerifications:i}=Bl,s=/^(PBES2-HS(256|384|512)\053)?(RSA-OAEP|dir|A(128|192|256)KW)$/,o=/^A(128|192|256)(GCM|CBC-HS(256|384|512))$/;function a(n,i,s,o,a,u){let c,d,p=i[3]?+i[1]>>2:+i[1]>>3,y=i[3]?h:l;if("dir"!==n[0]){c=t.randomBytes(p);let e=n[4]?m:f;try{d=e(c,a,+n[4])}catch(error){return r(error,null,u)}}else{if("string"==typeof a)a=e.from(a,"base64");else if(!(a instanceof e)){let e=new TypeError("Key must be a buffer or a base64 string");return r(e,null,u)}if(a.length<p){let e=new TypeError(`Key must be at least ${p} bytes`);return r(e,null,u)}c=a.slice(0,p),d=""}o.iat=Math.floor(Date.now()/1e3);let g=y(s,c,d,JSON.stringify(o),+i[1]);return r(null,g,u)}function u(t,n,s,o,a){let u,l,h=e.from(t.parts[0]),f=e.from(t.parts[1],"base64"),m=e.from(t.parts[2],"base64"),g=e.from(t.parts[3],"base64"),v=e.from(t.parts[4],"base64"),b=s[3]?+s[1]>>2:+s[1]>>3,_=s[3]?d:c;if("dir"!==n[0]){let e=n[4]?y:p;try{u=e(f,o,+n[4])}catch(error){return t.error={message:"Could not decrypt token. "+error.message},r(null,t,a)}}else{if("string"==typeof o)o=e.from(o,"base64");else if(!(o instanceof e))return t.error={message:"Invalid key"},r(null,t,a);if(o.length<b)return t.error={message:`Invalid key length. Must be at least ${b} bytes`},r(null,t,a);u=o.slice(0,b)}try{l=_(g,h,v,u,m,+s[1])}catch(error){return t.error={message:"Could not decrypt token. "+error.message},r(null,t,a)}try{t.payload=JSON.parse(l)}catch(error){return t.error={message:"Non parsable payload. "+error.message},r(null,t,a)}return i(t,a)}function l(r,i,s,o,a){let u=t.randomBytes(12),l=t.createCipheriv(`id-aes${a}-GCM`,i,u);l.setAutoPadding(!1),l.setAAD(e.from(r));let c=n(e.concat([l.update(o),l.final()])),h=n(l.getAuthTag());return`${r}.${s}.${n(u)}.${c}.${h}`}function c(r,n,i,s,o,a){let u=t.createDecipheriv(`id-aes${a}-GCM`,s,o);return u.setAutoPadding(!1),u.setAAD(n),u.setAuthTag(i),e.concat([u.update(r),u.final()])}function h(r,i,s,o,a){let u=t.randomBytes(16),l=a>>3,c=t.createCipheriv(`AES-${a}-CBC`,i.slice(l),u),h=e.concat([c.update(o),c.final()]),d=r.length<<3,f=e.from(("000000000000000"+d.toString(16)).slice(-16),"hex"),p=t.createHmac("SHA"+(a<<1),i.slice(0,l));p.update(e.from(r)).update(u).update(h).update(f);let m=n(p.digest().slice(0,l));return`${r}.${s}.${n(u)}.${n(h)}.${m}`}function d(r,n,i,s,o,a){let u=a>>3,l=n.length<<3,c=e.from(("000000000000000"+l.toString(16)).slice(-16),"hex"),h=t.createHmac("SHA"+(a<<1),s.slice(0,u));if(h.update(n).update(o).update(r).update(c),!t.timingSafeEqual(h.digest().slice(0,u),i))throw new Error("Authentication of encrypted data failed");let d=s.slice(u),f=t.createDecipheriv(`AES-${a}-CBC`,d,o);return e.concat([f.update(r),f.final()])}function f(r,i){if(i instanceof e)i=i.toString();else if("string"!=typeof i)throw new TypeError("Key must be a buffer or a string");if(!i.includes("-----BEGIN")||!i.includes("KEY-----")&&!i.includes("CERTIFICATE-----"))throw new TypeError("Key must be a PEM formatted RSA public key");let s={key:i,padding:t.constants.RSA_PKCS1_OAEP_PADDING};return n(t.publicEncrypt(s,r))}function p(r,n){if(n instanceof e&&(n=n.toString()),"string"!=typeof n||!n.includes("-----BEGIN")||!n.includes("KEY-----"))throw new TypeError("Key must be a PEM formatted RSA private key");let i={key:n,padding:t.constants.RSA_PKCS1_OAEP_PADDING};return t.privateDecrypt(i,r)}function m(r,i,s){let o=s>>3;if("string"==typeof i)i=e.from(i,"base64");else if(!(i instanceof e))throw new TypeError("Key must be a buffer or a base64-encoded string");if(i.length<o)throw new TypeError(`Key length must be at least ${o} bytes`);i=i.slice(0,o);let a=[];for(let e=0;e<r.length;e+=8)a.push(r.slice(e,e+8));let u=e.alloc(16),l=e.from("A6A6A6A6A6A6A6A6","hex"),c=1;for(let n=0;n<6;n++)for(let r=0;r<a.length;r++){let n=t.createCipheriv("AES"+s,i,u),o=("000000000000000"+c.toString(16)).slice(-16),h=n.update(e.concat([l,a[r]]));l=e.from(o,"hex");for(let e=0;e<8;e++)l[e]^=h[e];a[r]=h.slice(8,16),c++}return n(e.concat([l].concat(a)))}function y(r,n,i){let s=i>>3;if("string"==typeof n)n=e.from(n,"base64");else if(!(n instanceof e))throw new TypeError("Key must be a buffer or a base64 string");if(n.length<s)throw new TypeError(`Key must be at least ${s} bytes`);n=n.slice(0,s);let o=r.slice(0,8),a=[];for(let e=8;e<r.length;e+=8)a.push(r.slice(e,e+8));let u=e.alloc(16),l=6*a.length;for(let c=5;c>=0;c--)for(let r=a.length-1;r>=0;r--){let s=("000000000000000"+l.toString(16)).slice(-16);s=e.from(s,"hex");for(let e=0;e<8;e++)o[e]^=s[e];let c=t.createDecipheriv("AES"+i,n,u).update(e.concat([o,a[r],u]));o=c.slice(0,8),a[r]=c.slice(8,16),l--}if(!o.equals(e.from("A6A6A6A6A6A6A6A6","hex")))throw new Error("Key unwrapping failed");return e.concat(a)}Hl.generate=(i,u,l,...c)=>{let h,d,f={alg:i,enc:u};if(c[0].constructor!==Object)h=c[0],d="function"==typeof c[1]?c[1]:void 0;else if(f.kid=c[1],h=c[0][c[1]],d="function"==typeof c[2]?c[2]:void 0,!h)return r(new TypeError("Invalid key identifier"),null,d);let p="string"==typeof i?i.match(s):null;if(!p||p[2]&&+p[2]!=2*p[4]){let e=new TypeError("Unrecognized key management algorithm");return r(e,null,d)}let m,y="string"==typeof u?u.match(o):null;if(!y||y[3]&&+y[3]!=2*y[1]){let e=new TypeError("Unrecognized content encryption algorithm");return r(e,null,d)}if(p[2]){let r=t.randomBytes(16);if(f.p2c=1024,f.p2s=n(r),m=e.concat([e.from(i),e.from([0]),r]),!d){let e=Number(p[2]);h=t.pbkdf2Sync(h,m,f.p2c,e>>4,"sha"+e)}}let g=n(e.from(JSON.stringify(f)));if(!p[2]||!d)return a(p,y,g,l,h,d);let v=Number(p[2]);t.pbkdf2(h,m,f.p2c,v>>4,"sha"+v,(e,t)=>{if(e)return d(e);a(p,y,g,l,t,d)})},Hl.verify=(n,i,a)=>{if(n.error)return r(null,n,a);if("string"!=typeof n.header.alg)return n.error={message:"Missing or invalid alg claim in header"},r(null,n,a);if("string"!=typeof n.header.enc)return n.error={message:"Missing or invalid enc claim in header"},r(null,n,a);let l=n.header.alg.match(s);if(!l||l[2]&&+l[2]!=2*l[4])return n.error={message:"Unrecognized key management algorithm "+n.header.alg},r(null,n,a);if(n.algList&&!n.algList.includes(n.header.alg))return n.error={message:"Unwanted key management algorithm "+n.header.alg},r(null,n,a);let c,h,d=n.header.enc.match(o);if(!d||d[3]&&+d[3]!=2*d[1])return n.error={message:"Unrecognized content encryption algorithm "+n.header.enc},r(null,n,a);if(n.encList&&!n.encList.includes(n.header.enc))return n.error={message:"Unwanted content encryption algorithm "+n.header.enc},r(null,n,a);if(l[2]){if(h=n.header.p2c,!Number.isInteger(h)||h<1||h>16384)return n.error={message:"Missing or invalid p2c claim in header"},r(null,n,a);if(!a&&h>1024)return n.error={message:"p2c value too large for synchronous mode"},r(null,n,a);if("string"!=typeof n.header.p2s)return n.error={message:"Missing or invalid p2s claim in header"},r(null,n,a);let s=e.from(n.header.p2s,"base64"),o=n.header.alg;if(c=e.concat([e.from(o),e.from([0]),s]),!a){let e=Number(l[2]);i=t.pbkdf2Sync(i,c,h,e>>4,"sha"+e)}}if(!l[2]||!a)return u(n,l,d,i,a);let f=Number(l[2]);t.pbkdf2(i,c,h,f>>4,"sha"+f,(e,t)=>{if(e)return a(e);u(n,l,d,t,a)})}}).call(this,require("buffer").Buffer);var Ql={};(function(e){const{responder:t}=Bl;function r(t){if(this.parts="string"==typeof t?t.split("."):[],3===this.parts.length)this.type="JWS";else{if(5!==this.parts.length)return void(this.error={message:"Invalid token"});this.type="JWE"}try{this.header=JSON.parse(e.from(this.parts[0],"base64"))}catch(error){return void(this.error={message:"Non parsable header. "+error.message})}if("JWS"===this.type)try{this.payload=JSON.parse(e.from(this.parts[1],"base64"))}catch(error){this.error={message:"Non parsable payload. "+error.message}}}Ql.generate=(e,...t)=>{if(t[0].constructor===Object)return zl.generate(e,...t);if(t[1].constructor===Object)return Hl.generate(e,...t);let r=t.length-1;if(!(r>1&&r<5&&"function"==typeof t[r]))throw error;t[r](error)},Ql.parse=e=>new r(e),r.prototype.setAlgorithmList=function(e,t){return"string"==typeof e?this.algList=[e]:Array.isArray(e)&&(this.algList=e),"string"==typeof t?this.encList=[t]:Array.isArray(t)&&(this.encList=t),this},r.prototype.setTokenLifetime=function(e){return Number.isInteger(e)&&e>0&&(this.lifetime=e),this},r.prototype.setAudience=function(e){return"string"==typeof e?this.audList=[e]:Array.isArray(e)&&(this.audList=e),this},r.prototype.setIssuer=function(e){return"string"==typeof e?this.issList=[e]:Array.isArray(e)&&(this.issList=e),this},r.prototype.verify=function(e,r){if(r="function"==typeof r?r:void 0,this.error)return t(null,this,r);let n;if(e.constructor!==Object)n=e;else{if(void 0===this.header.kid)return this.error={message:"Missing kid claim in header"},t(null,this,r);if(void 0===e[this.header.kid])return this.error={message:"Key with id not found",kid:this.header.kid},t(null,this,r);n=e[this.header.kid]}return("JWS"===this.type?zl.verify:Hl.verify)(this,n,r)}}).call(this,require("buffer").Buffer);var Wl={};(function(e){const t=e.env.PERSISTR_SERVER_SECRET;Wl={encode:async function(e,r="Bearer"){return new Promise((function(n,i){Ql.generate("PBES2-HS512+A256KW","A256GCM",e,t,(e,t)=>{e?i(new cs.TokenGenerationFailed({error:e})):t.error?i(new cs.TokenGenerationFailed({error:t.error})):n([r,t].join(" ").trim())})}))},decode:function(e,r="Bearer"){return new Promise((function(n,i){try{e||i(new cs.InvalidAuthToken({auth:e}));const s=e.split(" ");if(s[0]!==r&&!s[1])return void i(new cs.InvalidAuthToken({auth:e}));const o=s[1];Ql.parse(o).setAlgorithmList("PBES2-HS512+A256KW","A256GCM").setIssuer(["api.persistr.com"]).verify(t,(t,s)=>{if(t)i(new cs.InvalidAuthToken({auth:e,error:t}));else if(s.error)i(new cs.InvalidAuthToken({auth:e,error:s.error}));else if("Bearer"===r){if(!Fl.is(s).valid("auth/bearer"))return void i(new cs.InvalidBearerToken({token:s}));n({id:s.payload.id,username:s.payload.sub,name:s.payload.name,dbs:s.payload.dbs||[]})}else if("Apikey"===r){if(!Fl.is(s).valid("auth/apikey"))return void i(new cs.InvalidApiKeyToken({token:s}));n({user:s.payload.user.toString("utf8"),ts:s.payload.ts})}else i(new cs.UnknownTokenScheme({scheme:r}))})}catch(error){i(new cs.InvalidAuthToken({auth:e}))}}))}}}).call(this,require("_process"));const{DateTime:Jl}=Q;var Kl={generate:async function(e){return await Wl.encode({iss:"api.persistr.com",user:e,ts:Jl.local().toMillis()},"")}},Gl={};(function(e){"use strict";var t=require("crypto");Gl=function(r){return{hash:function(n,i){if(void 0===i&&n instanceof Function&&(i=n,n=void 0),!r)return i("No password provided");"string"==typeof n&&(n=new e(n,"hex"));var s=function(){t.pbkdf2(r,n,1e4,64,"sha1",(function(e,t){if(e)return i(e);var r="pbkdf2$10000$"+t.toString("hex")+"$"+n.toString("hex");i(null,r)}))};n?s():t.randomBytes(64,(function(e,t){if(e)return i(e);n=t,s()}))},verifyAgainst:function(e,t){if(!e||!r)return t(null,!1);var n=e.split("$");return 4===n.length&&n[2]&&n[3]?"pbkdf2"!==n[0]||n[1]!==1e4.toString()?t("Wrong algorithm and/or iterations"):void this.hash(n[3],(function(r,n){if(r)return t(r);t(null,n===e)})):t("Hash not formatted correctly")}}}}).call(this,require("buffer").Buffer);var Yl=Gl,Zl={jwt:Wl,keys:Kl,passwords:{hash:async function(e){return new Promise((function(t,r){Yl(e).hash((function(e,r){t(r)}))}))},verify:async function({password:e,against:t}){return new Promise((function(r,n){""!==e||""!==t?Yl(e).verifyAgainst(t,(function(e,t){r(!e&&!!t)})):r(!0)}))}}},Xl={};(function(e){const t=require("fs"),r=require("path"),n=[],i=(e,n,s)=>{const o=r.resolve(e,...n);t.readdirSync(o).forEach(a=>{if(t.statSync(`${o}/${a}`).isDirectory())return i(e,[...n,a],s);a.toLowerCase().endsWith(".js")&&s(e,n,o,a,r.resolve(o,a))})};i(r.resolve(e),[],(e,t,i,s,o)=>{const a=r.parse(s);".js"===a.ext&&"index"!==a.name&&n.push({name:t.join("."),method:a.name,module:require(o)})}),Xl=n}).call(this,"/node_modules/@persistr/store/src/entities");var ec={};Object.defineProperty(ec,"__esModule",{value:!0}),ec.TimeoutError=class extends Error{};var tc={};Object.defineProperty(tc,"__esModule",{value:!0}),tc.PromiseInspection=class{constructor(e){this._value=e.value,this._error=e.error}value(){return this._value}reason(){return this._error}isRejected(){return!!this._error}isFulfilled(){return!!this._value}};var rc={};function nc(e){return"number"==typeof e&&e===Math.round(e)&&e>0}Object.defineProperty(rc,"__esModule",{value:!0}),rc.defer=function(){let e=null,t=null;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}},rc.now=function(){return Date.now()},rc.duration=function(e,t){return Math.abs(t-e)},rc.checkOptionalTime=function(e){return void 0===e||nc(e)},rc.checkRequiredTime=nc,rc.delay=function(e){return new Promise(t=>setTimeout(t,e))},rc.reflect=function(e){return e.then(e=>new tc.PromiseInspection({value:e})).catch(e=>new tc.PromiseInspection({error:e}))},rc.tryPromise=function(e){try{const t=e();return Promise.resolve(t)}catch(t){return Promise.reject(t)}};var ic={};Object.defineProperty(ic,"__esModule",{value:!0}),ic.PendingOperation=class{constructor(e){var t,r;this.timeoutMillis=e,this.deferred=rc.defer(),this.possibleTimeoutCause=null,this.isRejected=!1,this.promise=(t=this.deferred.promise,r=e,new Promise((e,n)=>{const i=setTimeout(()=>n(new ec.TimeoutError),r);t.then(t=>{clearTimeout(i),e(t)}).catch(e=>{clearTimeout(i),n(e)})})).catch(e=>(e instanceof ec.TimeoutError&&(e=this.possibleTimeoutCause?new ec.TimeoutError(this.possibleTimeoutCause.message):new ec.TimeoutError("operation timed out for an unknown reason")),this.isRejected=!0,Promise.reject(e)))}abort(){this.reject(new Error("aborted"))}reject(e){this.deferred.reject(e)}resolve(e){this.deferred.resolve(e)}};var sc={};Object.defineProperty(sc,"__esModule",{value:!0});class oc{constructor(e){this.resource=e,this.resource=e,this.timestamp=rc.now(),this.deferred=rc.defer()}get promise(){return this.deferred.promise}resolve(){return this.deferred.resolve(void 0),new oc(this.resource)}}sc.Resource=oc;var ac={};Object.defineProperty(ac,"__esModule",{value:!0});const uc=require("events"),lc=require("timers");function cc(e,t){const r=e.indexOf(t);return-1!==r&&(e.splice(r,1),!0)}ac.Pool=class{constructor(e){if(this.destroyed=!1,this.emitter=new uc.EventEmitter,!(e=e||{}).create)throw new Error("Tarn: opt.create function most be provided");if(!e.destroy)throw new Error("Tarn: opt.destroy function most be provided");if("number"!=typeof e.min||e.min<0||e.min!==Math.round(e.min))throw new Error("Tarn: opt.min must be an integer >= 0");if("number"!=typeof e.max||e.max<=0||e.max!==Math.round(e.max))throw new Error("Tarn: opt.max must be an integer > 0");if(e.min>e.max)throw new Error("Tarn: opt.max is smaller than opt.min");if(!rc.checkOptionalTime(e.acquireTimeoutMillis))throw new Error("Tarn: invalid opt.acquireTimeoutMillis "+JSON.stringify(e.acquireTimeoutMillis));if(!rc.checkOptionalTime(e.createTimeoutMillis))throw new Error("Tarn: invalid opt.createTimeoutMillis "+JSON.stringify(e.createTimeoutMillis));if(!rc.checkOptionalTime(e.destroyTimeoutMillis))throw new Error("Tarn: invalid opt.destroyTimeoutMillis "+JSON.stringify(e.destroyTimeoutMillis));if(!rc.checkOptionalTime(e.idleTimeoutMillis))throw new Error("Tarn: invalid opt.idleTimeoutMillis "+JSON.stringify(e.idleTimeoutMillis));if(!rc.checkOptionalTime(e.reapIntervalMillis))throw new Error("Tarn: invalid opt.reapIntervalMillis "+JSON.stringify(e.reapIntervalMillis));if(!rc.checkOptionalTime(e.createRetryIntervalMillis))throw new Error("Tarn: invalid opt.createRetryIntervalMillis "+JSON.stringify(e.createRetryIntervalMillis));const t={create:!0,validate:!0,destroy:!0,log:!0,min:!0,max:!0,acquireTimeoutMillis:!0,createTimeoutMillis:!0,destroyTimeoutMillis:!0,idleTimeoutMillis:!0,reapIntervalMillis:!0,createRetryIntervalMillis:!0,propagateCreateError:!0};for(const r of Object.keys(e))if(!t[r])throw new Error("Tarn: unsupported option opt."+r);this.creator=e.create,this.destroyer=e.destroy,this.validate="function"==typeof e.validate?e.validate:()=>!0,this.log=e.log||(()=>{}),this.acquireTimeoutMillis=e.acquireTimeoutMillis||3e4,this.createTimeoutMillis=e.createTimeoutMillis||3e4,this.destroyTimeoutMillis=e.destroyTimeoutMillis||5e3,this.idleTimeoutMillis=e.idleTimeoutMillis||3e4,this.reapIntervalMillis=e.reapIntervalMillis||1e3,this.createRetryIntervalMillis=e.createRetryIntervalMillis||200,this.propagateCreateError=!!e.propagateCreateError,this.min=e.min,this.max=e.max,this.used=[],this.free=[],this.pendingCreates=[],this.pendingAcquires=[],this.pendingDestroys=[],this.pendingValidations=[],this.destroyed=!1,this.interval=null,this.eventId=1}numUsed(){return this.used.length}numFree(){return this.free.length}numPendingAcquires(){return this.pendingAcquires.length}numPendingValidations(){return this.pendingValidations.length}numPendingCreates(){return this.pendingCreates.length}acquire(){const e=this.eventId++;this._executeEventHandlers("acquireRequest",e);const t=new ic.PendingOperation(this.acquireTimeoutMillis);return this.pendingAcquires.push(t),t.promise=t.promise.then(t=>(this._executeEventHandlers("acquireSuccess",e,t),t)).catch(r=>(this._executeEventHandlers("acquireFail",e,r),cc(this.pendingAcquires,t),Promise.reject(r))),this._tryAcquireOrCreate(),t}release(e){this._executeEventHandlers("release",e);for(let t=0,r=this.used.length;t<r;++t){const r=this.used[t];if(r.resource===e)return this.used.splice(t,1),this.free.push(r.resolve()),this._tryAcquireOrCreate(),!0}return!1}isEmpty(){return 0===[this.numFree(),this.numUsed(),this.numPendingAcquires(),this.numPendingValidations(),this.numPendingCreates()].reduce((e,t)=>e+t)}check(){const e=rc.now(),t=[],r=this.min-this.used.length,n=this.free.length-r;let i=0;this.free.forEach(r=>{rc.duration(e,r.timestamp)>=this.idleTimeoutMillis&&i<n?(i++,this._destroy(r.resource)):t.push(r)}),this.free=t,this.isEmpty()&&this._stopReaping()}destroy(){const e=this.eventId++;return this._executeEventHandlers("poolDestroyRequest",e),this._stopReaping(),this.destroyed=!0,rc.reflect(Promise.all(this.pendingCreates.map(e=>rc.reflect(e.promise))).then(()=>new Promise((e,t)=>{if(0===this.numPendingValidations())return void e();const r=setInterval(()=>{0===this.numPendingValidations()&&(lc.clearInterval(r),e())},100)})).then(()=>Promise.all(this.used.map(e=>rc.reflect(e.promise)))).then(()=>Promise.all(this.pendingAcquires.map(e=>(e.abort(),rc.reflect(e.promise))))).then(()=>Promise.all(this.free.map(e=>rc.reflect(this._destroy(e.resource))))).then(()=>Promise.all(this.pendingDestroys.map(e=>e.promise))).then(()=>{this.free=[],this.pendingAcquires=[]})).then(t=>(this._executeEventHandlers("poolDestroySuccess",e),this.emitter.removeAllListeners(),t))}on(e,t){this.emitter.on(e,t)}removeListener(e,t){this.emitter.removeListener(e,t)}removeAllListeners(e){this.emitter.removeAllListeners(e)}_tryAcquireOrCreate(){this.destroyed||(this._hasFreeResources()?this._doAcquire():this._shouldCreateMoreResources()&&this._doCreate())}_hasFreeResources(){return this.free.length>0}_doAcquire(){for(;this._canAcquire();){const e=this.pendingAcquires.shift(),t=this.free.pop();if(void 0===t||void 0===e){const e="this.free was empty while trying to acquire resource";throw this.log("Tarn: "+e,"warn"),new Error("Internal error, should never happen. "+e)}this.pendingValidations.push(e),this.used.push(t);const r=new ic.PendingOperation(this.acquireTimeoutMillis);e.promise.catch(e=>{r.abort()}),r.promise.catch(e=>(this.log("Tarn: resource validator threw an exception "+e.stack,"warn"),!1)).then(r=>{try{r&&!e.isRejected?(this._startReaping(),e.resolve(t.resource)):(cc(this.used,t),r?this.free.push(t):(this._destroy(t.resource),setTimeout(()=>{this._tryAcquireOrCreate()},0)),e.isRejected||this.pendingAcquires.unshift(e))}finally{cc(this.pendingValidations,e)}}),this._validateResource(t.resource).then(e=>{r.resolve(e)}).catch(e=>{r.reject(e)})}}_canAcquire(){return this.free.length>0&&this.pendingAcquires.length>0}_validateResource(e){try{return Promise.resolve(this.validate(e))}catch(t){return Promise.reject(t)}}_shouldCreateMoreResources(){return this.used.length+this.pendingCreates.length<this.max&&this.pendingCreates.length<this.pendingAcquires.length}_doCreate(){const e=this.pendingAcquires.slice();this._create().promise.then(()=>(this._tryAcquireOrCreate(),null)).catch(t=>{this.propagateCreateError&&0!==this.pendingAcquires.length&&this.pendingAcquires[0].reject(t),e.forEach(e=>{e.possibleTimeoutCause=t}),rc.delay(this.createRetryIntervalMillis).then(()=>this._tryAcquireOrCreate())})}_create(){const e=this.eventId++;this._executeEventHandlers("createRequest",e);const t=new ic.PendingOperation(this.createTimeoutMillis);var r;return t.promise=t.promise.catch(r=>{throw cc(this.pendingCreates,t)&&this._executeEventHandlers("createFail",e,r),r}),this.pendingCreates.push(t),(r=this.creator,new Promise((e,t)=>{const n=(r,n)=>{r?t(r):e(n)};rc.tryPromise(()=>r(n)).then(t=>{t&&e(t)}).catch(e=>{t(e)})})).then(r=>t.isRejected?(this.destroyer(r),null):(cc(this.pendingCreates,t),this.free.push(new sc.Resource(r)),t.resolve(r),this._executeEventHandlers("createSuccess",e,r),null)).catch(r=>(t.isRejected||(cc(this.pendingCreates,t)&&this._executeEventHandlers("createFail",e,r),t.reject(r)),null)),t}_destroy(e){const t=this.eventId++;this._executeEventHandlers("destroyRequest",t,e);const r=new ic.PendingOperation(this.destroyTimeoutMillis);return Promise.resolve().then(()=>this.destroyer(e)).then(()=>{r.resolve(e)}).catch(e=>{r.reject(e)}),this.pendingDestroys.push(r),r.promise.then(r=>(this._executeEventHandlers("destroySuccess",t,e),r)).catch(r=>this._logDestroyerError(t,e,r)).then(e=>{const t=this.pendingDestroys.findIndex(e=>e===r);return this.pendingDestroys.splice(t,1),e})}_logDestroyerError(e,t,r){this._executeEventHandlers("destroyFail",e,t,r),this.log("Tarn: resource destroyer threw an exception "+r.stack,"warn")}_startReaping(){this.interval||(this._executeEventHandlers("startReaping"),this.interval=setInterval(()=>this.check(),this.reapIntervalMillis))}_stopReaping(){null!==this.interval&&(this._executeEventHandlers("stopReaping"),lc.clearInterval(this.interval)),this.interval=null}_executeEventHandlers(e,...t){this.emitter.listeners(e).forEach(r=>{try{r(...t)}catch(n){this.log(`Tarn: event handler "${e}" threw an exception ${n.stack}`,"warn")}})}};var hc={};function dc(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}Object.defineProperty(hc,"__esModule",{value:!0}),hc.Pool=ac.Pool,hc.TimeoutError=ec.TimeoutError,hc={Pool:ac.Pool,TimeoutError:ec.TimeoutError};var fc={};(function(e){const t=/[\0\b\t\n\r\x1a"'\\]/g,r={"\0":"\\0","\b":"\\b","\t":"\\t","\n":"\\n","\r":"\\r","\x1a":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};function n(e){return function t(r,n={}){return e(r,t,n)}}function i(e,t,r){return e&&"function"==typeof e.toSQL?e.toSQL(r):JSON.stringify(e)}function s(e,t,r){let n="";for(let i=0;i<e.length;i++){const o=e[i];Array.isArray(o)?n+=(0===i?"":", ")+"("+s(o,t,r)+")":n+=(0===i?"":", ")+t(o,r)}return n}function o(e){return"X"+a(e.toString("hex"))}function a(e,n,i){let s,o=t.lastIndex=0,a="";for(;s=t.exec(e);)a+=e.slice(o,s.index)+r[s[0]],o=t.lastIndex;return 0===o?"'"+e+"'":o<e.length?"'"+a+e.slice(o)+"'":"'"+a+"'"}function u(e,t,r={}){const n=r.timeZone||"local",i=new Date(e);let s,o,a,u,c,h,d;if("local"===n)s=i.getFullYear(),o=i.getMonth()+1,a=i.getDate(),u=i.getHours(),c=i.getMinutes(),h=i.getSeconds(),d=i.getMilliseconds();else{const e=function(e){if("Z"===e)return 0;const t=e.match(/([+\-\s])(\d\d):?(\d\d)?/);return!!t&&("-"==t[1]?-1:1)*(parseInt(t[2],10)+(t[3]?parseInt(t[3],10):0)/60)*60}(n);!1!==e&&0!==e&&i.setTime(i.getTime()+6e4*e),s=i.getUTCFullYear(),o=i.getUTCMonth()+1,a=i.getUTCDate(),u=i.getUTCHours(),c=i.getUTCMinutes(),h=i.getUTCSeconds(),d=i.getUTCMilliseconds()}return l(s,4)+"-"+l(o,2)+"-"+l(a,2)+" "+l(u,2)+":"+l(c,2)+":"+l(h,2)+"."+l(d,3)}function l(e,t){for(e=e.toString();e.length<t;)e="0"+e;return e}fc={arrayToList:s,bufferToString:o,dateToString:u,escapeString:a,charsRegex:t,charsMap:r,escapeObject:i,makeEscape:function(t={}){const r=t.escapeDate||u,l=t.escapeArray||s,c=t.escapeBuffer||o,h=t.escapeString||a,d=t.escapeObject||i,f=t.wrap||n;function p(t,n,i){if(null==t)return"NULL";switch(typeof t){case"boolean":return t?"true":"false";case"number":return t+"";case"object":if(!(t instanceof Date))return Array.isArray(t)?l(t,n,i):e.isBuffer(t)?c(t,n,i):d(t,n,i);t=r(t,n,i)}return h(t,n,i)}return f?f(p):p}}}).call(this,{isBuffer:function(e){return null!=e&&(dc(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&dc(e.slice(0,0))}(e)||!!e._isBuffer)}});var pc=function(e,t){return e===t||e!=e&&t!=t},mc=function(e,t){for(var r=e.length;r--;)if(pc(e[r][0],t))return r;return-1},yc=Array.prototype.splice,gc={};function vc(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}vc.prototype.clear=function(){this.__data__=[],this.size=0},vc.prototype.delete=function(e){var t=this.__data__,r=mc(t,e);return!(r<0||(r==t.length-1?t.pop():yc.call(t,r,1),--this.size,0))},vc.prototype.get=function(e){var t=this.__data__,r=mc(t,e);return r<0?void 0:t[r][1]},vc.prototype.has=function(e){return mc(this.__data__,e)>-1},vc.prototype.set=function(e,t){var r=this.__data__,n=mc(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},gc=vc;var bc={};(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;bc=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _c,wc="object"==typeof self&&self&&self.Object===Object&&self,Ec=bc||wc||Function("return this")(),Cc=Ec.Symbol,Nc=Object.prototype,$c=Nc.hasOwnProperty,xc=Nc.toString,Tc=Cc?Cc.toStringTag:void 0,Oc=Object.prototype.toString,Sc=Cc?Cc.toStringTag:void 0,kc=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Sc&&Sc in Object(e)?function(e){var t=$c.call(e,Tc),r=e[Tc];try{e[Tc]=void 0;var n=!0}catch(Zv){}var i=xc.call(e);return n&&(t?e[Tc]=r:delete e[Tc]),i}(e):function(e){return Oc.call(e)}(e)},jc=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Ac=function(e){if(!jc(e))return!1;var t=kc(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Rc=Ec["__core-js_shared__"],Ic=(_c=/[^.]+$/.exec(Rc&&Rc.keys&&Rc.keys.IE_PROTO||""))?"Symbol(src)_1."+_c:"",Pc=Function.prototype.toString,qc=function(e){if(null!=e){try{return Pc.call(e)}catch(Zv){}try{return e+""}catch(Zv){}}return""},Lc=/^\[object .+?Constructor\]$/,Mc=Function.prototype,Dc=Object.prototype,Fc=Mc.toString,Uc=Dc.hasOwnProperty,Bc=RegExp("^"+Fc.call(Uc).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vc=function(e){return!(!jc(e)||(t=e,Ic&&Ic in t))&&(Ac(e)?Bc:Lc).test(qc(e));var t},zc=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Vc(r)?r:void 0},Hc=zc(Ec,"Map"),Qc=zc(Object,"create"),Wc=Object.prototype.hasOwnProperty,Jc=Object.prototype.hasOwnProperty,Kc={};function Gc(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gc.prototype.clear=function(){this.__data__=Qc?Qc(null):{},this.size=0},Gc.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Gc.prototype.get=function(e){var t=this.__data__;if(Qc){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Wc.call(t,e)?t[e]:void 0},Gc.prototype.has=function(e){var t=this.__data__;return Qc?void 0!==t[e]:Jc.call(t,e)},Gc.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Qc&&void 0===t?"__lodash_hash_undefined__":t,this},Kc=Gc;var Yc=function(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map},Zc={};function Xc(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xc.prototype.clear=function(){this.size=0,this.__data__={hash:new Kc,map:new(Hc||gc),string:new Kc}},Xc.prototype.delete=function(e){var t=Yc(this,e).delete(e);return this.size-=t?1:0,t},Xc.prototype.get=function(e){return Yc(this,e).get(e)},Xc.prototype.has=function(e){return Yc(this,e).has(e)},Xc.prototype.set=function(e,t){var r=Yc(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Zc=Xc;var eh={};function th(e){var t=this.__data__=new gc(e);this.size=t.size}th.prototype.clear=function(){this.__data__=new gc,this.size=0},th.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},th.prototype.get=function(e){return this.__data__.get(e)},th.prototype.has=function(e){return this.__data__.has(e)},th.prototype.set=function(e,t){var r=this.__data__;if(r instanceof gc){var n=r.__data__;if(!Hc||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Zc(n)}return r.set(e,t),this.size=r.size,this},eh=th;var rh=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},nh=function(){try{var e=zc(Object,"defineProperty");return e({},"",{}),e}catch(Zv){}}(),ih=function(e,t,r){"__proto__"==t&&nh?nh(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},sh=Object.prototype.hasOwnProperty,oh=function(e,t,r){var n=e[t];sh.call(e,t)&&pc(n,r)&&(void 0!==r||t in e)||ih(e,t,r)},ah=function(e,t,r,n){var i=!r;r||(r={});for(var s=-1,o=t.length;++s<o;){var a=t[s],u=n?n(r[a],e[a],a,r,e):void 0;void 0===u&&(u=e[a]),i?ih(r,a,u):oh(r,a,u)}return r},uh=function(e){return null!=e&&"object"==typeof e},lh=function(e){return uh(e)&&"[object Arguments]"==kc(e)},ch=Object.prototype,hh=ch.hasOwnProperty,dh=ch.propertyIsEnumerable,fh=lh(function(){return arguments}())?lh:function(e){return uh(e)&&hh.call(e,"callee")&&!dh.call(e,"callee")},ph=Array.isArray,mh={exports:{}},yh="object"==typeof mh.exports&&mh.exports&&!mh.exports.nodeType&&mh.exports,gh=yh&&mh&&!mh.nodeType&&mh,vh=gh&&gh.exports===yh?Ec.Buffer:void 0,bh=(vh?vh.isBuffer:void 0)||function(){return!1};mh.exports=bh,mh=mh.exports;var _h,wh=/^(?:0|[1-9]\d*)$/,Eh=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&wh.test(e))&&e>-1&&e%1==0&&e<t},Ch=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Nh={};Nh["[object Float32Array]"]=Nh["[object Float64Array]"]=Nh["[object Int8Array]"]=Nh["[object Int16Array]"]=Nh["[object Int32Array]"]=Nh["[object Uint8Array]"]=Nh["[object Uint8ClampedArray]"]=Nh["[object Uint16Array]"]=Nh["[object Uint32Array]"]=!0,Nh["[object Arguments]"]=Nh["[object Array]"]=Nh["[object ArrayBuffer]"]=Nh["[object Boolean]"]=Nh["[object DataView]"]=Nh["[object Date]"]=Nh["[object Error]"]=Nh["[object Function]"]=Nh["[object Map]"]=Nh["[object Number]"]=Nh["[object Object]"]=Nh["[object RegExp]"]=Nh["[object Set]"]=Nh["[object String]"]=Nh["[object WeakMap]"]=!1,_h=function(e){return uh(e)&&Ch(e.length)&&!!Nh[kc(e)]};var $h=function(e){return function(t){return e(t)}},xh={exports:{}},Th="object"==typeof xh.exports&&xh.exports&&!xh.exports.nodeType&&xh.exports,Oh=Th&&xh&&!xh.nodeType&&xh,Sh=Oh&&Oh.exports===Th&&bc.process,kh=function(){try{return Oh&&Oh.require&&Oh.require("util").types||Sh&&Sh.binding&&Sh.binding("util")}catch(Zv){}}();xh.exports=kh;var jh=(xh=xh.exports)&&xh.isTypedArray,Ah=jh?$h(jh):_h,Rh=Object.prototype.hasOwnProperty,Ih=function(e,t){var r=ph(e),n=!r&&fh(e),i=!r&&!n&&mh(e),s=!r&&!n&&!i&&Ah(e),o=r||n||i||s,a=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],u=a.length;for(var l in e)!t&&!Rh.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Eh(l,u))||a.push(l);return a},Ph=Object.prototype,qh=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ph)},Lh=function(e,t){return function(r){return e(t(r))}},Mh=Lh(Object.keys,Object),Dh=Object.prototype.hasOwnProperty,Fh=function(e){if(!qh(e))return Mh(e);var t=[];for(var r in Object(e))Dh.call(e,r)&&"constructor"!=r&&t.push(r);return t},Uh=function(e){return null!=e&&Ch(e.length)&&!Ac(e)},Bh=function(e){return Uh(e)?Ih(e):Fh(e)},Vh=Object.prototype.hasOwnProperty,zh=function(e){if(!jc(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=qh(e),r=[];for(var n in e)("constructor"!=n||!t&&Vh.call(e,n))&&r.push(n);return r},Hh=function(e){return Uh(e)?Ih(e,!0):zh(e)},Qh={exports:{}},Wh="object"==typeof Qh.exports&&Qh.exports&&!Qh.exports.nodeType&&Qh.exports,Jh=Wh&&Qh&&!Qh.nodeType&&Qh,Kh=Jh&&Jh.exports===Wh?Ec.Buffer:void 0,Gh=Kh?Kh.allocUnsafe:void 0;Qh.exports=function(e,t){if(t)return e.slice();var r=e.length,n=Gh?Gh(r):new e.constructor(r);return e.copy(n),n},Qh=Qh.exports;var Yh=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},Zh=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s},Xh=function(){return[]},ed=Object.prototype.propertyIsEnumerable,td=Object.getOwnPropertySymbols,rd=td?function(e){return null==e?[]:(e=Object(e),Zh(td(e),(function(t){return ed.call(e,t)})))}:Xh,nd=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},id=Lh(Object.getPrototypeOf,Object),sd=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)nd(t,rd(e)),e=id(e);return t}:Xh,od=function(e,t,r){var n=t(e);return ph(e)?n:nd(n,r(e))},ad=function(e){return od(e,Bh,rd)},ud=function(e){return od(e,Hh,sd)},ld=zc(Ec,"DataView"),cd=zc(Ec,"Promise"),hd=zc(Ec,"Set"),dd=zc(Ec,"WeakMap"),fd={},pd=qc(ld),md=qc(Hc),yd=qc(cd),gd=qc(hd),vd=qc(dd),bd=kc;(ld&&"[object DataView]"!=bd(new ld(new ArrayBuffer(1)))||Hc&&"[object Map]"!=bd(new Hc)||cd&&"[object Promise]"!=bd(cd.resolve())||hd&&"[object Set]"!=bd(new hd)||dd&&"[object WeakMap]"!=bd(new dd))&&(bd=function(e){var t=kc(e),r="[object Object]"==t?e.constructor:void 0,n=r?qc(r):"";if(n)switch(n){case pd:return"[object DataView]";case md:return"[object Map]";case yd:return"[object Promise]";case gd:return"[object Set]";case vd:return"[object WeakMap]"}return t}),fd=bd;var _d,wd=Object.prototype.hasOwnProperty,Ed=Ec.Uint8Array,Cd=function(e){var t=new e.constructor(e.byteLength);return new Ed(t).set(new Ed(e)),t},Nd=/\w*$/,$d=Cc?Cc.prototype:void 0,xd=$d?$d.valueOf:void 0,Td=function(e,t){var r=t?Cd(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},Od=function(e,t,r){var n,i,s,o=e.constructor;switch(t){case"[object ArrayBuffer]":return Cd(e);case"[object Boolean]":case"[object Date]":return new o(+e);case"[object DataView]":return function(e,t){var r=t?Cd(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Td(e,r);case"[object Map]":return new o;case"[object Number]":case"[object String]":return new o(e);case"[object RegExp]":return(s=new(i=e).constructor(i.source,Nd.exec(i))).lastIndex=i.lastIndex,s;case"[object Set]":return new o;case"[object Symbol]":return n=e,xd?Object(xd.call(n)):{}}},Sd=Object.create,kd=function(){function e(){}return function(t){if(!jc(t))return{};if(Sd)return Sd(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),jd=function(e){return"function"!=typeof e.constructor||qh(e)?{}:kd(id(e))},Ad=xh&&xh.isMap,Rd=Ad?$h(Ad):function(e){return uh(e)&&"[object Map]"==fd(e)},Id=xh&&xh.isSet,Pd=Id?$h(Id):function(e){return uh(e)&&"[object Set]"==fd(e)},qd={};qd["[object Arguments]"]=qd["[object Array]"]=qd["[object ArrayBuffer]"]=qd["[object DataView]"]=qd["[object Boolean]"]=qd["[object Date]"]=qd["[object Float32Array]"]=qd["[object Float64Array]"]=qd["[object Int8Array]"]=qd["[object Int16Array]"]=qd["[object Int32Array]"]=qd["[object Map]"]=qd["[object Number]"]=qd["[object Object]"]=qd["[object RegExp]"]=qd["[object Set]"]=qd["[object String]"]=qd["[object Symbol]"]=qd["[object Uint8Array]"]=qd["[object Uint8ClampedArray]"]=qd["[object Uint16Array]"]=qd["[object Uint32Array]"]=!0,qd["[object Error]"]=qd["[object Function]"]=qd["[object WeakMap]"]=!1,_d=function e(t,r,n,i,s,o){var a,u=1&r,l=2&r,c=4&r;if(n&&(a=s?n(t,i,s,o):n(t)),void 0!==a)return a;if(!jc(t))return t;var h=ph(t);if(h){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&wd.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!u)return Yh(t,a)}else{var d=fd(t),f="[object Function]"==d||"[object GeneratorFunction]"==d;if(mh(t))return Qh(t,u);if("[object Object]"==d||"[object Arguments]"==d||f&&!s){if(a=l||f?{}:jd(t),!u)return l?function(e,t){return ah(e,sd(e),t)}(t,function(e,t){return e&&ah(t,Hh(t),e)}(a,t)):function(e,t){return ah(e,rd(e),t)}(t,function(e,t){return e&&ah(t,Bh(t),e)}(a,t))}else{if(!qd[d])return s?t:{};a=Od(t,d,u)}}o||(o=new eh);var p=o.get(t);if(p)return p;o.set(t,a),Pd(t)?t.forEach((function(i){a.add(e(i,r,n,i,t,o))})):Rd(t)&&t.forEach((function(i,s){a.set(s,e(i,r,n,s,t,o))}));var m=h?void 0:(c?l?ud:ad:l?Hh:Bh)(t);return rh(m||t,(function(i,s){m&&(i=t[s=i]),oh(a,s,e(i,r,n,s,t,o))})),a};var Ld,Md,Dd,Fd=function(e){return e},Ud=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Bd=Math.max,Vd=function(e){return function(){return e}},zd=nh?function(e,t){return nh(e,"toString",{configurable:!0,enumerable:!1,value:Vd(t),writable:!0})}:Fd,Hd=Date.now,Qd=(Ld=zd,Md=0,Dd=0,function(){var e=Hd(),t=16-(e-Dd);if(Dd=e,t>0){if(++Md>=800)return arguments[0]}else Md=0;return Ld.apply(void 0,arguments)}),Wd=function(e,t){return Qd(function(e,t,r){return t=Bd(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=Bd(n.length-t,0),o=Array(s);++i<s;)o[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(o),Ud(e,this,a)}}(e,t,Fd),e+"")},Jd=function(e,t,r){if(!jc(r))return!1;var n=typeof t;return!!("number"==n?Uh(r)&&Eh(t,r.length):"string"==n&&t in r)&&pc(r[t],e)},Kd=Object.prototype,Gd=Kd.hasOwnProperty,Yd=Wd((function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&Jd(t[0],t[1],i)&&(n=1);++r<n;)for(var s=t[r],o=Hh(s),a=-1,u=o.length;++a<u;){var l=o[a],c=e[l];(void 0===c||pc(c,Kd[l])&&!Gd.call(e,l))&&(e[l]=s[l])}return e})),Zd=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},Xd=function(e){return"symbol"==typeof e||uh(e)&&"[object Symbol]"==kc(e)},ef=Cc?Cc.prototype:void 0,tf=ef?ef.toString:void 0,rf=function(e){return null==e?"":function e(t){if("string"==typeof t)return t;if(ph(t))return Zd(t,e)+"";if(Xd(t))return tf?tf.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}(e)},nf=0,sf=function(e){var t=++nf;return rf(e)+t},of={};class af extends Error{constructor(e){super(e),this.name="KnexTimeoutError"}}of.KnexTimeoutError=af,of.timeout=function(e,t){return new Promise((function(r,n){const i=setTimeout((function(){n(new af("operation timed out"))}),t);e.then((function(e){clearTimeout(i),r(e)}),(function(e){clearTimeout(i),n(e)}))}))};var uf={ensureConnectionCallback:function(e){e.client.emit("start",e.builder),e.builder.emit("start",e.builder);const t=e.builder.toSQL();return e.builder._debug&&e.client.logger.debug(t),Array.isArray(t)?e.queryArray(t):e.query(t)},ensureConnectionStreamCallback:function(e,t){try{const r=e.builder.toSQL();if(Array.isArray(r)&&t.hasHandler)throw new Error("The stream may only be used with a single query statement.");return e.client.stream(e.connection,r,t.stream,t.options)}catch(Zv){throw t.stream.emit("error",Zv),Zv}}};const{KnexTimeoutError:lf}=of,{timeout:cf}=of,{ensureConnectionCallback:hf,ensureConnectionStreamCallback:df}=uf;let ff;class pf{constructor(e,t){this.client=e,this.builder=t,this.queries=[],this.connection=void 0}async run(){const e=this;try{const t=await this.ensureConnection(hf);return e.builder.emit("end"),t}catch(t){throw e.builder._events&&e.builder._events.error&&e.builder.emit("error",t),t}}stream(e,t){const r="function"==typeof e&&1===arguments.length,n=r?{}:e,i=r?e:t,s="function"==typeof i;ff=ff||require("stream").Transform;const o=this.builder.queryContext();let a;const u=new ff({objectMode:!0,transform:(e,t,r)=>{r(null,this.client.postProcessResponse(e,o))},destroy(){a&&a.destroy&&a.destroy(new Error("stream destroyed"))}});u.on("pipe",e=>{a=e});const l=this.ensureConnection(df,{options:n,hasHandler:s,stream:u}).catch(e=>{this.connection||u.emit("error",e)});return s?(i(u),l):u}pipe(e,t){return this.stream(t).pipe(e)}async query(e){const{__knexUid:t,__knexTxId:r}=this.connection;this.builder.emit("query",Object.assign({__knexUid:t,__knexTxId:r},e));const n=this,i=this.builder.queryContext();null!==e&&"object"==typeof e&&(e.queryContext=i);let s=this.client.query(this.connection,e);return e.timeout&&(s=cf(s,e.timeout)),s.then(e=>this.client.processResponse(e,n)).then(n=>{const s=this.client.postProcessResponse(n,i);return this.builder.emit("query-response",s,Object.assign({__knexUid:t,__knexTxId:r},e),this.builder),this.client.emit("query-response",s,Object.assign({__knexUid:t,__knexTxId:r},e),this.builder),s}).catch(t=>{if(!(t instanceof lf))return Promise.reject(t);const{timeout:r,sql:n,bindings:i}=e;let s;return e.cancelOnTimeout?s=this.client.cancelQuery(this.connection):(this.connection.__knex__disposed=t,s=Promise.resolve()),s.catch(e=>{throw this.connection.__knex__disposed=t,Object.assign(e,{message:`After query timeout of ${r}ms exceeded, cancelling of query failed.`,sql:n,bindings:i,timeout:r})}).then(()=>{throw Object.assign(t,{message:`Defined query timeout of ${r}ms exceeded when running query.`,sql:n,bindings:i,timeout:r})})}).catch(n=>{throw this.builder.emit("query-error",n,Object.assign({__knexUid:t,__knexTxId:r,queryContext:i},e)),n})}async queryArray(e){if(1===e.length){const t=e[0];if(!t.statementsProducer)return this.query(t);const r=await t.statementsProducer(void 0,this.connection),n=r.sql.map(e=>({sql:e,bindings:t.bindings})),i=r.pre.map(e=>({sql:e,bindings:t.bindings})),s=r.post.map(e=>({sql:e,bindings:t.bindings}));let o=[];await this.queryArray(i);try{await this.client.transaction(async e=>{const t=new pf(e.client,this.builder);if(t.connection=this.connection,o=await t.queryArray(n),r.check&&(await e.raw(r.check)).length>0)throw new Error("FOREIGN KEY constraint failed")},{connection:this.connection})}finally{await this.queryArray(s)}return o}const t=[];for(const r of e)t.push(await this.queryArray([r]));return t}async ensureConnection(e,t){if(this.builder._connection&&(this.connection=this.builder._connection),this.connection)return e(this,t);let r;try{r=await this.client.acquireConnection()}catch(error){if(!(error instanceof lf))return Promise.reject(error);throw this.builder&&(error.sql=this.builder.sql,error.bindings=this.builder.bindings),error}try{return this.connection=r,await e(this,t)}finally{await this.client.releaseConnection(r)}}}var mf=pf,yf={};(function(e){yf.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+yf.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),e.splice(n,0,t)},yf.save=function(e){try{e?yf.storage.setItem("debug",e):yf.storage.removeItem("debug")}catch(error){}},yf.load=function(){let t;try{t=yf.storage.getItem("debug")}catch(error){}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},yf.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},yf.storage=function(){try{return localStorage}catch(error){}}(),yf.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),yf.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],yf.log=console.debug||console.log||(()=>{}),yf=function(e){function t(e){let n,i,s,o=null;function a(...e){if(!a.enabled)return;const r=a,i=Number(new Date),s=i-(n||i);r.diff=s,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];n=s.call(r,t),e.splice(o,1),o--}return n}),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=f({}),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}(yf);const{formatters:t}=yf;t.j=function(e){try{return JSON.stringify(e)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}}).call(this,require("_process"));var gf=function(){},vf={};(function(e){vf=class{constructor(e){this.client=e}now(e){return"number"==typeof e?this.client.raw(`CURRENT_TIMESTAMP(${e})`):this.client.raw("CURRENT_TIMESTAMP")}uuidToBin(t,r=!0){const n=e.from(t.replace(/-/g,""),"hex");return r?e.concat([n.slice(6,8),n.slice(4,6),n.slice(0,4),n.slice(8,16)]):e.concat([n.slice(0,4),n.slice(4,6),n.slice(6,8),n.slice(8,16)])}binToUuid(t,r=!0){const n=e.from(t,"hex");return r?[n.toString("hex",4,8),n.toString("hex",2,4),n.toString("hex",0,2),n.toString("hex",8,10),n.toString("hex",10,16)].join("-"):[n.toString("hex",0,4),n.toString("hex",4,6),n.toString("hex",6,8),n.toString("hex",8,10),n.toString("hex",10,16)].join("-")}}}).call(this,require("buffer").Buffer);var bf,_f=["with","withRecursive","withMaterialized","withNotMaterialized","select","as","columns","column","from","fromJS","fromRaw","into","withSchema","table","distinct","join","joinRaw","innerJoin","leftJoin","leftOuterJoin","rightJoin","rightOuterJoin","outerJoin","fullOuterJoin","crossJoin","where","andWhere","orWhere","whereNot","orWhereNot","whereLike","andWhereLike","orWhereLike","whereILike","andWhereILike","orWhereILike","whereRaw","whereWrapped","havingWrapped","orWhereRaw","whereExists","orWhereExists","whereNotExists","orWhereNotExists","whereIn","orWhereIn","whereNotIn","orWhereNotIn","whereNull","orWhereNull","whereNotNull","orWhereNotNull","whereBetween","whereNotBetween","andWhereBetween","andWhereNotBetween","orWhereBetween","orWhereNotBetween","groupBy","groupByRaw","orderBy","orderByRaw","union","unionAll","intersect","having","havingRaw","orHaving","orHavingRaw","offset","limit","count","countDistinct","min","max","sum","sumDistinct","avg","avgDistinct","increment","decrement","first","debug","pluck","clearSelect","clearWhere","clearGroup","clearOrder","clearHaving","insert","update","returning","del","delete","truncate","transacting","connection","jsonExtract","jsonSet","jsonInsert","jsonRemove","whereJsonObject","orWhereJsonObject","andWhereJsonObject","whereNotJsonObject","orWhereNotJsonObject","andWhereNotJsonObject","whereJsonPath","orWhereJsonPath","andWhereJsonPath","whereJsonSupersetOf","orWhereJsonSupersetOf","andWhereJsonSupersetOf","whereJsonNotSupersetOf","orWhereJsonNotSupersetOf","andWhereJsonNotSupersetOf","whereJsonSubsetOf","orWhereJsonSubsetOf","andWhereJsonSubsetOf","whereJsonNotSubsetOf","orWhereJsonNotSubsetOf","andWhereJsonNotSubsetOf"],wf=function(e,t,r){(void 0===r||pc(e[t],r))&&(void 0!==r||t in e)||ih(e,t,r)},Ef=function(e,t,r){for(var n=-1,i=Object(e),s=r(e),o=s.length;o--;){var a=s[bf?o:++n];if(!1===t(i[a],a,i))break}return e},Cf=Function.prototype,Nf=Object.prototype,$f=Cf.toString,xf=Nf.hasOwnProperty,Tf=$f.call(Object),Of=function(e){if(!uh(e)||"[object Object]"!=kc(e))return!1;var t=id(e);if(null===t)return!0;var r=xf.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&$f.call(r)==Tf},Sf=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},kf=function(e,t,r,n,i,s,o){var a,u=Sf(e,r),l=Sf(t,r),c=o.get(l);if(c)wf(e,r,c);else{var h=s?s(u,l,r+"",e,t,o):void 0,d=void 0===h;if(d){var f=ph(l),p=!f&&mh(l),m=!f&&!p&&Ah(l);h=l,f||p||m?ph(u)?h=u:uh(a=u)&&Uh(a)?h=Yh(u):p?(d=!1,h=Qh(l,!0)):m?(d=!1,h=Td(l,!0)):h=[]:Of(l)||fh(l)?(h=u,fh(u)?h=function(e){return ah(e,Hh(e))}(u):jc(u)&&!Ac(u)||(h=jd(l))):d=!1}d&&(o.set(l,h),i(h,l,n,s,o),o.delete(l)),wf(e,r,h)}},jf=function(e){return Wd((function(t,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,o&&Jd(r[0],r[1],o)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n,s)}return t}))},Af=jf((function(e,t,r){!function e(t,r,n,i,s){t!==r&&Ef(r,(function(o,a){if(s||(s=new eh),jc(o))kf(t,r,a,n,e,i,s);else{var u=i?i(Sf(t,a),o,a+"",t,r,s):void 0;void 0===u&&(u=o),wf(t,a,u)}}),Hh)}(e,t,r)})),Rf=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s},If=/\s/,Pf=/^\s+/,qf=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&If.test(e.charAt(t)););return t}(e)+1).replace(Pf,""):e},Lf=/^[-+]0x[0-9a-f]+$/i,Mf=/^0b[01]+$/i,Df=/^0o[0-7]+$/i,Ff=parseInt,Uf=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(Xd(e))return NaN;if(jc(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=jc(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=qf(e);var r=Mf.test(e);return r||Df.test(e)?Ff(e.slice(2),r?2:8):Lf.test(e)?NaN:+e}(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},Bf=function(e){var t=Uf(e),r=t%1;return t==t?r?t-r:t:0},Vf=Math.ceil,zf=Math.max,Hf=Cc?Cc.isConcatSpreadable:void 0,Qf=function(e){return ph(e)||fh(e)||!!(Hf&&e&&e[Hf])},Wf=function(e){return null!=e&&e.length?function e(t,r,n,i,s){var o=-1,a=t.length;for(n||(n=Qf),s||(s=[]);++o<a;){var u=t[o];r>0&&n(u)?r>1?e(u,r-1,n,i,s):nd(s,u):i||(s[s.length]=u)}return s}(e,1):[]},Jf={isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isUndefined:function(e){return void 0===e},isObject:function(e){return"object"==typeof e&&null!==e},isFunction:function(e){return"function"==typeof e}};const{isNumber:Kf}=Jf;var Gf=function(e,t,r,n=1e3){let i=void 0,s=null;if(!Kf(n)||n<1)throw new TypeError("Invalid chunkSize: "+n);if(!Array.isArray(r))throw new TypeError("Invalid batch: Expected array, got "+typeof r);const o=function(e,t,r){t=(r?Jd(e,t,r):void 0===t)?1:zf(Bf(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,s=0,o=Array(Vf(n/t));i<n;)o[s++]=Rf(e,i,i+=t);return o}(r,n);return Object.assign(Promise.resolve().then(async()=>{return await(n=1,new Promise(e=>setTimeout(e,n))),r=async e=>{const r=[];for(const n of o)r.push(await e(t).insert(n,i));return Wf(r)},s?r(s):e.transaction(r);var r,n}),{returning(e){return i=e,this},transacting(e){return s=e,this}})};const{EventEmitter:Yf}=require("events"),{Migrator:Zf}=gf,{isObject:Xf}=Jf,ep={client:{get(){return this.context.client},set(e){this.context.client=e},configurable:!0},userParams:{get(){return this.context.userParams},set(e){this.context.userParams=e},configurable:!0},schema:{get(){return this.client.schemaBuilder()},configurable:!0},migrate:{get(){return new Zf(this)},configurable:!0},seed:{get(){return new gf(this)},configurable:!0},fn:{get(){return new vf(this.client)},configurable:!0}},tp=["raw","batchInsert","transaction","transactionProvider","initialize","destroy","ref","withUserParams","queryBuilder","disableProcessing","enableProcessing"];for(const pN of tp)ep[pN]={value:function(...e){return this.context[pN](...e)},configurable:!0};function rp(e,t,r){t.listeners(e).forEach(t=>{r.on(e,t)})}function np(e,t){for(let n=0;n<_f.length;n++){const t=_f[n];e[t]=function(){const e=this.queryBuilder();return e[t].apply(e,arguments)}}Object.defineProperties(e,ep),function(e){const t=e.context||{};Object.assign(t,{queryBuilder(){return this.client.queryBuilder()},raw(){return this.client.raw.apply(this.client,arguments)},batchInsert(e,t,r=1e3){return Gf(this,e,t,r)},transaction(e,t){!t&&Xf(e)&&(t=e,e=null);const r=Object.assign({},t);return r.userParams=this.userParams||{},void 0===r.doNotRejectOnRollback&&(r.doNotRejectOnRollback=!0),this._transaction(e,r)},_transaction(e,t,r=null){return e?this.client.transaction(e,t,r):new Promise((e,n)=>{this.client.transaction(e,t,r).catch(n)})},transactionProvider(e){let t;return()=>(t||(t=this.transaction(void 0,e)),t)},initialize(e){return this.client.initializePool(e)},destroy(e){return this.client.destroy(e)},ref(e){return this.client.ref(e)},disableProcessing(){this.userParams.isProcessingDisabled||(this.userParams.wrapIdentifier=this.client.config.wrapIdentifier,this.userParams.postProcessResponse=this.client.config.postProcessResponse,this.client.config.wrapIdentifier=null,this.client.config.postProcessResponse=null,this.userParams.isProcessingDisabled=!0)},enableProcessing(){this.userParams.isProcessingDisabled&&(this.client.config.wrapIdentifier=this.userParams.wrapIdentifier,this.client.config.postProcessResponse=this.userParams.postProcessResponse,this.userParams.isProcessingDisabled=!1)},withUserParams(t){const r=function(e){const t=Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e)),r={},n=((e,t)=>sp(r,e,t)).bind(t);return Object.assign(n,e),n.context=r,n}(e);return this.client&&(r.client=Object.create(this.client.constructor.prototype),Af(r.client,this.client),r.client.config=Object.assign({},this.client.config)),np(r,r.client),rp("query",e,r),rp("query-error",e,r),rp("query-response",e,r),rp("start",e,r),r.userParams=t,r}}),e.context||(e.context=t)}(e),e.client=t,e.userParams={};const r=new Yf;for(const n in r)e[n]=r[n];e._internalListeners&&e._internalListeners.forEach(({eventName:t,listener:r})=>{e.client.removeListener(t,r)}),e._internalListeners=[],ip(e,"start",t=>{e.emit("start",t)}),ip(e,"query",t=>{e.emit("query",t)}),ip(e,"query-error",(t,r)=>{e.emit("query-error",t,r)}),ip(e,"query-response",(t,r,n)=>{e.emit("query-response",t,r,n)})}function ip(e,t,r){e.client.on(t,r),e._internalListeners.push({eventName:t,listener:r})}function sp(e,t,r){const n=e.queryBuilder();return t||e.client.logger.warn("calling knex without a tableName is deprecated. Use knex.queryBuilder() instead."),t?n.table(t,r):n}var op=function(e){function t(e,r){return sp(t.context,e,r)}return np(t,e),t},ap=Promise.prototype.finally?e=>Object.assign(e,{finally(e){return this.then().finally(e)}}):gf,up={};const{EventEmitter:lp}=require("events"),{callbackify:cp}=require("util"),{timeout:hp,KnexTimeoutError:dp}=of,fp=yf("knex:tx"),pp=["read uncommitted","read committed","snapshot","repeatable read","serializable"];class mp extends lp{constructor(e,t,r={userParams:{},doNotRejectOnRollback:!0},n=null){super(),this.userParams=r.userParams,this.doNotRejectOnRollback=r.doNotRejectOnRollback;const i=this.txid=sf("trx");this.client=e,this.logger=e.logger,this.outerTx=n,this.trxClient=void 0,this._completed=!1,this._debug=e.config&&e.config.debug,r.isolationLevel&&this.setIsolationLevel(r.isolationLevel),fp("%s: Starting %s transaction",i,n?"nested":"top level"),this._lastChild=Promise.resolve();const s=(n?n._lastChild:Promise.resolve()).then(()=>this._evaluateContainer(r,t));this._promise=s.then(e=>e),n&&(n._lastChild=s.catch(()=>{}))}isCompleted(){return this._completed||this.outerTx&&this.outerTx.isCompleted()||!1}begin(e){return(this.isolationLevel?this.query(e,`SET TRANSACTION ISOLATION LEVEL ${this.isolationLevel};`):Promise.resolve()).then(()=>this.query(e,"BEGIN;"))}savepoint(e){return this.query(e,`SAVEPOINT ${this.txid};`)}commit(e,t){return this.query(e,"COMMIT;",1,t)}release(e,t){return this.query(e,`RELEASE SAVEPOINT ${this.txid};`,1,t)}setIsolationLevel(e){if(!pp.includes(e))throw new Error("Invalid isolationLevel, supported isolation levels are: "+JSON.stringify(pp));return this.isolationLevel=e,this}rollback(e,t){return hp(this.query(e,"ROLLBACK",2,t),5e3).catch(e=>{if(!(e instanceof dp))return Promise.reject(e);this._rejecter(t)})}rollbackTo(e,t){return hp(this.query(e,"ROLLBACK TO SAVEPOINT "+this.txid,2,t),5e3).catch(e=>{if(!(e instanceof dp))return Promise.reject(e);this._rejecter(t)})}query(e,t,r,n){const i=this.trxClient.query(e,t).catch(e=>{r=2,n=e,this._completed=!0,fp("%s error running transaction query",this.txid)}).then(e=>{if(1===r&&this._resolver(n),2===r){if(void 0===n){if(this.doNotRejectOnRollback&&/^ROLLBACK\b/i.test(t))return void this._resolver();n=new Error("Transaction rejected with non-error: "+n)}this._rejecter(n)}return e});return 1!==r&&2!==r||(this._completed=!0),i}debug(e){return this._debug=!arguments.length||e,this}async _evaluateContainer(e,t){return this.acquireConnection(e,e=>{const r=this.trxClient=function(e,t,r){const n=Object.create(t.constructor.prototype);n.version=t.version,n.config=t.config,n.driver=t.driver,n.connectionSettings=t.connectionSettings,n.transacting=!0,n.valueForUndefined=t.valueForUndefined,n.logger=t.logger,n.on("start",(function(r){e.emit("start",r),t.emit("start",r)})),n.on("query",(function(r){e.emit("query",r),t.emit("query",r)})),n.on("query-error",(function(r,n){e.emit("query-error",r,n),t.emit("query-error",r,n)})),n.on("query-response",(function(r,n,i){e.emit("query-response",r,n,i),t.emit("query-response",r,n,i)}));const i=n.query;n.query=function(t,s){const o=e.isCompleted();return new Promise((function(a,u){try{if(t!==r)throw new Error("Invalid connection for transaction query.");o&&yp(e,s),a(i.call(n,t,s))}catch(Zv){u(Zv)}}))};const s=n.stream;return n.stream=function(t,i,o,a){const u=e.isCompleted();return new Promise((function(l,c){try{if(t!==r)throw new Error("Invalid connection for transaction query.");u&&yp(e,i),l(s.call(n,t,i,o,a))}catch(Zv){c(Zv)}}))},n.acquireConnection=function(){return Promise.resolve(r)},n.releaseConnection=function(){return Promise.resolve()},n}(this,this.client,e),n=this.client.transacting?this.savepoint(e):this.begin(e),i=new Promise((e,t)=>{this._resolver=e,this._rejecter=t});return n.then(()=>function(e,t,r){const n=op(r);return n.context.withUserParams=()=>{throw new Error("Cannot set user params on a transaction - it can only inherit params from main knex instance")},n.isTransaction=!0,n.userParams=e.userParams||{},n.context.transaction=function(t,r){return r?void 0===r.doNotRejectOnRollback&&(r.doNotRejectOnRollback=!0):r={doNotRejectOnRollback:!0},this._transaction(t,r,e)},n.savepoint=function(e,t){return n.transaction(e,t)},e.client.transacting?(n.commit=r=>e.release(t,r),n.rollback=r=>e.rollbackTo(t,r)):(n.commit=r=>e.commit(t,r),n.rollback=r=>e.rollback(t,r)),n.isCompleted=()=>e.isCompleted(),n}(this,e,r)).then(e=>{let r;e.executionPromise=i;try{r=t(e)}catch(n){r=Promise.reject(n)}return r&&r.then&&"function"==typeof r.then&&r.then(t=>e.commit(t)).catch(t=>e.rollback(t)),null}).catch(e=>this._rejecter(e)),i})}async acquireConnection(e,t){const r=e&&e.connection,n=r||await this.client.acquireConnection();try{return n.__knexTxId=this.txid,await t(n)}finally{r?fp("%s: not releasing external connection",this.txid):(fp("%s: releasing connection",this.txid),this.client.releaseConnection(n))}}then(e,t){return this._promise.then(e,t)}catch(...e){return this._promise.catch(...e)}asCallback(e){return cp(()=>this._promise)(e),this._promise}}function yp(e,t){const r="string"==typeof t?t:t&&t.sql;throw fp("%s: Transaction completed: %s",e.txid,r),new Error("Transaction query already complete, run with DEBUG=knex:tx for more info")}ap(mp.prototype),up=mp;const gp=yf("knex:query"),vp=yf("knex:bindings"),{isString:bp}=Jf;function _p(e,t,r,n){t=null==t?[]:[].concat(t);let i=0;return e.replace(/\\?\?/g,e=>{if("\\?"===e)return"?";if(i===t.length)return e;const s=t[i++];return n._escapeBinding(s,{timeZone:r})})}var wp={enrichQueryObject:function(e,t,r){const n=bp(t)?{sql:t}:t;n.bindings=r.prepBindings(n.bindings),n.sql=r.positionBindings(n.sql);const{__knexUid:i,__knexTxId:s}=e;return r.emit("query",Object.assign({__knexUid:i,__knexTxId:s},n)),o=n.sql,a=s,gp(o.replace(/%/g,"%%"),a),vp(n.bindings,s),n;var o,a},executeQuery:function(e,t,r){return r._query(e,t).catch(n=>{throw n.message=_p(t.sql,t.bindings,void 0,r)+" - "+n.message,r.emit("query-error",n,Object.assign({__knexUid:e.__knexUid,__knexTxId:e.__knexUid},t)),n})},formatQuery:_p},Ep=Object.prototype.hasOwnProperty,Cp=jf((function(e,t){if(qh(t)||Uh(t))ah(t,Bh(t),e);else for(var r in t)Ep.call(t,r)&&oh(e,r,t[r])})),Np=function(e){return _d(e,4)},$p=function(e,t){return e&&Ef(e,t,Bh)},xp=function(e,t){return function(r,n){if(null==r)return r;if(!Uh(r))return e(r,n);for(var i=r.length,s=t?i:-1,o=Object(r);(t?s--:++s<i)&&!1!==n(o[s],s,o););return r}}($p),Tp=function(e,t){return(ph(e)?rh:xp)(e,"function"==typeof(r=t)?r:Fd);var r},Op=Object.prototype.hasOwnProperty,Sp=function(e){if(null==e)return!0;if(Uh(e)&&(ph(e)||"string"==typeof e||"function"==typeof e.splice||mh(e)||Ah(e)||fh(e)))return!e.length;var t=fd(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(qh(e))return!Fh(e).length;for(var r in e)if(Op.call(e,r))return!1;return!0},kp=function(e,t){var r=[];return xp(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r},jp={};function Ap(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Zc;++t<r;)this.add(e[t])}Ap.prototype.add=Ap.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ap.prototype.has=function(e){return this.__data__.has(e)},jp=Ap;var Rp=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},Ip=function(e,t){return e.has(t)},Pp=function(e,t,r,n,i,s){var o=1&r,a=e.length,u=t.length;if(a!=u&&!(o&&u>a))return!1;var l=s.get(e),c=s.get(t);if(l&&c)return l==t&&c==e;var h=-1,d=!0,f=2&r?new jp:void 0;for(s.set(e,t),s.set(t,e);++h<a;){var p=e[h],m=t[h];if(n)var y=o?n(m,p,h,t,e,s):n(p,m,h,e,t,s);if(void 0!==y){if(y)continue;d=!1;break}if(f){if(!Rp(t,(function(e,t){if(!Ip(f,t)&&(p===e||i(p,e,r,n,s)))return f.push(t)}))){d=!1;break}}else if(p!==m&&!i(p,m,r,n,s)){d=!1;break}}return s.delete(e),s.delete(t),d},qp=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r},Lp=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},Mp=Cc?Cc.prototype:void 0,Dp=Mp?Mp.valueOf:void 0,Fp=Object.prototype.hasOwnProperty,Up=Object.prototype.hasOwnProperty,Bp=function(e,t,r,n,i,s){var o=ph(e),a=ph(t),u=o?"[object Array]":fd(e),l=a?"[object Array]":fd(t),c="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),h="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),d=u==l;if(d&&mh(e)){if(!mh(t))return!1;o=!0,c=!1}if(d&&!c)return s||(s=new eh),o||Ah(e)?Pp(e,t,r,n,i,s):function(e,t,r,n,i,s,o){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new Ed(e),new Ed(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return pc(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=qp;case"[object Set]":var u=1&n;if(a||(a=Lp),e.size!=t.size&&!u)return!1;var l=o.get(e);if(l)return l==t;n|=2,o.set(e,t);var c=Pp(a(e),a(t),n,i,s,o);return o.delete(e),c;case"[object Symbol]":if(Dp)return Dp.call(e)==Dp.call(t)}return!1}(e,t,u,r,n,i,s);if(!(1&r)){var f=c&&Up.call(e,"__wrapped__"),p=h&&Up.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,y=p?t.value():t;return s||(s=new eh),i(m,y,r,n,s)}}return!!d&&(s||(s=new eh),function(e,t,r,n,i,s){var o=1&r,a=ad(e),u=a.length;if(u!=ad(t).length&&!o)return!1;for(var l=u;l--;){var c=a[l];if(!(o?c in t:Fp.call(t,c)))return!1}var h=s.get(e),d=s.get(t);if(h&&d)return h==t&&d==e;var f=!0;s.set(e,t),s.set(t,e);for(var p=o;++l<u;){var m=e[c=a[l]],y=t[c];if(n)var g=o?n(y,m,c,t,e,s):n(m,y,c,e,t,s);if(!(void 0===g?m===y||i(m,y,r,n,s):g)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var v=e.constructor,b=t.constructor;v!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b)&&(f=!1)}return s.delete(e),s.delete(t),f}(e,t,r,n,i,s))},Vp=function e(t,r,n,i,s){return t===r||(null==t||null==r||!uh(t)&&!uh(r)?t!=t&&r!=r:Bp(t,r,n,i,e,s))},zp=function(e){return e==e&&!jc(e)},Hp=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},Qp=function(e){var t=function(e){for(var t=Bh(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,zp(i)]}return t}(e);return 1==t.length&&t[0][2]?Hp(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var i=r.length,s=i,o=!n;if(null==e)return!s;for(e=Object(e);i--;){var a=r[i];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<s;){var u=(a=r[i])[0],l=e[u],c=a[1];if(o&&a[2]){if(void 0===l&&!(u in e))return!1}else{var h=new eh;if(n)var d=n(l,c,u,e,t,h);if(!(void 0===d?Vp(c,l,3,n,h):d))return!1}}return!0}(r,e,t)}},Wp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Jp=/^\w*$/,Kp=function(e,t){if(ph(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Xd(e))||Jp.test(e)||!Wp.test(e)||null!=t&&e in Object(t)},Gp={};function Yp(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=e.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(Yp.Cache||Zc),r}Yp.Cache=Zc,Gp=Yp;var Zp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xp=/\\(\\)?/g,em=function(e){var t=Gp(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Zp,(function(e,r,n,i){t.push(n?i.replace(Xp,"$1"):r||e)})),t})),tm=function(e,t){return ph(e)?e:Kp(e,t)?[e]:em(rf(e))},rm=function(e){if("string"==typeof e||Xd(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},nm=function(e,t){for(var r=0,n=(t=tm(t,e)).length;null!=e&&r<n;)e=e[rm(t[r++])];return r&&r==n?e:void 0},im=function(e,t){return null!=e&&t in Object(e)},sm=function(e,t,r){for(var n=-1,i=(t=tm(t,e)).length,s=!1;++n<i;){var o=rm(t[n]);if(!(s=null!=e&&r(e,o)))break;e=e[o]}return s||++n!=i?s:!!(i=null==e?0:e.length)&&Ch(i)&&Eh(o,i)&&(ph(e)||fh(e))},om=function(e,t){return Kp(e)&&zp(t)?Hp(rm(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:nm(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?function(e,t){return null!=e&&sm(e,t,im)}(r,e):Vp(t,n,3)}},am=function(e){return Kp(e)?(t=rm(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return nm(t,e)}}(e);var t},um=function(e){return"function"==typeof e?e:null==e?Fd:"object"==typeof e?ph(e)?om(e[0],e[1]):Qp(e):am(e)},lm=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},cm=function(e){var t=null==e?0:e.length;return t?Rf(e,1,t):[]},hm=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),dm="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",fm="\\ud83c[\\udffb-\\udfff]",pm="[^\\ud800-\\udfff]",mm="(?:\\ud83c[\\udde6-\\uddff]){2}",ym="[\\ud800-\\udbff][\\udc00-\\udfff]",gm="(?:"+dm+"|"+fm+")?",vm="[\\ufe0e\\ufe0f]?"+gm+"(?:\\u200d(?:"+[pm,mm,ym].join("|")+")[\\ufe0e\\ufe0f]?"+gm+")*",bm="(?:"+[pm+dm+"?",dm,mm,ym,"[\\ud800-\\udfff]"].join("|")+")",_m=RegExp(fm+"(?="+fm+")|"+bm+vm,"g"),wm=function(e){return function(e){return hm.test(e)}(e)?function(e){return e.match(_m)||[]}(e):function(e){return e.split("")}(e)},Em=function(e){return null==e?[]:function(e,t){return Zd(t,(function(t){return e[t]}))}(e,Bh(e))},Cm=Cc?Cc.iterator:void 0,Nm=function(e){if(!e)return[];if(Uh(e))return function(e){return"string"==typeof e||!ph(e)&&uh(e)&&"[object String]"==kc(e)}(e)?wm(e):Yh(e);if(Cm&&e[Cm])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[Cm]());var t=fd(e);return("[object Map]"==t?qp:"[object Set]"==t?Lp:Em)(e)};const $m=Object.freeze({pg:"postgres",postgresql:"postgres",sqlite:"sqlite3"}),xm=Object.freeze(["mssql","mysql","mysql2","oracledb","postgres","pgnative","redshift","sqlite3","cockroachdb","better-sqlite3"].concat(Object.keys($m))),Tm=Object.freeze({MsSQL:"mssql",MySQL:"mysql",MySQL2:"mysql2",Oracle:"oracledb",PostgreSQL:"pg",PgNative:"pgnative",Redshift:"pg-redshift",SQLite:"sqlite3",CockroachDB:"cockroachdb",BetterSQLite3:"better-sqlite3"});var Om={CLIENT_ALIASES:$m,SUPPORTED_CLIENTS:xm,POOL_CONFIG_OPTIONS:Object.freeze(["maxWaitingClients","testOnBorrow","fifo","priorityRange","autostart","evictionRunIntervalMillis","numTestsPerRun","softIdleTimeoutMillis","Promise"]),COMMA_NO_PAREN_REGEX:/,[\s](?![^(]*\))/g,DRIVER_NAMES:Tm};const{CLIENT_ALIASES:Sm}=Om,{isFunction:km}=Jf;function jm(e){let t=!1;if(Ah(e))return!1;if(e&&km(e.toSQL))return t;if(Array.isArray(e))for(let r=0;r<e.length&&!t;r++)t=jm(e[r]);else Of(e)?Object.keys(e).forEach(r=>{t||(t=jm(e[r]))}):t=void 0===e;return t}var Am={addQueryContext:function(e){e.prototype.queryContext=function(e){return void 0===e?this._queryContext:(this._queryContext=e,this)}},containsUndefined:jm,getUndefinedIndices:function(e){const t=[];return Array.isArray(e)?e.forEach((e,r)=>{jm(e)&&t.push(r)}):Of(e)?Object.keys(e).forEach(r=>{jm(e[r])&&t.push(r)}):t.push(0),t},normalizeArr:function(...e){return Array.isArray(e[0])?e[0]:e},resolveClientNameWithAliases:function(e){return Sm[e]||e},toNumber:function(e,t){if(null==e)return t;const r=parseInt(e,10);return isNaN(r)?t:r}},Rm={};function Im(e,t,r,n,i){if("function"==typeof r)return{type:"onWrapped",value:r,bool:t};switch(arguments.length){case 3:return{type:"onRaw",value:r,bool:t};case 4:return{type:e,column:r,operator:"=",value:n,bool:t};default:return{type:e,column:r,operator:n,value:i,bool:t}}}class Pm{constructor(e,t,r){this.schema=r,this.table=e,this.joinType=t,this.and=this,this.clauses=[]}get or(){return this._bool("or")}on(e){if("object"==typeof e&&"function"!=typeof e.toSQL){const t=Object.keys(e);let r=-1;const n="or"===this._bool()?"orOn":"on";for(;++r<t.length;)this[n](t[r],e[t[r]]);return this}const t=Im("onBasic",this._bool(),...arguments);return t&&this.clauses.push(t),this}orOn(e,t,r){return this._bool("or").on.apply(this,arguments)}onJsonPathEquals(e,t,r,n){return this.clauses.push({type:"onJsonPathEquals",columnFirst:e,jsonPathFirst:t,columnSecond:r,jsonPathSecond:n,bool:this._bool(),not:this._not()}),this}orOnJsonPathEquals(e,t,r,n){return this._bool("or").onJsonPathEquals.apply(this,arguments)}using(e){return this.clauses.push({type:"onUsing",column:e,bool:this._bool()})}onVal(e){if("object"==typeof e&&"function"!=typeof e.toSQL){const t=Object.keys(e);let r=-1;const n="or"===this._bool()?"orOnVal":"onVal";for(;++r<t.length;)this[n](t[r],e[t[r]]);return this}const t=Im("onVal",this._bool(),...arguments);return t&&this.clauses.push(t),this}andOnVal(){return this.onVal(...arguments)}orOnVal(){return this._bool("or").onVal(...arguments)}onBetween(e,t){return this.clauses.push({type:"onBetween",column:e,value:t,bool:this._bool(),not:this._not()}),this}onNotBetween(e,t){return this._not(!0).onBetween(e,t)}orOnBetween(e,t){return this._bool("or").onBetween(e,t)}orOnNotBetween(e,t){return this._bool("or")._not(!0).onBetween(e,t)}onIn(e,t){return Array.isArray(t)&&0===t.length?this.on(1,"=",0):(this.clauses.push({type:"onIn",column:e,value:t,not:this._not(),bool:this._bool()}),this)}onNotIn(e,t){return this._not(!0).onIn(e,t)}orOnIn(e,t){return this._bool("or").onIn(e,t)}orOnNotIn(e,t){return this._bool("or")._not(!0).onIn(e,t)}onNull(e){return this.clauses.push({type:"onNull",column:e,not:this._not(),bool:this._bool()}),this}orOnNull(e){return this._bool("or").onNull(e)}onNotNull(e){return this._not(!0).onNull(e)}orOnNotNull(e){return this._not(!0)._bool("or").onNull(e)}onExists(e){return this.clauses.push({type:"onExists",value:e,not:this._not(),bool:this._bool()}),this}orOnExists(e){return this._bool("or").onExists(e)}onNotExists(e){return this._not(!0).onExists(e)}orOnNotExists(e){return this._not(!0)._bool("or").onExists(e)}type(e){return this.joinType=e,this}_bool(e){if(1===arguments.length)return this._boolFlag=e,this;const t=this._boolFlag||"and";return this._boolFlag="and",t}_not(e){if(1===arguments.length)return this._notFlag=e,this;const t=this._notFlag;return this._notFlag=!1,t}}Object.assign(Pm.prototype,{grouping:"join"}),Pm.prototype.andOn=Pm.prototype.on,Pm.prototype.andOnIn=Pm.prototype.onIn,Pm.prototype.andOnNotIn=Pm.prototype.onNotIn,Pm.prototype.andOnNull=Pm.prototype.onNull,Pm.prototype.andOnNotNull=Pm.prototype.onNotNull,Pm.prototype.andOnExists=Pm.prototype.onExists,Pm.prototype.andOnNotExists=Pm.prototype.onNotExists,Pm.prototype.andOnBetween=Pm.prototype.onBetween,Pm.prototype.andOnNotBetween=Pm.prototype.onNotBetween,Pm.prototype.andOnJsonPathEquals=Pm.prototype.onJsonPathEquals,Rm=Pm;var qm=function(e,t){e.client.config.asyncStackTraces&&(e._asyncStack={error:new Error,lines:t})};const{callbackify:Lm}=require("util"),{formatQuery:Mm}=wp;var Dm={augmentWithBuilderInterface:function(e){e.prototype.toQuery=function(e){let t=this.toSQL(this._method,e);return Array.isArray(t)||(t=[t]),t.length?t.map(t=>Mm(t.sql,t.bindings,e,this.client)).reduce((e,t)=>e.concat(e.endsWith(";")?"\n":";\n",t)):""},e.prototype.then=function(){let e=this.client.runner(this).run();return this.client.config.asyncStackTraces&&(e=e.catch(e=>{e.originalStack=e.stack;const t=e.stack.split("\n")[0],{error:r,lines:n}=this._asyncStack,i=r.stack.split("\n").slice(n);throw i.unshift(t),e.stack=i.join("\n"),e})),e.then.apply(e,arguments)},e.prototype.options=function(e){return this._options=this._options||[],this._options.push(Np(e)||{}),this},e.prototype.connection=function(e){return this._connection=e,this.client.processPassedConnection(e),this},e.prototype.debug=function(e){return this._debug=!arguments.length||e,this},e.prototype.transacting=function(e){if(e&&e.client&&(e.client.transacting?this.client=e.client:e.client.logger.warn("Invalid transaction value: "+e.client)),Sp(e))throw this.client.logger.error("Invalid value on transacting call, potential bug"),Error("Invalid transacting value (null, undefined or empty object)");return this},e.prototype.stream=function(e){return this.client.runner(this).stream(e)},e.prototype.pipe=function(e,t){return this.client.runner(this).pipe(e,t)},e.prototype.asCallback=function(e){const t=this.then();return Lm(()=>t)(e),t},e.prototype.catch=function(e){return this.then().catch(e)},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:()=>"object"}),ap(e.prototype)}};const{EventEmitter:Fm}=require("events"),{addQueryContext:Um,normalizeArr:Bm}=Am,{isBoolean:Vm,isNumber:zm,isObject:Hm,isString:Qm,isFunction:Wm}=Jf,{lockMode:Jm,waitMode:Km}={lockMode:{forShare:"forShare",forUpdate:"forUpdate",forNoKeyUpdate:"forNoKeyUpdate",forKeyShare:"forKeyShare"},waitMode:{skipLocked:"skipLocked",noWait:"noWait"}},{augmentWithBuilderInterface:Gm}=Dm,Ym=new Set(["pluck","first","select"]),Zm=new Set(["with","select","columns","hintComments","where","union","join","group","order","having","limit","offset","counter","counters"]),Xm=new Set([Jm.forShare,Jm.forUpdate,Jm.forNoKeyUpdate,Jm.forKeyShare]);class ey extends Fm{constructor(e){super(),this.client=e,this.and=this,this._single={},this._statements=[],this._method="select",e.config&&(qm(this,5),this._debug=e.config.debug),this._joinFlag="inner",this._boolFlag="and",this._notFlag=!1,this._asColumnFlag=!1}toString(){return this.toQuery()}toSQL(e,t){return this.client.queryCompiler(this).toSQL(e||this._method,t)}clone(){const e=new this.constructor(this.client);return e._method=this._method,e._single=Np(this._single),e._statements=Np(this._statements),e._debug=this._debug,void 0!==this._options&&(e._options=Np(this._options)),void 0!==this._queryContext&&(e._queryContext=Np(this._queryContext)),void 0!==this._connection&&(e._connection=this._connection),e}timeout(e,{cancel:t}={}){return zm(e)&&e>0&&(this._timeout=e,t&&(this.client.assertCanCancelQuery(),this._cancelOnTimeout=!0)),this}isValidStatementArg(e){return"function"==typeof e||e instanceof ey||e&&e.isRawInstance}_validateWithArgs(e,t,r,n){const[i,s]=void 0===r?[t,void 0]:[r,t];if("string"!=typeof e)throw new Error(n+"() first argument must be a string");if(!this.isValidStatementArg(i)||void 0!==s){if(!(Array.isArray(s)&&s.length>0&&s.every(e=>"string"==typeof e)))throw new Error(n+"() second argument must be a statement or non-empty column name list.");if(!this.isValidStatementArg(i))throw new Error(n+"() third argument must be a function / QueryBuilder or a raw when its second argument is a column name list")}}with(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r)}withMaterialized(e,t,r){throw new Error("With materialized is not supported by this dialect")}withNotMaterialized(e,t,r){throw new Error("With materialized is not supported by this dialect")}withWrapped(e,t,r,n){const[i,s]=void 0===r?[t,void 0]:[r,t],o={grouping:"with",type:"withWrapped",alias:e,columnList:s,value:i};return void 0!==n&&(o.materialized=n),this._statements.push(o),this}withRecursive(e,t,r){return this._validateWithArgs(e,t,r,"withRecursive"),this.withRecursiveWrapped(e,t,r)}withRecursiveWrapped(e,t,r){return this.withWrapped(e,t,r),this._statements[this._statements.length-1].recursive=!0,this}columns(e){return e||0===e?(this._statements.push({grouping:"columns",value:Bm(...arguments)}),this):this}as(e){return this._single.as=e,this}hintComment(e){if((e=Array.isArray(e)?e:[e]).some(e=>!Qm(e)))throw new Error("Hint comment must be a string");if(e.some(e=>e.includes("/*")||e.includes("*/")))throw new Error('Hint comment cannot include "/*" or "*/"');if(e.some(e=>e.includes("?")))throw new Error('Hint comment cannot include "?"');return this._statements.push({grouping:"hintComments",value:e}),this}withSchema(e){return this._single.schema=e,this}table(e,t={}){return this._single.table=e,this._single.only=!0===t.only,this}distinct(...e){return this._statements.push({grouping:"columns",value:Bm(...e),distinct:!0}),this}distinctOn(...e){if(Sp(e))throw new Error("distinctOn requires at least on argument");return this._statements.push({grouping:"columns",value:Bm(...e),distinctOn:!0}),this}join(e,t,...r){let n;const i=e instanceof ey||"function"==typeof e?void 0:this._single.schema,s=this._joinType();return"function"==typeof t?(n=new Rm(e,s,i),t.call(n,n)):"raw"===s?n=new Rm(this.client.raw(e,t),"raw"):(n=new Rm(e,s,i),t&&n.on(t,...r)),this._statements.push(n),this}using(e){throw new Error("'using' function is only available in PostgreSQL dialect with Delete statements.")}innerJoin(...e){return this._joinType("inner").join(...e)}leftJoin(...e){return this._joinType("left").join(...e)}leftOuterJoin(...e){return this._joinType("left outer").join(...e)}rightJoin(...e){return this._joinType("right").join(...e)}rightOuterJoin(...e){return this._joinType("right outer").join(...e)}outerJoin(...e){return this._joinType("outer").join(...e)}fullOuterJoin(...e){return this._joinType("full outer").join(...e)}crossJoin(...e){return this._joinType("cross").join(...e)}joinRaw(...e){return this._joinType("raw").join(...e)}get or(){return this._bool("or")}get not(){return this._not(!0)}where(e,t,r){const n=arguments.length;if(!1===e||!0===e)return this.where(1,"=",e?1:0);if("function"==typeof e)return this.whereWrapped(e);if(Hm(e)&&!e.isRawInstance)return this._objectWhere(e);if(e&&e.isRawInstance&&1===n)return this.whereRaw(e);if(2===n&&(r=t,t="=",null===r))return this.whereNull(e);const i=(""+t).toLowerCase().trim();if(3===n){if("in"===i||"not in"===i)return this._not("not in"===i).whereIn(e,r);if("between"===i||"not between"===i)return this._not("not between"===i).whereBetween(e,r)}return null!==r||"is"!==i&&"is not"!==i?(this._statements.push({grouping:"where",type:"whereBasic",column:e,operator:t,value:r,not:this._not(),bool:this._bool(),asColumn:this._asColumnFlag}),this):this._not("is not"===i).whereNull(e)}whereColumn(...e){return this._asColumnFlag=!0,this.where(...e),this._asColumnFlag=!1,this}orWhere(e,...t){this._bool("or");const r=e;return Hm(r)&&!r.isRawInstance?this.whereWrapped((function(){for(const e in r)this.andWhere(e,r[e])})):this.where(e,...t)}orWhereColumn(e,...t){this._bool("or");const r=e;return Hm(r)&&!r.isRawInstance?this.whereWrapped((function(){for(const e in r)this.andWhereColumn(e,"=",r[e])})):this.whereColumn(e,...t)}whereNot(e,...t){return t.length>=2&&("in"!==t[0]&&"between"!==t[0]||this.client.logger.warn('whereNot is not suitable for "in" and "between" type subqueries. You should use "not in" and "not between" instead.')),this._not(!0).where(e,...t)}whereNotColumn(...e){return this._not(!0).whereColumn(...e)}orWhereNot(...e){return this._bool("or").whereNot(...e)}orWhereNotColumn(...e){return this._bool("or").whereNotColumn(...e)}_objectWhere(e){const t=this._bool(),r=this._not()?"Not":"";for(const n in e)this[t+"Where"+r](n,e[n]);return this}whereRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"where",type:"whereRaw",value:r,not:this._not(),bool:this._bool()}),this}orWhereRaw(e,t){return this._bool("or").whereRaw(e,t)}whereWrapped(e){return this._statements.push({grouping:"where",type:"whereWrapped",value:e,not:this._not(),bool:this._bool()}),this}whereExists(e){return this._statements.push({grouping:"where",type:"whereExists",value:e,not:this._not(),bool:this._bool()}),this}orWhereExists(e){return this._bool("or").whereExists(e)}whereNotExists(e){return this._not(!0).whereExists(e)}orWhereNotExists(e){return this._bool("or").whereNotExists(e)}whereIn(e,t){return Array.isArray(t)&&Sp(t)?this.where(this._not()):(this._statements.push({grouping:"where",type:"whereIn",column:e,value:t,not:this._not(),bool:this._bool()}),this)}orWhereIn(e,t){return this._bool("or").whereIn(e,t)}whereNotIn(e,t){return this._not(!0).whereIn(e,t)}orWhereNotIn(e,t){return this._bool("or")._not(!0).whereIn(e,t)}whereNull(e){return this._statements.push({grouping:"where",type:"whereNull",column:e,not:this._not(),bool:this._bool()}),this}orWhereNull(e){return this._bool("or").whereNull(e)}whereNotNull(e){return this._not(!0).whereNull(e)}orWhereNotNull(e){return this._bool("or").whereNotNull(e)}whereBetween(e,t){return this._statements.push({grouping:"where",type:"whereBetween",column:e,value:t,not:this._not(),bool:this._bool()}),this}whereNotBetween(e,t){return this._not(!0).whereBetween(e,t)}orWhereBetween(e,t){return this._bool("or").whereBetween(e,t)}orWhereNotBetween(e,t){return this._bool("or").whereNotBetween(e,t)}_whereLike(e,t,r){return this._statements.push({grouping:"where",type:e,column:t,value:r,not:this._not(),bool:this._bool(),asColumn:this._asColumnFlag}),this}whereLike(e,t){return this._whereLike("whereLike",e,t)}orWhereLike(e,t){return this._bool("or")._whereLike("whereLike",e,t)}whereILike(e,t){return this._whereLike("whereILike",e,t)}orWhereILike(e,t){return this._bool("or")._whereLike("whereILike",e,t)}groupBy(e){return e&&e.isRawInstance?this.groupByRaw.apply(this,arguments):(this._statements.push({grouping:"group",type:"groupByBasic",value:Bm(...arguments)}),this)}groupByRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"group",type:"groupByRaw",value:r}),this}orderBy(e,t,r=""){return Array.isArray(e)?this._orderByArray(e):(this._statements.push({grouping:"order",type:"orderByBasic",value:e,direction:t,nulls:r}),this)}_orderByArray(e){for(let t=0;t<e.length;t++){const r=e[t];Hm(r)?this._statements.push({grouping:"order",type:"orderByBasic",value:r.column,direction:r.order,nulls:r.nulls}):Qm(r)&&this._statements.push({grouping:"order",type:"orderByBasic",value:r})}return this}orderByRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"order",type:"orderByRaw",value:r}),this}_union(e,t){let r=t[0],n=t[1];if(1===t.length||2===t.length&&Vm(n)){Array.isArray(r)||(r=[r]);for(let t=0,i=r.length;t<i;t++)this._statements.push({grouping:"union",clause:e,value:r[t],wrap:n||!1})}else r=Nm(t).slice(0,t.length-1),n=t[t.length-1],Vm(n)||(r.push(n),n=!1),this._union(e,[r,n]);return this}union(...e){return this._union("union",e)}unionAll(...e){return this._union("union all",e)}intersect(e,t){if(1===arguments.length||2===arguments.length&&Vm(t)){Array.isArray(e)||(e=[e]);for(let r=0,n=e.length;r<n;r++)this._statements.push({grouping:"union",clause:"intersect",value:e[r],wrap:t||!1})}else e=Nm(arguments).slice(0,arguments.length-1),Vm(t=arguments[arguments.length-1])||(e.push(t),t=!1),this.intersect(e,t);return this}having(e,t,r){return e.isRawInstance&&1===arguments.length?this.havingRaw(e):"function"==typeof e?this.havingWrapped(e):(this._statements.push({grouping:"having",type:"havingBasic",column:e,operator:t,value:r,bool:this._bool(),not:this._not()}),this)}orHaving(e,...t){this._bool("or");const r=e;return Hm(r)&&!r.isRawInstance?this.havingWrapped((function(){for(const e in r)this.andHaving(e,r[e])})):this.having(e,...t)}havingWrapped(e){return this._statements.push({grouping:"having",type:"havingWrapped",value:e,bool:this._bool(),not:this._not()}),this}havingNull(e){return this._statements.push({grouping:"having",type:"havingNull",column:e,not:this._not(),bool:this._bool()}),this}orHavingNull(e){return this._bool("or").havingNull(e)}havingNotNull(e){return this._not(!0).havingNull(e)}orHavingNotNull(e){return this._not(!0)._bool("or").havingNull(e)}havingExists(e){return this._statements.push({grouping:"having",type:"havingExists",value:e,not:this._not(),bool:this._bool()}),this}orHavingExists(e){return this._bool("or").havingExists(e)}havingNotExists(e){return this._not(!0).havingExists(e)}orHavingNotExists(e){return this._not(!0)._bool("or").havingExists(e)}havingBetween(e,t){return this._statements.push({grouping:"having",type:"havingBetween",column:e,value:t,not:this._not(),bool:this._bool()}),this}orHavingBetween(e,t){return this._bool("or").havingBetween(e,t)}havingNotBetween(e,t){return this._not(!0).havingBetween(e,t)}orHavingNotBetween(e,t){return this._not(!0)._bool("or").havingBetween(e,t)}havingIn(e,t){return Array.isArray(t)&&Sp(t)?this.where(this._not()):(this._statements.push({grouping:"having",type:"havingIn",column:e,value:t,not:this._not(),bool:this._bool()}),this)}orHavingIn(e,t){return this._bool("or").havingIn(e,t)}havingNotIn(e,t){return this._not(!0).havingIn(e,t)}orHavingNotIn(e,t){return this._bool("or")._not(!0).havingIn(e,t)}havingRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"having",type:"havingRaw",value:r,bool:this._bool(),not:this._not()}),this}orHavingRaw(e,t){return this._bool("or").havingRaw(e,t)}_setSkipBinding(e,t){let r=t;Hm(t)&&(r=t.skipBinding),this._single.skipBinding=this._single.skipBinding||{},this._single.skipBinding[e]=r}offset(e,t){if(null==e||e.isRawInstance||e instanceof ey)this._single.offset=e;else{const t=parseInt(e,10);if(isNaN(t))this.client.logger.warn("A valid integer must be provided to offset");else{if(t<0)throw new Error("A non-negative integer must be provided to offset.");this._single.offset=t}}return this._setSkipBinding("offset",t),this}limit(e,t){const r=parseInt(e,10);return isNaN(r)?this.client.logger.warn("A valid integer must be provided to limit"):(this._single.limit=r,this._setSkipBinding("limit",t)),this}count(e,t){return this._aggregate("count",e||"*",t)}min(e,t){return this._aggregate("min",e,t)}max(e,t){return this._aggregate("max",e,t)}sum(e,t){return this._aggregate("sum",e,t)}avg(e,t){return this._aggregate("avg",e,t)}countDistinct(...e){let t;return e.length>1&&Of((n=null==(r=e)?0:r.length)?r[n-1]:void 0)&&([t]=e.splice(e.length-1,1)),e.length?1===e.length&&(e=e[0]):e="*",this._aggregate("count",e,{...t,distinct:!0});var r,n}sumDistinct(e,t){return this._aggregate("sum",e,{...t,distinct:!0})}avgDistinct(e,t){return this._aggregate("avg",e,{...t,distinct:!0})}increment(e,t=1){if(Hm(e)){for(const t in e)this._counter(t,e[t]);return this}return this._counter(e,t)}decrement(e,t=1){if(Hm(e)){for(const t in e)this._counter(t,-e[t]);return this}return this._counter(e,-t)}clearCounters(){return this._single.counter={},this}first(...e){if(this._method&&"select"!==this._method)throw new Error(`Cannot chain .first() on "${this._method}" query`);return this.select(Bm(...e)),this._method="first",this.limit(1),this}connection(e){return this._connection=e,this.client.processPassedConnection(e),this}pluck(e){if(this._method&&"select"!==this._method)throw new Error(`Cannot chain .pluck() on "${this._method}" query`);return this._method="pluck",this._single.pluck=e,this._statements.push({grouping:"columns",type:"pluck",value:e}),this}clearSelect(){return this._clearGrouping("columns"),this}clearWhere(){return this._clearGrouping("where"),this}clearGroup(){return this._clearGrouping("group"),this}clearOrder(){return this._clearGrouping("order"),this}clearHaving(){return this._clearGrouping("having"),this}clear(e){if(!Zm.has(e))throw new Error(`Knex Error: unknown statement '${e}'`);return e.startsWith("counter")?this.clearCounters():("select"===e&&(e="columns"),this._clearGrouping(e),this)}insert(e,t,r){return this._method="insert",Sp(t)||this.returning(t,r),this._single.insert=e,this}update(e,t,r){let n;const i=this._single.update||{};if(this._method="update",Qm(e))Of(t)?i[e]=JSON.stringify(t):i[e]=t,arguments.length>2&&(n=arguments[2]);else{const t=Object.keys(e);this._single.update&&this.client.logger.warn("Update called multiple times with objects.");let r=-1;for(;++r<t.length;)i[t[r]]=e[t[r]];n=arguments[1]}return Sp(n)||this.returning(n,r),this._single.update=i,this}returning(e,t){return this._single.returning=e,this._single.options=t,this}onConflict(e){return"string"==typeof e&&(e=[e]),new ty(this,e||!0)}delete(e,t){return this._method="del",Sp(e)||this.returning(e,t),this}truncate(e){return this._method="truncate",e&&(this._single.table=e),this}columnInfo(e){return this._method="columnInfo",this._single.columnInfo=e,this}forUpdate(...e){return this._single.lock=Jm.forUpdate,1===e.length&&Array.isArray(e[0])?this._single.lockTables=e[0]:this._single.lockTables=e,this}forShare(...e){return this._single.lock=Jm.forShare,this._single.lockTables=e,this}forNoKeyUpdate(...e){return this._single.lock=Jm.forNoKeyUpdate,this._single.lockTables=e,this}forKeyShare(...e){return this._single.lock=Jm.forKeyShare,this._single.lockTables=e,this}skipLocked(){if(!this._isSelectQuery())throw new Error(`Cannot chain .skipLocked() on "${this._method}" query!`);if(!this._hasLockMode())throw new Error(".skipLocked() can only be used after a call to .forShare() or .forUpdate()!");if(this._single.waitMode===Km.noWait)throw new Error(".skipLocked() cannot be used together with .noWait()!");return this._single.waitMode=Km.skipLocked,this}noWait(){if(!this._isSelectQuery())throw new Error(`Cannot chain .noWait() on "${this._method}" query!`);if(!this._hasLockMode())throw new Error(".noWait() can only be used after a call to .forShare() or .forUpdate()!");if(this._single.waitMode===Km.skipLocked)throw new Error(".noWait() cannot be used together with .skipLocked()!");return this._single.waitMode=Km.noWait,this}fromJS(e){return Tp(e,(e,t)=>{"function"!=typeof this[t]&&this.client.logger.warn("Knex Error: unknown key "+t),Array.isArray(e)?this[t].apply(this,e):this[t](e)}),this}fromRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this.from(r)}modify(e){return e.apply(this,[this].concat(cm(arguments))),this}upsert(e,t,r){throw new Error("Upsert is not yet supported for dialect "+this.client.dialect)}_json(e,t){return this._statements.push({grouping:"columns",type:"json",method:e,params:t}),this}jsonExtract(){const e=arguments[0];let t,r,n=!0;return arguments.length>=2&&(t=arguments[1]),arguments.length>=3&&(r=arguments[2]),4===arguments.length&&(n=arguments[3]),2===arguments.length&&Array.isArray(arguments[0])&&Vm(arguments[1])&&(n=arguments[1]),this._json("jsonExtract",{column:e,path:t,alias:r,singleValue:n})}jsonSet(e,t,r,n){return this._json("jsonSet",{column:e,path:t,value:r,alias:n})}jsonInsert(e,t,r,n){return this._json("jsonInsert",{column:e,path:t,value:r,alias:n})}jsonRemove(e,t,r){return this._json("jsonRemove",{column:e,path:t,alias:r})}_isJsonObject(e){return Hm(e)&&!(e instanceof ey)}_whereJsonWrappedValue(e,t,r){const n={grouping:"where",type:e,column:t,value:r,not:this._not(),bool:this._bool(),asColumn:this._asColumnFlag};arguments[3]&&(n.operator=arguments[3]),arguments[4]&&(n.jsonPath=arguments[4]),this._statements.push(n)}whereJsonObject(e,t){return this._whereJsonWrappedValue("whereJsonObject",e,t),this}orWhereJsonObject(e,t,r){return this._bool("or").whereJsonObject(e,t,r)}whereNotJsonObject(e,t){return this._not(!0)._whereJsonWrappedValue("whereJsonObject",e,t),this}orWhereNotJsonObject(e,t,r){return this._not(!0)._bool("or").whereJsonObject(e,t,r)}whereJsonPath(e,t,r,n){return this._whereJsonWrappedValue("whereJsonPath",e,n,r,t),this}orWhereJsonPath(e,t,r,n){return this._bool("or").whereJsonPath(e,t,r,n)}whereJsonSupersetOf(e,t){return this._whereJsonWrappedValue("whereJsonSupersetOf",e,t),this}whereJsonNotSupersetOf(e,t){return this._not(!0).whereJsonSupersetOf(e,t),this}orWhereJsonSupersetOf(e,t){return this._whereJsonWrappedValue("whereJsonSupersetOf",e,t),this}orWhereJsonNotSupersetOf(e,t){return this._not(!0)._bool("or").whereJsonSupersetOf(e,t),this}whereJsonSubsetOf(e,t){return this._whereJsonWrappedValue("whereJsonSubsetOf",e,t),this}whereJsonNotSubsetOf(e,t){return this._not(!0).whereJsonSubsetOf(e,t),this}orWhereJsonSubsetOf(e,t){return this._whereJsonWrappedValue("whereJsonSubsetOf",e,t),this}orWhereJsonNotSubsetOf(e,t){return this._not(!0)._bool("or").whereJsonSubsetOf(e,t),this}whereJsonHasNone(e,t){return this._not(!0).whereJsonHasAll(e,t),this}_analytic(e,t,r){let n;const{schema:i}=this._single,s=this._analyticMethod();if(e="string"==typeof e?e:null,Wm(t))n=new class{constructor(e,t,r,n,i){this.schema=t,this.type="analytic",this.method=e,this.order=n||[],this.partitions=i||[],this.alias=r,this.and=this,this.grouping="columns"}partitionBy(e,t){return Array.isArray(e)?this.partitions=this.partitions.concat(e):this.partitions.push({column:e,order:t}),this}orderBy(e,t){return Array.isArray(e)?this.order=this.order.concat(e):this.order.push({column:e,order:t}),this}}(s,i,e),t.call(n,n);else if(t.isRawInstance)n={grouping:"columns",type:"analytic",method:s,raw:t,alias:e};else{let i=r||[];n={grouping:"columns",type:"analytic",method:s,order:Array.isArray(t)?t:[t],alias:e,partitions:i=Array.isArray(i)?i:[i]}}return this._statements.push(n),this}rank(...e){return this._analyticMethod("rank")._analytic(...e)}denseRank(...e){return this._analyticMethod("dense_rank")._analytic(...e)}rowNumber(...e){return this._analyticMethod("row_number")._analytic(...e)}_counter(e,t){return t=parseFloat(t),this._method="update",this._single.counter=this._single.counter||{},this._single.counter[e]=t,this}_bool(e){if(1===arguments.length)return this._boolFlag=e,this;const t=this._boolFlag;return this._boolFlag="and",t}_not(e){if(1===arguments.length)return this._notFlag=e,this;const t=this._notFlag;return this._notFlag=!1,t}_joinType(e){if(1===arguments.length)return this._joinFlag=e,this;const t=this._joinFlag||"inner";return this._joinFlag="inner",t}_analyticMethod(e){return 1===arguments.length?(this._analyticFlag=e,this):this._analyticFlag||"row_number"}_aggregate(e,t,r={}){return this._statements.push({grouping:"columns",type:t.isRawInstance?"aggregateRaw":"aggregate",method:e,value:t,aggregateDistinct:r.distinct||!1,alias:r.as}),this}_clearGrouping(e){var t,r;e in this._single?this._single[e]=void 0:this._statements=(t=this._statements,r={grouping:e},(ph(t)?Zh:kp)(t,lm(um(r))))}_isSelectQuery(){return Ym.has(this._method)}_hasLockMode(){return Xm.has(this._single.lock)}}ey.prototype.select=ey.prototype.columns,ey.prototype.column=ey.prototype.columns,ey.prototype.andWhereNot=ey.prototype.whereNot,ey.prototype.andWhereNotColumn=ey.prototype.whereNotColumn,ey.prototype.andWhere=ey.prototype.where,ey.prototype.andWhereColumn=ey.prototype.whereColumn,ey.prototype.andWhereRaw=ey.prototype.whereRaw,ey.prototype.andWhereBetween=ey.prototype.whereBetween,ey.prototype.andWhereNotBetween=ey.prototype.whereNotBetween,ey.prototype.andWhereJsonObject=ey.prototype.whereJsonObject,ey.prototype.andWhereNotJsonObject=ey.prototype.whereJsonObject,ey.prototype.andWhereJsonPath=ey.prototype.whereJsonPath,ey.prototype.andWhereLike=ey.prototype.whereLike,ey.prototype.andWhereILike=ey.prototype.whereILike,ey.prototype.andHaving=ey.prototype.having,ey.prototype.andHavingIn=ey.prototype.havingIn,ey.prototype.andHavingNotIn=ey.prototype.havingNotIn,ey.prototype.andHavingNull=ey.prototype.havingNull,ey.prototype.andHavingNotNull=ey.prototype.havingNotNull,ey.prototype.andHavingExists=ey.prototype.havingExists,ey.prototype.andHavingNotExists=ey.prototype.havingNotExists,ey.prototype.andHavingBetween=ey.prototype.havingBetween,ey.prototype.andHavingNotBetween=ey.prototype.havingNotBetween,ey.prototype.from=ey.prototype.table,ey.prototype.into=ey.prototype.table,ey.prototype.del=ey.prototype.delete,Gm(ey),Um(ey),ey.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(ey.prototype,e))throw new Error(`Can't extend QueryBuilder with existing method ('${e}').`);Cp(ey.prototype,{[e]:t})};class ty{constructor(e,t){this.builder=e,this._columns=t}ignore(){return this.builder._single.onConflict=this._columns,this.builder._single.ignore=!0,this.builder}merge(e){return this.builder._single.onConflict=this._columns,this.builder._single.merge={updates:e},this.builder}then(){throw new Error("Incomplete onConflict clause. .onConflict() must be directly followed by either .merge() or .ignore()")}}var ry=ey,ny=function(e,t,r,n){var i=-1,s=null==e?0:e.length;for(n&&s&&(r=e[++i]);++i<s;)r=t(r,e[i],i,e);return r},iy=function(e,t,r,n,i){return i(e,(function(e,i,s){r=n?(n=!1,e):t(r,e,i,s)})),r},sy=function(e,t,r){var n=ph(e)?ny:iy,i=arguments.length<3;return n(e,um(t),r,i,xp)};const{isObject:oy}=Jf;var ay={compileCallback:function(e,t,r,n){const i=r.queryBuilder();return e.call(i,i),r.queryCompiler(i,n.bindings).toSQL(t||i._method||"select")},wrapAsIdentifier:function(e,t,r){const n=t.queryContext();return r.wrapIdentifier((e||"").trim(),n)},formatDefault:function(e,t,r){return void 0===e?"":null===e?"null":e&&e.isRawInstance?e.toQuery():"bool"===t?("false"===e&&(e=0),`'${e?1:0}'`):"json"!==t&&"jsonb"!==t||!oy(e)?r._escapeBinding(e.toString()):`'${JSON.stringify(e)}'`}};const{compileCallback:uy,wrapAsIdentifier:ly}=ay,cy=["asc","desc"],hy=function(e,t,r){var n=ph(e),i=n||mh(e)||Ah(e);if(t=um(t),null==r){var s=e&&e.constructor;r=i?n?new s:[]:jc(e)&&Ac(s)?kd(id(e)):{}}return(i?rh:$p)(e,(function(e,n,i){return t(r,e,n,i)})),r}(["=","<",">","<=",">=","<>","!=","like","not like","between","not between","ilike","not ilike","exists","not exist","rlike","not rlike","regexp","not regexp","match","&","|","^","<<",">>","~","~=","~*","!~","!~*","#","&&","@>","<@","||","&<","&>","-|-","@@","!!",["?","\\?"],["?|","\\?|"],["?&","\\?&"]],(e,t)=>{Array.isArray(t)?e[t[0]]=t[1]:e[t]=t},{});function dy(e,t,r,n,i){const s=fy(e,t,r,n,i);if(s)return s;switch(typeof e){case"function":return my(uy(e,void 0,n,i),!0,r,n);case"object":return function(e,t,r,n){const i=[];for(const s in e){const o=e[s];if("function"==typeof o){const e=uy(o,void 0,r,n);e.as=s,i.push(my(e,!0,t,r))}else o instanceof ry?i.push(r.alias(`(${dy(o,void 0,t,r,n)})`,ly(s,t,r))):i.push(r.alias(dy(o,void 0,t,r,n),ly(s,t,r)))}return i.join(", ")}(e,r,n,i);case"number":return e;default:return py(e+"",r,n)}}function fy(e,t,r,n,i){let s;return e instanceof ry?((s=n.queryCompiler(e).toSQL()).bindings&&i.bindings.push(...s.bindings),my(s,t,r,n)):e&&e.isRawInstance?(e.client=n,r._queryContext&&(e.queryContext=()=>r._queryContext),(s=e.toSQL()).bindings&&i.bindings.push(...s.bindings),s.sql):void(t&&i.bindings.push(e))}function py(e,t,r){const n=e.toLowerCase().indexOf(" as ");if(-1!==n){const i=e.slice(0,n),s=e.slice(n+4);return r.alias(py(i,t,r),ly(s,t,r))}const i=[];let s=-1;const o=e.split(".");for(;++s<o.length;)e=o[s],0===s&&o.length>1?i.push(py((e||"").trim(),t,r)):i.push(ly(e,t,r));return i.join(".")}function my(e,t,r,n){let i=e.sql||"";return i&&("select"===e.method||"first"===e.method)&&(t||e.as)&&(i=`(${i})`,e.as)?n.alias(i,py(e.as,r,n)):i}var yy={columnize:function(e,t,r,n){const i=Array.isArray(e)?e:[e];let s="",o=-1;for(;++o<i.length;)o>0&&(s+=", "),s+=dy(i[o],void 0,t,r,n);return s},direction:function(e,t,r,n){return fy(e,void 0,t,r,n)||(-1!==cy.indexOf((e||"").toLowerCase())?e:"asc")},operator:function(e,t,r,n){const i=fy(e,void 0,t,r,n);if(i)return i;const s=hy[(e||"").toLowerCase()];if(!s)throw new TypeError(`The operator "${e}" is not permitted`);return s},outputQuery:my,rawOrFn:function(e,t,r,n,i){return"function"==typeof e?my(uy(e,t,n,i),void 0,r,n):fy(e,void 0,r,n,i)||""},unwrapRaw:fy,wrap:dy,wrapString:py};const{columnize:gy}=yy;var vy={replaceKeyBindings:function(e,t){const r={bindings:[]},n=e,i=e.bindings;return{method:"raw",sql:e.sql.replace(/\\?(:(\w+):(?=::)|:(\w+):(?!:)|:(\w+))/g,(function(e,s,o,a,u){if(e!==s)return s;const l=o||a||u,c=e.trim(),h=":"===c[c.length-1],d=i[l];return void 0===d?(Object.prototype.hasOwnProperty.call(i,l)&&r.bindings.push(d),e):h?e.replace(s,gy(d,n,t,r)):e.replace(s,t.parameter(d,n,r))})),bindings:r.bindings}},replaceRawArrBindings:function(e,t){const r={bindings:[]},n=e,i=e.bindings.length,s=e.bindings;let o=0;const a=e.sql.replace(/\\?\?\??/g,(function(e){if("\\?"===e)return e;const i=s[o++];return"??"===e?gy(i,n,t,r):t.parameter(i,n,r)}));if(i!==o)throw new Error(`Expected ${i} bindings, saw ${o}`);return{method:"raw",sql:a,bindings:r.bindings}}};var by={nanoid:function(e=21){let t="",r=e;for(;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},nanonum:function(e=21){let t="",r=e;for(;r--;)t+="0123456789"[10*Math.random()|0];return t}},_y={};const{EventEmitter:wy}=require("events"),{replaceRawArrBindings:Ey,replaceKeyBindings:Cy}=vy,{nanoid:Ny}=by,{isNumber:$y,isObject:xy}=Jf,{augmentWithBuilderInterface:Ty}=Dm,Oy=yf("knex:bindings");class Sy extends wy{constructor(e){super(),this.client=e,this.sql="",this.bindings=[],this._wrappedBefore=void 0,this._wrappedAfter=void 0,e&&e.config&&(this._debug=e.config.debug,qm(this,4))}set(e,t){return this.sql=e,this.bindings=xy(t)&&!t.toSQL||void 0===t?t:[t],this}timeout(e,{cancel:t}={}){return $y(e)&&e>0&&(this._timeout=e,t&&(this.client.assertCanCancelQuery(),this._cancelOnTimeout=!0)),this}wrap(e,t){return this._wrappedBefore=e,this._wrappedAfter=t,this}toString(){return this.toQuery()}toSQL(e,t){let r;if(r=Array.isArray(this.bindings)?Ey(this,this.client):this.bindings&&Of(this.bindings)?Cy(this,this.client):{method:"raw",sql:this.sql,bindings:void 0===this.bindings?[]:[this.bindings]},this._wrappedBefore&&(r.sql=this._wrappedBefore+r.sql),this._wrappedAfter&&(r.sql=r.sql+this._wrappedAfter),r.options=sy(this._options,Cp,{}),this._timeout&&(r.timeout=this._timeout,this._cancelOnTimeout&&(r.cancelOnTimeout=this._cancelOnTimeout)),r.bindings=r.bindings||[],Am.containsUndefined(r.bindings)){const e=Am.getUndefinedIndices(this.bindings);throw Oy(r.bindings),new Error(`Undefined binding(s) detected for keys [${e}] when compiling RAW query: ${r.sql}`)}return r.__knexQueryUid=Ny(),Object.defineProperties(r,{toNative:{value:()=>({sql:this.client.positionBindings(r.sql),bindings:this.client.prepBindings(r.bindings)}),enumerable:!1}}),r}}Sy.prototype.isRawInstance=!0,Ty(Sy),Am.addQueryContext(Sy),_y=Sy;var ky,jy,Ay=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var s=e[t];s&&(i[n++]=s)}return i},Ry=function(e,t,r,n){for(var i=-1,s=null==e?0:e.length;++i<s;){var o=e[i];t(n,o,r(o),e)}return n},Iy=function(e,t,r,n){return xp(e,(function(e,i,s){t(n,e,r(e),s)})),n},Py=Object.prototype.hasOwnProperty,qy=(ky=function(e,t,r){Py.call(e,r)?e[r].push(t):ih(e,r,[t])},function(e,t){var r=ph(e)?Ry:Iy,n=jy?jy():{};return r(e,ky,um(t),n)}),Ly=Object.prototype.hasOwnProperty,My=function(e,t){return null!=e&&Ly.call(e,t)},Dy=function(e,t){return null!=e&&sm(e,t,My)},Fy=function(e,t){var r=-1,n=Uh(e)?Array(e.length):[];return xp(e,(function(e,i,s){n[++r]=t(e,i,s)})),n},Uy=function(e,t){return(ph(e)?Zd:Fy)(e,um(t))},By=function(e,t,r,n){if(!jc(e))return e;for(var i=-1,s=(t=tm(t,e)).length,o=s-1,a=e;null!=a&&++i<s;){var u=rm(t[i]),l=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=o){var c=a[u];void 0===(l=n?n(c,u,a):void 0)&&(l=jc(c)?c:Eh(t[i+1])?[]:{})}oh(a,u,l),a=a[u]}return e},Vy=function(e,t){if(null==e)return{};var r=Zd(ud(e),(function(e){return[e]}));return t=um(t),function(e,t,r){for(var n=-1,i=t.length,s={};++n<i;){var o=t[n],a=nm(e,o);r(a,o)&&By(s,tm(o,e),a)}return s}(e,r,(function(e,r){return t(e,r[0])}))};const{nanoid:zy}=by,{isString:Hy,isUndefined:Qy}=Jf,{columnize:Wy,direction:Jy,operator:Ky,wrap:Gy,unwrapRaw:Yy,rawOrFn:Zy}=yy,Xy=yf("knex:bindings"),eg=["columns","join","where","union","group","having","order","limit","offset","lock","waitMode"];var tg=class{constructor(e,t,r){this.client=e,this.method=t._method||"select",this.options=t._options,this.single=t._single,this.timeout=t._timeout||!1,this.cancelOnTimeout=t._cancelOnTimeout||!1,this.grouped=qy(t._statements,"grouping"),this.formatter=e.formatter(t),this._emptyInsertValue="default values",this.first=this.select,this.bindings=r||[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.builder=this.formatter.builder}toSQL(e,t){this._undefinedInWhereClause=!1,this.undefinedBindingsInfo=[];const r=this[e=e||this.method]()||"",n={method:e,options:sy(this.options,Cp,{}),timeout:this.timeout,cancelOnTimeout:this.cancelOnTimeout,bindings:this.bindingsHolder.bindings||[],__knexQueryUid:zy()};if(Object.defineProperties(n,{toNative:{value:()=>({sql:this.client.positionBindings(n.sql),bindings:this.client.prepBindings(n.bindings)}),enumerable:!1}}),Hy(r)?n.sql=r:Cp(n,r),"select"!==e&&"first"!==e||this.single.as&&(n.as=this.single.as),this._undefinedInWhereClause)throw Xy(n.bindings),new Error(`Undefined binding(s) detected when compiling ${e.toUpperCase()}. Undefined column(s): [${this.undefinedBindingsInfo.join(", ")}] query: ${n.sql}`);return n}select(){let e=this.with(),t="";const r=[],n=[];eg.forEach(e=>{const i=this[e](this);switch(e){case"union":t=i;break;case"columns":case"join":case"where":r.push(i);break;default:n.push(i)}});const i=this.grouped.union&&this.grouped.union.map(e=>e.wrap).some(e=>e);if(this.onlyUnions()){const i=Ay(r.concat(n)).join(" ");e+=t+(i?" "+i:"")}else{const s=(i?"(":"")+Ay(r).join(" ")+(i?")":""),o=Ay(n).join(" ");e+=s+(t?" "+t:"")+(o?" "+o:o)}return e}pluck(){let e=this.single.pluck;return-1!==e.indexOf(".")&&(e=e.split(".").slice(-1)[0]),{sql:this.select(),pluck:e}}insert(){const e=this.single.insert||[],t=this.with()+`insert into ${this.tableName} `,r=this._insertBody(e);return""===r?"":t+r}_onConflictClause(e){return e instanceof _y?this.formatter.wrap(e):`(${this.formatter.columnize(e)})`}_buildInsertValues(e){let t="",r=-1;for(;++r<e.values.length;)0!==r&&(t+="), ("),t+=this.client.parameterize(e.values[r],this.client.valueForUndefined,this.builder,this.bindingsHolder);return t}_insertBody(e){let t="";if(Array.isArray(e)){if(0===e.length)return""}else if("object"==typeof e&&Sp(e))return t+this._emptyInsertValue;const r=this._prepInsert(e);return"string"==typeof r?t+=r:r.columns.length?(t+="("+Wy(r.columns,this.builder,this.client,this.bindingsHolder),t+=") values ("+this._buildInsertValues(r)+")"):1===e.length&&e[0]?t+=this._emptyInsertValue:t="",t}update(){const e=this.with(),{tableName:t}=this,r=this._prepUpdate(this.single.update),n=this.where();return e+`update ${this.single.only?"only ":""}${t} set `+r.join(", ")+(n?" "+n:"")}_hintComments(){let e=this.grouped.hintComments||[];return e=e.map(e=>Ay(e.value).join(" ")),(e=Ay(e).join(" "))?`/*+ ${e} */ `:""}columns(){let e="";if(this.onlyUnions())return"";const t=this._hintComments(),r=this.grouped.columns||[];let n=-1,i=[];if(r)for(;++n<r.length;){const t=r[n];t.distinct&&(e="distinct "),t.distinctOn?e=this.distinctOn(t.value):"aggregate"===t.type?i.push(...this.aggregate(t)):"aggregateRaw"===t.type?i.push(this.aggregateRaw(t)):"analytic"===t.type?i.push(this.analytic(t)):"json"===t.type?i.push(this.json(t)):t.value&&t.value.length>0&&i.push(Wy(t.value,this.builder,this.client,this.bindingsHolder))}return 0===i.length&&(i=["*"]),`${this.onlyJson()?"":"select "}${t}${e}`+i.join(", ")+(this.tableName?` from ${this.single.only?"only ":""}${this.tableName}`:"")}_aggregate(e,{aliasSeparator:t=" as ",distinctParentheses:r}={}){const n=e.value,i=e.method,s=e.aggregateDistinct?"distinct ":"",o=e=>Gy(e,void 0,this.builder,this.client,this.bindingsHolder),a=(e,r)=>r?e+t+o(r):e,u=(e,t)=>{let n=e.map(o).join(", ");if(s){const e=r?"(":" ",t=r?")":"";n=s.trim()+e+n+t}return a(`${i}(${n})`,t)},l=(e,t)=>{const r=`${i}(${s+o(e)})`;return a(r,t)};if(Array.isArray(n))return[u(n)];if("object"==typeof n){if(e.alias)throw new Error("When using an object explicit alias can not be used");return Object.entries(n).map(([e,t])=>Array.isArray(t)?u(t,e):l(t,e))}const c=n.toLowerCase().indexOf(" as ");let h=n,{alias:d}=e;if(-1!==c){if(h=n.slice(0,c),d)throw new Error("Found multiple aliases for same column: "+h);d=n.slice(c+4)}return[l(h,d)]}aggregate(e){return this._aggregate(e)}aggregateRaw(e){const t=e.aggregateDistinct?"distinct ":"";return`${e.method}(${t+Yy(e.value,void 0,this.builder,this.client,this.bindingsHolder)})`}_joinTable(e){return!e.schema||e.table instanceof _y?e.table:`${e.schema}.${e.table}`}join(){let e="",t=-1;const r=this.grouped.join;if(!r)return"";for(;++t<r.length;){const n=r[t],i=this._joinTable(n);if(t>0&&(e+=" "),"raw"===n.joinType)e+=Yy(n.table,void 0,this.builder,this.client,this.bindingsHolder);else{e+=n.joinType+" join "+Gy(i,void 0,this.builder,this.client,this.bindingsHolder);let t=-1;for(;++t<n.clauses.length;){const r=n.clauses[t];e+=t>0?` ${r.bool} `:` ${"onUsing"===r.type?"using":"on"} `;const i=this[r.type](r);i&&(e+=i)}}}return e}onBetween(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"between")+" "+e.value.map(e=>this.client.parameter(e,this.builder,this.bindingsHolder)).join(" and ")}onNull(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" is "+this._not(e,"null")}onExists(e){return this._not(e,"exists")+" ("+Zy(e.value,void 0,this.builder,this.client,this.bindingsHolder)+")"}onIn(e){if(Array.isArray(e.column))return this.multiOnIn(e);let t;return t=e.value instanceof _y?this.client.parameter(e.value,this.builder,this.formatter):this.client.parameterize(e.value,void 0,this.builder,this.bindingsHolder),Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"in ")+this.wrap(t)}multiOnIn(e){let t=-1,r=`(${Wy(e.column,this.builder,this.client,this.bindingsHolder)}) `;for(r+=this._not(e,"in ")+"((";++t<e.value.length;)0!==t&&(r+="),("),r+=this.client.parameterize(e.value[t],void 0,this.builder,this.bindingsHolder);return r+"))"}where(){const e=this.grouped.where;if(!e)return;const t=[];let r=-1;for(;++r<e.length;){const n=e[r];Object.prototype.hasOwnProperty.call(n,"value")&&Am.containsUndefined(n.value)&&(this.undefinedBindingsInfo.push(n.column),this._undefinedInWhereClause=!0);const i=this[n.type](n);i&&(0===t.length?t[0]="where":t.push(n.bool),t.push(i))}return t.length>1?t.join(" "):""}group(){return this._groupsOrders("group")}order(){return this._groupsOrders("order")}having(){const e=this.grouped.having;if(!e)return"";const t=["having"];for(let r=0,n=e.length;r<n;r++){const n=e[r],i=this[n.type](n);i&&(0===t.length&&(t[0]="where"),(t.length>1||1===t.length&&"having"!==t[0])&&t.push(n.bool),t.push(i))}return t.length>1?t.join(" "):""}havingRaw(e){return this._not(e,"")+Yy(e.value,void 0,this.builder,this.client,this.bindingsHolder)}havingWrapped(e){const t=Zy(e.value,"where",this.builder,this.client,this.bindingsHolder);return t&&this._not(e,"")+"("+t.slice(6)+")"||""}havingBasic(e){return this._not(e,"")+Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+Ky(e.operator,this.builder,this.client,this.bindingsHolder)+" "+this.client.parameter(e.value,this.builder,this.bindingsHolder)}havingNull(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" is "+this._not(e,"null")}havingExists(e){return this._not(e,"exists")+" ("+Zy(e.value,void 0,this.builder,this.client,this.bindingsHolder)+")"}havingBetween(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"between")+" "+e.value.map(e=>this.client.parameter(e,this.builder,this.bindingsHolder)).join(" and ")}havingIn(e){return Array.isArray(e.column)?this.multiHavingIn(e):Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"in ")+this.wrap(this.client.parameterize(e.value,void 0,this.builder,this.bindingsHolder))}multiHavingIn(e){return this.multiOnIn(e)}union(){const e=this.onlyUnions(),t=this.grouped.union;if(!t)return"";let r="";for(let n=0,i=t.length;n<i;n++){const i=t[n];n>0&&(r+=" "),(n>0||!e)&&(r+=i.clause+" ");const s=Zy(i.value,void 0,this.builder,this.client,this.bindingsHolder);if(s){const e=i.wrap;e&&(r+="("),r+=s,e&&(r+=")")}}return r}onlyUnions(){return(!this.grouped.columns||!!this.grouped.columns[0].value)&&this.grouped.union&&!this.tableName}_getValueOrParameterFromAttribute(e,t){return!0===this.single.skipBinding[e]?null!=t?t:this.single[e]:this.client.parameter(this.single[e],this.builder,this.bindingsHolder)}onlyJson(){return!this.tableName&&this.grouped.columns&&1===this.grouped.columns.length&&"json"===this.grouped.columns[0].type}limit(){return this.single.limit||0===this.single.limit?"limit "+this._getValueOrParameterFromAttribute("limit"):""}offset(){return this.single.offset?"offset "+this._getValueOrParameterFromAttribute("offset"):""}del(){const{tableName:e}=this,t=this.with(),r=this.where(),n=this.join();return t+`delete ${n?e+" ":""}from ${this.single.only?"only ":""}${e}`+(n?" "+n:"")+(r?" "+r:"")}truncate(){return"truncate "+this.tableName}lock(){if(this.single.lock)return this[this.single.lock]()}waitMode(){if(this.single.waitMode)return this[this.single.waitMode]()}skipLocked(){throw new Error(".skipLocked() is currently only supported on MySQL 8.0+ and PostgreSQL 9.5+")}noWait(){throw new Error(".noWait() is currently only supported on MySQL 8.0+, MariaDB 10.3.0+ and PostgreSQL 9.5+")}distinctOn(e){throw new Error(".distinctOn() is currently only supported on PostgreSQL")}onWrapped(e){const t=this,r=new Rm;e.value.call(r,r);let n="";for(let i=0;i<r.clauses.length;i++){const e=r.clauses[i];i>0&&(n+=` ${e.bool} `);const s=t[e.type](e);s&&(n+=s)}return n.length?`(${n})`:""}onBasic(e){const t=e.value instanceof ry;return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+Ky(e.operator,this.builder,this.client,this.bindingsHolder)+" "+(t?"(":"")+Gy(e.value,void 0,this.builder,this.client,this.bindingsHolder)+(t?")":"")}onVal(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+Ky(e.operator,this.builder,this.client,this.bindingsHolder)+" "+this.client.parameter(e.value,this.builder,this.bindingsHolder)}onRaw(e){return Yy(e.value,void 0,this.builder,this.client,this.bindingsHolder)}onUsing(e){return"("+Wy(e.column,this.builder,this.client,this.bindingsHolder)+")"}_valueClause(e){return e.asColumn?Gy(e.value,void 0,this.builder,this.client,this.bindingsHolder):this.client.parameter(e.value,this.builder,this.bindingsHolder)}_columnClause(e){return Array.isArray(e.column)?`(${Wy(e.column,this.builder,this.client,this.bindingsHolder)})`:Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)}whereIn(e){const t=this.client.values(e.value,this.builder,this.bindingsHolder);return`${this._columnClause(e)} ${this._not(e,"in ")}${t}`}whereLike(e){return`${this._columnClause(e)} ${this._not(e,"like ")}${this._valueClause(e)}`}whereILike(e){return`${this._columnClause(e)} ${this._not(e,"ilike ")}${this._valueClause(e)}`}whereNull(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" is "+this._not(e,"null")}whereBasic(e){return this._not(e,"")+Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+Ky(e.operator,this.builder,this.client,this.bindingsHolder)+" "+this._valueClause(e)}whereExists(e){return this._not(e,"exists")+" ("+Zy(e.value,void 0,this.builder,this.client,this.bindingsHolder)+")"}whereWrapped(e){const t=Zy(e.value,"where",this.builder,this.client,this.bindingsHolder);return t&&this._not(e,"")+"("+t.slice(6)+")"||""}whereBetween(e){return Gy(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"between")+" "+e.value.map(e=>this.client.parameter(e,this.builder,this.bindingsHolder)).join(" and ")}whereRaw(e){return this._not(e,"")+Yy(e.value,void 0,this.builder,this.client,this.bindingsHolder)}_jsonWrapValue(e){if(!this.builder._isJsonObject(e))try{return JSON.stringify(JSON.parse(e.replace(/\n|\t/g,"")))}catch(Zv){return e}return JSON.stringify(e)}_jsonValueClause(e){return e.value=this._jsonWrapValue(e.value),this._valueClause(e)}whereJsonObject(e){return`${this._columnClause(e)} ${e.not?"!=":"="} ${this._jsonValueClause(e)}`}wrap(e){return"("!==e.charAt(0)?`(${e})`:e}json(e){return this[e.method](e.params)}analytic(e){let t="";const r=this;return t+=e.method+"() over (",e.raw?t+=e.raw:(e.partitions.length&&(t+="partition by ",t+=Uy(e.partitions,(function(e){return Hy(e)?r.formatter.columnize(e):r.formatter.columnize(e.column)+(e.order?" "+e.order:"")})).join(", ")+" "),t+="order by ",t+=Uy(e.order,(function(e){return Hy(e)?r.formatter.columnize(e):r.formatter.columnize(e.column)+(e.order?" "+e.order:"")})).join(", ")),t+=")",e.alias&&(t+=" as "+e.alias),t}with(){if(!this.grouped.with||!this.grouped.with.length)return"";const e=this.grouped.with;if(!e)return;const t=[];let r=-1,n=!1;for(;++r<e.length;){const i=e[r];i.recursive&&(n=!0);const s=this[i.type](i);t.push(s)}return`with ${n?"recursive ":""}${t.join(", ")} `}withWrapped(e){const t=Zy(e.value,void 0,this.builder,this.client,this.bindingsHolder),r=e.columnList?"("+Wy(e.columnList,this.builder,this.client,this.bindingsHolder)+")":"",n=void 0===e.materialized?"":e.materialized?"materialized ":"not materialized ";return t&&Wy(e.alias,this.builder,this.client,this.bindingsHolder)+r+" as "+n+"("+t+")"||""}_not(e,t){return e.not?"not "+t:t}_prepInsert(e){const t=Zy(e,void 0,this.builder,this.client,this.bindingsHolder);if(t)return t;let r=[];const n=[];Array.isArray(e)||(e=e?[e]:[]);let i=-1;for(;++i<e.length&&null!=e[i];){0===i&&(r=Object.keys(e[i]).sort());const t=new Array(r.length),s=Object.keys(e[i]);let o=-1;for(;++o<s.length;){const a=s[o];let u=r.indexOf(a);if(-1===u){u=(r=r.concat(a).sort()).indexOf(a);let e=-1;for(;++e<n.length;)n[e].splice(u,0,void 0);t.splice(u,0,void 0)}t[u]=e[i][a]}n.push(t)}return{columns:r,values:n}}_prepUpdate(e={}){const{counter:t={}}=this.single;for(const s of Object.keys(t)){if(Dy(e,s)){this.client.logger.warn("increment/decrement called for a column that has already been specified in main .update() call. Ignoring increment/decrement and using value from .update() call.");continue}let r=t[s];const n=r<0?"-":"+";"-"===n&&(r=-r),e[s]=this.client.raw(`?? ${n} ?`,[s,r])}e=Vy(e,lm(um(Qy)));const r=[],n=Object.keys(e);let i=-1;for(;++i<n.length;)r.push(Gy(n[i],void 0,this.builder,this.client,this.bindingsHolder)+" = "+this.client.parameter(e[n[i]],this.builder,this.bindingsHolder));if(Sp(r))throw new Error(["Empty .update() call detected!","Update data does not contain any values to update.","This will result in a faulty query.",this.single.table?`Table: ${this.single.table}.`:"",this.single.update?`Columns: ${Object.keys(this.single.update)}.`:""].join(" "));return r}_formatGroupsItemValue(e,t){const{formatter:r}=this;let n="";return"last"===t?n=" is null":"first"===t&&(n=" is not null"),e instanceof _y?Yy(e,void 0,this.builder,this.client,this.bindingsHolder):e instanceof ry||t?"("+r.columnize(e)+n+")":r.columnize(e)}_basicGroupOrder(e,t){return this._formatGroupsItemValue(e.value,e.nulls)+("order"===t&&"orderByRaw"!==e.type?" "+Jy(e.direction,this.builder,this.client,this.bindingsHolder):"")}_groupOrder(e,t){return this._basicGroupOrder(e,t)}_groupOrderNulls(e,t){const r=this._formatGroupsItemValue(e.value),n="order"===t&&"orderByRaw"!==e.type?" "+Jy(e.direction,this.builder,this.client,this.bindingsHolder):"";return!e.nulls||e.value instanceof _y?r+n:`${r}${n||""} nulls ${e.nulls}`}_groupsOrders(e){const t=this.grouped[e];if(!t)return"";const r=t.map(t=>this._groupOrder(t,e));return r.length?e+" by "+r.join(", "):""}get tableName(){if(!this._tableName){let e=this.single.table;const t=this.single.schema;if(e&&t){const r=e instanceof _y,n="function"==typeof e;e instanceof ry||r||n||(e=`${t}.${e}`)}this._tableName=e?Gy(e,e instanceof ry,this.builder,this.client,this.bindingsHolder):""}return this._tableName}_jsonPathWrap(e){return this.client.parameter(e.path||e[1],this.builder,this.bindingsHolder)}_jsonExtract(e,t){let r;return r=Array.isArray(t.column)?t.column:[t],Array.isArray(e)||(e=[e]),r.map(t=>{let r=`${Wy(t.column||t[0],this.builder,this.client,this.bindingsHolder)}, ${this._jsonPathWrap(t)}`;e.forEach(e=>{r=e+"("+r+")"});const n=t.alias||t[2];return n?this.client.alias(r,this.formatter.wrap(n)):r}).join(", ")}_jsonSet(e,t){const r=`${e}(${Wy(t.column,this.builder,this.client,this.bindingsHolder)}, ${this.client.parameter(t.path,this.builder,this.bindingsHolder)}, ${this.client.parameter(t.value,this.builder,this.bindingsHolder)})`;return t.alias?this.client.alias(r,this.formatter.wrap(t.alias)):r}_whereJsonPath(e,t){return`${e}(${this._columnClause(t)}, ${this._jsonPathWrap({path:t.jsonPath})}) ${Ky(t.operator,this.builder,this.client,this.bindingsHolder)} ${this._jsonValueClause(t)}`}_onJsonPathEquals(e,t){return e+"("+Gy(t.columnFirst,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.parameter(t.jsonPathFirst,this.builder,this.bindingsHolder)+") = "+e+"("+Gy(t.columnSecond,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.parameter(t.jsonPathSecond,this.builder,this.bindingsHolder)+")"}},rg={};const{EventEmitter:ng}=require("events"),{addQueryContext:ig}=Am,{augmentWithBuilderInterface:sg}=Dm;class og extends ng{constructor(e){super(),this.client=e,this._sequence=[],e.config&&(this._debug=e.config.debug,qm(this,4))}withSchema(e){return this._schema=e,this}toString(){return this.toQuery()}toSQL(){return this.client.schemaCompiler(this).toSQL()}async generateDdlCommands(){return await this.client.schemaCompiler(this).generateDdlCommands()}}["createTable","createTableIfNotExists","createTableLike","createView","createViewOrReplace","createMaterializedView","refreshMaterializedView","dropView","dropViewIfExists","dropMaterializedView","dropMaterializedViewIfExists","createSchema","createSchemaIfNotExists","dropSchema","dropSchemaIfExists","createExtension","createExtensionIfNotExists","dropExtension","dropExtensionIfExists","table","alterTable","view","alterView","hasTable","hasColumn","dropTable","renameTable","renameView","dropTableIfExists","raw"].forEach((function(e){og.prototype[e]=function(){return"createTableIfNotExists"===e&&this.client.logger.warn(["Use async .hasTable to check if table exists and then use plain .createTable. Since ",'.createTableIfNotExists actually just generates plain "CREATE TABLE IF NOT EXIST..." ',"query it will not work correctly if there are any alter table queries generated for ","columns afterwards. To not break old migrations this function is left untouched for now",", but it should not be used when writing new code and it is removed from documentation."].join("")),"table"===e&&(e="alterTable"),"view"===e&&(e="alterView"),this._sequence.push({method:e,args:Nm(arguments)}),this}})),og.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(og.prototype,e))throw new Error(`Can't extend SchemaBuilder with existing method ('${e}').`);Cp(og.prototype,{[e]:t})},sg(og),ig(og),rg=og;const{isString:ag}=Jf;var ug={pushAdditional:function(e){const t=new this.constructor(this.client,this.tableCompiler,this.columnBuilder);e.call(t,cm(arguments)),this.sequence.additional=(this.sequence.additional||[]).concat(t.sequence)},pushQuery:function(e){e&&(ag(e)&&(e={sql:e}),e.bindings||(e.bindings=this.bindingsHolder.bindings),this.sequence.push(e),this.formatter=this.client.formatter(this._commonBuilder),this.bindings=[],this.formatter.bindings=this.bindings)},unshiftQuery:function(e){e&&(ag(e)&&(e={sql:e}),e.bindings||(e.bindings=this.bindingsHolder.bindings),this.sequence.unshift(e),this.formatter=this.client.formatter(this._commonBuilder),this.bindings=[],this.formatter.bindings=this.bindings)}},lg={};const{pushQuery:cg,pushAdditional:hg,unshiftQuery:dg}=ug;class fg{constructor(e,t){this.builder=t,this._commonBuilder=this.builder,this.client=e,this.schema=t._schema,this.bindings=[],this.bindingsHolder=this,this.formatter=e.formatter(t),this.formatter.bindings=this.bindings,this.sequence=[]}createSchema(){vg("createSchema")}createSchemaIfNotExists(){vg("createSchemaIfNotExists")}dropSchema(){vg("dropSchema")}dropSchemaIfExists(){vg("dropSchemaIfExists")}dropTable(e){this.pushQuery(this.dropTablePrefix+this.formatter.wrap(gg(this.schema,e)))}dropTableIfExists(e){this.pushQuery(this.dropTablePrefix+"if exists "+this.formatter.wrap(gg(this.schema,e)))}dropView(e){this._dropView(e,!1,!1)}dropViewIfExists(e){this._dropView(e,!0,!1)}dropMaterializedView(e){throw new Error("materialized views are not supported by this dialect.")}dropMaterializedViewIfExists(e){throw new Error("materialized views are not supported by this dialect.")}renameView(e,t){throw new Error("rename view is not supported by this dialect (instead drop then create another view).")}refreshMaterializedView(){throw new Error("materialized views are not supported by this dialect.")}_dropView(e,t,r){this.pushQuery((r?this.dropMaterializedViewPrefix:this.dropViewPrefix)+(t?"if exists ":"")+this.formatter.wrap(gg(this.schema,e)))}raw(e,t){this.sequence.push(this.client.raw(e,t).toSQL())}toSQL(){const e=this.builder._sequence;for(let t=0,r=e.length;t<r;t++){const r=e[t];this[r.method].apply(this,r.args)}return this.sequence}async generateDdlCommands(){const e=this.toSQL();return{pre:[],sql:Array.isArray(e)?e:[e],check:null,post:[]}}}function pg(e){const t=this.builder.queryContext();void 0!==t&&void 0===e.queryContext()&&e.queryContext(t),e.setSchema(this.schema);const r=e.toSQL();for(let n=0,i=r.length;n<i;n++)this.sequence.push(r[n])}function mg(e){return"createLike"===e?function(t,r,n){const i=this.client.tableBuilder(e,t,r,n);pg.call(this,i)}:function(t,r){const n=this.client.tableBuilder(e,t,null,r);pg.call(this,n)}}function yg(e){return function(t,r){const n=this.client.viewBuilder(e,t,r);pg.call(this,n)}}function gg(e,t){return e?`${e}.${t}`:t}function vg(e){throw new Error(e+" is not supported for this dialect (only PostgreSQL supports it currently).")}fg.prototype.dropTablePrefix="drop table ",fg.prototype.dropViewPrefix="drop view ",fg.prototype.dropMaterializedViewPrefix="drop materialized view ",fg.prototype.alterViewPrefix="alter view ",fg.prototype.alterTable=mg("alter"),fg.prototype.createTable=mg("create"),fg.prototype.createTableIfNotExists=mg("createIfNot"),fg.prototype.createTableLike=mg("createLike"),fg.prototype.createView=yg("create"),fg.prototype.createViewOrReplace=yg("createOrReplace"),fg.prototype.createMaterializedView=yg("createMaterializedView"),fg.prototype.alterView=yg("alter"),fg.prototype.pushQuery=cg,fg.prototype.pushAdditional=hg,fg.prototype.unshiftQuery=dg,lg=fg;var bg=jf((function(e,t){ah(t,Hh(t),e)})),_g={};const{isString:wg,isFunction:Eg,isObject:Cg}=Jf;class Ng{constructor(e,t,r,n,i){if(this.client=e,this._fn=i,this._method=t,this._schemaName=void 0,this._tableName=r,this._tableNameLike=n,this._statements=[],this._single={},!n&&!Eg(this._fn))throw new TypeError("A callback function must be supplied to calls against `.createTable` and `.table`")}setSchema(e){this._schemaName=e}toSQL(){return"alter"===this._method&&bg(this,$g),this._fn&&this._fn.call(this,this),this.client.tableCompiler(this).toSQL()}timestamps(e,t,r){Cg(e)&&({useTimestamps:e,defaultToNow:t,useCamelCase:r}=e);const n=!0===e?"timestamp":"datetime",i=this[n](r?"createdAt":"created_at"),s=this[n](r?"updatedAt":"updated_at");if(!0===t){const e=this.client.raw("CURRENT_TIMESTAMP");i.notNullable().defaultTo(e),s.notNullable().defaultTo(e)}}comment(e){if("string"!=typeof e)throw new TypeError("Table comment must be string");this._single.comment=e}foreign(e,t){const r={column:e,keyName:t};this._statements.push({grouping:"alterTable",method:"foreign",args:[r]});let n={references(e){let t;return wg(e)&&(t=e.split(".")),t&&1!==t.length?(r.inTable=t[0],r.references=t[1],n):(r.references=t?t[0]:e,{on(e){if("string"!=typeof e)throw new TypeError("Expected tableName to be a string, got: "+typeof e);return r.inTable=e,n},inTable(){return this.on.apply(this,arguments)}})},withKeyName:e=>(r.keyName=e,n),onUpdate:e=>(r.onUpdate=e,n),onDelete:e=>(r.onDelete=e,n),deferrable:e=>{if(-1!==["mysql","mssql","redshift","mysql2","oracledb"].indexOf(this.client.dialect))throw new Error(this.client.dialect+" does not support deferrable");return r.deferrable=e,n},_columnBuilder:e=>(bg(e,n),n=e,e)};return n}check(e,t,r){return this._statements.push({grouping:"checks",args:[e,t,r]}),this}}["index","primary","unique","dropPrimary","dropUnique","dropIndex","dropForeign"].forEach(e=>{Ng.prototype[e]=function(){return this._statements.push({grouping:"alterTable",method:e,args:Nm(arguments)}),this}}),Tp({mysql:["engine","charset","collate"],postgresql:["inherits"]},(function(e,t){e.forEach((function(e){Ng.prototype[e]=function(r){if(this.client.dialect!==t)throw new Error(`Knex only supports ${e} statement with ${t}.`);if("alter"===this._method)throw new Error(`Knex does not support altering the ${e} outside of create table, please use knex.raw statement.`);this._single[e]=r}}))})),Am.addQueryContext(Ng),["tinyint","smallint","mediumint","int","bigint","decimal","float","double","real","bit","boolean","serial","date","datetime","timestamp","time","year","geometry","geography","point","char","varchar","tinytext","tinyText","text","mediumtext","mediumText","longtext","longText","binary","varbinary","tinyblob","tinyBlob","mediumblob","mediumBlob","blob","longblob","longBlob","enum","set","bool","dateTime","increments","bigincrements","bigIncrements","integer","biginteger","bigInteger","string","json","jsonb","uuid","enu","specificType"].forEach(e=>{Ng.prototype[e]=function(){const t=Nm(arguments),r=this.client.columnBuilder(this,e,t);return this._statements.push({grouping:"columns",builder:r}),r}});const $g={renameColumn(e,t){return this._statements.push({grouping:"alterTable",method:"renameColumn",args:[e,t]}),this},dropTimestamps(){return this.dropColumns(!0===arguments[0]?["createdAt","updatedAt"]:["created_at","updated_at"])},setNullable(e){return this._statements.push({grouping:"alterTable",method:"setNullable",args:[e]}),this},check(e,t,r){this._statements.push({grouping:"alterTable",method:"check",args:[e,t,r]})},dropChecks(){this._statements.push({grouping:"alterTable",method:"dropChecks",args:Nm(arguments)})},dropNullable(e){return this._statements.push({grouping:"alterTable",method:"dropNullable",args:[e]}),this}};$g.dropColumn=$g.dropColumns=function(){return this._statements.push({grouping:"alterTable",method:"dropColumn",args:Nm(arguments)}),this},Ng.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(Ng.prototype,e))throw new Error(`Can't extend TableBuilder with existing method ('${e}').`);Cp(Ng.prototype,{[e]:t})},_g=Ng;var xg=function(e){return e!=e},Tg=function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,xg,r)},Og=Math.max,Sg=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Bf(r);return i<0&&(i=Og(n+i,0)),Tg(e,t,i)},kg={};const{pushAdditional:jg,pushQuery:Ag,unshiftQuery:Rg}=ug,{normalizeArr:Ig}=Am;class Pg{constructor(e,t){this.client=e,this.tableBuilder=t,this._commonBuilder=this.tableBuilder,this.method=t._method,this.schemaNameRaw=t._schemaName,this.tableNameRaw=t._tableName,this.tableNameLikeRaw=t._tableNameLike,this.single=t._single,this.grouped=qy(t._statements,"grouping"),this.formatter=e.formatter(t),this.bindings=[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.sequence=[],this._formatting=e.config&&e.config.formatting,this.checksCount=0}toSQL(){return this[this.method](),this.sequence}create(e,t){const r=this.getColumns().map(e=>e.toSQL()),n=this.getColumnTypes(r);this.createAlterTableMethods&&this.alterTableForCreate(n),this.createQuery(n,e,t),this.columnQueries(r),delete this.single.comment,this.alterTable()}createIfNot(){this.create(!0)}createLike(){this.create(!1,!0)}createLikeIfNot(){this.create(!0,!0)}alter(){const e=this.getColumns().map(e=>e.toSQL()),t=this.getColumns("alter"),r=t.map(e=>e.toSQL()),n=this.getColumnTypes(e),i=this.getColumnTypes(r);this.addColumns(n),this.alterColumns(i,t),this.columnQueries(e),this.columnQueries(r),this.alterTable()}foreign(e){if(e.inTable&&e.references){const t=e.keyName?this.formatter.wrap(e.keyName):this._indexCommand("foreign",this.tableNameRaw,e.column),r=this.formatter.columnize(e.column),n=this.formatter.columnize(e.references),i=this.formatter.wrap(e.inTable),s=e.onUpdate?(this.lowerCase?" on update ":" ON UPDATE ")+e.onUpdate:"",o=e.onDelete?(this.lowerCase?" on delete ":" ON DELETE ")+e.onDelete:"",a=e.deferrable?this.lowerCase?` deferrable initially ${e.deferrable.toLowerCase()} `:` DEFERRABLE INITIALLY ${e.deferrable.toUpperCase()} `:"";this.lowerCase?this.pushQuery((this.forCreate?"":`alter table ${this.tableName()} add `)+"constraint "+t+" foreign key ("+r+") references "+i+" ("+n+")"+s+o+a):this.pushQuery((this.forCreate?"":`ALTER TABLE ${this.tableName()} ADD `)+"CONSTRAINT "+t+" FOREIGN KEY ("+r+") REFERENCES "+i+" ("+n+")"+s+o+a)}}getColumnTypes(e){return e.reduce((function(e,t){const r=t[0];return e.sql.push(r.sql),e.bindings.concat(r.bindings),e}),{sql:[],bindings:[]})}columnQueries(e){const t=e.reduce((function(e,t){const r=cm(t);return Sp(r)?e:e.concat(r)}),[]);for(const r of t)this.pushQuery(r)}addColumns(e,t){if(t=t||this.addColumnsPrefix,e.sql.length>0){const r=e.sql.map(e=>t+e);this.pushQuery({sql:(this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+r.join(", "),bindings:e.bindings})}}alterColumns(e,t){e.sql.length>0&&this.addColumns(e,this.alterColumnsPrefix,t)}getColumns(e){const t=this.grouped.columns||[];e=e||"add";const r=this.tableBuilder.queryContext();return t.filter(t=>t.builder._method===e).map(e=>(void 0!==r&&void 0===e.builder.queryContext()&&e.builder.queryContext(r),this.client.columnCompiler(this,e.builder)))}tableName(){const e=this.schemaNameRaw?`${this.schemaNameRaw}.${this.tableNameRaw}`:this.tableNameRaw;return this.formatter.wrap(e)}tableNameLike(){const e=this.schemaNameRaw?`${this.schemaNameRaw}.${this.tableNameLikeRaw}`:this.tableNameLikeRaw;return this.formatter.wrap(e)}alterTable(){const e=this.grouped.alterTable||[];for(let t=0,r=e.length;t<r;t++){const r=e[t];this[r.method]?this[r.method].apply(this,r.args):this.client.logger.error(`Debug: ${r.method} does not exist`)}for(const t in this.single)"function"==typeof this[t]&&this[t](this.single[t])}alterTableForCreate(e){this.forCreate=!0;const t=this.sequence,r=this.grouped.alterTable||[];this.grouped.alterTable=[];for(let n=0,i=r.length;n<i;n++){const t=r[n];Sg(this.createAlterTableMethods,t.method)<0?this.grouped.alterTable.push(t):this[t.method]?(this.sequence=[],this[t.method].apply(this,t.args),e.sql.push(this.sequence[0].sql)):this.client.logger.error(`Debug: ${t.method} does not exist`)}this.sequence=t,this.forCreate=!1}dropIndex(e){this.pushQuery("drop index"+e)}dropUnique(){throw new Error("Method implemented in the dialect driver")}dropForeign(){throw new Error("Method implemented in the dialect driver")}dropColumn(){const e=Am.normalizeArr.apply(null,arguments),t=(Array.isArray(e)?e:[e]).map(e=>this.dropColumnPrefix+this.formatter.wrap(e));this.pushQuery((this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+t.join(", "))}_setNullableState(e,t){const r=this.tableName(),n=this.formatter.columnize(e),i=this.alterColumnsPrefix;return this.pushQuery({sql:"SELECT 1",output:()=>this.client.queryBuilder().from(this.tableNameRaw).columnInfo(e).then(e=>{if(Sp(e))throw new Error(`.setNullable: Column ${n} does not exist in table ${r}.`);const s=t?"null":"not null",o=e.type+(e.maxLength?`(${e.maxLength})`:""),a=null!==e.defaultValue&&void 0!==e.defaultValue?`default '${e.defaultValue}'`:"",u=`alter table ${r} ${i} ${n} ${o} ${s} ${a}`;return this.client.raw(u)})})}setNullable(e){return this._setNullableState(e,!0)}dropNullable(e){return this._setNullableState(e,!1)}dropChecks(e){if(void 0===e)return"";e=Ig(e);const t=`alter table ${this.tableName()} ${e.map(e=>"drop constraint "+e).join(", ")}`;this.pushQuery(t)}check(e,t,r){const n=this.tableName();let i=r;i||(this.checksCount++,i=n+"_"+this.checksCount);const s=`alter table ${n} add constraint ${i} check(${e})`;this.pushQuery(s)}_addChecks(){return this.grouped.checks?", "+this.grouped.checks.map(e=>`${e.args[2]?"constraint "+e.args[2]+" ":""}check (${this.client.raw(e.args[0],e.args[1])})`).join(", "):""}_indexCommand(e,t,r){Array.isArray(r)||(r=r?[r]:[]);const n=(t.replace(/\.|-/g,"_")+"_"+r.join("_")+"_"+e).toLowerCase();return this.formatter.wrap(n)}_getPrimaryKeys(){return(this.grouped.alterTable||[]).filter(e=>"primary"===e.method).flatMap(e=>e.args).flat()}_canBeAddPrimaryKey(e){return e.primaryKey&&0===this._getPrimaryKeys().length}_getIncrementsColumnNames(){return this.grouped.columns.filter(e=>"increments"===e.builder._type).map(e=>e.builder._args[0])}}Pg.prototype.pushQuery=Ag,Pg.prototype.pushAdditional=jg,Pg.prototype.unshiftQuery=Rg,Pg.prototype.lowerCase=!0,Pg.prototype.createAlterTableMethods=null,Pg.prototype.addColumnsPrefix="add column ",Pg.prototype.alterColumnsPrefix="alter column ",Pg.prototype.modifyColumnPrefix="modify column ",Pg.prototype.dropColumnPrefix="drop column ",kg=Pg;const{addQueryContext:qg}=Am;class Lg{constructor(e,t,r,n){this.client=e,this._method="add",this._single={},this._modifiers={},this._statements=[],this._type=Fg[r]||r,this._args=n,this._tableBuilder=t,"alter"===t._method&&bg(this,Dg)}references(e){return this._tableBuilder.foreign.call(this._tableBuilder,this._args[0],void 0,this)._columnBuilder(this).references(e)}}const Mg={default:"defaultTo",defaultsTo:"defaultTo"};["default","defaultsTo","defaultTo","unsigned","nullable","first","after","comment","collate","check","checkPositive","checkNegative","checkIn","checkNotIn","checkBetween","checkLength","checkRegex"].forEach((function(e){const t=Mg[e]||e;Lg.prototype[e]=function(){return this._modifiers[t]=Nm(arguments),this}})),qg(Lg),Lg.prototype.notNull=Lg.prototype.notNullable=function(){return this.nullable(!1)},["index","primary","unique"].forEach((function(e){Lg.prototype[e]=function(){return-1===this._type.toLowerCase().indexOf("increments")&&this._tableBuilder[e].apply(this._tableBuilder,[this._args[0]].concat(Nm(arguments))),this}})),Lg.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(Lg.prototype,e))throw new Error(`Can't extend ColumnBuilder with existing method ('${e}').`);Cp(Lg.prototype,{[e]:t})};const Dg={drop:function(){return this._single.drop=!0,this},alterType:function(e){return this._statements.push({grouping:"alterType",value:e}),this},alter:function({alterNullable:e=!0,alterType:t=!0}={}){return this._method="alter",this.alterNullable=e,this.alterType=t,this}},Fg={float:"floating",enum:"enu",boolean:"bool",string:"varchar",bigint:"bigInteger"};var Ug=Lg,Bg=function(e){return e&&e.length?e[0]:void 0},Vg={};const{toNumber:zg}=Am,{formatDefault:Hg}=ay,{operator:Qg}=yy;class Wg{constructor(e,t,r){this.client=e,this.tableCompiler=t,this.columnBuilder=r,this._commonBuilder=this.columnBuilder,this.args=r._args,this.type=r._type.toLowerCase(),this.grouped=qy(r._statements,"grouping"),this.modified=r._modifiers,this.isIncrements=-1!==this.type.indexOf("increments"),this.formatter=e.formatter(r),this.bindings=[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.sequence=[],this.modifiers=[],this.checksCount=0}_addCheckModifiers(){this.modifiers.push("check","checkPositive","checkNegative","checkIn","checkNotIn","checkBetween","checkLength","checkRegex")}defaults(e){if(Object.prototype.hasOwnProperty.call(this._defaultMap,e))return this._defaultMap[e].bind(this)();throw new Error("There is no default for the specified identifier "+e)}toSQL(){return this.pushQuery(this.compileColumn()),this.sequence.additional&&(this.sequence=this.sequence.concat(this.sequence.additional)),this.sequence}compileColumn(){return this.formatter.wrap(this.getColumnName())+" "+this.getColumnType()+this.getModifiers()}getColumnName(){return Bg(this.args)||this.defaults("columnName")}getColumnType(){if(!this._columnType){const e=this[this.type];this._columnType="function"==typeof e?e.apply(this,cm(this.args)):e}return this._columnType}getModifiers(){const e=[];for(let t=0,r=this.modifiers.length;t<r;t++){const r=this.modifiers[t];if((!this.isIncrements||this.isIncrements&&"comment"===r)&&Dy(this.modified,r)){const t=this[r].apply(this,this.modified[r]);t&&e.push(t)}}return e.length>0?" "+e.join(" "):""}varchar(e){return`varchar(${zg(e,255)})`}floating(e,t){return`float(${zg(e,8)}, ${zg(t,2)})`}decimal(e,t){if(null===e)throw new Error("Specifying no precision on decimal columns is not supported for that SQL dialect.");return`decimal(${zg(e,8)}, ${zg(t,2)})`}specifictype(e){return e}nullable(e){return!1===e?"not null":"null"}notNullable(){return this.nullable(!1)}defaultTo(e){return"default "+Hg(e,this.type,this.client)}increments(e={primaryKey:!0}){return"integer not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")+" autoincrement"}bigincrements(e={primaryKey:!0}){return this.increments(e)}_pushAlterCheckQuery(e,t){let r=t;r||(this.checksCount++,r=this.tableCompiler.tableNameRaw+"_"+this.getColumnName()+"_"+this.checksCount),this.pushAdditional((function(){this.pushQuery(`alter table ${this.tableCompiler.tableName()} add constraint ${r} check(${e})`)}))}_checkConstraintName(e){return e?`constraint ${e} `:""}_check(e,t){return"alter"===this.columnBuilder._method?(this._pushAlterCheckQuery(e,t),""):`${this._checkConstraintName(t)}check (${e})`}checkPositive(e){return this._check(`${this.formatter.wrap(this.getColumnName())} ${Qg(">",this.columnBuilder,this.bindingsHolder)} 0`,e)}checkNegative(e){return this._check(`${this.formatter.wrap(this.getColumnName())} ${Qg("<",this.columnBuilder,this.bindingsHolder)} 0`,e)}_checkIn(e,t,r){return this._check(`${this.formatter.wrap(this.getColumnName())} ${r?"not ":""}in (${e.map(e=>this.client._escapeBinding(e)).join(",")})`,t)}checkIn(e,t){return this._checkIn(e,t)}checkNotIn(e,t){return this._checkIn(e,t,!0)}checkBetween(e,t){2!==e.length||Array.isArray(e[0])||Array.isArray(e[1])||(e=[e]);const r=e.map(e=>`${this.formatter.wrap(this.getColumnName())} between ${this.client._escapeBinding(e[0])} and ${this.client._escapeBinding(e[1])}`).join(" or ");return this._check(r,t)}checkLength(e,t,r){return this._check(`length(${this.formatter.wrap(this.getColumnName())}) ${Qg(e,this.columnBuilder,this.bindingsHolder)} ${zg(t)}`,r)}}Wg.prototype.binary="blob",Wg.prototype.bool="boolean",Wg.prototype.date="date",Wg.prototype.datetime="datetime",Wg.prototype.time="time",Wg.prototype.timestamp="timestamp",Wg.prototype.geometry="geometry",Wg.prototype.geography="geography",Wg.prototype.point="point",Wg.prototype.enu="varchar",Wg.prototype.bit=Wg.prototype.json="text",Wg.prototype.uuid=({useBinaryUuid:e=!1}={})=>e?"binary(16)":"char(36)",Wg.prototype.integer=Wg.prototype.smallint=Wg.prototype.mediumint="integer",Wg.prototype.biginteger="bigint",Wg.prototype.text="text",Wg.prototype.tinyint="tinyint",Wg.prototype.pushQuery=ug.pushQuery,Wg.prototype.pushAdditional=ug.pushAdditional,Wg.prototype.unshiftQuery=ug.unshiftQuery,Wg.prototype._defaultMap={columnName:function(){if(!this.isIncrements)throw new Error(`You did not specify a column name for the ${this.type} column.`);return"id"}},Vg=Wg;var Jg=class extends _y{constructor(e,t){super(e),this.ref=t,this._schema=null,this._alias=null}withSchema(e){return this._schema=e,this}as(e){return this._alias=e,this}toSQL(){const e=this._schema?`${this._schema}.${this.ref}`:this.ref,t=this.client.formatter(this),r=t.columnize(e),n=this._alias?`${r} as ${t.wrap(this._alias)}`:r;return this.set(n,[]),super.toSQL(...arguments)}};const{columnize:Kg,wrap:Gg}=yy;var Yg=class{constructor(e,t){this.client=e,this.builder=t,this.bindings=[]}columnize(e){return Kg(e,this.builder,this.client,this)}wrap(e,t){return Gg(e,t,this.builder,this.client,this)}},Zg={};(function(e){"use strict";Object.defineProperty(Zg,"__esModule",{value:!0});var t=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}(require("tty"));const r=e.env||{},n=e.argv||[],i="NO_COLOR"in r||n.includes("--no-color"),s="FORCE_COLOR"in r||n.includes("--color"),o="win32"===e.platform,a=t&&t.isatty&&t.isatty(1)&&r.TERM&&"dumb"!==r.TERM,u=!i&&(s||o||a||"CI"in r&&("GITHUB_ACTIONS"in r||"GITLAB_CI"in r||"CIRCLECI"in r)),l=(e,t,r,n,i=t.substring(0,e)+n,s=t.substring(e+r.length),o=s.indexOf(r))=>i+(o<0?s:l(o,s,r,n)),c=(e,t,r)=>((e,t,r=e,n=e.length+1)=>i=>i||""!==i&&void 0!==i?((e,t,r,n,i)=>e<0?r+t+n:r+l(e,t,n,i)+n)((""+i).indexOf(t,n),i,e,t,r):"")(`\x1b[${e}m`,`\x1b[${t}m`,r),h={reset:c(0,0),bold:c(1,22,"\x1b[22m\x1b[1m"),dim:c(2,22,"\x1b[22m\x1b[2m"),italic:c(3,23),underline:c(4,24),inverse:c(7,27),hidden:c(8,28),strikethrough:c(9,29),black:c(30,39),red:c(31,39),green:c(32,39),yellow:c(33,39),blue:c(34,39),magenta:c(35,39),cyan:c(36,39),white:c(37,39),gray:c(90,39),bgBlack:c(40,49),bgRed:c(41,49),bgGreen:c(42,49),bgYellow:c(43,49),bgBlue:c(44,49),bgMagenta:c(45,49),bgCyan:c(46,49),bgWhite:c(47,49),blackBright:c(90,39),redBright:c(91,39),greenBright:c(92,39),yellowBright:c(93,39),blueBright:c(94,39),magentaBright:c(95,39),cyanBright:c(96,39),whiteBright:c(97,39),bgBlackBright:c(100,49),bgRedBright:c(101,49),bgGreenBright:c(102,49),bgYellowBright:c(103,49),bgBlueBright:c(104,49),bgMagentaBright:c(105,49),bgCyanBright:c(106,49),bgWhiteBright:c(107,49)},d=e=>e,f=({useColor:e=u}={})=>e?h:Object.keys(h).reduce((e,t)=>({...e,[t]:d}),{}),{reset:p,bold:m,dim:y,italic:g,underline:v,inverse:b,hidden:_,strikethrough:w,black:E,red:C,green:N,yellow:$,blue:x,magenta:T,cyan:O,white:S,gray:k,bgBlack:j,bgRed:A,bgGreen:R,bgYellow:I,bgBlue:P,bgMagenta:q,bgCyan:L,bgWhite:M,blackBright:D,redBright:F,greenBright:U,yellowBright:B,blueBright:V,magentaBright:z,cyanBright:H,whiteBright:Q,bgBlackBright:W,bgRedBright:J,bgGreenBright:K,bgYellowBright:G,bgBlueBright:Y,bgMagentaBright:Z,bgCyanBright:X,bgWhiteBright:ee}=f();Zg.bgBlack=j,Zg.bgBlackBright=W,Zg.bgBlue=P,Zg.bgBlueBright=Y,Zg.bgCyan=L,Zg.bgCyanBright=X,Zg.bgGreen=R,Zg.bgGreenBright=K,Zg.bgMagenta=q,Zg.bgMagentaBright=Z,Zg.bgRed=A,Zg.bgRedBright=J,Zg.bgWhite=M,Zg.bgWhiteBright=ee,Zg.bgYellow=I,Zg.bgYellowBright=G,Zg.black=E,Zg.blackBright=D,Zg.blue=x,Zg.blueBright=V,Zg.bold=m,Zg.createColors=f,Zg.cyan=O,Zg.cyanBright=H,Zg.dim=y,Zg.gray=k,Zg.green=N,Zg.greenBright=U,Zg.hidden=_,Zg.inverse=b,Zg.isColorSupported=u,Zg.italic=g,Zg.magenta=T,Zg.magentaBright=z,Zg.red=C,Zg.redBright=F,Zg.reset=p,Zg.strikethrough=w,Zg.underline=v,Zg.white=S,Zg.whiteBright=Q,Zg.yellow=$,Zg.yellowBright=B}).call(this,require("_process"));var Xg={};(function(e){const{inspect:t}=require("util"),{isString:r,isFunction:n}=Jf;Xg=class{constructor(t={}){const{log:{debug:r,warn:n,error:i,deprecate:s,inspectionDepth:o,enableColors:a}={}}=t;var u;this._inspectionDepth=o||5,this._enableColors=null!=(u=a)?u:!(!e||!e.stdout)&&e.stdout.isTTY,this._debug=r,this._warn=n,this._error=i,this._deprecate=s}_log(e,i,s){if(null!=i&&!n(i))throw new TypeError("Extensions to knex logger must be functions!");n(i)?i(e):(r(e)||(e=t(e,{depth:this._inspectionDepth,colors:this._enableColors})),console.log(s?s(e):e))}debug(e){this._log(e,this._debug)}warn(e){this._log(e,this._warn,Zg.yellow)}error(e){this._log(e,this._error,Zg.red)}deprecate(e,t){const r=`${e} is deprecated, please use ${t}`;this._log(r,this._deprecate,Zg.yellow)}}}).call(this,require("_process"));var ev={};class tv{constructor(e,t,r,n){this.client=e,this._method=t,this._schemaName=void 0,this._columns=void 0,this._fn=n,this._viewName=r,this._statements=[],this._single={}}setSchema(e){this._schemaName=e}columns(e){this._columns=e}as(e){this._selectQuery=e}checkOption(){throw new Error("check option definition is not supported by this dialect.")}localCheckOption(){throw new Error("check option definition is not supported by this dialect.")}cascadedCheckOption(){throw new Error("check option definition is not supported by this dialect.")}toSQL(){return"alter"===this._method&&bg(this,rv),this._fn.call(this,this),this.client.viewCompiler(this).toSQL()}}const rv={column(e){const t=this;return{rename:function(r){return t._statements.push({grouping:"alterView",method:"renameColumn",args:[e,r]}),this},defaultTo:function(r){return t._statements.push({grouping:"alterView",method:"defaultTo",args:[e,r]}),this}}}};Am.addQueryContext(tv),tv.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(tv.prototype,e))throw new Error(`Can't extend ViewBuilder with existing method ('${e}').`);Cp(tv.prototype,{[e]:t})},ev=tv;var nv={};const{pushQuery:iv}=ug,{columnize:sv}=yy;class ov{constructor(e,t){this.client=e,this.viewBuilder=t,this._commonBuilder=this.viewBuilder,this.method=t._method,this.schemaNameRaw=t._schemaName,this.viewNameRaw=t._viewName,this.single=t._single,this.selectQuery=t._selectQuery,this.columns=t._columns,this.grouped=qy(t._statements,"grouping"),this.formatter=e.formatter(t),this.bindings=[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.sequence=[]}toSQL(){return this[this.method](),this.sequence}create(){this.createQuery(this.columns,this.selectQuery)}createOrReplace(){throw new Error("replace views is not supported by this dialect.")}createMaterializedView(){throw new Error("materialized views are not supported by this dialect.")}createQuery(e,t,r,n){const i="create "+(r?"materialized ":"")+(n?"or replace ":"")+"view ",s=e?" ("+sv(e,this.viewBuilder,this.client,this.bindingsHolder)+")":"";let o=i+this.viewName()+s;switch(o+=" as ",o+=t.toString(),this.single.checkOption){case"default_option":o+=" with check option";break;case"local":o+=" with local check option";break;case"cascaded":o+=" with cascaded check option"}this.pushQuery({sql:o})}renameView(e,t){throw new Error("rename view is not supported by this dialect (instead drop, then create another view).")}refreshMaterializedView(){throw new Error("materialized views are not supported by this dialect.")}alter(){this.alterView()}alterView(){const e=this.grouped.alterView||[];for(let t=0,r=e.length;t<r;t++){const r=e[t];this[r.method]?this[r.method].apply(this,r.args):this.client.logger.error(`Debug: ${r.method} does not exist`)}for(const t in this.single)"function"==typeof this[t]&&this[t](this.single[t])}renameColumn(e,t){throw new Error("rename column of views is not supported by this dialect.")}defaultTo(e,t){throw new Error("change default values of views is not supported by this dialect.")}viewName(){const e=this.schemaNameRaw?`${this.schemaNameRaw}.${this.viewNameRaw}`:this.viewNameRaw;return this.formatter.wrap(e)}}ov.prototype.pushQuery=iv,nv=ov;var av={};const{Pool:uv,TimeoutError:lv}=hc,{EventEmitter:cv}=require("events"),{promisify:hv}=require("util"),{makeEscape:dv}=fc,{executeQuery:fv,enrichQueryObject:pv}=wp,{KnexTimeoutError:mv}=of,{outputQuery:yv,unwrapRaw:gv}=yy,{compileCallback:vv}=ay,{POOL_CONFIG_OPTIONS:bv}=Om,_v=yf("knex:client");class wv extends cv{constructor(e={}){if(super(),this.config=e,this.logger=new Xg(e),this.dialect&&!this.config.client&&this.logger.warn("Using 'this.dialect' to identify the client is deprecated and support for it will be removed in the future. Please use configuration option 'client' instead."),!this.config.client&&!this.dialect)throw new Error("knex: Required configuration option 'client' is missing.");var t;e.version&&(this.version=e.version),e.connection&&e.connection instanceof Function?(this.connectionConfigProvider=e.connection,this.connectionConfigExpirationChecker=()=>!0):(this.connectionSettings=(t=e.connection||{},_d(t,5)),this.connectionConfigExpirationChecker=null),this.driverName&&e.connection&&(this.initializeDriver(),(!e.pool||e.pool&&0!==e.pool.max)&&this.initializePool(e)),this.valueForUndefined=this.raw("DEFAULT"),e.useNullAsDefault&&(this.valueForUndefined=null)}formatter(e){return new Yg(this,e)}queryBuilder(){return new ry(this)}queryCompiler(e,t){return new tg(this,e,t)}schemaBuilder(){return new rg(this)}schemaCompiler(e){return new lg(this,e)}tableBuilder(e,t,r,n){return new _g(this,e,t,r,n)}viewBuilder(e,t,r){return new ev(this,e,t,r)}tableCompiler(e){return new kg(this,e)}viewCompiler(e){return new nv(this,e)}columnBuilder(e,t,r){return new Ug(this,e,t,r)}columnCompiler(e,t){return new Vg(this,e,t)}runner(e){return new mf(this,e)}transaction(e,t,r){return new up(this,e,t,r)}raw(){return new _y(this).set(...arguments)}ref(){return new Jg(this,...arguments)}query(e,t){const r=pv(e,t,this);return fv(e,r,this)}stream(e,t,r,n){const i=pv(e,t,this);return this._stream(e,i,r,n)}prepBindings(e){return e}positionBindings(e){return e}postProcessResponse(e,t){return this.config.postProcessResponse?this.config.postProcessResponse(e,t):e}wrapIdentifier(e,t){return this.customWrapIdentifier(e,this.wrapIdentifierImpl,t)}customWrapIdentifier(e,t,r){return this.config.wrapIdentifier?this.config.wrapIdentifier(e,t,r):t(e)}wrapIdentifierImpl(e){return"*"!==e?`"${e.replace(/"/g,'""')}"`:"*"}initializeDriver(){try{this.driver=this._driver()}catch(Zv){const t=`Knex: run\n$ npm install ${this.driverName} --save`;throw this.logger.error(`${t}\n${Zv.message}\n${Zv.stack}`),new Error(`${t}\n${Zv.message}`)}}poolDefaults(){return{min:2,max:10,propagateCreateError:!0}}getPoolSettings(e){e=Yd({},e,this.poolDefaults()),bv.forEach(t=>{t in e&&this.logger.warn([`Pool config option "${t}" is no longer supported.`,"See https://github.com/Vincit/tarn.js for possible pool config options."].join(" "))});const t=[this.config.acquireConnectionTimeout||6e4,e.acquireTimeoutMillis].filter(e=>void 0!==e);e.acquireTimeoutMillis=Math.min(...t);const r=async()=>{if(!this.connectionConfigProvider)return;if(!this.connectionConfigExpirationChecker||!this.connectionConfigExpirationChecker())return;const e=await this.connectionConfigProvider();e.expirationChecker?(this.connectionConfigExpirationChecker=e.expirationChecker,delete e.expirationChecker):this.connectionConfigExpirationChecker=null,this.connectionSettings=e};return Object.assign(e,{create:async()=>{await r();const t=await this.acquireRawConnection();return t.__knexUid=sf("__knexUid"),e.afterCreate&&await hv(e.afterCreate)(t),t},destroy:e=>{if(void 0!==e)return this.destroyRawConnection(e)},validate:e=>e.__knex__disposed?(this.logger.warn("Connection Error: "+e.__knex__disposed),!1):this.validateConnection(e)})}initializePool(e=this.config){if(this.pool)return void this.logger.warn("The pool has already been initialized");const t={...this.getPoolSettings(e.pool)};t.afterCreate&&delete t.afterCreate,this.pool=new uv(t)}validateConnection(e){return!0}async acquireConnection(){if(!this.pool)throw new Error("Unable to acquire a connection");try{const e=await this.pool.acquire().promise;return _v("acquired connection from pool: %s",e.__knexUid),e}catch(error){let t=error;throw error instanceof lv&&(t=new mv("Knex: Timeout acquiring a connection. The pool is probably full. Are you missing a .transacting(trx) call?")),t}}releaseConnection(e){return _v("releasing connection to pool: %s",e.__knexUid),this.pool.release(e)||_v("pool refused connection: %s",e.__knexUid),Promise.resolve()}async destroy(e){try{this.pool&&this.pool.destroy&&await this.pool.destroy(),this.pool=void 0,"function"==typeof e&&e()}catch(t){if("function"==typeof e)return e(t);throw t}}database(){return this.connectionSettings.database}toString(){return"[object KnexClient]"}assertCanCancelQuery(){if(!this.canCancelQuery)throw new Error("Query cancelling not supported for this dialect")}cancelQuery(){throw new Error("Query cancelling not supported for this dialect")}alias(e,t){return e+" as "+t}parameter(e,t,r){return"function"==typeof e?yv(vv(e,void 0,this,r),!0,t,this):gv(e,!0,t,this,r)||"?"}parameterize(e,t,r,n){if("function"==typeof e)return this.parameter(e,r,n);e=Array.isArray(e)?e:[e];let i="",s=-1;for(;++s<e.length;){s>0&&(i+=", ");let o=e[s];Of(o)&&(o=JSON.stringify(o)),i+=this.parameter(void 0===o?t:o,r,n)}return i}values(e,t,r){return Array.isArray(e)?Array.isArray(e[0])?`(${e.map(e=>`(${this.parameterize(e,void 0,t,r)})`).join(", ")})`:`(${this.parameterize(e,void 0,t,r)})`:e&&e.isRawInstance?`(${this.parameter(e,t,r)})`:this.parameter(e,t,r)}processPassedConnection(e){}toPathForJson(e){return e}}Object.assign(wv.prototype,{_escapeBinding:dv({escapeString:e=>`'${e.replace(/'/g,"''")}'`}),canCancelQuery:!1}),av=wv;var Ev,Cv=require("url"),Nv=require("fs");function $v(e){if("/"===e.charAt(0))return{host:(r=e.split(" "))[0],database:r[1]};var t=Cv.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)?encodeURI(e).replace(/\%25(\d\d)/g,"%$1"):e,!0),r=t.query;for(var n in r)Array.isArray(r[n])&&(r[n]=r[n][r[n].length-1]);var i=(t.auth||":").split(":");if(r.user=i[0],r.password=i.splice(1).join(":"),r.port=t.port,"socket:"==t.protocol)return r.host=decodeURI(t.pathname),r.database=t.query.db,r.client_encoding=t.query.encoding,r;r.host||(r.host=t.hostname);var s=t.pathname;if(!r.host&&s&&/^%2f/i.test(s)){var o=s.split("/");r.host=decodeURIComponent(o[0]),s=o.splice(1).join("/")}switch(s&&"/"===s.charAt(0)&&(s=s.slice(1)||null),r.database=s&&decodeURI(s),"true"!==r.ssl&&"1"!==r.ssl||(r.ssl=!0),"0"===r.ssl&&(r.ssl=!1),(r.sslcert||r.sslkey||r.sslrootcert||r.sslmode)&&(r.ssl={}),r.sslcert&&(r.ssl.cert=Nv.readFileSync(r.sslcert).toString()),r.sslkey&&(r.ssl.key=Nv.readFileSync(r.sslkey).toString()),r.sslrootcert&&(r.ssl.ca=Nv.readFileSync(r.sslrootcert).toString()),r.sslmode){case"disable":r.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":r.ssl.rejectUnauthorized=!1}return r}Ev=$v,$v.parse=$v;var xv={};(function(e){const{parse:t}=Ev,r=t,n=e&&e.platform&&"win32"===e.platform;function i(e){const t={};let r=e.pathname;if("/"===r[0]&&(r=r.slice(1)),t.database=r,e.hostname&&(0===e.protocol.indexOf("mssql")?t.server=e.hostname:t.host=e.hostname),e.port&&(t.port=e.port),(e.username||e.password)&&(t.user=decodeURIComponent(e.username)),e.password&&(t.password=decodeURIComponent(e.password)),e.searchParams)for(const[i,s]of e.searchParams.entries())if(["mysql:","mariadb:"].includes(e.protocol))try{t[i]=JSON.parse(s)}catch(n){t[i]=s}else t[i]=s;return t}xv=function(e){const t=function(e){try{return new URL(e)}catch(Zv){return null}}(e),s=n&&t&&2===t.protocol.length;if(!t||s)return{client:"sqlite3",connection:{filename:e}};let{protocol:o}=t;return":"===o.slice(-1)&&(o=o.slice(0,-1)),{client:o,connection:["postgresql","postgres"].includes(o)?r(e):i(t)}}}).call(this,require("_process"));var Tv=class extends up{begin(e){return this.isolationLevel&&this.client.logger.warn("sqlite3 only supports serializable transactions, ignoring the isolation level param"),this.query(e,"BEGIN;")}};const{isString:Ov}=Jf,{wrapString:Sv,columnize:kv}=yy,jv=Vd("");var Av=class extends tg{constructor(e,t,r){super(e,t,r),this.forShare=jv,this.forKeyShare=jv,this.forUpdate=jv,this.forNoKeyUpdate=jv}insert(){const e=this.single.insert||[];let t=this.with()+`insert into ${this.tableName} `;if(Array.isArray(e)){if(0===e.length)return"";if(1===e.length&&e[0]&&Sp(e[0]))return{sql:t+this._emptyInsertValue}}else if("object"==typeof e&&Sp(e))return{sql:t+this._emptyInsertValue};const r=this._prepInsert(e);if(Ov(r))return{sql:t+r};if(0===r.columns.length)return{sql:""};if(t+=`(${this.formatter.columnize(r.columns)})`,null!==this.client.valueForUndefined&&r.values.forEach(e=>{Tp(e,e=>{if(void 0===e)throw new TypeError("`sqlite` does not support inserting default values. Specify values explicitly or use the `useNullAsDefault` config flag. (see docs http://knexjs.org/#Builder-insert).")})}),1===r.values.length){t+=` values (${this.client.parameterize(r.values[0],this.client.valueForUndefined,this.builder,this.bindingsHolder)})`;const{onConflict:n,ignore:i,merge:s}=this.single;if(n&&i)t+=this._ignore(n);else if(n&&s){t+=this._merge(s.updates,n,e);const r=this.where();r&&(t+=" "+r)}const{returning:o}=this.single;return o&&(t+=this._returning(o)),{sql:t,returning:o}}const n=[];let i=-1;for(;++i<r.values.length;){let e=-1;const t=n[i]=[];let s=r.values[i];for(s=void 0===s?this.client.valueForUndefined:s;++e<r.columns.length;)t.push(this.client.alias(this.client.parameter(s[e],this.builder,this.bindingsHolder),this.formatter.wrap(r.columns[e])));n[i]=t.join(", ")}t+=" select "+n.join(" union all select ");const{onConflict:s,ignore:o,merge:a}=this.single;s&&o?t+=" where true"+this._ignore(s):s&&a&&(t+=" where true"+this._merge(a.updates,s,e));const{returning:u}=this.single;return u&&(t+=this._returning(u)),{sql:t,returning:u}}_ignore(e){return!0===e?" on conflict do nothing":` on conflict ${this._onConflictClause(e)} do nothing`}_merge(e,t,r){let n=` on conflict ${this._onConflictClause(t)} do update set `;if(e&&Array.isArray(e))return n+e.map(e=>Sv(e.split(".").pop(),this.formatter.builder,this.client,this.formatter)).map(e=>`${e} = excluded.${e}`).join(", ");if(e&&"object"==typeof e){const t=this._prepUpdate(e);return n+("string"==typeof t?t:t.join(","))}{const e=this._prepInsert(r);if("string"==typeof e)throw new Error("If using merge with a raw insert query, then updates must be provided");return n+e.columns.map(e=>Sv(e.split(".").pop(),this.builder,this.client)).map(e=>`${e} = excluded.${e}`).join(", ")}}_returning(e){return e?" returning "+this.formatter.columnize(e):""}truncate(){const{table:e}=this.single;return{sql:"delete from "+this.tableName,output(){return this.query({sql:`delete from sqlite_sequence where name = '${e}'`}).catch(gf)}}}columnInfo(){const e=this.single.columnInfo;return{sql:`PRAGMA table_info(\`${this.client.customWrapIdentifier(this.single.table,Fd)}\`)`,output(t){const r=/.*\((\d+)\)/,n=sy(t,(function(e,t){let{type:n}=t,i=n.match(r);return i&&(i=i[1]),n=i?n.split("(")[0]:n,e[t.name]={type:n.toLowerCase(),maxLength:i,nullable:!t.notnull,defaultValue:t.dflt_value},e}),{});return e&&n[e]||n}}}limit(){const e=!this.single.limit&&0!==this.single.limit;return e&&!this.single.offset?"":(this.single.limit=e?-1:this.single.limit,"limit "+this._getValueOrParameterFromAttribute("limit"))}jsonExtract(e){return this._jsonExtract("json_extract",e)}jsonSet(e){return this._jsonSet("json_set",e)}jsonInsert(e){return this._jsonSet("json_insert",e)}jsonRemove(e){const t=`json_remove(${kv(e.column,this.builder,this.client,this.bindingsHolder)},${this.client.parameter(e.path,this.builder,this.bindingsHolder)})`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){return this._whereJsonPath("json_extract",e)}whereJsonSupersetOf(e){throw new Error("Json superset where clause not actually supported by SQLite")}whereJsonSubsetOf(e){throw new Error("Json subset where clause not actually supported by SQLite")}onJsonPathEquals(e){return this._onJsonPathEquals("json_extract",e)}},Rv=function(e,t){var r;return xp(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r},Iv=class extends lg{constructor(e,t){super(e,t)}hasTable(e){const t="select * from sqlite_master where type = 'table' and name = "+this.client.parameter(this.formatter.wrap(e).replace(/`/g,""),this.builder,this.bindingsHolder);this.pushQuery({sql:t,output:e=>e.length>0})}hasColumn(e,t){this.pushQuery({sql:`PRAGMA table_info(${this.formatter.wrap(e)})`,output(e){return function(e,t,r){var n=ph(e)?Rp:Rv;return r&&Jd(e,t,r)&&(t=void 0),n(e,um(t))}(e,e=>this.client.wrapIdentifier(e.name.toLowerCase())===this.client.wrapIdentifier(t.toLowerCase()))}})}renameTable(e,t){this.pushQuery(`alter table ${this.formatter.wrap(e)} rename to ${this.formatter.wrap(t)}`)}async generateDdlCommands(){const e=this.builder._sequence;for(let r=0,n=e.length;r<n;r++){const t=e[r];this[t.method].apply(this,t.args)}const t=this.sequence;if(1===t.length&&t[0].statementsProducer)return t[0].statementsProducer();{const e=[];for(const r of t){const t=r.sql;Array.isArray(t)?e.push(...t):e.push(t)}return{pre:[],sql:e,check:null,post:[]}}}},Pv={};class qv extends Vg{constructor(){super(...arguments),this.modifiers=["nullable","defaultTo"],this._addCheckModifiers()}enu(e){return`text check (${this.formatter.wrap(this.args[0])} in ('${e.join("', '")}'))`}_pushAlterCheckQuery(e,t){throw new Error("Alter table with to add constraints is not permitted in SQLite")}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} REGEXP ${this.client._escapeBinding(e)}`,t)}}qv.prototype.json="json",qv.prototype.jsonb="json",qv.prototype.double=qv.prototype.decimal=qv.prototype.floating="float",qv.prototype.timestamp="datetime",qv.prototype.increments=qv.prototype.bigincrements="integer not null primary key autoincrement",Pv=qv;var Lv=function(e,t){return(ph(e)?Zh:kp)(e,um(t))};const{isObject:Mv}=Jf,{formatDefault:Dv}=ay;var Fv=class extends kg{constructor(){super(...arguments)}createQuery(e,t,r){let n=(t?"create table if not exists ":"create table ")+this.tableName();r&&this.tableNameLike()?n+=" as select * from "+this.tableNameLike()+" where 0=1":(n+=" ("+e.sql.join(", "),n+=this.foreignKeys()||"",n+=this.primaryKeys()||"",n+=this._addChecks(),n+=")"),this.pushQuery(n),r&&this.addColumns(e,this.addColumnsPrefix)}addColumns(e,t,r){if(t===this.alterColumnsPrefix){const e=this,t=r.map(e=>{const t=this.client.customWrapIdentifier(e.getColumnName(),Fd,e.columnBuilder.queryContext()),r=e.getColumnType();return{name:t,type:r,defaultTo:e.modified.defaultTo?Dv(e.modified.defaultTo[0],r,this.client):null,notNull:e.modified.nullable&&!1===e.modified.nullable[0]}});this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,statementsProducer:(r,n)=>e.client.ddl(e,r,n).alterColumn(t)})}else for(let n=0,i=e.sql.length;n<i;n++)this.pushQuery({sql:`alter table ${this.tableName()} add column ${e.sql[n]}`,bindings:e.bindings[n]})}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery("drop index "+t)}dropForeign(e,t){const r=this;e=(e=Array.isArray(e)?e:[e]).map(e=>this.client.customWrapIdentifier(e,Fd)),t=this.client.customWrapIdentifier(t,Fd),this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(n){return r.client.ddl(r,n,this.connection).dropForeign(e,t)}})}dropPrimary(e){const t=this;e=this.client.customWrapIdentifier(e,Fd),this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(r){return t.client.ddl(t,r,this.connection).dropPrimary(e)}})}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery("drop index "+t)}unique(e,t){let r;Mv(t)&&({indexName:t,deferrable:r}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`sqlite3: unique index \`${t}\` will not be deferrable ${r} because sqlite3 does not support deferred constraints.`),t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),e=this.formatter.columnize(e),this.pushQuery(`create unique index ${t} on ${this.tableName()} (${e})`)}index(e,t,r){let n;t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),e=this.formatter.columnize(e),Mv(r)&&({predicate:n}=r);const i=n?" "+this.client.queryCompiler(n).where():"";this.pushQuery(`create index ${t} on ${this.tableName()} (${e})${i}`)}primary(e,t){const r=this;let n;e=(e=Array.isArray(e)?e:[e]).map(e=>this.client.customWrapIdentifier(e,Fd)),Mv(t)&&({constraintName:t,deferrable:n}=t),n&&"not deferrable"!==n&&this.client.logger.warn(`sqlite3: primary key constraint \`${t}\` will not be deferrable ${n} because sqlite3 does not support deferred constraints.`),t=this.client.customWrapIdentifier(t,Fd),"create"!==this.method&&"createIfNot"!==this.method&&this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(n){return r.client.ddl(r,n,this.connection).primary(e,t)}})}foreign(e){const t=this;"create"!==this.method&&"createIfNot"!==this.method&&(e.column=Array.isArray(e.column)?e.column:[e.column],e.column=e.column.map(e=>this.client.customWrapIdentifier(e,Fd)),e.inTable=this.client.customWrapIdentifier(e.inTable,Fd),e.references=Array.isArray(e.references)?e.references:[e.references],e.references=e.references.map(e=>this.client.customWrapIdentifier(e,Fd)),this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,statementsProducer:(r,n)=>t.client.ddl(t,r,n).foreign(e)}))}primaryKeys(){const e=Lv(this.grouped.alterTable||[],{method:"primary"});if(e.length>0&&e[0].args.length>0){const t=e[0].args[0];let r=e[0].args[1]||"";return r&&(r=" constraint "+this.formatter.wrap(r)),`,${r} ${this.grouped.columns.filter(e=>"increments"===e.builder._type).length>0?"unique":"primary key"} (${this.formatter.columnize(t)})`}}foreignKeys(){let e="";const t=Lv(this.grouped.alterTable||[],{method:"foreign"});for(let r=0,n=t.length;r<n;r++){const n=t[r].args[0],i=this.formatter.columnize(n.column),s=this.formatter.columnize(n.references),o=this.formatter.wrap(n.inTable);let a=n.keyName||"";a&&(a=" constraint "+this.formatter.wrap(a)),e+=`,${a} foreign key(${i}) references ${o}(${s})`,n.onDelete&&(e+=" on delete "+n.onDelete),n.onUpdate&&(e+=" on update "+n.onUpdate)}return e}createTableBlock(){return this.getColumns().concat().join(",")}renameColumn(e,t){this.pushQuery({sql:`alter table ${this.tableName()} rename ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`})}_setNullableState(e,t){const r=this;this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,statementsProducer:(n,i)=>r.client.ddl(r,n,i).setNullable(e,t)})}dropColumn(){const e=this,t=Em(arguments).map(e=>this.client.customWrapIdentifier(e,Fd));this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(r){return e.client.ddl(e,r,this.connection).dropColumn(t)}})}};const{columnize:Uv}=yy;var Bv=class extends nv{constructor(e,t){super(e,t)}createOrReplace(){const e=this.columns,t=this.selectQuery.toString(),r=this.viewName(),n="drop view if exists "+r,i=`create view ${r}${e?" ("+Uv(e,this.viewBuilder,this.client,this.bindingsHolder)+")":""} as ${t}`;this.pushQuery({sql:n}),this.pushQuery({sql:i})}},Vv={tokenize:function(e,t){const r=new RegExp(Object.entries(t).map(([e,t])=>`(?<${e}>${t.source})`).join("|"),"yi");let n=0;const i=[];for(;n<e.length;){r.lastIndex=n;const t=e.match(r);if(null===t)throw new Error(`No matching tokenizer rule found at: [${e.substring(n)}]`);{const[e,r]=Object.entries(t.groups).find(([e,t])=>void 0!==t);n+=r.length,e.startsWith("_")||i.push({type:e,text:r})}}return i}};const{tokenize:zv}=Vv,{s:Hv,a:Qv,m:Wv,o:Jv,l:Kv,n:Gv,t:Yv,e:Zv,f:Xv}={s:function(e,t=(e=>e)){return function({index:r=0,input:n}){let i=r;const s=[];for(const t of e){const e=t({index:i,input:n});if(!e.success)return e;i=e.index,s.push(e.ast)}return{success:!0,ast:t(s),index:i,input:n}}},a:function(e,t=(e=>e)){return function({index:r=0,input:n}){for(const i of e){const e=i({index:r,input:n});if(e.success)return{success:!0,ast:t(e.ast),index:e.index,input:n}}return{success:!1,ast:null,index:r,input:n}}},m:function(e,t=(e=>e)){return function({index:r=0,input:n}){let i={},s=r;const o=[];do{(i=e({index:s,input:n})).success&&(s=i.index,o.push(i.ast))}while(i.success);return o.length>0?{success:!0,ast:t(o),index:s,input:n}:{success:!1,ast:null,index:s,input:n}}},o:function(e,t=(e=>e)){return function({index:r=0,input:n}){const i=e({index:r,input:n});return i.success?{success:!0,ast:t(i.ast),index:i.index,input:n}:{success:!0,ast:t(null),index:r,input:n}}},l:function(e,t=(e=>e)){return function({index:r=0,input:n}){const i=e.do({index:r,input:n});return i.success&&e.next({index:i.index,input:n}).success?{success:!0,ast:t(i.ast),index:i.index,input:n}:{success:!1,ast:null,index:r,input:n}}},n:function(e,t=(e=>e)){return function({index:r=0,input:n}){const i=e.do({index:r,input:n});return i.success&&!e.not({index:r,input:n}).success?{success:!0,ast:t(i.ast),index:i.index,input:n}:{success:!1,ast:null,index:r,input:n}}},t:function(e,t=(e=>e.text)){return function({index:r=0,input:n}){const i=n[r];return void 0===i||void 0!==e.type&&e.type!==i.type||void 0!==e.text&&e.text.toUpperCase()!==i.text.toUpperCase()?{success:!1,ast:null,index:r,input:n}:{success:!0,ast:t(i),index:r+1,input:n}}},e:function({index:e=0,input:t}){return{success:!0,ast:null,index:e,input:t}},f:function({index:e=0,input:t}){return{success:e===t.length,ast:null,index:e,input:t}}},eb={keyword:/(?:ABORT|ACTION|ADD|AFTER|ALL|ALTER|ALWAYS|ANALYZE|AND|AS|ASC|ATTACH|AUTOINCREMENT|BEFORE|BEGIN|BETWEEN|BY|CASCADE|CASE|CAST|CHECK|COLLATE|COLUMN|COMMIT|CONFLICT|CONSTRAINT|CREATE|CROSS|CURRENT|CURRENT_DATE|CURRENT_TIME|CURRENT_TIMESTAMP|DATABASE|DEFAULT|DEFERRED|DEFERRABLE|DELETE|DESC|DETACH|DISTINCT|DO|DROP|END|EACH|ELSE|ESCAPE|EXCEPT|EXCLUSIVE|EXCLUDE|EXISTS|EXPLAIN|FAIL|FILTER|FIRST|FOLLOWING|FOR|FOREIGN|FROM|FULL|GENERATED|GLOB|GROUP|GROUPS|HAVING|IF|IGNORE|IMMEDIATE|IN|INDEX|INDEXED|INITIALLY|INNER|INSERT|INSTEAD|INTERSECT|INTO|IS|ISNULL|JOIN|KEY|LAST|LEFT|LIKE|LIMIT|MATCH|MATERIALIZED|NATURAL|NO|NOT|NOTHING|NOTNULL|NULL|NULLS|OF|OFFSET|ON|OR|ORDER|OTHERS|OUTER|OVER|PARTITION|PLAN|PRAGMA|PRECEDING|PRIMARY|QUERY|RAISE|RANGE|RECURSIVE|REFERENCES|REGEXP|REINDEX|RELEASE|RENAME|REPLACE|RESTRICT|RETURNING|RIGHT|ROLLBACK|ROW|ROWS|SAVEPOINT|SELECT|SET|TABLE|TEMP|TEMPORARY|THEN|TIES|TO|TRANSACTION|TRIGGER|UNBOUNDED|UNION|UNIQUE|UPDATE|USING|VACUUM|VALUES|VIEW|VIRTUAL|WHEN|WHERE|WINDOW|WITH|WITHOUT)(?=\s+|-|\(|\)|;|\+|\*|\/|%|==|=|<=|<>|<<|<|>=|>>|>|!=|,|&|~|\|\||\||\.)/,id:/"[^"]*(?:""[^"]*)*"|`[^`]*(?:``[^`]*)*`|\[[^[\]]*\]|[a-z_][a-z0-9_$]*/,string:/'[^']*(?:''[^']*)*'/,blob:/x'(?:[0-9a-f][0-9a-f])+'/,numeric:/(?:\d+(?:\.\d*)?|\.\d+)(?:e(?:\+|-)?\d+)?|0x[0-9a-f]+/,variable:/\?\d*|[@$:][a-z0-9_$]+/,operator:/-|\(|\)|;|\+|\*|\/|%|==|=|<=|<>|<<|<|>=|>>|>|!=|,|&|~|\|\||\||\./,_ws:/\s+/};function tb(e){return Qv([Yv({text:"TEMP"}),Yv({text:"TEMPORARY"}),Zv],e=>({temporary:null!==e}))(e)}function rb(e){return Jv(Hv([Yv({text:"WITHOUT"}),Yv({text:"ROWID"})]),e=>({rowid:null!==e}))(e)}function nb(e){return Qv([Hv([ib,Yv({text:","}),nb],e=>({columns:[e[0]].concat(e[2].columns)})),Hv([ib],e=>({columns:[e[0]]}))])(e)}function ib(e){return Hv([Hv([Qb],e=>({name:e[0]})),sb,ob],e=>Object.assign({},...e))(e)}function sb(e){return Jv(Hv([Wv(Yv({type:"id"})),Qv([Hv([Yv({text:"("}),Kb,Yv({text:","}),Kb,Yv({text:")"})],e=>`(${e[1]}, ${e[3]})`),Hv([Yv({text:"("}),Kb,Yv({text:")"})],e=>`(${e[1]})`),Zv])],e=>`${e[0].join(" ")}${e[1]||""}`),e=>({type:e}))(e)}function ob(e){return Jv(Wv(ab),e=>({constraints:Object.assign({primary:null,notnull:null,null:null,unique:null,check:null,default:null,collate:null,references:null,as:null},...e||[])}))(e)}function ab(e){return Qv([ub,cb,hb,db,fb,pb,mb,yb,gb])(e)}function ub(e){return Hv([Ab,Yv({text:"PRIMARY"},e=>null),Yv({text:"KEY"},e=>null),Vb,Eb,lb],e=>({primary:Object.assign({},...e.filter(e=>null!==e))}))(e)}function lb(e){return Jv(Yv({text:"AUTOINCREMENT"}),e=>({autoincrement:null!==e}))(e)}function cb(e){return Hv([Ab,Yv({text:"NOT"},e=>null),Yv({text:"NULL"},e=>null),Eb],e=>({notnull:Object.assign({},...e.filter(e=>null!==e))}))(e)}function hb(e){return Hv([Ab,Yv({text:"NULL"},e=>null),Eb],e=>({null:Object.assign({},...e.filter(e=>null!==e))}))(e)}function db(e){return Hv([Ab,Yv({text:"UNIQUE"},e=>null),Eb],e=>({unique:Object.assign({},...e.filter(e=>null!==e))}))(e)}function fb(e){return Hv([Ab,Yv({text:"CHECK"},e=>null),Yv({text:"("},e=>null),Hv([Hb],e=>({expression:e[0]})),Yv({text:")"},e=>null)],e=>({check:Object.assign({},...e.filter(e=>null!==e))}))(e)}function pb(e){return Hv([Ab,Yv({text:"DEFAULT"},e=>null),Qv([Hv([Yv({text:"("}),Hb,Yv({text:")"})],e=>({value:e[1],expression:!0})),Hv([Jb],e=>({value:e[0],expression:!1})),Hv([Kb],e=>({value:e[0],expression:!1}))])],e=>({default:Object.assign({},...e.filter(e=>null!==e))}))(e)}function mb(e){return Hv([Ab,Yv({text:"COLLATE"},e=>null),Yv({type:"id"},e=>({collation:e.text}))],e=>({collate:Object.assign({},...e.filter(e=>null!==e))}))(e)}function yb(e){return Hv([Ab,Hv([$b],e=>e[0].references)],e=>({references:Object.assign({},...e.filter(e=>null!==e))}))(e)}function gb(e){return Hv([Ab,Jv(Hv([Yv({text:"GENERATED"}),Yv({text:"ALWAYS"})]),e=>({generated:null!==e})),Yv({text:"AS"},e=>null),Yv({text:"("},e=>null),Hv([Hb],e=>({expression:e[0]})),Yv({text:")"},e=>null),Qv([Yv({text:"STORED"}),Yv({text:"VIRTUAL"}),Zv],e=>({mode:e?e.toUpperCase():null}))],e=>({as:Object.assign({},...e.filter(e=>null!==e))}))(e)}function vb(e){return Jv(Wv(Hv([Yv({text:","}),bb],e=>e[1])),e=>({constraints:e||[]}))(e)}function bb(e){return Qv([_b,wb,Cb,Nb])(e)}function _b(e){return Hv([Ab,Yv({text:"PRIMARY"},e=>null),Yv({text:"KEY"},e=>null),Yv({text:"("},e=>null),Db,Yv({text:")"},e=>null),Eb],e=>Object.assign({type:"PRIMARY KEY"},...e.filter(e=>null!==e)))(e)}function wb(e){return Hv([Ab,Yv({text:"UNIQUE"},e=>null),Yv({text:"("},e=>null),Db,Yv({text:")"},e=>null),Eb],e=>Object.assign({type:"UNIQUE"},...e.filter(e=>null!==e)))(e)}function Eb(e){return Jv(Hv([Yv({text:"ON"}),Yv({text:"CONFLICT"}),Qv([Yv({text:"ROLLBACK"}),Yv({text:"ABORT"}),Yv({text:"FAIL"}),Yv({text:"IGNORE"}),Yv({text:"REPLACE"})])],e=>e[2]),e=>({conflict:e?e.toUpperCase():null}))(e)}function Cb(e){return Hv([Ab,Yv({text:"CHECK"},e=>null),Yv({text:"("},e=>null),Hv([Hb],e=>({expression:e[0]})),Yv({text:")"},e=>null)],e=>Object.assign({type:"CHECK"},...e.filter(e=>null!==e)))(e)}function Nb(e){return Hv([Ab,Yv({text:"FOREIGN"},e=>null),Yv({text:"KEY"},e=>null),Yv({text:"("},e=>null),Tb,Yv({text:")"},e=>null),$b],e=>Object.assign({type:"FOREIGN KEY"},...e.filter(e=>null!==e)))(e)}function $b(e){return Hv([Yv({text:"REFERENCES"},e=>null),Lb,xb,Jv(Wv(Qv([Ob,Sb,kb])),e=>Object.assign({delete:null,update:null,match:null},...e||[])),jb],e=>({references:Object.assign({},...e.filter(e=>null!==e))}))(e)}function xb(e){return Jv(Hv([Yv({text:"("}),Tb,Yv({text:")"})],e=>e[1]),e=>({columns:e?e.columns:[]}))(e)}function Tb(e){return Hv([Jv(Wv(Hv([Qb,Yv({text:","})],e=>e[0])),e=>null!==e?e:[]),Qb],e=>({columns:e[0].concat([e[1]])}))(e)}function Ob(e){return Hv([Yv({text:"ON"}),Yv({text:"DELETE"}),Wb],e=>({delete:e[2]}))(e)}function Sb(e){return Hv([Yv({text:"ON"}),Yv({text:"UPDATE"}),Wb],e=>({update:e[2]}))(e)}function kb(e){return Hv([Yv({text:"MATCH"}),Qv([Yv({type:"keyword"}),Yv({type:"id"})])],e=>({match:e[1]}))(e)}function jb(e){return Jv(Hv([Jv(Yv({text:"NOT"})),Yv({text:"DEFERRABLE"}),Jv(Hv([Yv({text:"INITIALLY"}),Qv([Yv({text:"DEFERRED"}),Yv({text:"IMMEDIATE"})])],e=>e[1].toUpperCase()))]),e=>({deferrable:e?{not:null!==e[0],initially:e[2]}:null}))(e)}function Ab(e){return Jv(Hv([Yv({text:"CONSTRAINT"}),Qb],e=>e[1]),e=>({name:e}))(e)}function Rb(e){return Jv(Yv({text:"UNIQUE"}),e=>({unique:null!==e}))(e)}function Ib(e){return Jv(Hv([Yv({text:"IF"}),Yv({text:"NOT"}),Yv({text:"EXISTS"})]),e=>({exists:null!==e}))(e)}function Pb(e){return Jv(Hv([Qb,Yv({text:"."})],e=>e[0]),e=>({schema:e}))(e)}function qb(e){return Hv([Qb],e=>({index:e[0]}))(e)}function Lb(e){return Hv([Qb],e=>({table:e[0]}))(e)}function Mb(e){return Jv(Hv([Yv({text:"WHERE"}),Hb],e=>e[1]),e=>({where:e}))(e)}function Db(e){return Qv([Hv([Fb,Yv({text:","}),Db],e=>({columns:[e[0]].concat(e[2].columns)})),Hv([Ub,Yv({text:","}),Db],e=>({columns:[e[0]].concat(e[2].columns)})),Kv({do:Fb,next:Yv({text:")"})},e=>({columns:[e]})),Kv({do:Ub,next:Yv({text:")"})},e=>({columns:[e]}))])(e)}function Fb(e){return Hv([Hv([Qb],e=>({name:e[0],expression:!1})),Bb,Vb],e=>Object.assign({},...e.filter(e=>null!==e)))(e)}function Ub(e){return Hv([Hv([zb],e=>({name:e[0],expression:!0})),Bb,Vb],e=>Object.assign({},...e.filter(e=>null!==e)))(e)}function Bb(e){return Jv(Hv([Yv({text:"COLLATE"}),Yv({type:"id"})],e=>e[1]),e=>({collation:e}))(e)}function Vb(e){return Qv([Yv({text:"ASC"}),Yv({text:"DESC"}),Zv],e=>({order:e?e.toUpperCase():null}))(e)}function zb(e){return Wv(Qv([Gv({do:Yv({type:"keyword"}),not:Qv([Yv({text:"COLLATE"}),Yv({text:"ASC"}),Yv({text:"DESC"})])}),Yv({type:"id"}),Yv({type:"string"}),Yv({type:"blob"}),Yv({type:"numeric"}),Yv({type:"variable"}),Gv({do:Yv({type:"operator"}),not:Qv([Yv({text:"("}),Yv({text:")"}),Yv({text:","})])}),Hv([Yv({text:"("}),Jv(Hb),Yv({text:")"})],e=>e[1]||[])]))(e)}function Hb(e){return Wv(Qv([Yv({type:"keyword"}),Yv({type:"id"}),Yv({type:"string"}),Yv({type:"blob"}),Yv({type:"numeric"}),Yv({type:"variable"}),Gv({do:Yv({type:"operator"}),not:Qv([Yv({text:"("}),Yv({text:")"})])}),Hv([Yv({text:"("}),Jv(Hb),Yv({text:")"})],e=>e[1]||[])]))(e)}function Qb(e){return Qv([Yv({type:"id"}),Yv({type:"string"})],e=>/^["`['][^]*["`\]']$/.test(e)?e.substring(1,e.length-1):e)(e)}function Wb(e){return Qv([Hv([Yv({text:"SET"}),Yv({text:"NULL"})],e=>`${e[0]} ${e[1]}`),Hv([Yv({text:"SET"}),Yv({text:"DEFAULT"})],e=>`${e[0]} ${e[1]}`),Yv({text:"CASCADE"}),Yv({text:"RESTRICT"}),Hv([Yv({text:"NO"}),Yv({text:"ACTION"})],e=>`${e[0]} ${e[1]}`)],e=>e.toUpperCase())(e)}function Jb(e){return Qv([Yv({type:"numeric"}),Yv({type:"string"}),Yv({type:"id"}),Yv({type:"blob"}),Yv({text:"NULL"}),Yv({text:"TRUE"}),Yv({text:"FALSE"}),Yv({text:"CURRENT_TIME"}),Yv({text:"CURRENT_DATE"}),Yv({text:"CURRENT_TIMESTAMP"})])(e)}function Kb(e){return Hv([Qv([Yv({text:"+"}),Yv({text:"-"}),Zv]),Yv({type:"numeric"})],e=>`${e[0]||""}${e[1]}`)(e)}var Gb={parseCreateTable:function(e){const t=(r={input:zv(e,eb)},Hv([Yv({text:"CREATE"},e=>null),tb,Yv({text:"TABLE"},e=>null),Ib,Pb,Lb,Yv({text:"("},e=>null),nb,vb,Yv({text:")"},e=>null),rb,Xv],e=>Object.assign({},...e.filter(e=>null!==e)))(r));var r;if(!t.success)throw new Error(`Parsing CREATE TABLE failed at [${t.input.slice(t.index).map(e=>e.text).join(" ")}] of "${e}"`);return t.ast},parseCreateIndex:function(e){const t=(r={input:zv(e,eb)},Hv([Yv({text:"CREATE"},e=>null),Rb,Yv({text:"INDEX"},e=>null),Ib,Pb,qb,Yv({text:"ON"},e=>null),Lb,Yv({text:"("},e=>null),Db,Yv({text:")"},e=>null),Mb,Xv],e=>Object.assign({},...e.filter(e=>null!==e)))(r));var r;if(!t.success)throw new Error(`Parsing CREATE INDEX failed at [${t.input.slice(t.index).map(e=>e.text).join(" ")}] of "${e}"`);return t.ast}};function Yb(e,t){return null!==e.conflict?" ON CONFLICT "+e.conflict:""}function Zb(e,t){return`REFERENCES ${n_(e,t)}${function(e,t){return e.columns.length>0?` (${Xb(e,t)})`:""}(e,t)}${function(e,t){return`${function(e,t){return null!==e.delete?" ON DELETE "+e.delete:""}(e)}${function(e,t){return null!==e.update?" ON UPDATE "+e.update:""}(e)}${function(e,t){return null!==e.match?" MATCH "+e.match:""}(e)}`}(e)}${function(e,t){return null!==e?` ${e.not?"NOT ":""}DEFERRABLE${null!==e.initially?" INITIALLY "+e.initially:""}`:""}(e.deferrable)}`}function Xb(e,t){return e.columns.map(e=>u_(e,t)).join(", ")}function e_(e,t){return null!==e.name?`CONSTRAINT ${u_(e.name,t)} `:""}function t_(e,t){return e.exists?" IF NOT EXISTS":""}function r_(e,t){return null!==e.schema?u_(e.schema,t)+".":""}function n_(e,t){return u_(e.table,t)}function i_(e,t){return e.columns.map(e=>e.expression?function(e,t){return`${function(e,t){return a_(e,t)}(e.name,t)}${s_(e,t)}${o_(e,t)}`}(e,t):function(e,t){return`${u_(e.name,t)}${s_(e,t)}${o_(e,t)}`}(e,t)).join(", ")}function s_(e,t){return null!==e.collation?" COLLATE "+e.collation:""}function o_(e,t){return null!==e.order?" "+e.order:""}function a_(e,t){return e.reduce((e,t)=>Array.isArray(t)?`${e}(${a_(t)})`:e?`${e} ${t}`:t,"")}function u_(e,t){return t(e)}var l_={compileCreateTable:function(e,t=(e=>e)){return function(e,t){return`CREATE${function(e,t){return e.temporary?" TEMP":""}(e)} TABLE${t_(e)} ${r_(e,t)}${n_(e,t)} (${function(e,t){return e.columns.map(e=>function(e,t){return`${u_(e.name,t)}${function(e,t){return null!==e.type?" "+e.type:""}(e)}${function(e,t){return`${function(e,t){return null!==e.primary?` ${e_(e.primary,t)}PRIMARY KEY${o_(e.primary)}${Yb(e.primary)}${function(e,t){return e.autoincrement?" AUTOINCREMENT":""}(e.primary)}`:""}(e,t)}${function(e,t){return null!==e.notnull?` ${e_(e.notnull,t)}NOT NULL${Yb(e.notnull)}`:""}(e,t)}${function(e,t){return null!==e.null?` ${e_(e.null,t)}NULL${Yb(e.null)}`:""}(e,t)}${function(e,t){return null!==e.unique?` ${e_(e.unique,t)}UNIQUE${Yb(e.unique)}`:""}(e,t)}${function(e,t){return null!==e.check?` ${e_(e.check,t)}CHECK (${a_(e.check.expression)})`:""}(e,t)}${function(e,t){return null!==e.default?` ${e_(e.default,t)}DEFAULT ${e.default.expression?`(${a_(e.default.value)})`:e.default.value}`:""}(e,t)}${function(e,t){return null!==e.collate?` ${e_(e.collate,t)}COLLATE ${e.collate.collation}`:""}(e,t)}${function(e,t){return null!==e.references?` ${e_(e.references,t)}${Zb(e.references,t)}`:""}(e,t)}${function(e,t){return null!==e.as?` ${e_(e.as,t)}${e.as.generated?"GENERATED ALWAYS ":""}AS (${a_(e.as.expression)})${null!==e.as.mode?" "+e.as.mode:""}`:""}(e,t)}`}(e.constraints,t)}`}(e,t)).join(", ")}(e,t)}${function(e,t){return e.constraints.reduce((e,r)=>`${e}, ${function(e,t){switch(e.type){case"PRIMARY KEY":return function(e,t){return`${e_(e,t)}PRIMARY KEY (${i_(e,t)})${Yb(e)}`}(e,t);case"UNIQUE":return function(e,t){return`${e_(e,t)}UNIQUE (${i_(e,t)})${Yb(e)}`}(e,t);case"CHECK":return function(e,t){return`${e_(e,t)}CHECK (${a_(e.expression)})`}(e,t);case"FOREIGN KEY":return function(e,t){return`${e_(e,t)}FOREIGN KEY (${Xb(e,t)}) ${Zb(e.references,t)}`}(e,t)}}(r,t)}`,"")}(e,t)})${function(e,t){return e.rowid?" WITHOUT ROWID":""}(e)}`}(e,t)},compileCreateIndex:function(e,t=(e=>e)){return function(e,t){return`CREATE${function(e,t){return e.unique?" UNIQUE":""}(e)} INDEX${t_(e)} ${r_(e,t)}${function(e,t){return u_(e.index,t)}(e,t)} on ${n_(e,t)} (${i_(e,t)})${function(e,t){return null!==e.where?" where "+a_(e.where):""}(e)}`}(e,t)}};function c_(e,t){return e.toLowerCase()===t.toLowerCase()}var h_={isEqualId:c_,includesId:function(e,t){return e.some(e=>c_(e,t))}};const{nanonum:d_}=by,{copyData:f_,dropOriginal:p_,renameTable:m_,getTableSql:y_,isForeignCheckEnabled:g_,setForeignCheck:v_,executeForeignCheck:b_}={copyData:function(e,t,r){return`INSERT INTO "${t}" SELECT ${void 0===r?"*":r.map(e=>`"${e}"`).join(", ")} FROM "${e}";`},dropOriginal:function(e){return`DROP TABLE "${e}"`},renameTable:function(e,t){return`ALTER TABLE "${e}" RENAME TO "${t}"`},getTableSql:function(e){return`SELECT type, sql FROM sqlite_master WHERE (type='table' OR (type='index' AND sql IS NOT NULL)) AND tbl_name='${e}'`},isForeignCheckEnabled:function(){return"PRAGMA foreign_keys"},setForeignCheck:function(e){return"PRAGMA foreign_keys = "+(e?"ON":"OFF")},executeForeignCheck:function(){return"PRAGMA foreign_key_check"}},{parseCreateTable:__,parseCreateIndex:w_}=Gb,{compileCreateTable:E_,compileCreateIndex:C_}=l_,{isEqualId:N_,includesId:$_}=h_;var x_=class{constructor(e,t,r,n){this.client=e,this.tableCompiler=t,this.pragma=r,this.tableNameRaw=this.tableCompiler.tableNameRaw,this.alteredName="_knex_temp_alter"+d_(3),this.connection=n,this.formatter=e=>this.client.customWrapIdentifier(e,Fd),this.wrap=e=>this.client.wrapIdentifierImpl(e)}tableName(){return this.formatter(this.tableNameRaw)}getTableSql(){const e=this.tableName();return this.client.transaction(async t=>{t.disableProcessing();const r=await t.raw(y_(e));return t.enableProcessing(),{createTable:r.filter(e=>"table"===e.type)[0].sql,createIndices:r.filter(e=>"index"===e.type).map(e=>e.sql)}},{connection:this.connection})}async isForeignCheckEnabled(){return 1===(await this.client.raw(g_()).connection(this.connection))[0].foreign_keys}async setForeignCheck(e){await this.client.raw(v_(e)).connection(this.connection)}renameTable(e){return e.raw(m_(this.alteredName,this.tableName()))}dropOriginal(e){return e.raw(p_(this.tableName()))}copyData(e,t){return e.raw(f_(this.tableName(),this.alteredName,t))}async alterColumn(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=__(t);n.table=this.alteredName,n.columns=n.columns.map(t=>{const r=e.find(e=>N_(e.name,t.name));return r&&(t.type=r.type,t.constraints.default=null!==r.defaultTo?{name:null,value:r.defaultTo,expression:!1}:null,t.constraints.notnull=r.notNull?{name:null,conflict:null}:null,t.constraints.null=r.notNull?null:t.constraints.null),t});const i=E_(n,this.wrap);return this.generateAlterCommands(i,r)}async dropColumn(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=__(t);if(n.table=this.alteredName,n.columns=n.columns.filter(t=>t.expression||!$_(e,t.name)),0===n.columns.length)throw new Error("Unable to drop last column from table");n.constraints=n.constraints.filter(t=>"PRIMARY KEY"===t.type||"UNIQUE"===t.type?t.columns.every(t=>t.expression||!$_(e,t.name)):"FOREIGN KEY"!==t.type||t.columns.every(t=>!$_(e,t))&&(t.references.table!==n.table||t.references.columns.every(t=>!$_(e,t))));const i=n.columns.map(e=>e.name),s=E_(n,this.wrap),o=[];for(const a of r){const t=w_(a);t.columns=t.columns.filter(t=>t.expression||!$_(e,t.name)),t.columns.length>0&&o.push(C_(t,this.wrap))}return this.alter(s,o,i)}async dropForeign(e,t){const{createTable:r,createIndices:n}=await this.getTableSql(),i=__(r);i.table=this.alteredName,t||(i.columns=i.columns.map(t=>({...t,references:$_(e,t.name)?null:t.references}))),i.constraints=i.constraints.filter(r=>"FOREIGN KEY"!==r.type||(t?!r.name||!N_(r.name,t):r.columns.every(t=>!$_(e,t))));const s=E_(i,this.wrap);return this.alter(s,n)}async dropPrimary(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=__(t);n.table=this.alteredName,n.columns=n.columns.map(e=>({...e,primary:null})),n.constraints=n.constraints.filter(t=>"PRIMARY KEY"!==t.type||!!e&&(!t.name||!N_(t.name,e)));const i=E_(n,this.wrap);return this.alter(i,r)}async primary(e,t){const{createTable:r,createIndices:n}=await this.getTableSql(),i=__(r);i.table=this.alteredName,i.columns=i.columns.map(e=>({...e,primary:null})),i.constraints=i.constraints.filter(e=>"PRIMARY KEY"!==e.type),i.constraints.push({type:"PRIMARY KEY",name:t||null,columns:e.map(e=>({name:e,expression:!1,collation:null,order:null})),conflict:null});const s=E_(i,this.wrap);return this.alter(s,n)}async foreign(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=__(t);n.table=this.alteredName,n.constraints.push({type:"FOREIGN KEY",name:e.keyName||null,columns:e.column,references:{table:e.inTable,columns:e.references,delete:e.onDelete||null,update:e.onUpdate||null,match:null,deferrable:null}});const i=E_(n,this.wrap);return this.generateAlterCommands(i,r)}async setNullable(e,t){const{createTable:r,createIndices:n}=await this.getTableSql(),i=__(r);i.table=this.alteredName;const s=i.columns.find(t=>N_(e,t.name));if(!s)throw new Error(`.setNullable: Column ${e} does not exist in table ${this.tableName()}.`);s.constraints.notnull=t?null:{name:null,conflict:null},s.constraints.null=t?s.constraints.null:null;const o=E_(i,this.wrap);return this.generateAlterCommands(o,n)}async alter(e,t,r){const n=await this.isForeignCheckEnabled();n&&await this.setForeignCheck(!1);try{await this.client.transaction(async i=>{await i.raw(e),await this.copyData(i,r),await this.dropOriginal(i),await this.renameTable(i);for(const e of t)await i.raw(e);if(n&&(await i.raw(b_())).length>0)throw new Error("FOREIGN KEY constraint failed")},{connection:this.connection})}finally{n&&await this.setForeignCheck(!0)}}async generateAlterCommands(e,t,r){const n=[],i=[],s=[];let o=null;n.push(e),n.push(f_(this.tableName(),this.alteredName,r)),n.push(p_(this.tableName())),n.push(m_(this.alteredName,this.tableName()));for(const a of t)n.push(a);return await this.isForeignCheckEnabled()&&(i.push(v_(!1)),s.push(v_(!0)),o=b_()),{pre:i,sql:n,check:o,post:s}}},T_=class extends ry{withMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!0)}withNotMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!1)}},O_=class extends up{begin(e){return this.isolationLevel?this.query(e,`BEGIN ISOLATION LEVEL ${this.isolationLevel};`):this.query(e,"BEGIN;")}};const{wrapString:S_,columnize:k_,operator:j_,wrap:A_}=yy;var R_=class extends tg{constructor(e,t,r){super(e,t,r),this._defaultInsertValue="default"}truncate(){return`truncate ${this.tableName} restart identity`}insert(){let e=super.insert();if(""===e)return e;const{returning:t,onConflict:r,ignore:n,merge:i,insert:s}=this.single;if(r&&n&&(e+=this._ignore(r)),r&&i){e+=this._merge(i.updates,r,s);const t=this.where();t&&(e+=" "+t)}return t&&(e+=this._returning(t)),{sql:e,returning:t}}update(){const e=this.with(),t=this._prepUpdate(this.single.update),r=this.where(),{returning:n}=this.single;return{sql:e+`update ${this.single.only?"only ":""}${this.tableName} set `+t.join(", ")+(r?" "+r:"")+this._returning(n),returning:n}}using(){const e=this.single.using;if(!e)return;let t="using ";return Array.isArray(e)?t+=e.map(e=>this.formatter.wrap(e)).join(","):t+=this.formatter.wrap(e),t}del(){const{tableName:e}=this,t=this.with();let r=this.where()||"",n=this.using()||"";const i=this.grouped.join,s=[];if(Array.isArray(i)){for(const e of i){s.push(A_(this._joinTable(e),void 0,this.builder,this.client,this.bindingsHolder));const t=[];for(const r of e.clauses)t.push(this.whereBasic({column:r.column,operator:"=",value:r.value,asColumn:!0}));t.length>0&&(r+=(r?" and ":"where ")+t.join(" and "))}s.length>0&&(n+=(n?",":"using ")+s.join(","))}const o=t+`delete from ${this.single.only?"only ":""}${e}`+(n?" "+n:"")+(r?" "+r:""),{returning:a}=this.single;return{sql:o+this._returning(a),returning:a}}aggregate(e){return this._aggregate(e,{distinctParentheses:!0})}_returning(e){return e?" returning "+this.formatter.columnize(e):""}_ignore(e){return!0===e?" on conflict do nothing":` on conflict ${this._onConflictClause(e)} do nothing`}_merge(e,t,r){let n=` on conflict ${this._onConflictClause(t)} do update set `;if(e&&Array.isArray(e))return n+e.map(e=>S_(e.split(".").pop(),this.formatter.builder,this.client,this.formatter)).map(e=>`${e} = excluded.${e}`).join(", ");if(e&&"object"==typeof e){const t=this._prepUpdate(e);return n+("string"==typeof t?t:t.join(","))}{const e=this._prepInsert(r);if("string"==typeof e)throw new Error("If using merge with a raw insert query, then updates must be provided");return n+e.columns.map(e=>S_(e.split(".").pop(),this.builder,this.client)).map(e=>`${e} = excluded.${e}`).join(", ")}}_tableNames(e){const t=this.single.schema,r=[];for(let n=0;n<e.length;n++){let i=e[n];i&&(t&&(i=`${t}.${i}`),r.push(this.formatter.wrap(i)))}return r.join(", ")}_lockingClause(e){const t=this.single.lockTables||[];return e+(t.length?" of "+this._tableNames(t):"")}_groupOrder(e,t){return super._groupOrderNulls(e,t)}forUpdate(){return this._lockingClause("for update")}forShare(){return this._lockingClause("for share")}forNoKeyUpdate(){return this._lockingClause("for no key update")}forKeyShare(){return this._lockingClause("for key share")}skipLocked(){return"skip locked"}noWait(){return"nowait"}columnInfo(){const e=this.single.columnInfo;let t=this.single.schema;const r=this.client.customWrapIdentifier(this.single.table,Fd);t&&(t=this.client.customWrapIdentifier(t,Fd));const n=[r];return this._buildColumnInfoQuery(t,"select * from information_schema.columns where table_name = ? and table_catalog = current_database()",n,e)}_buildColumnInfoQuery(e,t,r,n){return e?(t+=" and table_schema = ?",r.push(e)):t+=" and table_schema = current_schema()",{sql:t,bindings:r,output(e){const t=sy(e.rows,(function(e,t){return e[t.column_name]={type:t.data_type,maxLength:t.character_maximum_length,nullable:"YES"===t.is_nullable,defaultValue:t.column_default},e}),{});return n&&t[n]||t}}}distinctOn(e){return"distinct on ("+this.formatter.columnize(e)+") "}jsonExtract(e){return this._jsonExtract("jsonb_path_query",e)}jsonSet(e){return this._jsonSet("jsonb_set",Object.assign({},e,{path:this.client.toPathForJson(e.path)}))}jsonInsert(e){return this._jsonSet("jsonb_insert",Object.assign({},e,{path:this.client.toPathForJson(e.path)}))}jsonRemove(e){const t=`${k_(e.column,this.builder,this.client,this.bindingsHolder)} #- ${this.client.parameter(this.client.toPathForJson(e.path),this.builder,this.bindingsHolder)}`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){let t="";return t=!isNaN(e.value)&&parseInt(e.value)?"::int":!isNaN(e.value)&&parseFloat(e.value)?"::float":" #>> '{}'",`jsonb_path_query_first(${this._columnClause(e)}, ${this.client.parameter(e.jsonPath,this.builder,this.bindingsHolder)})${t} ${j_(e.operator,this.builder,this.client,this.bindingsHolder)} ${this._jsonValueClause(e)}`}whereJsonSupersetOf(e){return this._not(e,`${A_(e.column,void 0,this.builder,this.client,this.bindingsHolder)} @> ${this._jsonValueClause(e)}`)}whereJsonSubsetOf(e){return this._not(e,`${k_(e.column,this.builder,this.client,this.bindingsHolder)} <@ ${this._jsonValueClause(e)}`)}onJsonPathEquals(e){return this._onJsonPathEquals("jsonb_path_query_first",e)}},I_=class extends ry{using(e){return this._single.using=e,this}withMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!0)}withNotMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!1)}},P_={};const{isObject:q_}=Jf,{toNumber:L_}=Am,M_=/(?<!')'(?!')/g;class D_ extends Vg{constructor(e,t,r){super(e,t,r),this.modifiers=["nullable","defaultTo","comment"],this._addCheckModifiers()}bit(e){return!1!==e.length?`bit(${e.length})`:"bit"}enu(e,t){const r=(t=t||{}).useNative&&t.existingType?void 0:e.join("', '");if(t.useNative){let e="";const n=t.schemaName||this.tableCompiler.schemaNameRaw;return n&&(e+=`"${n}".`),e+=`"${t.enumName}"`,t.existingType||this.tableCompiler.unshiftQuery(`create type ${e} as enum ('${r}')`),e}return`text check (${this.formatter.wrap(this.args[0])} in ('${r}'))`}decimal(e,t){return null===e?"decimal":`decimal(${L_(e,8)}, ${L_(t,2)})`}json(e){return e&&this.client.logger.deprecate("json(true)","jsonb()"),F_(this.client,e)}jsonb(){return F_(this.client,!0)}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} ~ ${this.client._escapeBinding(e)}`,t)}datetime(e=!1,t){let r;return q_(e)?({useTz:r,precision:t}=e):r=!e,`${(r="boolean"!=typeof r||r)?"timestamptz":"timestamp"}${t=null!=t?"("+t+")":""}`}timestamp(e=!1,t){return this.datetime(e,t)}comment(e){const t=this.args[0]||this.defaults("columnName"),r=e?`'${e.replace(M_,"''")}'`:"NULL";this.pushAdditional((function(){this.pushQuery(`comment on column ${this.tableCompiler.tableName()}.`+this.formatter.wrap(t)+" is "+r)}),e)}increments(e={primaryKey:!0}){return"serial"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}bigincrements(e={primaryKey:!0}){return"bigserial"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}}function F_(e,t){return!e.version||"cockroachdb"===e.config.client||parseFloat(e.version)>=9.2?t?"jsonb":"json":"text"}D_.prototype.bigint="bigint",D_.prototype.binary="bytea",D_.prototype.bool="boolean",D_.prototype.double="double precision",D_.prototype.floating="real",D_.prototype.smallint="smallint",D_.prototype.tinyint="smallint",D_.prototype.uuid="uuid",P_=D_;const{isObject:U_,isString:B_}=Jf;var V_=class extends kg{constructor(e,t){super(e,t)}renameColumn(e,t){return this.pushQuery({sql:`alter table ${this.tableName()} rename ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`})}_setNullableState(e,t){const r=t?"drop not null":"set not null",n=`alter table ${this.tableName()} alter column ${this.formatter.wrap(e)} ${r}`;return this.pushQuery({sql:n})}compileAdd(e){const t=this.formatter.wrap(e),r=this.prefixArray("add column",this.getColumns(e));return this.pushQuery({sql:`alter table ${t} ${r.join(", ")}`})}createQuery(e,t,r){const n=t?"create table if not exists ":"create table ",i=" ("+e.sql.join(", ")+this._addChecks()+")";let s=n+this.tableName()+(r&&this.tableNameLike()?" (like "+this.tableNameLike()+" including all"+(e.sql.length?", "+e.sql.join(", "):"")+")":i);this.single.inherits&&(s+=` inherits (${this.formatter.wrap(this.single.inherits)})`),this.pushQuery({sql:s,bindings:e.bindings}),Dy(this.single,"comment")&&this.comment(this.single.comment)}addColumns(e,t,r){if(t===this.alterColumnsPrefix)for(const n of r)this._addColumn(n);else super.addColumns(e,t)}_addColumn(e){const t=this.tableName(),r=e.getColumnType(),n=this.client.wrapIdentifier(e.getColumnName(),e.columnBuilder.queryContext()),i="enu"===e.type;this.pushQuery({sql:`alter table ${t} alter column ${n} drop default`,bindings:[]});const s=e.columnBuilder.alterNullable;s&&this.pushQuery({sql:`alter table ${t} alter column ${n} drop not null`,bindings:[]}),e.columnBuilder.alterType&&this.pushQuery({sql:`alter table ${t} alter column ${n} type ${r} using (${n}${i?"::text::":"::"}${r})`,bindings:[]});const o=e.modified.defaultTo;if(o){const r=e.defaultTo.apply(e,o);this.pushQuery({sql:`alter table ${t} alter column ${n} set ${r}`,bindings:[]})}if(s){const r=e.modified.nullable;r&&!1===r[0]&&this.pushQuery({sql:`alter table ${t} alter column ${n} set not null`,bindings:[]})}}comment(e){this.pushQuery(`comment on table ${this.tableName()} is '${this.single.comment}'`)}primary(e,t){let r;U_(t)&&({constraintName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} primary key (${this.formatter.columnize(e)})${r}`)}unique(e,t){let r;U_(t)&&({indexName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} unique (`+this.formatter.columnize(e)+")"+r)}index(e,t,r){let n,i;t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),B_(r)?i=r:U_(r)&&({indexType:i,predicate:n}=r);const s=n?" "+this.client.queryCompiler(n).where():"";this.pushQuery(`create index ${t} on ${this.tableName()}${i&&" using "+i||""} (`+this.formatter.columnize(e)+")"+s)}dropPrimary(e){e=e?this.formatter.wrap(e):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`alter table ${this.tableName()} drop constraint ${e}`)}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),t=this.schemaNameRaw?`${this.formatter.wrap(this.schemaNameRaw)}.${t}`:t,this.pushQuery("drop index "+t)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}},z_=class extends nv{constructor(e,t){super(e,t)}renameColumn(e,t){return this.pushQuery({sql:`alter view ${this.viewName()} rename ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`})}defaultTo(e,t){return this.pushQuery({sql:`alter view ${this.viewName()} alter ${this.formatter.wrap(e)} set default ${t}`})}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}createMaterializedView(){this.createQuery(this.columns,this.selectQuery,!0)}},H_=class extends ev{constructor(){super(...arguments)}checkOption(){this._single.checkOption="default_option"}localCheckOption(){this._single.checkOption="local"}cascadedCheckOption(){this._single.checkOption="cascaded"}},Q_=class extends lg{constructor(e,t){super(e,t)}hasTable(e){let t="select * from information_schema.tables where table_name = ?";const r=[e];this.schema?(t+=" and table_schema = ?",r.push(this.schema)):t+=" and table_schema = current_schema()",this.pushQuery({sql:t,bindings:r,output:e=>e.rows.length>0})}hasColumn(e,t){let r="select * from information_schema.columns where table_name = ? and column_name = ?";const n=[e,t];this.schema?(r+=" and table_schema = ?",n.push(this.schema)):r+=" and table_schema = current_schema()",this.pushQuery({sql:r,bindings:n,output:e=>e.rows.length>0})}qualifiedTableName(e){const t=this.schema?`${this.schema}.${e}`:e;return this.formatter.wrap(t)}renameTable(e,t){this.pushQuery(`alter table ${this.qualifiedTableName(e)} rename to ${this.formatter.wrap(t)}`)}createSchema(e){this.pushQuery("create schema "+this.formatter.wrap(e))}createSchemaIfNotExists(e){this.pushQuery("create schema if not exists "+this.formatter.wrap(e))}dropSchema(e,t=!1){this.pushQuery(`drop schema ${this.formatter.wrap(e)}${t?" cascade":""}`)}dropSchemaIfExists(e,t=!1){this.pushQuery(`drop schema if exists ${this.formatter.wrap(e)}${t?" cascade":""}`)}dropExtension(e){this.pushQuery("drop extension "+this.formatter.wrap(e))}dropExtensionIfExists(e){this.pushQuery("drop extension if exists "+this.formatter.wrap(e))}createExtension(e){this.pushQuery("create extension "+this.formatter.wrap(e))}createExtensionIfNotExists(e){this.pushQuery("create extension if not exists "+this.formatter.wrap(e))}renameView(e,t){this.pushQuery(this.alterViewPrefix+`${this.formatter.wrap(e)} rename to ${this.formatter.wrap(t)}`)}refreshMaterializedView(e,t=!1){this.pushQuery({sql:`refresh materialized view${t?" concurrently":""} ${this.formatter.wrap(e)}`})}dropMaterializedView(e){this._dropView(e,!1,!0)}dropMaterializedViewIfExists(e){this._dropView(e,!0,!0)}};const{columnize:W_,wrap:J_,operator:K_}=yy;var G_=class extends R_{truncate(){return"truncate "+this.tableName}upsert(){let e=this._upsert();if(""===e)return e;const{returning:t}=this.single;return t&&(e+=this._returning(t)),{sql:e,returning:t}}_upsert(){const e=this.single.upsert||[],t=this.with()+`upsert into ${this.tableName} `,r=this._insertBody(e);return""===r?"":t+r}_groupOrder(e,t){return this._basicGroupOrder(e,t)}whereJsonPath(e){let t="";return t=!isNaN(e.value)&&parseInt(e.value)?"::int":!isNaN(e.value)&&parseFloat(e.value)?"::float":" #>> '{}'",`json_extract_path(${this._columnClause(e)}, ${this.client.toArrayPathFromJsonPath(e.jsonPath,this.builder,this.bindingsHolder)})${t} ${K_(e.operator,this.builder,this.client,this.bindingsHolder)} ${this._jsonValueClause(e)}`}_jsonExtract(e,t){let r;return(r=Array.isArray(t.column)?t.column:[t]).map(e=>{const t=`json_extract_path(${W_(e.column||e[0],this.builder,this.client,this.bindingsHolder)}, ${this.client.toArrayPathFromJsonPath(e.path||e[1],this.builder,this.bindingsHolder)})`,r=e.alias||e[2];return r?this.client.alias(t,this.formatter.wrap(r)):t}).join(", ")}_onJsonPathEquals(e,t){return"json_extract_path("+J_(t.columnFirst,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.toArrayPathFromJsonPath(t.jsonPathFirst,this.builder,this.bindingsHolder)+") = json_extract_path("+J_(t.columnSecond,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.toArrayPathFromJsonPath(t.jsonPathSecond,this.builder,this.bindingsHolder)+")"}},Y_=class extends V_{constructor(e,t){super(e,t)}addColumns(e,t,r){if(t===this.alterColumnsPrefix)for(const n of r)this.client.logger.warn("Experimental alter column in use, see issue: https://github.com/cockroachdb/cockroach/issues/49329"),this.pushQuery({sql:"SET enable_experimental_alter_column_type_general = true",bindings:[]}),super._addColumn(n);else super.addColumns(e,t)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`drop index ${this.tableName()}@${t} cascade `)}},Z_=class extends z_{renameColumn(e,t){throw new Error("rename column of views is not supported by this dialect.")}defaultTo(e,t){throw new Error("change default values of views is not supported by this dialect.")}},X_=class extends ry{upsert(e,t,r){return this._method="upsert",Sp(t)||this.returning(t,r),this._single.upsert=e,this}},ew=function(e){return null==e},tw=class extends Yg{columnizeWithPrefix(e,t){const r="string"==typeof t?[t]:t;let n="",i=-1;for(;++i<r.length;)i>0&&(n+=", "),n+=e+this.wrap(r[i]);return n}escapingStringDelimiters(e){return(e||"").replace(/'/g,"''")}};const rw=yf("knex:tx");var nw=class extends up{begin(e){return rw("transaction::begin id=%s",this.txid),new Promise((t,r)=>{e.beginTransaction(e=>{if(e)return rw("transaction::begin error id=%s message=%s",this.txid,e.message),r(e);t()},this.outerTx?this.txid:void 0,function(e){if(!e)return;e=e.toUpperCase().replace(" ","_");const t=iw[e];if(!t)throw new Error("Unknown Isolation level, was expecting one of: "+JSON.stringify(sw));return t}(this.isolationLevel))}).then(this._resolver,this._rejecter)}savepoint(e){return rw("transaction::savepoint id=%s",this.txid),new Promise((t,r)=>{e.saveTransaction(e=>{if(e)return rw("transaction::savepoint id=%s message=%s",this.txid,e.message),r(e);this.trxClient.emit("query",{__knexUid:this.trxClient.__knexUid,__knexTxId:this.trxClient.__knexTxId,autogenerated:!0,sql:this.outerTx?`SAVE TRANSACTION [${this.txid}]`:"SAVE TRANSACTION"}),t()},this.outerTx?this.txid:void 0)})}commit(e,t){return rw("transaction::commit id=%s",this.txid),new Promise((r,n)=>{e.commitTransaction(e=>{if(e)return rw("transaction::commit error id=%s message=%s",this.txid,e.message),n(e);this._completed=!0,r(t)},this.outerTx?this.txid:void 0)}).then(()=>this._resolver(t),this._rejecter)}release(e,t){return this._resolver(t)}rollback(e,t){return this._completed=!0,rw("transaction::rollback id=%s",this.txid),new Promise((r,n)=>e.inTransaction?"LoggedIn"!==e.state.name?n(new Error("Can't rollback transaction. There is a request in progress")):void e.rollbackTransaction(e=>{e&&rw("transaction::rollback error id=%s message=%s",this.txid,e.message),n(e||t||new Error("Transaction rejected with non-error: undefined"))},this.outerTx?this.txid:void 0):n(t||new Error("Transaction rejected with non-error: undefined"))).catch(e=>{if(t||!this.doNotRejectOnRollback){if(t)try{e.originalError=t}catch(r){}this._rejecter(e)}else this._resolver()})}rollbackTo(e,t){return this.rollback(e,t).then(()=>{this.trxClient.emit("query",{__knexUid:this.trxClient.__knexUid,__knexTxId:this.trxClient.__knexTxId,autogenerated:!0,sql:"ROLLBACK TRANSACTION"})})}};const iw={READ_UNCOMMITTED:1,READ_COMMITTED:2,REPEATABLE_READ:3,SERIALIZABLE:4,SNAPSHOT:5},sw=Object.keys(iw).map(e=>e.toLowerCase().replace("_"," ")),{columnize:ow}=yy,aw=["columns","join","lock","where","union","group","having","order","limit","offset"];var uw=class extends tg{constructor(e,t,r){super(e,t,r);const{onConflict:n}=this.single;if(n)throw new Error(".onConflict() is not supported for mssql.");this._emptyInsertValue="default values"}with(){const e=[];if(this.grouped.with)for(const r of this.grouped.with)r.recursive&&(e.push(r),r.recursive=!1);const t=super.with();for(const r of e)r.recursive=!0;return t}select(){const e=this.with(),t=aw.map(e=>this[e](this));return e+Ay(t).join(" ")}insert(){return this.single.options&&this.single.options.includeTriggerModifications?this.insertWithTriggers():this.standardInsert()}insertWithTriggers(){const e=this.single.insert||[],{returning:t}=this.single;let r=this.with()+`${this._buildTempTable(t)}insert into ${this.tableName} `;const n=t?this._returning("insert",t,!0)+" ":"";if(Array.isArray(e)){if(0===e.length)return""}else if("object"==typeof e&&Sp(e))return{sql:r+n+this._emptyInsertValue+this._buildReturningSelect(t),returning:t};return r+=this._buildInsertData(e,n),t&&(r+=this._buildReturningSelect(t)),{sql:r,returning:t}}_buildInsertData(e,t){let r="";const n=this._prepInsert(e);if("string"==typeof n)r+=n;else if(n.columns.length)r+="("+this.formatter.columnize(n.columns),r+=`) ${t}values (`+this._buildInsertValues(n)+")";else{if(1!==e.length||!e[0])return"";r+=t+this._emptyInsertValue}return r}standardInsert(){const e=this.single.insert||[];let t=this.with()+`insert into ${this.tableName} `;const{returning:r}=this.single,n=r?this._returning("insert",r)+" ":"";if(Array.isArray(e)){if(0===e.length)return""}else if("object"==typeof e&&Sp(e))return{sql:t+n+this._emptyInsertValue,returning:r};return{sql:t+=this._buildInsertData(e,n),returning:r}}update(){return this.single.options&&this.single.options.includeTriggerModifications?this.updateWithTriggers():this.standardUpdate()}updateWithTriggers(){const e=this.top(),t=this.with(),r=this._prepUpdate(this.single.update),n=this.join(),i=this.where(),s=this.order(),{returning:o}=this.single;return{sql:t+this._buildTempTable(o)+`update ${e?e+" ":""}${this.tableName} set `+r.join(", ")+(o?" "+this._returning("update",o,!0):"")+(n?` from ${this.tableName} ${n}`:"")+(i?" "+i:"")+(s?" "+s:"")+(o?this._buildReturningSelect(o):this._returning("rowcount","@@rowcount")),returning:o||"@@rowcount"}}_formatGroupsItemValue(e,t){const r=super._formatGroupsItemValue(e);if(t&&!(e instanceof _y)){const e=`IIF(${r} is null,`;if("first"===t)return e+"0,1)";if("last"===t)return e+"1,0)"}return r}standardUpdate(){const e=this.top(),t=this.with(),r=this._prepUpdate(this.single.update),n=this.join(),i=this.where(),s=this.order(),{returning:o}=this.single;return{sql:t+`update ${e?e+" ":""}${this.tableName} set `+r.join(", ")+(o?" "+this._returning("update",o):"")+(n?` from ${this.tableName} ${n}`:"")+(i?" "+i:"")+(s?" "+s:"")+(o?"":this._returning("rowcount","@@rowcount")),returning:o||"@@rowcount"}}del(){return this.single.options&&this.single.options.includeTriggerModifications?this.deleteWithTriggers():this.standardDelete()}deleteWithTriggers(){const e=this.with(),{tableName:t}=this,r=this.where(),n=this.join(),{returning:i}=this.single,s=i?" "+this._returning("del",i,!0):"",o=n?`${t}${s} `:"";return{sql:e+`${this._buildTempTable(i)}delete ${o}from ${t}`+(n?"":s)+(n?" "+n:"")+(r?" "+r:"")+(i?this._buildReturningSelect(i):this._returning("rowcount","@@rowcount")),returning:i||"@@rowcount"}}standardDelete(){const e=this.with(),{tableName:t}=this,r=this.where(),n=this.join(),{returning:i}=this.single,s=i?" "+this._returning("del",i):"";return{sql:e+`delete ${n?`${t}${s} `:""}from ${t}`+(n?"":s)+(n?" "+n:"")+(r?" "+r:"")+(i?"":this._returning("rowcount","@@rowcount")),returning:i||"@@rowcount"}}columns(){let e="";if(this.onlyUnions())return"";const t=this.top(),r=this._hintComments(),n=this.grouped.columns||[];let i=-1,s=[];if(n)for(;++i<n.length;){const t=n[i];t.distinct&&(e="distinct "),t.distinctOn?e=this.distinctOn(t.value):"aggregate"===t.type?s.push(...this.aggregate(t)):"aggregateRaw"===t.type?s.push(this.aggregateRaw(t)):"analytic"===t.type?s.push(this.analytic(t)):"json"===t.type?s.push(this.json(t)):t.value&&t.value.length>0&&s.push(this.formatter.columnize(t.value))}return 0===s.length&&(s=["*"]),`${this.onlyJson()?"":"select "}${r}${e}`+(t?t+" ":"")+s.join(", ")+(this.tableName?" from "+this.tableName:"")}_returning(e,t,r){switch(e){case"update":case"insert":return t?`output ${this.formatter.columnizeWithPrefix("inserted.",t)}${r?" into #out":""}`:"";case"del":return t?`output ${this.formatter.columnizeWithPrefix("deleted.",t)}${r?" into #out":""}`:"";case"rowcount":return t?";select @@rowcount":""}}_buildTempTable(e){if(e&&e.length>0){let t="",r=`select top(0) ${t=Array.isArray(e)?e.map(e=>"[t]."+this.formatter.columnize(e)).join(","):"[t]."+this.formatter.columnize(e)} into #out `;return r+=`from ${this.tableName} as t `,r+=`left join ${this.tableName} on 0=1;`}return""}_buildReturningSelect(e){if(e&&e.length>0){let t="",r=`; select ${t=Array.isArray(e)?e.map(e=>""+this.formatter.columnize(e)).join(","):this.formatter.columnize(e)} from #out; `;return r+="drop table #out;"}return""}truncate(){return"truncate table "+this.tableName}forUpdate(){return"with (UPDLOCK)"}forShare(){return"with (HOLDLOCK)"}columnInfo(){const e=this.single.columnInfo;let t=this.single.schema;const r=this.client.customWrapIdentifier(this.single.table,Fd);t&&(t=this.client.customWrapIdentifier(t,Fd));let n="select [COLUMN_NAME], [COLUMN_DEFAULT], [DATA_TYPE], [CHARACTER_MAXIMUM_LENGTH], [IS_NULLABLE] from INFORMATION_SCHEMA.COLUMNS where table_name = ? and table_catalog = ?";const i=[r,this.client.database()];return t?(n+=" and table_schema = ?",i.push(t)):n+=" and table_schema = 'dbo'",{sql:n,bindings:i,output(t){const r=t.reduce((e,t)=>(e[t[0].value]={defaultValue:t[1].value,type:t[2].value,maxLength:t[3].value,nullable:"YES"===t[4].value},e),{});return e&&r[e]||r}}}top(){const e=!this.single.limit&&0!==this.single.limit,t=!this.single.offset;return e||!t?"":`top (${this._getValueOrParameterFromAttribute("limit")})`}limit(){return""}offset(){const e=!this.single.limit&&0!==this.single.limit,t=!this.single.offset;if(t)return"";let r=`offset ${t?"0":this._getValueOrParameterFromAttribute("offset")} rows`;return e||(r+=` fetch next ${this._getValueOrParameterFromAttribute("limit")} rows only`),r}whereLike(e){return`${this._columnClause(e)} collate SQL_Latin1_General_CP1_CS_AS ${this._not(e,"like ")}${this._valueClause(e)}`}whereILike(e){return`${this._columnClause(e)} collate SQL_Latin1_General_CP1_CI_AS ${this._not(e,"like ")}${this._valueClause(e)}`}jsonExtract(e){return this._jsonExtract(e.singleValue?"JSON_VALUE":"JSON_QUERY",e)}jsonSet(e){return this._jsonSet("JSON_MODIFY",e)}jsonInsert(e){return this._jsonSet("JSON_MODIFY",e)}jsonRemove(e){const t=`JSON_MODIFY(${ow(e.column,this.builder,this.client,this.bindingsHolder)},${this.client.parameter(e.path,this.builder,this.bindingsHolder)}, NULL)`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){return this._whereJsonPath("JSON_VALUE",e)}whereJsonSupersetOf(e){throw new Error("Json superset where clause not actually supported by MSSQL")}whereJsonSubsetOf(e){throw new Error("Json subset where clause not actually supported by MSSQL")}_getExtracts(e,t){const r=ow(e.column,this.builder,this.client,this.bindingsHolder);return(Array.isArray(e.values)?e.values:[e.values]).map((function(e){return"JSON_VALUE("+r+","+this.client.parameter(e,this.builder,this.bindingsHolder)+")"}),this).join(t)}onJsonPathEquals(e){return this._onJsonPathEquals("JSON_VALUE",e)}},lw={};class cw extends lg{constructor(e,t){super(e,t)}dropTableIfExists(e){const t=this.formatter.wrap(hw(this.schema,e));this.pushQuery(`if object_id('${t}', 'U') is not null DROP TABLE ${t}`)}dropViewIfExists(e){const t=this.formatter.wrap(hw(this.schema,e));this.pushQuery(`if object_id('${t}', 'V') is not null DROP VIEW ${t}`)}renameTable(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(hw(this.schema,e),this.builder,this.bindingsHolder)}, ${this.client.parameter(t,this.builder,this.bindingsHolder)}`)}renameView(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(hw(this.schema,e),this.builder,this.bindingsHolder)}, ${this.client.parameter(t,this.builder,this.bindingsHolder)}`)}hasTable(e){const t=[e];let r="SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = "+this.client.parameter(hw(this.schema,e),this.builder,this.bindingsHolder);this.schema&&(r+=" AND TABLE_SCHEMA = ?",t.push(this.schema)),this.pushQuery({sql:r,bindings:t,output:e=>e.length>0})}hasColumn(e,t){const r=`select object_id from sys.columns where name = ${this.client.parameter(t,this.builder,this.bindingsHolder)} and object_id = object_id(${this.client.parameter(this.formatter.wrap(hw(this.schema,e)),this.builder,this.bindingsHolder)})`;this.pushQuery({sql:r,output:e=>e.length>0})}}function hw(e,t){return e?`${e}.${t}`:t}cw.prototype.dropTablePrefix="DROP TABLE ",lw=cw;var dw={};const{isObject:fw}=Jf;class pw extends kg{constructor(e,t){super(e,t)}createQuery(e,t,r){let n=t?`if object_id('${this.tableName()}', 'U') is null `:"";n+=r?`SELECT * INTO ${this.tableName()} FROM ${this.tableNameLike()} WHERE 0=1`:"CREATE TABLE "+this.tableName()+(this._formatting?" (\n    ":" (")+e.sql.join(this._formatting?",\n    ":", ")+this._addChecks()+")",this.pushQuery(n),this.single.comment&&this.comment(this.single.comment),r&&this.addColumns(e,this.addColumnsPrefix)}comment(e){if(!e)return;e.length>3750&&this.client.logger.warn("Your comment might be longer than the max comment length for MSSQL of 7,500 bytes.");const t=this.formatter.escapingStringDelimiters(e),r=this.formatter.escapingStringDelimiters(this.schemaNameRaw||"dbo"),n=this.formatter.escapingStringDelimiters(this.tableNameRaw),i=`N'MS_Description', N'${t}', N'Schema', N'${r}', N'Table', N'${n}'`,s=`EXISTS(SELECT * FROM sys.fn_listextendedproperty(N'MS_Description', N'Schema', N'${r}', N'Table', N'${n}', NULL, NULL))`;this.pushQuery(`IF ${s}\n  EXEC sys.sp_updateextendedproperty ${i}\nELSE\n  EXEC sys.sp_addextendedproperty ${i}`)}addColumns(e,t){t=t||this.addColumnsPrefix,e.sql.length>0&&this.pushQuery({sql:(this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+t+e.sql.join(", "),bindings:e.bindings})}alterColumns(e,t){for(let r=0,n=t.length;r<n;r++){const e=t[r];if(e.modified.defaultTo){const t=`\n              DECLARE @constraint varchar(100) = (SELECT default_constraints.name\n                                                  FROM sys.all_columns\n                                                  INNER JOIN sys.tables\n                                                    ON all_columns.object_id = tables.object_id\n                                                  INNER JOIN sys.schemas\n                                                    ON tables.schema_id = schemas.schema_id\n                                                  INNER JOIN sys.default_constraints\n                                                    ON all_columns.default_object_id = default_constraints.object_id\n                                                  WHERE schemas.name = '${this.schemaNameRaw||"dbo"}'\n                                                  AND tables.name = '${this.tableNameRaw}'\n                                                  AND all_columns.name = '${e.getColumnName()}')\n\n              IF @constraint IS NOT NULL EXEC('ALTER TABLE ${this.tableNameRaw} DROP CONSTRAINT ' + @constraint)`;this.pushQuery(t)}}e.sql.forEach(t=>{this.pushQuery({sql:(this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+(this.lowerCase?this.alterColumnPrefix.toLowerCase():this.alterColumnPrefix)+t,bindings:e.bindings})})}dropColumn(){const e=this,t=Am.normalizeArr.apply(null,arguments),r=(Array.isArray(t)?t:[t]).map(t=>e.formatter.wrap(t)),n=this.schemaNameRaw||"dbo";for(const i of t){const e=`\n              DECLARE @constraint varchar(100) = (SELECT default_constraints.name\n                                                  FROM sys.all_columns\n                                                  INNER JOIN sys.tables\n                                                    ON all_columns.object_id = tables.object_id\n                                                  INNER JOIN sys.schemas\n                                                    ON tables.schema_id = schemas.schema_id\n                                                  INNER JOIN sys.default_constraints\n                                                    ON all_columns.default_object_id = default_constraints.object_id\n                                                  WHERE schemas.name = '${n}'\n                                                  AND tables.name = '${this.tableNameRaw}'\n                                                  AND all_columns.name = '${i}')\n\n              IF @constraint IS NOT NULL EXEC('ALTER TABLE ${this.tableNameRaw} DROP CONSTRAINT ' + @constraint)`;this.pushQuery(e)}this.pushQuery((this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+this.dropColumnPrefix+r.join(", "))}changeType(){}renameColumn(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(this.tableName()+"."+e,this.tableBuilder,this.bindingsHolder)}, ${this.client.parameter(t,this.tableBuilder,this.bindingsHolder)}, 'COLUMN'`)}dropFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.CONSTRAINT_NAME),i=r.wrap(t.TABLE_NAME);return e.query({sql:`ALTER TABLE ${i} DROP CONSTRAINT ${n}`})})))}createFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.TABLE_NAME),i=r.wrap(t.CONSTRAINT_NAME),s=r.columnize(t.COLUMN_NAME),o=r.columnize(t.REFERENCED_COLUMN_NAME),a=r.wrap(t.REFERENCED_TABLE_NAME),u=" ON UPDATE "+t.UPDATE_RULE,l=" ON DELETE "+t.DELETE_RULE;return e.query({sql:`ALTER TABLE ${n} ADD CONSTRAINT ${i} FOREIGN KEY (`+s+") REFERENCES "+a+" ("+o+")"+u+l})})))}index(e,t,r){let n;t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),fw(r)&&({predicate:n}=r);const i=n?" "+this.client.queryCompiler(n).where():"";this.pushQuery(`CREATE INDEX ${t} ON ${this.tableName()} (${this.formatter.columnize(e)})${i}`)}primary(e,t){let r;fw(t)&&({constraintName:t,deferrable:r}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`mssql: primary key constraint [${t}] will not be deferrable ${r} because mssql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.forCreate?this.pushQuery(`CONSTRAINT ${t} PRIMARY KEY (${this.formatter.columnize(e)})`):this.pushQuery(`ALTER TABLE ${this.tableName()} ADD CONSTRAINT ${t} PRIMARY KEY (${this.formatter.columnize(e)})`)}unique(e,t){let r,n=!1;fw(t)&&({indexName:t,deferrable:r,useConstraint:n}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`mssql: unique index [${t}] will not be deferrable ${r} because mssql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),Array.isArray(e)||(e=[e]);const i=e.map(e=>this.formatter.columnize(e)+" IS NOT NULL").join(" AND ");n?this.pushQuery(`ALTER TABLE ${this.tableName()} ADD CONSTRAINT ${t} UNIQUE (${this.formatter.columnize(e)})`):this.pushQuery(`CREATE UNIQUE INDEX ${t} ON ${this.tableName()} (${this.formatter.columnize(e)}) WHERE ${i}`)}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery(`DROP INDEX ${t} ON ${this.tableName()}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`ALTER TABLE ${this.tableName()} DROP CONSTRAINT ${t}`)}dropPrimary(e){e=e?this.formatter.wrap(e):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`ALTER TABLE ${this.tableName()} DROP CONSTRAINT ${e}`)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`DROP INDEX ${t} ON ${this.tableName()}`)}}pw.prototype.createAlterTableMethods=["foreign","primary"],pw.prototype.lowerCase=!1,pw.prototype.addColumnsPrefix="ADD ",pw.prototype.dropColumnPrefix="DROP COLUMN ",pw.prototype.alterColumnPrefix="ALTER COLUMN ",dw=pw;const{columnize:mw}=yy;var yw=class extends nv{constructor(e,t){super(e,t)}createQuery(e,t,r,n){let i="CREATE "+(n?"OR ALTER ":"")+"VIEW "+this.viewName();i+=e?" ("+mw(e,this.viewBuilder,this.client,this.bindingsHolder)+")":"",i+=" AS ",i+=t.toString(),this.pushQuery({sql:i})}renameColumn(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(this.viewName()+"."+e,this.viewBuilder,this.bindingsHolder)}, ${this.client.parameter(t,this.viewBuilder,this.bindingsHolder)}, 'COLUMN'`)}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}},gw={};const{toNumber:vw}=Am,{formatDefault:bw}=ay,{operator:_w}=yy;class ww extends Vg{constructor(e,t,r){super(e,t,r),this.modifiers=["nullable","defaultTo","first","after","comment"],this._addCheckModifiers()}double(e,t){return"float"}floating(e,t){return"float"}integer(){return"int"}tinyint(){return"tinyint"}varchar(e){return`nvarchar(${vw(e,255)})`}timestamp({useTz:e=!1}={}){return e?"datetimeoffset":"datetime2"}bit(e){return e>1&&this.client.logger.warn("Bit field is exactly 1 bit length for MSSQL"),"bit"}binary(e){return e?`varbinary(${vw(e)})`:"varbinary(max)"}first(){return this.client.logger.warn("Column first modifier not available for MSSQL"),""}after(e){return this.client.logger.warn("Column after modifier not available for MSSQL"),""}defaultTo(e,{constraintName:t}={}){const r=bw(e,this.type,this.client);return t=void 0!==t?t:`${this.tableCompiler.tableNameRaw}_${this.getColumnName()}_default`.toLowerCase(),"alter"===this.columnBuilder._method?(this.pushAdditional((function(){this.pushQuery(`ALTER TABLE ${this.tableCompiler.tableName()} ADD CONSTRAINT ${this.formatter.wrap(t)} DEFAULT ${r} FOR ${this.formatter.wrap(this.getColumnName())}`)})),""):t?`CONSTRAINT ${this.formatter.wrap(t)} DEFAULT ${r}`:"DEFAULT "+r}comment(e){if(!e)return;e&&e.length>3750&&this.client.logger.warn("Your comment might be longer than the max comment length for MSSQL of 7,500 bytes.");const t=this.formatter.escapingStringDelimiters(e),r=this.tableCompiler.schemaNameRaw||"dbo",n=this.formatter.escapingStringDelimiters(this.tableCompiler.tableNameRaw),i=this.formatter.escapingStringDelimiters(this.args[0]||this.defaults("columnName")),s=`N'MS_Description', N'${t}', N'Schema', N'${r}', N'Table', N'${n}', N'Column', N'${i}'`;return this.pushAdditional((function(){const e=`EXISTS(SELECT * FROM sys.fn_listextendedproperty(N'MS_Description', N'Schema', N'${r}', N'Table', N'${n}', N'Column', N'${i}'))`;this.pushQuery(`IF ${e}\n  EXEC sys.sp_updateextendedproperty ${s}\nELSE\n  EXEC sys.sp_addextendedproperty ${s}`)})),""}checkLength(e,t,r){return this._check(`LEN(${this.formatter.wrap(this.getColumnName())}) ${_w(e,this.columnBuilder,this.bindingsHolder)} ${vw(t)}`,r)}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} LIKE ${this.client._escapeBinding("%"+e+"%")}`,t)}increments(e={primaryKey:!0}){return"int identity(1,1) not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}bigincrements(e={primaryKey:!0}){return"bigint identity(1,1) not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}}ww.prototype.bigint="bigint",ww.prototype.mediumint="int",ww.prototype.smallint="smallint",ww.prototype.text="nvarchar(max)",ww.prototype.mediumtext="nvarchar(max)",ww.prototype.longtext="nvarchar(max)",ww.prototype.json=ww.prototype.jsonb="nvarchar(max)",ww.prototype.enu="nvarchar(100)",ww.prototype.uuid=({useBinaryUuid:e=!1}={})=>e?"binary(16)":"uniqueidentifier",ww.prototype.datetime="datetime2",ww.prototype.bool="bit",gw=ww;var Ew=Wd((function(e,t){return function(e,t,r){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,r)}),t)}(e,1,t)}));const Cw=yf("knex:tx");var Nw=class extends up{query(e,t,r,n){const i=this,s=this.trxClient.query(e,t).catch(e=>{1305!==e.errno?(r=2,n=e,i._completed=!0,Cw("%s error running transaction query",i.txid)):this.trxClient.logger.warn("Transaction was implicitly committed, do not mix transactions and DDL with MySQL (#805)")}).then((function(e){if(1===r&&i._resolver(n),2===r){if(void 0===n){if(i.doNotRejectOnRollback&&/^ROLLBACK\b/i.test(t))return void i._resolver();n=new Error("Transaction rejected with non-error: "+n)}i._rejecter(n)}return e}));return 1!==r&&2!==r||(i._completed=!0),s}};const{wrapAsIdentifier:$w}=ay,{columnize:xw,wrap:Tw}=yy;var Ow=class extends tg{constructor(e,t,r){super(e,t,r);const{returning:n}=this.single;n&&this.client.logger.warn(".returning() is not supported by mysql and will not have any effect."),this._emptyInsertValue="() values ()"}insert(){let e=super.insert();if(""===e)return e;const{ignore:t,merge:r,insert:n}=this.single;if(t&&(e=e.replace("insert into","insert ignore into")),r&&(e+=this._merge(r.updates,n),this.where()))throw new Error(".onConflict().merge().where() is not supported for mysql");return e}_merge(e,t){const r=" on duplicate key update ";if(e&&Array.isArray(e))return r+e.map(e=>$w(e,this.formatter.builder,this.client)).map(e=>`${e} = values(${e})`).join(", ");if(e&&"object"==typeof e)return r+this._prepUpdate(e).join(",");{const e=this._prepInsert(t);if("string"==typeof e)throw new Error("If using merge with a raw insert query, then updates must be provided");return r+e.columns.map(e=>$w(e,this.builder,this.client)).map(e=>`${e} = values(${e})`).join(", ")}}update(){const e=this.with(),t=this.join(),r=this._prepUpdate(this.single.update),n=this.where(),i=this.order(),s=this.limit();return e+"update "+this.tableName+(t?" "+t:"")+" set "+r.join(", ")+(n?" "+n:"")+(i?" "+i:"")+(s?" "+s:"")}forUpdate(){return"for update"}forShare(){return"lock in share mode"}skipLocked(){return"skip locked"}noWait(){return"nowait"}columnInfo(){const e=this.single.columnInfo;return{sql:"select * from information_schema.columns where table_name = ? and table_schema = ?",bindings:[this.client.customWrapIdentifier(this.single.table,Fd),this.client.database()],output(t){const r=t.reduce((function(e,t){return e[t.COLUMN_NAME]={defaultValue:"NULL"===t.COLUMN_DEFAULT?null:t.COLUMN_DEFAULT,type:t.DATA_TYPE,maxLength:t.CHARACTER_MAXIMUM_LENGTH,nullable:"YES"===t.IS_NULLABLE},e}),{});return e&&r[e]||r}}}limit(){const e=!this.single.limit&&0!==this.single.limit;return e&&!this.single.offset?"":"limit "+(this.single.offset&&e?"18446744073709551615":this._getValueOrParameterFromAttribute("limit"))}whereLike(e){return`${this._columnClause(e)} ${this._not(e,"like ")}${this._valueClause(e)} COLLATE utf8_bin`}whereILike(e){return`${this._columnClause(e)} ${this._not(e,"like ")}${this._valueClause(e)}`}jsonExtract(e){return this._jsonExtract(["json_extract","json_unquote"],e)}jsonSet(e){return this._jsonSet("json_set",e)}jsonInsert(e){return this._jsonSet("json_insert",e)}jsonRemove(e){const t=`json_remove(${xw(e.column,this.builder,this.client,this.bindingsHolder)},${this.client.parameter(e.path,this.builder,this.bindingsHolder)})`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonObject(e){return this._not(e,`json_contains(${this._columnClause(e)}, ${this._jsonValueClause(e)})`)}whereJsonPath(e){return this._whereJsonPath("json_extract",e)}whereJsonSupersetOf(e){return this._not(e,`json_contains(${Tw(e.column,void 0,this.builder,this.client,this.bindingsHolder)},${this._jsonValueClause(e)})`)}whereJsonSubsetOf(e){return this._not(e,`json_contains(${this._jsonValueClause(e)},${Tw(e.column,void 0,this.builder,this.client,this.bindingsHolder)})`)}onJsonPathEquals(e){return this._onJsonPathEquals("json_extract",e)}},Sw=class extends lg{constructor(e,t){super(e,t)}renameTable(e,t){this.pushQuery(`rename table ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`)}renameView(e,t){this.renameTable(e,t)}hasTable(e){let t="select * from information_schema.tables where table_name = ?";const r=[e];this.schema?(t+=" and table_schema = ?",r.push(this.schema)):t+=" and table_schema = database()",this.pushQuery({sql:t,bindings:r,output:function(e){return e.length>0}})}hasColumn(e,t){this.pushQuery({sql:"show columns from "+this.formatter.wrap(e),output(e){return e.some(e=>this.client.wrapIdentifier(e.Field.toLowerCase())===this.client.wrapIdentifier(t.toLowerCase()))}})}},kw={};const{isObject:jw,isString:Aw}=Jf;class Rw extends kg{constructor(e,t){super(e,t)}createQuery(e,t,r){const n=t?"create table if not exists ":"create table ",{client:i}=this;let s={},o=" ("+e.sql.join(", ");o+=this.primaryKeys()||"",o+=this._addChecks(),o+=")";let a=n+this.tableName()+(r&&this.tableNameLike()?" like "+this.tableNameLike():o);i.connectionSettings&&(s=i.connectionSettings);const u=this.single.charset||s.charset||"",l=this.single.collate||s.collate||"",c=this.single.engine||"";if(u&&!r&&(a+=" default character set "+u),l&&(a+=" collate "+l),c&&(a+=" engine = "+c),this.single.comment){const e=this.single.comment||"",t=1024;e.length>t&&this.client.logger.warn(`The max length for a table comment is ${t} characters`),a+=` comment = '${e}'`}this.pushQuery(a),r&&this.addColumns(e,this.addColumnsPrefix)}comment(e){this.pushQuery(`alter table ${this.tableName()} comment = '${e}'`)}changeType(){}renameColumn(e,t){const r=this,n=this.tableName(),i=this.formatter.wrap(e)+" "+this.formatter.wrap(t);this.pushQuery({sql:`show full fields from ${n} where field = `+this.client.parameter(e,this.tableBuilder,this.bindingsHolder),output(s){const o=s[0],a=this;return r.getFKRefs(a).then(([s])=>new Promise((e,t)=>{try{s.length||e(),e(r.dropFKRefs(a,s))}catch(Zv){t(Zv)}}).then((function(){let e=`alter table ${n} change ${i} ${o.Type}`;return"YES"!==String(o.Null).toUpperCase()?e+=" NOT NULL":e+=" NULL",void 0!==o.Default&&null!==o.Default&&(e+=` DEFAULT '${o.Default}'`),void 0!==o.Collation&&null!==o.Collation&&(e+=` COLLATE '${o.Collation}'`),"auto_increment"==o.Extra&&(e+=" AUTO_INCREMENT"),a.query({sql:e})})).then((function(){if(s.length)return r.createFKRefs(a,s.map((function(r){return r.REFERENCED_COLUMN_NAME===e&&(r.REFERENCED_COLUMN_NAME=t),r.COLUMN_NAME===e&&(r.COLUMN_NAME=t),r})))})))}})}primaryKeys(){const e=(this.grouped.alterTable||[]).filter(e=>"primary"===e.method);if(e.length>0&&e[0].args.length>0){const t=e[0].args[0];let r=e[0].args[1]||"";if(r&&(r=" constraint "+this.formatter.wrap(r)),this.grouped.columns){const e=this._getIncrementsColumnNames();e.length&&e.forEach(e=>{t.includes(e)||t.unshift(e)})}return`,${r} primary key (${this.formatter.columnize(t)})`}}getFKRefs(e){const t={bindings:[]},r="SELECT KCU.CONSTRAINT_NAME, KCU.TABLE_NAME, KCU.COLUMN_NAME,        KCU.REFERENCED_TABLE_NAME, KCU.REFERENCED_COLUMN_NAME,        RC.UPDATE_RULE, RC.DELETE_RULE FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS RC        USING(CONSTRAINT_NAME)WHERE KCU.REFERENCED_TABLE_NAME = "+this.client.parameter(this.tableNameRaw,this.tableBuilder,t)+"   AND KCU.CONSTRAINT_SCHEMA = "+this.client.parameter(this.client.database(),this.tableBuilder,t)+"   AND RC.CONSTRAINT_SCHEMA = "+this.client.parameter(this.client.database(),this.tableBuilder,t);return e.query({sql:r,bindings:t.bindings})}dropFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.CONSTRAINT_NAME),i=r.wrap(t.TABLE_NAME);return e.query({sql:`alter table ${i} drop foreign key ${n}`})})))}createFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.TABLE_NAME),i=r.wrap(t.CONSTRAINT_NAME),s=r.columnize(t.COLUMN_NAME),o=r.columnize(t.REFERENCED_COLUMN_NAME),a=r.wrap(t.REFERENCED_TABLE_NAME),u=" ON UPDATE "+t.UPDATE_RULE,l=" ON DELETE "+t.DELETE_RULE;return e.query({sql:`alter table ${n} add constraint ${i} foreign key (`+s+") references "+a+" ("+o+")"+u+l})})))}index(e,t,r){let n,i;Aw(r)?i=r:jw(r)&&({indexType:i,storageEngineIndexType:n}=r),t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),n=n?" using "+n:"",this.pushQuery(`alter table ${this.tableName()} add${i?" "+i:""} index ${t}(${this.formatter.columnize(e)})${n}`)}primary(e,t){let r;jw(t)&&({constraintName:t,deferrable:r}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`mysql: primary key constraint \`${t}\` will not be deferrable ${r} because mysql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey");const n=e;let i=[];this.grouped.columns&&(i=this._getIncrementsColumnNames())&&i.forEach(e=>{n.includes(e)||n.unshift(e)}),"create"!==this.method&&"createIfNot"!==this.method&&this.pushQuery(`alter table ${this.tableName()} add primary key ${t}(${this.formatter.columnize(n)})`),i.length&&this.pushQuery(`alter table ${this.tableName()} modify column ${this.formatter.columnize(i)} int unsigned not null auto_increment`)}unique(e,t){let r,n;jw(t)&&({indexName:t,deferrable:n,storageEngineIndexType:r}=t),n&&"not deferrable"!==n&&this.client.logger.warn(`mysql: unique index \`${t}\` will not be deferrable ${n} because mysql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),r=r?" using "+r:"",this.pushQuery(`alter table ${this.tableName()} add unique ${t}(${this.formatter.columnize(e)})${r}`)}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop index ${t}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop foreign key ${t}`)}dropPrimary(){this.pushQuery(`alter table ${this.tableName()} drop primary key`)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop index ${t}`)}}Rw.prototype.addColumnsPrefix="add ",Rw.prototype.alterColumnsPrefix="modify ",Rw.prototype.dropColumnPrefix="drop ",kw=Rw;var Iw={};const{isObject:Pw}=Jf,{toNumber:qw}=Am,Lw=/(?<!\\)'/g;class Mw extends Vg{constructor(e,t,r){super(e,t,r),this.modifiers=["unsigned","nullable","defaultTo","comment","collate","first","after"],this._addCheckModifiers()}double(e,t){return e?`double(${qw(e,8)}, ${qw(t,2)})`:"double"}integer(e){return"int"+(e=e?`(${qw(e,11)})`:"")}tinyint(e){return"tinyint"+(e=e?`(${qw(e,1)})`:"")}text(e){switch(e){case"medium":case"mediumtext":return"mediumtext";case"long":case"longtext":return"longtext";default:return"text"}}mediumtext(){return this.text("medium")}longtext(){return this.text("long")}enu(e){return`enum('${e.join("', '")}')`}datetime(e){return Pw(e)&&({precision:e}=e),"number"==typeof e?`datetime(${e})`:"datetime"}timestamp(e){return Pw(e)&&({precision:e}=e),"number"==typeof e?`timestamp(${e})`:"timestamp"}time(e){return Pw(e)&&({precision:e}=e),"number"==typeof e?`time(${e})`:"time"}bit(e){return e?`bit(${qw(e)})`:"bit"}binary(e){return e?`varbinary(${qw(e)})`:"blob"}json(){return"json"}jsonb(){return"json"}defaultTo(e){if(null==e)return;if(("json"===this.type||"jsonb"===this.type)&&Pw(e))return`default ('${JSON.stringify(e)}')`;const t=super.defaultTo.apply(this,arguments);return"blob"!==this.type&&-1===this.type.indexOf("text")?t:""}unsigned(){return"unsigned"}comment(e){return e&&e.length>255&&this.client.logger.warn("Your comment is longer than the max comment length for MySQL"),e&&`comment '${e.replace(Lw,"\\'")}'`}first(){return"first"}after(e){return"after "+this.formatter.wrap(e)}collate(e){return e&&`collate '${e}'`}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} REGEXP ${this.client._escapeBinding(e)}`,t)}increments(e={primaryKey:!0}){return"int unsigned not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" auto_increment primary key":"")}bigincrements(e={primaryKey:!0}){return"bigint unsigned not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" auto_increment primary key":"")}}Mw.prototype.bigint="bigint",Mw.prototype.mediumint="mediumint",Mw.prototype.smallint="smallint",Iw=Mw;var Dw=class extends nv{constructor(e,t){super(e,t)}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}},Fw=class extends ev{constructor(){super(...arguments)}checkOption(){this._single.checkOption="default_option"}localCheckOption(){this._single.checkOption="local"}cascadedCheckOption(){this._single.checkOption="cascaded"}};const Uw=yf("knex:tx");var Bw=class extends up{query(e,t,r,n){const i=this,s=this.trxClient.query(e,t).catch(e=>{"ER_SP_DOES_NOT_EXIST"!==e.code?(r=2,n=e,i._completed=!0,Uw("%s error running transaction query",i.txid)):this.trxClient.logger.warn("Transaction was implicitly committed, do not mix transactions and DDL with MySQL (#805)")}).then((function(e){if(1===r&&i._resolver(n),2===r){if(void 0===n){if(i.doNotRejectOnRollback&&/^ROLLBACK\b/i.test(t))return void i._resolver();n=new Error("Transaction rejected with non-error: "+n)}return i._rejecter(n),e}}));return 1!==r&&2!==r||(i._completed=!0),s}},Vw={};function zw(e){this.columnName=e}zw.prototype.toString=function(){return`[object ReturningHelper:${this.columnName}]`},Vw={generateCombinedName:function(e,t,r,n){const i=require("crypto");Array.isArray(n)||(n=n?[n]:[]);const s=r.replace(/\.|-/g,"_"),o=n.join("_");let a=`${s}_${o.length?o+"_":""}${t}`.toLowerCase();return a.length>30&&(e.warn(`Automatically generated name "${a}" exceeds 30 character limit for Oracle. Using base64 encoded sha1 of that name instead.`),a=i.createHash("sha1").update(a).digest("base64").replace("=","")),a},isConnectionError:function(e){return["DPI-1010","DPI-1080","ORA-03114","ORA-03113","ORA-03135","ORA-12514","ORA-00022","ORA-00028","ORA-00031","ORA-00045","ORA-00378","ORA-00602","ORA-00603","ORA-00609","ORA-01012","ORA-01041","ORA-01043","ORA-01089","ORA-01092","ORA-02396","ORA-03122","ORA-12153","ORA-12537","ORA-12547","ORA-12570","ORA-12583","ORA-27146","ORA-28511","ORA-56600","NJS-024","NJS-003"].some((function(t){return 0===e.message.indexOf(t)}))},wrapSqlWithCatch:function(e,t){return`begin execute immediate '${e.replace(/'/g,"''")}'; exception when others then if sqlcode != ${t} then raise; end if; end;`},ReturningHelper:zw};var Hw={renameColumnTrigger:function(e,t,r,n){const i=Vw.generateCombinedName(e,"autoinc_trg",t);return`DECLARE PK_NAME VARCHAR(200); IS_AUTOINC NUMBER := 0; BEGIN  EXECUTE IMMEDIATE ('ALTER TABLE "${t}" RENAME COLUMN "${r}" TO "${n}"');  SELECT COUNT(*) INTO IS_AUTOINC from "USER_TRIGGERS" where trigger_name = '${i}';  IF (IS_AUTOINC > 0) THEN    SELECT cols.column_name INTO PK_NAME    FROM all_constraints cons, all_cons_columns cols    WHERE cons.constraint_type = 'P'    AND cons.constraint_name = cols.constraint_name    AND cons.owner = cols.owner    AND cols.table_name = '${t}';    IF ('${n}' = PK_NAME) THEN      EXECUTE IMMEDIATE ('DROP TRIGGER "${i}"');      EXECUTE IMMEDIATE ('create or replace trigger "${i}"      BEFORE INSERT on "${t}" for each row        declare        checking number := 1;        begin          if (:new."${n}" is null) then            while checking >= 1 loop              select "${Vw.generateCombinedName(e,"seq",t)}".nextval into :new."${n}" from dual;              select count("${n}") into checking from "${t}"              where "${n}" = :new."${n}";            end loop;          end if;        end;');    end if;  end if;END;`},createAutoIncrementTrigger:function(e,t,r){const n=`"${t}"`,i=t,s=r?`"${r}".`:"",o=r?`'${r}'`:"cols.owner",a=Vw.generateCombinedName(e,"autoinc_trg",t),u=`"${Vw.generateCombinedName(e,"seq",t)}"`;return`DECLARE PK_NAME VARCHAR(200); BEGIN  EXECUTE IMMEDIATE ('CREATE SEQUENCE ${s}${u}');  SELECT cols.column_name INTO PK_NAME  FROM all_constraints cons, all_cons_columns cols  WHERE cons.constraint_type = 'P'  AND cons.constraint_name = cols.constraint_name  AND cons.owner = `+o+`  AND cols.table_name = '${i}';`+`  execute immediate ('create or replace trigger ${s}"${a}"`+`  BEFORE INSERT on ${s}${n}  for each row  declare  checking number := 1;  begin    if (:new."' || PK_NAME || '" is null) then      while checking >= 1 loop`+`        select ${s}${u}.nextval into :new."' || PK_NAME || '" from dual;`+`        select count("' || PK_NAME || '") into checking from ${s}${n}        where "' || PK_NAME || '" = :new."' || PK_NAME || '";      end loop;    end if;  end;'); END;`},renameTableAndAutoIncrementTrigger:function(e,t,r){const n=Vw.generateCombinedName(e,"autoinc_trg",t),i=Vw.generateCombinedName(e,"seq",t),s=Vw.generateCombinedName(e,"autoinc_trg",r),o=Vw.generateCombinedName(e,"seq",r);return`DECLARE PK_NAME VARCHAR(200); IS_AUTOINC NUMBER := 0; BEGIN  EXECUTE IMMEDIATE ('RENAME "${t}" TO "${r}"');  SELECT COUNT(*) INTO IS_AUTOINC from "USER_TRIGGERS" where trigger_name = '${n}';  IF (IS_AUTOINC > 0) THEN    EXECUTE IMMEDIATE ('DROP TRIGGER "${n}"');    EXECUTE IMMEDIATE ('RENAME "${i}" TO "${o}"');    SELECT cols.column_name INTO PK_NAME    FROM all_constraints cons, all_cons_columns cols    WHERE cons.constraint_type = 'P'    AND cons.constraint_name = cols.constraint_name    AND cons.owner = cols.owner    AND cols.table_name = '${r}';    EXECUTE IMMEDIATE ('create or replace trigger "${s}"    BEFORE INSERT on "${r}" for each row      declare      checking number := 1;      begin        if (:new."' || PK_NAME || '" is null) then          while checking >= 1 loop            select "${o}".nextval into :new."' || PK_NAME || '" from dual;            select count("' || PK_NAME || '") into checking from "${r}"            where "' || PK_NAME || '" = :new."' || PK_NAME || '";          end loop;        end if;      end;');  end if;END;`}},Qw=class extends lg{constructor(){super(...arguments)}renameTable(e,t){const r=Hw.renameTableAndAutoIncrementTrigger(this.client.logger,e,t);this.pushQuery(r)}hasTable(e){this.pushQuery({sql:"select TABLE_NAME from USER_TABLES where TABLE_NAME = "+this.client.parameter(e,this.builder,this.bindingsHolder),output:e=>e.length>0})}hasColumn(e,t){const r=`select COLUMN_NAME from ALL_TAB_COLUMNS where TABLE_NAME = ${this.client.parameter(e,this.builder,this.bindingsHolder)} and COLUMN_NAME = `+this.client.parameter(t,this.builder,this.bindingsHolder);this.pushQuery({sql:r,output:e=>e.length>0})}dropSequenceIfExists(e){const t=this.schema?`"${this.schema}".`:"";this.pushQuery(Vw.wrapSqlWithCatch(`drop sequence ${t}${this.formatter.wrap(e)}`,-2289))}_dropRelatedSequenceIfExists(e){const t=Vw.generateCombinedName(this.client.logger,"seq",e);this.dropSequenceIfExists(t)}dropTable(e){const t=this.schema?`"${this.schema}".`:"";this.pushQuery(`drop table ${t}${this.formatter.wrap(e)}`),this._dropRelatedSequenceIfExists(e)}dropTableIfExists(e){this.dropObject(e,"table")}dropViewIfExists(e){this.dropObject(e,"view")}dropObject(e,t){const r=this.schema?`"${this.schema}".`:"";let n=-942;"materialized view"===t&&(n=-12003),this.pushQuery(Vw.wrapSqlWithCatch(`drop ${t} ${r}${this.formatter.wrap(e)}`,n)),this._dropRelatedSequenceIfExists(e)}refreshMaterializedView(e){return this.pushQuery({sql:`BEGIN DBMS_MVIEW.REFRESH('${this.schemaNameRaw?this.schemaNameRaw+".":""}${e}'); END;`})}dropMaterializedView(e){this._dropView(e,!1,!0)}dropMaterializedViewIfExists(e){this.dropObject(e,"materialized view")}},Ww=class extends Ug{constructor(){super(...arguments)}checkIn(){return this._modifiers.checkIn=Nm(arguments),this}},Jw=function(e,t){return!(null==e||!e.length)&&Tg(e,t,0)>-1},Kw=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},Gw=hd&&1/Lp(new hd([,-0]))[1]==1/0?function(e){return new hd(e)}:function(){},Yw=function(e){return e&&e.length?function(e,t,r){var n=-1,i=Jw,s=e.length,o=!0,a=[],u=a;if(r)o=!1,i=Kw;else if(s>=200){var l=t?null:Gw(e);if(l)return Lp(l);o=!1,i=Ip,u=new jp}else u=t?[]:a;e:for(;++n<s;){var c=e[n],h=t?t(c):c;if(c=r||0!==c?c:0,o&&h==h){for(var d=u.length;d--;)if(u[d]===h)continue e;t&&u.push(h),a.push(c)}else i(u,h,r)||(u!==a&&u.push(h),a.push(c))}return a}(e):[]},Zw={createAutoIncrementTriggerAndSequence:function(e){e.pushAdditional((function(){const e=this.tableCompiler.tableNameRaw,t=this.tableCompiler.schemaNameRaw,r=Hw.createAutoIncrementTrigger(this.client.logger,e,t);this.pushQuery(r)}))}},Xw={};const{createAutoIncrementTriggerAndSequence:eE}=Zw,{toNumber:tE}=Am;class rE extends Vg{constructor(){super(...arguments),this.modifiers=["defaultTo","checkIn","nullable","comment"]}increments(e={primaryKey:!0}){return eE(this),"integer not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}bigincrements(e={primaryKey:!0}){return eE(this),"number(20, 0) not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}floating(e){const t=tE(e,0);return"float"+(t?`(${t})`:"")}double(e,t){return`number(${tE(e,8)}, ${tE(t,2)})`}decimal(e,t){return null===e?"decimal":`decimal(${tE(e,8)}, ${tE(t,2)})`}integer(e){return e?`number(${tE(e,11)})`:"integer"}enu(e){const t=((e=Yw(e))||[]).reduce((e,t)=>Math.max(e,String(t).length),1);return this.columnBuilder._modifiers.checkIn=[e],`varchar2(${t})`}datetime(e){return e?"timestamp":"timestamp with time zone"}timestamp(e){return e?"timestamp":"timestamp with time zone"}bool(){return this.columnBuilder._modifiers.checkIn=[[0,1]],"number(1, 0)"}varchar(e){return`varchar2(${tE(e,255)})`}comment(e){const t=this.args[0]||this.defaults("columnName");this.pushAdditional((function(){this.pushQuery(`comment on column ${this.tableCompiler.tableName()}.`+this.formatter.wrap(t)+" is '"+(e||"")+"'")}),e)}checkIn(e){return void 0===e?"":(e=e instanceof _y?e.toQuery():Array.isArray(e)?e.map(e=>`'${e}'`).join(", "):`'${e}'`,`check (${this.formatter.wrap(this.args[0])} in (${e}))`)}}rE.prototype.tinyint="smallint",rE.prototype.smallint="smallint",rE.prototype.mediumint="integer",rE.prototype.biginteger="number(20, 0)",rE.prototype.text="clob",rE.prototype.time="timestamp with time zone",rE.prototype.bit="clob",rE.prototype.json="clob",Xw=rE;var nE={};const{isObject:iE}=Jf;class sE extends kg{constructor(){super(...arguments)}addColumns(e,t){if(e.sql.length>0){t=t||this.addColumnsPrefix;const r=e.sql;let n=`${this.lowerCase?"alter table ":"ALTER TABLE "}${this.tableName()} ${t}`;e.sql.length>1?n+=`(${r.join(", ")})`:n+=r.join(", "),this.pushQuery({sql:n,bindings:e.bindings})}}renameColumn(e,t){const r=this.tableName().slice(1,-1);return this.pushQuery(Hw.renameColumnTrigger(this.client.logger,r,e,t))}compileAdd(e){const t=this.formatter.wrap(e),r=this.prefixArray("add column",this.getColumns(e));return this.pushQuery({sql:`alter table ${t} ${r.join(", ")}`})}createQuery(e,t,r){const n=r&&this.tableNameLike()?" as (select * from "+this.tableNameLike()+" where 0=1)":" ("+e.sql.join(", ")+this._addChecks()+")",i=`create table ${this.tableName()}${n}`;this.pushQuery({sql:t?Vw.wrapSqlWithCatch(i,-955):i,bindings:e.bindings}),this.single.comment&&this.comment(this.single.comment),r&&this.addColumns(e,this.addColumnsPrefix)}comment(e){this.pushQuery(`comment on table ${this.tableName()} is '${e}'`)}dropColumn(){const e=Am.normalizeArr.apply(null,arguments);this.pushQuery(`alter table ${this.tableName()} drop (${this.formatter.columnize(e)})`)}_indexCommand(e,t,r){return this.formatter.wrap(Vw.generateCombinedName(this.client.logger,e,t,r))}primary(e,t){let r;iE(t)&&({constraintName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey");const n=e;let i=[];this.grouped.columns&&(i=this._getIncrementsColumnNames())&&i.forEach(e=>{n.includes(e)||n.unshift(e)}),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} primary key (${this.formatter.columnize(n)})${r}`)}dropPrimary(e){e=e?this.formatter.wrap(e):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`alter table ${this.tableName()} drop constraint ${e}`)}index(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery(`create index ${t} on ${this.tableName()} (`+this.formatter.columnize(e)+")")}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery("drop index "+t)}unique(e,t){let r;iE(t)&&({indexName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} unique (`+this.formatter.columnize(e)+")"+r)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}}sE.prototype.addColumnsPrefix="add ",sE.prototype.alterColumnsPrefix="modify ",nE=sE;const{ReturningHelper:oE}=Vw,{isString:aE}=Jf,uE=["columns","join","where","union","group","having","order","lock"];var lE=class extends tg{constructor(e,t,r){super(e,t,r);const{onConflict:n}=this.single;if(n)throw new Error(".onConflict() is not supported for oracledb.");this.first=this.select}insert(){let e=this.single.insert||[],{returning:t}=this.single;if(!Array.isArray(e)&&Of(this.single.insert)&&(e=[this.single.insert]),t&&!Array.isArray(t)&&(t=[t]),Array.isArray(e)&&1===e.length&&Sp(e[0]))return this._addReturningToSqlAndConvert(`insert into ${this.tableName} (${this.formatter.wrap(this.single.returning)}) values (default)`,t,this.tableName);if(Sp(this.single.insert)&&"function"!=typeof this.single.insert)return"";const r=this._prepInsert(e),n={};if(aE(r))return this._addReturningToSqlAndConvert(`insert into ${this.tableName} ${r}`,t);if(1===r.values.length)return this._addReturningToSqlAndConvert(`insert into ${this.tableName} (${this.formatter.columnize(r.columns)}) values (${this.client.parameterize(r.values[0],void 0,this.builder,this.bindingsHolder)})`,t,this.tableName);const i=0===r.columns.length;return n.sql="begin "+r.values.map(e=>{let s;const o=i?"":this.client.parameterize(e,this.client.valueForUndefined,this.builder,this.bindingsHolder),a=Array.isArray(t)?t:[t];let u=`insert into ${this.tableName} `;t&&(s=new oE(a.join(":")),n.outParams=(n.outParams||[]).concat(s)),u+=i?`(${this.formatter.wrap(this.single.returning)}) values (default)`:`(${this.formatter.columnize(r.columns)}) values (${o})`,u+=t?" returning ROWID into "+this.client.parameter(s,this.builder,this.bindingsHolder):"",u=this.formatter.client.positionBindings(u);const l=o.replace("DEFAULT, ","").replace(", DEFAULT","");return"execute immediate '"+u.replace(/'/g,"''")+(l||t?"' using ":"")+l+(l&&t?", ":"")+(t?"out ?":"")+";"}).join(" ")+"end;",t&&(n.returning=t,n.returningSql="select "+this.formatter.columnize(t)+" from "+this.tableName+" where ROWID in ("+n.outParams.map((e,t)=>":"+(t+1)).join(", ")+") order by case ROWID "+n.outParams.map((e,t)=>`when CHARTOROWID(:${t+1}) then ${t}`).join(" ")+" end"),n}update(){const e=this._prepUpdate(this.single.update),t=this.where();let{returning:r}=this.single;const n="update "+this.tableName+" set "+e.join(", ")+(t?" "+t:"");return r?(Array.isArray(r)||(r=[r]),this._addReturningToSqlAndConvert(n,r,this.tableName)):n}truncate(){return"truncate table "+this.tableName}forUpdate(){return"for update"}forShare(){return this.client.logger.warn("lock for share is not supported by oracle dialect"),""}columnInfo(){const e=this.single.columnInfo;return{sql:`select * from xmltable( '/ROWSET/ROW'\n      passing dbms_xmlgen.getXMLType('\n      select char_col_decl_length, column_name, data_type, data_default, nullable\n      from all_tab_columns where table_name = ''${this.client.customWrapIdentifier(this.single.table,Fd)}'' ')\n      columns\n      CHAR_COL_DECL_LENGTH number, COLUMN_NAME varchar2(200), DATA_TYPE varchar2(106),\n      DATA_DEFAULT clob, NULLABLE varchar2(1))`,output(t){const r=sy(t,(function(e,t){return e[t.COLUMN_NAME]={type:t.DATA_TYPE,defaultValue:t.DATA_DEFAULT,maxLength:t.CHAR_COL_DECL_LENGTH,nullable:"Y"===t.NULLABLE},e}),{});return e&&r[e]||r}}}select(){let e=this.with();const t=uE.map(e=>this[e]());return e+=Ay(t).join(" "),this._surroundQueryWithLimitAndOffset(e)}aggregate(e){return this._aggregate(e,{aliasSeparator:" "})}_addReturningToSqlAndConvert(e,t,r){const n={sql:e};if(!t)return n;const i=Array.isArray(t)?t:[t],s=new oE(i.join(":"));return n.sql=e+" returning ROWID into "+this.client.parameter(s,this.builder,this.bindingsHolder),n.returningSql=`select ${this.formatter.columnize(t)} from ${r} where ROWID = :1`,n.outParams=[s],n.returning=t,n}_surroundQueryWithLimitAndOffset(e){let{limit:t}=this.single;const{offset:r}=this.single,n=t||0===t||"0"===t;if(t=+t,!n&&!r)return e;if(e=e||"",n&&!r)return`select * from (${e}) where rownum <= ${this._getValueOrParameterFromAttribute("limit",t)}`;const i=+r+(n?t:1e13);return"select * from (select row_.*, ROWNUM rownum_ from ("+e+") row_ where rownum <= "+(this.single.skipBinding.offset?i:this.client.parameter(i,this.builder,this.bindingsHolder))+") where rownum_ > "+this._getValueOrParameterFromAttribute("offset",r)}},cE={};(function(e){const{promisify:t}=require("util"),r=require("stream");function n(e,t){this.columnName=e,this.value=t,this.returning=!1}n.prototype.toString=function(){return"[object BlobHelper:"+this.columnName+"]"};const i=function(t){const r=d({});let n;if(t.type)t.type===r.BLOB?n="buffer":t.type===r.CLOB&&(n="string");else{if(!t.iLob)throw new Error("Unrecognized oracledb lob stream type");t.iLob.type===r.CLOB?n="string":t.iLob.type===r.BLOB&&(n="buffer")}return"string"===n&&t.setEncoding("utf-8"),function(t,r){return new Promise((n,i)=>{let s="string"===r?"":e.alloc(0);t.on("error",(function(e){i(e)})),t.on("data",(function(t){"string"===r?s+=t:s=e.concat([s,t])})),t.on("end",(function(){n(s)}))})}(t,n)};Vw.BlobHelper=n,Vw.monkeyPatchConnection=function(e,n){if(e.executeAsync)return;e.commitAsync=function(){return new Promise((e,t)=>{this.commit((function(r){if(r)return t(r);e()}))})},e.rollbackAsync=function(){return new Promise((e,t)=>{this.rollback((function(r){if(r)return t(r);e()}))})};const s=t((function(t,r,i,s){if((i=i||{}).outFormat=n.driver.OUT_FORMAT_OBJECT||n.driver.OBJECT,!i.outFormat)throw new Error("not found oracledb.outFormat constants");i.resultSet?e.execute(t,r||[],i,(function(t,r){if(t)return Vw.isConnectionError(t)&&(e.close().catch((function(e){})),e.__knex__disposed=t),s(t);const n={rows:[],resultSet:r.resultSet},i=function(e,t,r){t.getRows(r,(function(o,a){if(o)Vw.isConnectionError(o)&&(e.close().catch((function(e){})),e.__knex__disposed=o),t.close((function(){return s(o)}));else{if(0===a.length)return s(null,n);if(a.length>0){if(a.length!==r)return n.rows=n.rows.concat(a),s(null,n);n.rows=n.rows.concat(a),i(e,t,r)}}}))};i(e,r.resultSet,100)})):e.execute(t,r||[],i,(function(t,r){return t?(Vw.isConnectionError(t)&&(e.close().catch((function(e){})),e.__knex__disposed=t),s(t)):s(null,r)}))}));e.executeAsync=function(e,n,o){return s(e,n,o).then(async e=>{const n=()=>e.resultSet?t(e.resultSet.close).call(e.resultSet):Promise.resolve(),s=[];if(e.rows&&Array.isArray(e.rows))for(let t=0;t<e.rows.length;t++){const n=e.rows[t];for(const e in n)n[e]instanceof r.Readable&&s.push({index:t,key:e,stream:n[e]})}try{for(const t of s)e.rows[t.index][t.key]=await i(t.stream)}catch(Zv){throw await n().catch(()=>{}),Zv}return await n(),e})}},cE=Vw}).call(this,require("buffer").Buffer);var hE={};(function(e){const t=cE.ReturningHelper,r=cE.BlobHelper,{isString:n}=Jf,{columnize:i}=yy;hE=class extends lE{insert(){const e=this,i=this._prepOutbindings(this.single.insert,this.single.returning),s=i.outBinding,o=i.returning,a=i.values;if(Array.isArray(a)&&1===a.length&&Sp(a[0])){const e=this.single.returning?" ("+this.formatter.wrap(this.single.returning)+")":"";return this._addReturningToSqlAndConvert("insert into "+this.tableName+e+" values (default)",s[0],this.tableName,o)}if(Sp(this.single.insert)&&"function"!=typeof this.single.insert)return"";const u=this._prepInsert(a),l={};if(n(u))return this._addReturningToSqlAndConvert("insert into "+this.tableName+" "+u,s[0],this.tableName,o);if(1===u.values.length)return this._addReturningToSqlAndConvert("insert into "+this.tableName+" ("+this.formatter.columnize(u.columns)+") values ("+this.client.parameterize(u.values[0],void 0,this.builder,this.bindingsHolder)+")",s[0],this.tableName,o);const c=0===u.columns.length;return l.returning=o,l.sql="begin "+u.values.map((function(n,i){const o=c?"":e.client.parameterize(n,e.client.valueForUndefined,e.builder,e.bindingsHolder);let a="insert into "+e.tableName;a+=c?" ("+e.formatter.wrap(e.single.returning)+") values (default)":" ("+e.formatter.columnize(u.columns)+") values ("+o+")";let l="",h="",d="",f="";Tp(n,(function(e){e instanceof r||(d+=" ?,")})),d=d.slice(0,-1),s[i].forEach((function(n){const i=n.columnName||n;if(l+=e.formatter.wrap(i)+",",h+=" ?,",f+=" out ?,",n instanceof r)return e.formatter.bindings.push(n);e.formatter.bindings.push(new t(i))})),l=l.slice(0,-1),h=h.slice(0,-1),f=f.slice(0,-1),l&&h&&(a+=" returning "+l+" into"+h),a=e.formatter.client.positionBindings(a);const p=o.replace(/DEFAULT, /g,"").replace(/, DEFAULT/g,"").replace("EMPTY_BLOB(), ","").replace(", EMPTY_BLOB()","");return"execute immediate '"+a.replace(/'/g,"''")+(p||n?"' using ":"")+p+(p&&f?",":"")+f+";"})).join(" ")+"end;",l.outBinding=s,"*"===o[0]&&(l.returningSql=function(){return"select * from "+e.tableName+" where ROWID in ("+this.outBinding.map((function(e,t){return":"+(t+1)})).join(", ")+") order by case ROWID "+this.outBinding.map((function(e,t){return"when CHARTOROWID(:"+(t+1)+") then "+t})).join(" ")+" end"}),l}with(){const e=[];if(this.grouped.with)for(const r of this.grouped.with)r.recursive&&(e.push(r),r.recursive=!1);const t=super.with();for(const r of e)r.recursive=!0;return t}_addReturningToSqlAndConvert(e,n,i,s){const o=this,a={sql:e};if(!n)return a;const u=Array.isArray(n)?n:[n];let l="",c="";return u.forEach((function(e){const n=e.columnName||e;if(l+=o.formatter.wrap(n)+",",c+="?,",e instanceof r)return o.formatter.bindings.push(e);o.formatter.bindings.push(new t(n))})),a.sql=e,l=l.slice(0,-1),c=c.slice(0,-1),l&&c&&(a.sql+=" returning "+l+" into "+c),a.outBinding=[n],"*"===s[0]&&(a.returningSql=function(){return"select * from "+o.tableName+" where ROWID = :1"}),a.returning=s,a}_prepOutbindings(t,n){const i={};let s=t||[],o=n||[];!Array.isArray(s)&&Of(t)&&(s=[s]),o&&!Array.isArray(o)&&(o=[o]);const a=[];return Tp(s,(function(t,n){"*"===o[0]?a[n]=["ROWID"]:a[n]=Np(o),Tp(t,(function(i,o){if(i instanceof e){t[o]=new r(o,i);const e=a[n].indexOf(o);e>=0&&(a[n].splice(e,1),t[o].returning=!0),a[n].push(t[o])}void 0===i&&delete s[n][o]}))})),i.returning=o,i.outBinding=a,i.values=s,i}_groupOrder(e,t){return super._groupOrderNulls(e,t)}update(){const e=this,n={},i=this._prepOutbindings(this.single.update||this.single.counter,this.single.returning),s=i.outBinding,o=i.returning,a=this._prepUpdate(this.single.update),u=this.where();let l="",c="";return Sp(a)&&"function"!=typeof this.single.update?"":(s.forEach((function(n){n.forEach((function(n){const i=n.columnName||n;if(l+=e.formatter.wrap(i)+",",c+=" ?,",n instanceof r)return e.formatter.bindings.push(n);e.formatter.bindings.push(new t(i))}))})),l=l.slice(0,-1),c=c.slice(0,-1),n.outBinding=s,n.returning=o,n.sql="update "+this.tableName+" set "+a.join(", ")+(u?" "+u:""),s.length&&!Sp(s[0])&&(n.sql+=" returning "+l+" into"+c),"*"===o[0]&&(n.returningSql=function(){let t="select * from "+e.tableName;const r=this.rowsAffected.length||this.rowsAffected;let n=" where ROWID in (",i=") order by case ROWID ";for(let e=0;e<r;e++)"*"===this.returning[0]&&(n+=":"+(e+1)+", ",i+="when CHARTOROWID(:"+(e+1)+") then "+e+" ");return"*"===this.returning[0]&&(this.returning=this.returning.slice(0,-1),n=n.slice(0,-2),i=i.slice(0,-1)),t+(n+i+" end")}),n)}_jsonPathWrap(e){return`'${e.path||e[1]}'`}jsonExtract(e){return this._jsonExtract(e.singleValue?"json_value":"json_query",e)}jsonSet(e){return`json_transform(${i(e.column,this.builder,this.client,this.bindingsHolder)}, set ${this.client.parameter(e.path,this.builder,this.bindingsHolder)} = ${this.client.parameter(e.value,this.builder,this.bindingsHolder)})`}jsonInsert(e){return`json_transform(${i(e.column,this.builder,this.client,this.bindingsHolder)}, insert ${this.client.parameter(e.path,this.builder,this.bindingsHolder)} = ${this.client.parameter(e.value,this.builder,this.bindingsHolder)})`}jsonRemove(e){const t=`json_transform(${i(e.column,this.builder,this.client,this.bindingsHolder)}, remove ${this.client.parameter(e.path,this.builder,this.bindingsHolder)})`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){return this._whereJsonPath("json_value",e)}whereJsonSupersetOf(e){throw new Error("Json superset where clause not actually supported by Oracle")}whereJsonSubsetOf(e){throw new Error("Json subset where clause not actually supported by Oracle")}onJsonPathEquals(e){return this._onJsonPathEquals("json_value",e)}}}).call(this,require("buffer").Buffer);var dE=class extends nE{constructor(e,t){super(e,t)}_setNullableState(e,t){const r=t?"NULL":"NOT NULL",n=`alter table ${this.tableName()} modify (${this.formatter.wrap(e)} ${r})`;return this.pushQuery({sql:n})}},fE={};const{isObject:pE}=Jf;class mE extends Xw{constructor(){super(...arguments),this.modifiers=["defaultTo","nullable","comment"],this._addCheckModifiers()}datetime(e){let t;return pE(e)?({useTz:t}=e):t=!e,t?"timestamp with local time zone":"timestamp"}timestamp(e){let t;return pE(e)?({useTz:t}=e):t=!e,t?"timestamp with local time zone":"timestamp"}checkRegex(e,t){return this._check(`REGEXP_LIKE(${this.formatter.wrap(this.getColumnName())},${this.client._escapeBinding(e)})`,t)}json(){return`varchar2(4000) check (${this.formatter.columnize(this.getColumnName())} is json)`}jsonb(){return this.json()}}mE.prototype.time="timestamp with local time zone",mE.prototype.uuid=({useBinaryUuid:e=!1}={})=>e?"raw(16)":"char(36)",fE=mE;var yE=class extends nv{constructor(e,t){super(e,t)}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}createMaterializedView(){this.createQuery(this.columns,this.selectQuery,!0)}},gE=class extends ev{constructor(){super(...arguments)}checkOption(){this._single.checkOption="default_option"}};const{timeout:vE,KnexTimeoutError:bE}=of,_E=yf("knex:tx");var wE=class extends up{begin(e){return this.isolationLevel&&this.client.logger.warn("Transaction isolation is not currently supported for Oracle"),Promise.resolve()}async commit(e,t){this._completed=!0;try{await e.commitAsync(),this._resolver(t)}catch(r){this._rejecter(r)}}release(e,t){return this._resolver(t)}rollback(e,t){return this._completed=!0,_E("%s: rolling back",this.txid),vE(e.rollbackAsync(),5e3).catch(e=>{if(!(e instanceof bE))return Promise.reject(e);this._rejecter(e)}).then(()=>{if(void 0===t){if(this.doNotRejectOnRollback)return void this._resolver();t=new Error("Transaction rejected with non-error: "+t)}this._rejecter(t)})}savepoint(e){return this.query(e,"SAVEPOINT "+this.txid)}async acquireConnection(e,t){const r=e&&e.connection,n=r||await this.client.acquireConnection();try{return n.__knexTxId=this.txid,n.isTransaction=!0,await t(n)}finally{_E("%s: releasing connection",this.txid),n.isTransaction=!1;try{await n.commitAsync()}catch(i){this._rejecter(i)}finally{r?_E("%s: not releasing external connection",this.txid):await this.client.releaseConnection(n)}}}},EE=class extends up{begin(e){return this.isolationLevel?this.query(e,`BEGIN ISOLATION LEVEL ${this.isolationLevel};`):this.query(e,"BEGIN;")}savepoint(e){return this.trxClient.logger("Redshift does not support savepoints."),Promise.resolve()}release(e,t){return this.trxClient.logger("Redshift does not support savepoints."),Promise.resolve()}rollbackTo(e,t){return this.trxClient.logger("Redshift does not support savepoints."),Promise.resolve()}};const{columnize:CE}=yy;var NE=class extends R_{truncate(){return"truncate "+this.tableName.toLowerCase()}insert(){const e=tg.prototype.insert.apply(this,arguments);return""===e?e:(this._slightReturn(),{sql:e})}update(){const e=tg.prototype.update.apply(this,arguments);return this._slightReturn(),{sql:e}}del(){const e=tg.prototype.del.apply(this,arguments);return this._slightReturn(),{sql:e}}_slightReturn(){this.single.isReturning&&this.client.logger.warn("insert/update/delete returning is not supported by redshift dialect")}forUpdate(){return this.client.logger.warn("table lock is not supported by redshift dialect"),""}forShare(){return this.client.logger.warn("lock for share is not supported by redshift dialect"),""}forNoKeyUpdate(){return this.client.logger.warn("table lock is not supported by redshift dialect"),""}forKeyShare(){return this.client.logger.warn("lock for share is not supported by redshift dialect"),""}columnInfo(){const e=this.single.columnInfo;let t=this.single.schema;const r=this.client.customWrapIdentifier(this.single.table,Fd);t&&(t=this.client.customWrapIdentifier(t,Fd));const n=[r.toLowerCase(),this.client.database().toLowerCase()];return this._buildColumnInfoQuery(t,"select * from information_schema.columns where table_name = ? and table_catalog = ?",n,e)}jsonExtract(e){let t;return(t=Array.isArray(e.column)?e.column:[e]).map(t=>{const r=`json_extract_path_text(${CE(t.column||t[0],this.builder,this.client,this.bindingsHolder)}, ${this.client.toPathForJson(e.path||t[1],this.builder,this.bindingsHolder)})`,n=t.alias||t[2];return n?this.client.alias(r,this.formatter.wrap(n)):r}).join(", ")}jsonSet(e){throw new Error("Json set is not supported by Redshift")}jsonInsert(e){throw new Error("Json insert is not supported by Redshift")}jsonRemove(e){throw new Error("Json remove is not supported by Redshift")}whereJsonPath(e){return this._whereJsonPath("json_extract_path_text",Object.assign({},e,{path:this.client.toPathForJson(e.path)}))}whereJsonSupersetOf(e){throw new Error("Json superset is not supported by Redshift")}whereJsonSubsetOf(e){throw new Error("Json subset is not supported by Redshift")}onJsonPathEquals(e){return this._onJsonPathEquals("json_extract_path_text",e)}},$E=class extends Ug{constructor(){super(...arguments)}primary(){return this.notNullable(),super.primary(...arguments)}index(){return this.client.logger.warn("Redshift does not support the creation of indexes."),this}},xE={};class TE extends P_{constructor(){super(...arguments)}bit(e){return!1!==e.length?`char(${e.length})`:"char(1)"}datetime(e){return e?"timestamp":"timestamptz"}timestamp(e){return e?"timestamp":"timestamptz"}comment(e){this.pushAdditional((function(){this.pushQuery(`comment on column ${this.tableCompiler.tableName()}.`+this.formatter.wrap(this.args[0])+" is "+(e?`'${e}'`:"NULL"))}),e)}}TE.prototype.increments=({primaryKey:e=!0}={})=>"integer identity(1,1)"+(e?" primary key":"")+" not null",TE.prototype.bigincrements=({primaryKey:e=!0}={})=>"bigint identity(1,1)"+(e?" primary key":"")+" not null",TE.prototype.binary="varchar(max)",TE.prototype.blob="varchar(max)",TE.prototype.enu="varchar(255)",TE.prototype.enum="varchar(255)",TE.prototype.json="varchar(max)",TE.prototype.jsonb="varchar(max)",TE.prototype.longblob="varchar(max)",TE.prototype.mediumblob="varchar(16777218)",TE.prototype.set="text",TE.prototype.text="varchar(max)",TE.prototype.tinyblob="varchar(256)",TE.prototype.uuid=Vg.prototype.uuid,TE.prototype.varbinary="varchar(max)",TE.prototype.bigint="bigint",TE.prototype.bool="boolean",TE.prototype.double="double precision",TE.prototype.floating="real",TE.prototype.smallint="smallint",TE.prototype.tinyint="smallint",xE=TE;var OE=class extends V_{constructor(){super(...arguments)}index(e,t,r){this.client.logger.warn("Redshift does not support the creation of indexes.")}dropIndex(e,t){this.client.logger.warn("Redshift does not support the deletion of indexes.")}createQuery(e,t,r){const n=t?"create table if not exists ":"create table ",i=" ("+e.sql.join(", ")+this._addChecks()+")";let s=n+this.tableName()+(r&&this.tableNameLike()?" (like "+this.tableNameLike()+")":i);this.single.inherits&&(s+=` like (${this.formatter.wrap(this.single.inherits)})`),this.pushQuery({sql:s,bindings:e.bindings}),Dy(this.single,"comment")&&this.comment(this.single.comment),r&&this.addColumns(e,this.addColumnsPrefix)}primary(e,t){t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey"),e.constructor!==Array&&(e=[e]);const r=this.grouped.columns;if(r)for(let n=0;n<e.length;n++){let t=r.find(t=>"columns"===t.grouping&&t.builder&&"add"===t.builder._method&&t.builder._args&&t.builder._args.indexOf(e[n])>-1);if(t&&(t=t.builder),!(t&&t._modifiers&&t._modifiers.nullable&&!1===t._modifiers.nullable[0]))return t?this.client.logger.warn("Redshift does not allow primary keys to contain nullable columns."):this.client.logger.warn("Redshift does not allow primary keys to contain nonexistent columns.")}return this.pushQuery(`alter table ${this.tableName()} add constraint ${t} primary key (${this.formatter.columnize(e)})`)}addColumns(e,t,r){if(t===this.alterColumnsPrefix)super.addColumns(e,t,r);else{t=t||this.addColumnsPrefix,r=r||this.getColumns();for(const e of r){const r=this.tableName(),n=e.compileColumn();this.pushQuery({sql:`alter table ${r} ${t}${n}`,bindings:[]})}}}},SE=class extends Q_{constructor(){super(...arguments)}},kE=class extends z_{constructor(e,t){super(e,t)}},jE={};Object.defineProperty(jE,"__esModule",{value:!0}),jE.getDialectByNameOrAlias=void 0;const{resolveClientNameWithAliases:AE}=Am,RE=Object.freeze({"better-sqlite3":()=>c({}),cockroachdb:()=>u({}),mssql:()=>a({}),mysql:()=>o({}),mysql2:()=>s({}),oracle:()=>i({}),oracledb:()=>n({}),pgnative:()=>r({}),postgres:()=>l({}),redshift:()=>t({}),sqlite3:()=>h({})});jE.getDialectByNameOrAlias=function(e){const t=AE(e),r=RE[t];if(!r)throw new Error("Invalid clientName given: "+e);return r()};const{SUPPORTED_CLIENTS:IE}=Om,{getDialectByNameOrAlias:PE}=jE;var qE={resolveConfig:function(e){let t,r;const n="string"==typeof e?Object.assign(xv(e),arguments[2]):e;if(0===arguments.length||!n.client&&!n.dialect)t=av;else if("function"==typeof n.client)t=n.client;else{const e=n.client||n.dialect;if(!IE.includes(e))throw new Error(`knex: Unknown configuration option 'client' value ${e}. Note that it is case-sensitive, check documentation for supported values.`);t=PE(e)}return{resolvedConfig:r="string"==typeof n.connection?Object.assign({},n,{connection:xv(n.connection).connection}):Object.assign({},n),Dialect:t}}};const{KnexTimeoutError:LE}=of,{resolveConfig:ME}=qE;function DE(e){const{resolvedConfig:t,Dialect:r}=ME(...arguments),n=op(new r(t));return t.userParams&&(n.userParams=t.userParams),n}DE.Client=av,DE.KnexTimeoutError=LE,DE.QueryBuilder={extend:function(e,t){ry.extend(e,t),_f.push(e)}},DE.SchemaBuilder={extend:function(e,t){rg.extend(e,t)}},DE.ViewBuilder={extend:function(e,t){ev.extend(e,t)}},DE.ColumnBuilder={extend:function(e,t){Ug.extend(e,t)}},DE.TableBuilder={extend:function(e,t){_g.extend(e,t)}};var FE=DE,UE={};FE.knex=FE,FE.default=FE,UE=FE;for(var BE=function(e){return e.then(e=>[null,e]).catch(e=>[e])},VE=[],zE={},HE=0;HE<256;HE++)VE[HE]=(HE+256).toString(16).substr(1),zE[VE[HE]]=HE;var QE=function(e,t,r){var n=t&&r||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,(function(e){i<16&&(t[n+i++]=zE[e])}));i<16;)t[n+i++]=0;return t},WE=function(e,t){var r=t||0,n=VE;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]},JE={};let KE;Object.defineProperty(JE,"__esModule",{value:!0}),JE.default=function(){if(!KE&&!(KE="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return KE(GE)};const GE=new Uint8Array(16);var YE={};Object.defineProperty(YE,"__esModule",{value:!0}),YE.default=void 0,YE.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var ZE={};Object.defineProperty(ZE,"__esModule",{value:!0}),ZE.default=void 0;var XE,eC=(XE=YE)&&XE.__esModule?XE:{default:XE};ZE.default=function(e){return"string"==typeof e&&eC.default.test(e)};var tC={};Object.defineProperty(tC,"__esModule",{value:!0}),tC.default=void 0;var rC,nC=(rC=ZE)&&rC.__esModule?rC:{default:rC};const iC=[];for(let pN=0;pN<256;++pN)iC.push((pN+256).toString(16).substr(1));tC.default=function(e,t=0){const r=(iC[e[t+0]]+iC[e[t+1]]+iC[e[t+2]]+iC[e[t+3]]+"-"+iC[e[t+4]]+iC[e[t+5]]+"-"+iC[e[t+6]]+iC[e[t+7]]+"-"+iC[e[t+8]]+iC[e[t+9]]+"-"+iC[e[t+10]]+iC[e[t+11]]+iC[e[t+12]]+iC[e[t+13]]+iC[e[t+14]]+iC[e[t+15]]).toLowerCase();if(!(0,nC.default)(r))throw TypeError("Stringified UUID is invalid");return r};var sC={};Object.defineProperty(sC,"__esModule",{value:!0}),sC.default=void 0;var oC=uC(JE),aC=uC(tC);function uC(e){return e&&e.__esModule?e:{default:e}}let lC,cC,hC=0,dC=0;sC.default=function(e,t,r){let n=t&&r||0;const i=t||new Array(16);let s=(e=e||{}).node||lC,o=void 0!==e.clockseq?e.clockseq:cC;if(null==s||null==o){const t=e.random||(e.rng||oC.default)();null==s&&(s=lC=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==o&&(o=cC=16383&(t[6]<<8|t[7]))}let a=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:dC+1;const l=a-hC+(u-dC)/1e4;if(l<0&&void 0===e.clockseq&&(o=o+1&16383),(l<0||a>hC)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");hC=a,dC=u,cC=o;const c=(1e4*(268435455&(a+=122192928e5))+u)%4294967296;i[n++]=c>>>24&255,i[n++]=c>>>16&255,i[n++]=c>>>8&255,i[n++]=255&c;const h=a/4294967296*1e4&268435455;i[n++]=h>>>8&255,i[n++]=255&h,i[n++]=h>>>24&15|16,i[n++]=h>>>16&255,i[n++]=o>>>8|128,i[n++]=255&o;for(let d=0;d<6;++d)i[n+d]=s[d];return t||(0,aC.default)(i)};var fC={};Object.defineProperty(fC,"__esModule",{value:!0}),fC.default=void 0;var pC,mC=(pC=ZE)&&pC.__esModule?pC:{default:pC};fC.default=function(e){if(!(0,mC.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};var yC={};Object.defineProperty(yC,"__esModule",{value:!0}),yC.default=function(e,t,r){function n(e,n,i,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,vC.default)(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(n),o.set(e,n.length),(o=r(o))[6]=15&o[6]|t,o[8]=63&o[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=o[e];return i}return(0,gC.default)(o)}try{n.name=e}catch(i){}return n.DNS=_C,n.URL=wC,n},yC.URL=yC.DNS=void 0;var gC=bC(tC),vC=bC(fC);function bC(e){return e&&e.__esModule?e:{default:e}}const _C="6ba7b810-9dad-11d1-80b4-00c04fd430c8";yC.DNS=_C;const wC="6ba7b811-9dad-11d1-80b4-00c04fd430c8";yC.URL=wC;var EC={};function CC(e){return 14+(e+64>>>9<<4)+1}function NC(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function $C(e,t,r,n,i,s){return NC((o=NC(NC(t,e),NC(n,s)))<<(a=i)|o>>>32-a,r);var o,a}function xC(e,t,r,n,i,s,o){return $C(t&r|~t&n,e,t,i,s,o)}function TC(e,t,r,n,i,s,o){return $C(t&n|r&~n,e,t,i,s,o)}function OC(e,t,r,n,i,s,o){return $C(t^r^n,e,t,i,s,o)}function SC(e,t,r,n,i,s,o){return $C(r^(t|~n),e,t,i,s,o)}Object.defineProperty(EC,"__esModule",{value:!0}),EC.default=void 0;EC.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length;for(let n=0;n<r;n+=8){const r=e[n>>5]>>>n%32&255,i=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[CC(t)-1]=t;let r=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let o=0;o<e.length;o+=16){const t=r,a=n,u=i,l=s;r=xC(r,n,i,s,e[o],7,-680876936),s=xC(s,r,n,i,e[o+1],12,-389564586),i=xC(i,s,r,n,e[o+2],17,606105819),n=xC(n,i,s,r,e[o+3],22,-1044525330),r=xC(r,n,i,s,e[o+4],7,-176418897),s=xC(s,r,n,i,e[o+5],12,1200080426),i=xC(i,s,r,n,e[o+6],17,-1473231341),n=xC(n,i,s,r,e[o+7],22,-45705983),r=xC(r,n,i,s,e[o+8],7,1770035416),s=xC(s,r,n,i,e[o+9],12,-1958414417),i=xC(i,s,r,n,e[o+10],17,-42063),n=xC(n,i,s,r,e[o+11],22,-1990404162),r=xC(r,n,i,s,e[o+12],7,1804603682),s=xC(s,r,n,i,e[o+13],12,-40341101),i=xC(i,s,r,n,e[o+14],17,-1502002290),n=xC(n,i,s,r,e[o+15],22,1236535329),r=TC(r,n,i,s,e[o+1],5,-165796510),s=TC(s,r,n,i,e[o+6],9,-1069501632),i=TC(i,s,r,n,e[o+11],14,643717713),n=TC(n,i,s,r,e[o],20,-373897302),r=TC(r,n,i,s,e[o+5],5,-701558691),s=TC(s,r,n,i,e[o+10],9,38016083),i=TC(i,s,r,n,e[o+15],14,-660478335),n=TC(n,i,s,r,e[o+4],20,-405537848),r=TC(r,n,i,s,e[o+9],5,568446438),s=TC(s,r,n,i,e[o+14],9,-1019803690),i=TC(i,s,r,n,e[o+3],14,-187363961),n=TC(n,i,s,r,e[o+8],20,1163531501),r=TC(r,n,i,s,e[o+13],5,-1444681467),s=TC(s,r,n,i,e[o+2],9,-51403784),i=TC(i,s,r,n,e[o+7],14,1735328473),n=TC(n,i,s,r,e[o+12],20,-1926607734),r=OC(r,n,i,s,e[o+5],4,-378558),s=OC(s,r,n,i,e[o+8],11,-2022574463),i=OC(i,s,r,n,e[o+11],16,1839030562),n=OC(n,i,s,r,e[o+14],23,-35309556),r=OC(r,n,i,s,e[o+1],4,-1530992060),s=OC(s,r,n,i,e[o+4],11,1272893353),i=OC(i,s,r,n,e[o+7],16,-155497632),n=OC(n,i,s,r,e[o+10],23,-1094730640),r=OC(r,n,i,s,e[o+13],4,681279174),s=OC(s,r,n,i,e[o],11,-358537222),i=OC(i,s,r,n,e[o+3],16,-722521979),n=OC(n,i,s,r,e[o+6],23,76029189),r=OC(r,n,i,s,e[o+9],4,-640364487),s=OC(s,r,n,i,e[o+12],11,-421815835),i=OC(i,s,r,n,e[o+15],16,530742520),n=OC(n,i,s,r,e[o+2],23,-995338651),r=SC(r,n,i,s,e[o],6,-198630844),s=SC(s,r,n,i,e[o+7],10,1126891415),i=SC(i,s,r,n,e[o+14],15,-1416354905),n=SC(n,i,s,r,e[o+5],21,-57434055),r=SC(r,n,i,s,e[o+12],6,1700485571),s=SC(s,r,n,i,e[o+3],10,-1894986606),i=SC(i,s,r,n,e[o+10],15,-1051523),n=SC(n,i,s,r,e[o+1],21,-2054922799),r=SC(r,n,i,s,e[o+8],6,1873313359),s=SC(s,r,n,i,e[o+15],10,-30611744),i=SC(i,s,r,n,e[o+6],15,-1560198380),n=SC(n,i,s,r,e[o+13],21,1309151649),r=SC(r,n,i,s,e[o+4],6,-145523070),s=SC(s,r,n,i,e[o+11],10,-1120210379),i=SC(i,s,r,n,e[o+2],15,718787259),n=SC(n,i,s,r,e[o+9],21,-343485551),r=NC(r,t),n=NC(n,a),i=NC(i,u),s=NC(s,l)}return[r,n,i,s]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(CC(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};var kC={};Object.defineProperty(kC,"__esModule",{value:!0}),kC.default=void 0;var jC=RC(yC),AC=RC(EC);function RC(e){return e&&e.__esModule?e:{default:e}}var IC=(0,jC.default)("v3",48,AC.default);kC.default=IC;var PC={};Object.defineProperty(PC,"__esModule",{value:!0}),PC.default=void 0;var qC=MC(JE),LC=MC(tC);function MC(e){return e&&e.__esModule?e:{default:e}}PC.default=function(e,t,r){const n=(e=e||{}).random||(e.rng||qC.default)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return(0,LC.default)(n)};var DC={};function FC(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function UC(e,t){return e<<t|e>>>32-t}Object.defineProperty(DC,"__esModule",{value:!0}),DC.default=void 0;DC.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const n=e.length/4+2,i=Math.ceil(n/16),s=new Array(i);for(let o=0;o<i;++o){const t=new Uint32Array(16);for(let r=0;r<16;++r)t[r]=e[64*o+4*r]<<24|e[64*o+4*r+1]<<16|e[64*o+4*r+2]<<8|e[64*o+4*r+3];s[o]=t}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;for(let o=0;o<i;++o){const e=new Uint32Array(80);for(let t=0;t<16;++t)e[t]=s[o][t];for(let t=16;t<80;++t)e[t]=UC(e[t-3]^e[t-8]^e[t-14]^e[t-16],1);let n=r[0],i=r[1],a=r[2],u=r[3],l=r[4];for(let r=0;r<80;++r){const s=Math.floor(r/20),o=UC(n,5)+FC(s,i,a,u)+l+t[s]+e[r]>>>0;l=u,u=a,a=UC(i,30)>>>0,i=n,n=o}r[0]=r[0]+n>>>0,r[1]=r[1]+i>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+l>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};var BC={};Object.defineProperty(BC,"__esModule",{value:!0}),BC.default=void 0;var VC=HC(yC),zC=HC(DC);function HC(e){return e&&e.__esModule?e:{default:e}}var QC=(0,VC.default)("v5",80,zC.default);BC.default=QC;var WC={};Object.defineProperty(WC,"__esModule",{value:!0}),WC.default=void 0,WC.default="00000000-0000-0000-0000-000000000000";var JC={};Object.defineProperty(JC,"__esModule",{value:!0}),JC.default=void 0;var KC,GC=(KC=ZE)&&KC.__esModule?KC:{default:KC};JC.default=function(e){if(!(0,GC.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)};var YC={};Object.defineProperty(YC,"__esModule",{value:!0}),Object.defineProperty(YC,"v1",{enumerable:!0,get:function(){return ZC.default}}),Object.defineProperty(YC,"v3",{enumerable:!0,get:function(){return XC.default}}),Object.defineProperty(YC,"v4",{enumerable:!0,get:function(){return eN.default}}),Object.defineProperty(YC,"v5",{enumerable:!0,get:function(){return tN.default}}),Object.defineProperty(YC,"NIL",{enumerable:!0,get:function(){return rN.default}}),Object.defineProperty(YC,"version",{enumerable:!0,get:function(){return nN.default}}),Object.defineProperty(YC,"validate",{enumerable:!0,get:function(){return iN.default}}),Object.defineProperty(YC,"stringify",{enumerable:!0,get:function(){return sN.default}}),Object.defineProperty(YC,"parse",{enumerable:!0,get:function(){return oN.default}});var ZC=aN(sC),XC=aN(kC),eN=aN(PC),tN=aN(BC),rN=aN(WC),nN=aN(JC),iN=aN(ZE),sN=aN(tC),oN=aN(fC);function aN(e){return e&&e.__esModule?e:{default:e}}var uN={};(function(e){const{v4:t}=YC;uN={v4:()=>t(),toBuffer:t=>e.from(QE(t)),fromBuffer:e=>WE(e)}}).call(this,require("buffer").Buffer);const lN=require("events");class cN{constructor(e){this.identity=e.identity,this.store=e.store,Xl.forEach(e=>{this[e.name]||(this[e.name]={}),this[e.name][e.method]=async function(...t){return await this.store[e.name][e.method](this.identity,...t)}.bind(this)})}async disconnect(){await this.store.disconnect()}}var hN={Store:class extends lN{constructor(e,t){super(),Xl.forEach(e=>{this[e.name]||(this[e.name]={}),this[e.name][e.method]=async function(t,...r){var n;return null==this||null===(n=this.policy)||void 0===n||n.enforce(this.toolbox,t,e.name,e.method,r),await e.module(this.toolbox,t,...r)}.bind(this)}),this.url=e,this.options=t,this.policy=null==t?void 0:t.policy,this.toolbox={store:this,crypto:Zl,trycatch:BE,uuid:uN}}async connect(e,t){var r;e||(e=this.url),t||(t=this.options);const n=new URL(e),i={client:n.protocol.replace(":",""),connection:{host:n.hostname,port:n.port,user:n.username,password:n.password,database:n.pathname}};return"sqlite3"===i.client&&(i.useNullAsDefault=!0,i.connection.filename=i.connection.database,"memory"===i.connection.filename&&(i.connection.filename=":memory:")),this.knex=UE(i),this.toolbox={...this.toolbox,knex:this.knex},await async function(e,t){await e.schema.hasTable("AccountDatabases").then(r=>{if(!r)return e.schema.createTable("AccountDatabases",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("idDB",16).notNullable(),e.binary("idAccount",16).notNullable(),e.string("type",45).notNullable(),e.primary(["idDB","idAccount"])})}),await e.schema.hasTable("Accounts").then(r=>{if(!r)return e.schema.createTable("Accounts",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("id",16).notNullable().primary(),e.string("username",321).notNullable().unique(),e.text("name").notNullable(),e.string("password",300).notNullable(),e.string("key",500).notNullable(),e.tinyint("isActive",4).notNullable(),e.tinyint("isRoot",4).notNullable()})}),await e.schema.hasTable("Annotations").then(r=>{if(!r)return e.schema.createTable("Annotations",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("ns",16).notNullable(),e.binary("stream",16).notNullable(),e.json("annotation").notNullable(),e.primary(["db","ns","stream"])})}),await e.schema.hasTable("Databases").then(r=>{if(!r)return e.schema.createTable("Databases",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("id",16).notNullable().primary(),e.string("name",100).notNullable().unique()})}),await e.schema.hasTable("Events").then(r=>{if(!r)return e.schema.createTable("Events",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("ns",16).notNullable(),e.binary("stream",16).notNullable(),e.binary("id",16).notNullable(),e.integer("version",10),e.timestamp("ts",{precision:6}).notNullable(),e.json("meta").notNullable(),e.json("data").notNullable(),e.string("type",100).notNullable(),e.primary(["db","ns","stream","id"])})}),await e.schema.hasTable("Namespaces").then(r=>{if(!r)return e.schema.createTable("Namespaces",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("id",16).notNullable().primary(),e.string("name",100).notNullable(),e.unique(["name","db"])})}),await e.schema.hasTable("Objects").then(r=>{if(!r)return e.schema.createTable("Objects",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.string("id",100).notNullable(),e.json("data").notNullable(),e.primary(["db","id"])})}),await e.schema.hasTable("Streams").then(r=>{if(!r)return e.schema.createTable("Streams",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("domain",16).notNullable(),e.binary("stream",16).notNullable(),e.json("meta").notNullable(),e.json("annotation").notNullable(),e.primary(["db","domain","stream"])})})}(this.knex,i.client),new cN({store:this,identity:null===(r=t)||void 0===r?void 0:r.identity})}async disconnect(){this.toolbox={...this.toolbox,knex:void 0},this.knex&&(await this.knex.destroy(),this.knex=void 0)}}},dN={};(function(e){const t=class{constructor({credentials:e}){e&&(this.username=e.username,this.password=e.password)}get username(){return localStorage.getItem("username")}set username(e){localStorage.setItem("username",e)}async authenticate(e,{username:t,password:r}){localStorage.setItem("username",t),this.password=r,await e.details()}forget(){localStorage.removeItem("authorization"),localStorage.removeItem("username")}get credentials(){if(this.username||this.password)return{username:this.username,password:this.password}}async authorization(){return localStorage.getItem("authorization")||(this.credentials&&this.credentials.apikey?"Apikey "+this.credentials.apikey:this.credentials&&this.credentials.username&&this.credentials.password?"Basic "+(e=`${this.credentials.username}:${this.credentials.password}`,btoa(unescape(encodeURIComponent(e)))):void 0);var e}async authorized(e){localStorage.setItem("authorization",e)}async revoked(e){localStorage.removeItem("authorization")}},{Store:r}=hN;class n{constructor(){}async connect(e,t){if(e||t||(e="sqlite3:memory"),void 0===t&&"[object String]"!==Object.prototype.toString.call(e)&&(t=e,e={}),"[object String]"!==Object.prototype.toString.call(e)){const t=new URL(e);e={protocol:t.protocol.replace(":",""),hostname:t.hostname,port:t.port,username:t.username,password:t.password,database:t.pathname}}t||"persistr"===e.protocol||(t=new r(e));const n=new class{constructor(e){this.store=e}async close(){await this.store.disconnect()}accounts(){return new class{constructor(e){this.connection=e}get store(){return this.connection.store}async each(e){const t=this.store.accounts.find();for(const r of t)await e(r)}async all(){return this.store.accounts.find()}}(this)}account(e){return new ss(this,e)}}(await t.connect());return"persistr"===e.protocol&&(e.authorization||e.authorized||(e.authorization=()=>n.authorization,e.authorized=e=>n.authorization=e)),n}}dN={Persistr:n,persistr:new n,Identity:t},"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)&&(e.persistr=dN.persistr)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();