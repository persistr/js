!function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e((function(e,t){const r=l({});class n extends r{transaction(){return new QO(this,...arguments)}queryCompiler(e,t){return new GO(this,e,t)}columnBuilder(){return new KO(this,...arguments)}columnCompiler(){return new ZO(this,...arguments)}tableCompiler(){return new XO(this,...arguments)}schemaCompiler(){return new eS(this,...arguments)}viewCompiler(){return new tS(this,...arguments)}_driver(){return d({})}processResponse(e,t){const r=e.response;return e.output?e.output.call(t,r):"raw"===e.method?r:"SELECT"===r.command?"first"===e.method?r.rows[0]:"pluck"===e.method?dE(r.rows,e.pluck):r.rows:"INSERT"===r.command||"UPDATE"===r.command||"DELETE"===r.command?r.rowCount:r}toPathForJson(e,t,r){return e.replace(/^(\$\.)/,"").split(".").map(function(e){return this.parameter(e,t,r)}.bind(this)).join(", ")}}Object.assign(n.prototype,{dialect:"redshift",driverName:"pg-redshift"}),e.exports=n})),r=e((function(e,t){const r=l({});e.exports=class extends r{constructor(...e){super(...e),this.driverName="pgnative",this.canCancelQuery=!0}_driver(){return d({}).native}_stream(e,t,r,n){if(!t.sql)throw new Error("The query is empty");const i=this;return new Promise((n,s)=>(r.on("error",s),r.on("end",n),i._query(e,t).then(e=>e.response).then(({rows:e})=>e.forEach(e=>r.write(e))).catch((function(e){r.emit("error",e)})).then((function(){r.end()}))))}async cancelQuery(e){try{return await this._wrappedCancelQueryCall(null,e)}catch(t){throw this.logger.warn("Connection Error: "+t),t}}_wrappedCancelQueryCall(e,t){return new Promise((function(e,r){t.native.cancel((function(t){t?r(t):e(!0)}))}))}}})),n=e((function(e,t){(function(t){const{BlobHelper:r,ReturningHelper:n,monkeyPatchConnection:s}=PO,o=i({}),{isString:a}=vb,{outputQuery:u,unwrapRaw:l}=Uw,{compileCallback:c}=jw;class h extends o{constructor(e){super(e),this.driver&&(t.env.UV_THREADPOOL_SIZE=t.env.UV_THREADPOOL_SIZE||1,t.env.UV_THREADPOOL_SIZE=parseInt(t.env.UV_THREADPOOL_SIZE)+this.driver.poolMax)}_driver(){const e=this,t=d({});return e.fetchAsString=[],this.config.fetchAsString&&Array.isArray(this.config.fetchAsString)&&this.config.fetchAsString.forEach((function(r){a(r)&&(r=r.toUpperCase(),t[r]&&("NUMBER"!==r&&"DATE"!==r&&"CLOB"!==r&&"BUFFER"!==r&&this.logger.warn('Only "date", "number", "clob" and "buffer" are supported for fetchAsString'),e.fetchAsString.push(t[r])))})),t}queryCompiler(e,t){return new MO(this,e,t)}tableCompiler(){return new LO(this,...arguments)}columnCompiler(){return new qO(this,...arguments)}viewBuilder(){return new VO(this,...arguments)}viewCompiler(){return new UO(this,...arguments)}formatter(e){return new EC(this,e)}transaction(){return new WO(this,...arguments)}prepBindings(e){return dE(e,e=>e instanceof r&&this.driver?{type:this.driver.BLOB,dir:this.driver.BIND_OUT}:e instanceof n&&this.driver?{type:this.driver.STRING,dir:this.driver.BIND_OUT}:"boolean"==typeof e?e?1:0:e)}parameter(e,t,n){return"function"==typeof e?u(c(e,void 0,this,n),!0,t,this):e instanceof r?(n.bindings.push(e.value),"?"):l(e,!0,t,this,n)||"?"}acquireRawConnection(){const e=this;return new Promise((function(t,r){const n=e.connectionSettings.externalAuth?{externalAuth:e.connectionSettings.externalAuth}:{user:e.connectionSettings.user,password:e.connectionSettings.password};var i;n.connectString=(i=e.connectionSettings).connectString?i.connectString:i.port?i.host+":"+i.port+"/"+i.database:i.host+"/"+i.database,e.connectionSettings.prefetchRowCount&&(n.prefetchRows=e.connectionSettings.prefetchRowCount),void 0!==e.connectionSettings.stmtCacheSize&&(n.stmtCacheSize=e.connectionSettings.stmtCacheSize),e.driver.fetchAsString=e.fetchAsString,e.driver.getConnection(n,(function(n,i){if(n)return r(n);s(i,e),t(i)}))}))}destroyRawConnection(e){return e.release()}_query(e,t){if(!t.sql)throw new Error("The query is empty");const n={autoCommit:!1};return"select"===t.method&&(n.resultSet=!0),e.executeAsync(t.sql,t.bindings,n).then((async function(n){let i=gb(n.outBinds);if(t.response=n.rows||[],t.rowsAffected=n.rows?n.rows.rowsAffected:n.rowsAffected,"raw"===t.method&&i.length>0)return{response:i};if("update"===t.method){const e=t.rowsAffected.length||t.rowsAffected,r=[],n=[],s=t=>function(r,s){const o=s*e;n.push(i[t+o])};for(let i=0;i<e;i++)r.push(t.outBinding[0]),Zb(t.outBinding[0],s(i));i=n,t.outBinding=r}if(!t.returning&&0===i.length)return e.isTransaction||await e.commitAsync(),t;const s=[];let o=0;for(let e=0;e<t.outBinding.length;e++){const n=t.outBinding[e];o+=t.outBinding[e-1]?t.outBinding[e-1].length:0;for(let a=0;a<n.length;a++){const u=n[a];await new Promise((function(n,l){if(u instanceof r){const r=i[a+o];u.returning&&(t.response[e]=t.response[e]||{},t.response[e][u.columnName]=u.value),r.on("error",(function(e){l(e)})),r.on("finish",(function(){n()})),r.write(u.value),r.end()}else"ROWID"===t.outBinding[e][a]?(s.push(i[a+o]),n()):(t.response[e]=t.response[e]||{},t.response[e][u]=i[a+o],n())}))}}if(e.isTransaction)return t;if(await e.commitAsync(),t.returningSql){const r=await e.executeAsync(t.returningSql(),s,{resultSet:!0});t.response=r.rows}return t}))}processResponse(e,t){const{response:r}=e;if(e.output)return e.output.call(t,r);switch(e.method){case"select":default:return r;case"first":return r[0];case"pluck":return dE(r,e.pluck);case"insert":case"del":case"update":case"counter":return e.returning&&!Xb(e.returning)?r:void 0!==e.rowsAffected?e.rowsAffected:1}}processPassedConnection(e){s(e,this)}}h.prototype.driverName="oracledb",e.exports=h}).call(this,require("_process"))})),i=e((function(e,t){const{ReturningHelper:r}=pO,{isConnectionError:n}=pO;class i extends jC{schemaCompiler(){return new gO(this,...arguments)}columnBuilder(){return new vO(this,...arguments)}columnCompiler(){return new TO(this,...arguments)}tableCompiler(){return new SO(this,...arguments)}database(){return this.connectionSettings.database}positionBindings(e){let t=0;return e.replace(/\?/g,(function(){return t+=1,":"+t}))}_stream(e,t,r,i){if(!t.sql)throw new Error("The query is empty");return new Promise((function(s,o){r.on("error",t=>{n(t)&&(e.__knex__disposed=t),o(t)}),r.on("end",s);const a=e.queryStream(t.sql,t.bindings,i);a.pipe(r),a.on("error",(function(e){o(e),r.emit("error",e)}))}))}alias(e,t){return e+" "+t}parameter(e,t,n){return e instanceof r&&this.driver?e=new this.driver.OutParam(this.driver.OCCISTRING):"boolean"==typeof e&&(e=e?1:0),super.parameter(e,t,n)}}Object.assign(i.prototype,{dialect:"oracle",driverName:"oracle"}),e.exports=i})),s=e((function(e,t){const r=o({});class n extends r{transaction(){return new fO(this,...arguments)}_driver(){return d({})}validateConnection(e){return e&&!e._fatalError&&!e._protocolError&&!e._closing&&!e.stream.destroyed}}Object.assign(n.prototype,{driverName:"mysql2"}),e.exports=n})),o=e((function(e,t){const{promisify:r}=require("util"),{makeEscape:n}=qm;class i extends jC{_driver(){return d({})}queryCompiler(e,t){return new Xk(this,e,t)}schemaCompiler(){return new eO(this,...arguments)}tableCompiler(){return new tO(this,...arguments)}viewCompiler(){return new cO(this,...arguments)}viewBuilder(){return new hO(this,...arguments)}columnCompiler(){return new sO(this,...arguments)}transaction(){return new Gk(this,...arguments)}wrapIdentifierImpl(e){return"*"!==e?`\`${e.replace(/`/g,"``")}\``:"*"}acquireRawConnection(){return new Promise((e,t)=>{const r=this.driver.createConnection(this.connectionSettings);r.on("error",e=>{r.__knex__disposed=e}),r.connect(n=>{if(n)return r.removeAllListeners(),t(n);e(r)})})}async destroyRawConnection(e){try{const t=r(t=>e.end(t));return await t()}catch(t){e.__knex__disposed=t}finally{Qk(()=>e.removeAllListeners())}}validateConnection(e){return"connected"===e.state||"authenticated"===e.state}_stream(e,t,r,n){if(!t.sql)throw new Error("The query is empty");n=n||{};const i=Object.assign({sql:t.sql},t.options);return new Promise((s,o)=>{r.on("error",o),r.on("end",s);const a=e.query(i,t.bindings).stream(n);a.on("error",e=>{o(e),r.emit("error",e)}),a.pipe(r)})}_query(e,t){if(t&&"string"!=typeof t||(t={sql:t}),!t.sql)throw new Error("The query is empty");return new Promise((function(r,n){if(!t.sql)return void r();const i=Object.assign({sql:t.sql},t.options);e.query(i,t.bindings,(function(e,i,s){if(e)return n(e);t.response=[i,s],r(t)}))}))}processResponse(e,t){if(null==e)return;const{response:r}=e,{method:n}=e,i=r[0],s=r[1];if(e.output)return e.output.call(t,i,s);switch(n){case"select":return i;case"first":return i[0];case"pluck":return dE(i,e.pluck);case"insert":return[i.insertId];case"del":case"update":case"counter":return i.affectedRows;default:return r}}async cancelQuery(e){const t=await this.acquireRawConnection();try{return await this._wrappedCancelQueryCall(t,e)}finally{await this.destroyRawConnection(t),t.__knex__disposed&&this.logger.warn("Connection Error: "+t.__knex__disposed)}}_wrappedCancelQueryCall(e,t){return this._query(e,{sql:"KILL QUERY ?",bindings:[t.threadId],options:{}})}}Object.assign(i.prototype,{dialect:"mysql",driverName:"mysql",_escapeBinding:n(),canCancelQuery:!0}),e.exports=i})),a=e((function(e,t){(function(t,r){const n=Fv("knex:mssql");class i extends jC{constructor(e={}){super(e)}_generateConnection(){const e=this.connectionSettings;e.options=e.options||{};const t={authentication:{type:e.type||"default",options:{userName:e.userName||e.user,password:e.password,domain:e.domain,token:e.token,clientId:e.clientId,clientSecret:e.clientSecret,tenantId:e.tenantId,msiEndpoint:e.msiEndpoint}},server:e.server||e.host,options:{database:e.database,encrypt:e.encrypt||!1,port:e.port||1433,connectTimeout:e.connectionTimeout||e.timeout||15e3,requestTimeout:Nk(e.requestTimeout)?15e3:e.requestTimeout,rowCollectionOnDone:!1,rowCollectionOnRequestCompletion:!1,useColumnNames:!1,tdsVersion:e.options.tdsVersion||"7_4",appName:e.options.appName||"knex",trustServerCertificate:!1,...e.options}};return t.options.instanceName&&delete t.options.port,isNaN(t.options.requestTimeout)&&(t.options.requestTimeout=15e3),t.options.requestTimeout===1/0&&(t.options.requestTimeout=0),t.options.requestTimeout<0&&(t.options.requestTimeout=0),e.debug&&(t.options.debug={packet:!0,token:!0,data:!0,payload:!0}),t}_driver(){return d({})}formatter(){return new kk(this,...arguments)}transaction(){return new Sk(this,...arguments)}queryCompiler(){return new Ik(this,...arguments)}schemaCompiler(){return new Rk(this,...arguments)}tableCompiler(){return new Lk(this,...arguments)}viewCompiler(){return new Uk(this,...arguments)}queryBuilder(){return new Ow(this)}columnCompiler(){return new Vk(this,...arguments)}wrapIdentifierImpl(e){return"*"===e?"*":`[${e.replace(/[[\]]+/g,"")}]`}acquireRawConnection(){return new Promise((e,t)=>{n("connection::connection new connection requested");const r=this._driver(),i=Object.assign({},this._generateConnection()),s=new r.Connection(i);s.connect(r=>r?(n("connection::connect error: %s",r.message),t(r)):(n("connection::connect connected to server"),s.connected=!0,s.on("error",e=>{n("connection::error message=%s",e.message),s.__knex__disposed=e,s.connected=!1}),s.once("end",()=>{s.connected=!1,s.__knex__disposed="Connection to server was terminated.",n("connection::end connection ended.")}),e(s)))})}validateConnection(e){return e&&e.connected}destroyRawConnection(e){return n("connection::destroy"),new Promise(t=>{e.once("end",()=>{t()}),e.close()})}positionBindings(e){let t=-1;return e.replace(/\\?\?/g,e=>"\\?"===e?"?":(t+=1,"@p"+t))}_chomp(e){if("LoggedIn"===e.state.name){const t=this.requestQueue.pop();t&&(n("connection::query executing query, %d more in queue",this.requestQueue.length),e.execSql(t))}}_enqueueRequest(e,t){this.requestQueue.push(e),this._chomp(t)}_makeRequest(e,t){const r=this._driver(),i="string"==typeof e?e:e.sql;let s=0;if(!i)throw new Error("The query is empty");n("request::request sql=%s",i);const o=new r.Request(i,(e,r)=>{if(e)return n("request::error message=%s",e.message),t(e);s=r,n("request::callback rowCount=%d",s)});return o.on("prepared",()=>{n("request %s::request prepared",this.id)}),o.on("done",(e,t)=>{n("request::done rowCount=%d more=%s",e,t)}),o.on("doneProc",(e,t)=>{n("request::doneProc id=%s rowCount=%d more=%s",o.id,e,t)}),o.on("doneInProc",(e,t)=>{n("request::doneInProc id=%s rowCount=%d more=%s",o.id,e,t)}),o.once("requestCompleted",()=>(n("request::completed id=%s",o.id),t(null,s))),o.on("error",e=>(n("request::error id=%s message=%s",o.id,e.message),t(e))),o}_stream(e,t,r){return new Promise((n,i)=>{const s=this._makeRequest(t,e=>{if(e)return r.emit("error",e),i(e);n()});s.on("row",e=>{r.write(e.reduce((e,t)=>({...e,[t.metadata.colName]:t.value}),{}))}),s.on("error",e=>{r.emit("error",e),i(e)}),s.once("requestCompleted",()=>{r.end(),n()}),this._assignBindings(s,t.bindings),this._enqueueRequest(s,e)})}_assignBindings(e,t){if(Array.isArray(t))for(let r=0;r<t.length;r++){const n=t[r];this._setReqInput(e,r,n)}}_scaleForBinding(e){if(e%1==0)throw new Error(`The binding value ${e} must be a decimal number.`);return{scale:10}}_typeForBinding(e){const t=this._driver();switch(typeof e){case"string":return t.TYPES.NVarChar;case"boolean":return t.TYPES.Bit;case"number":if(e%1!=0)return t.TYPES.Float;if(e<-2147483648||e>2147483647){if(e<-9007199254740991||e>9007199254740991)throw new Error("Bigint must be safe integer or must be passed as string, saw "+e);return t.TYPES.BigInt}return t.TYPES.Int;default:return e instanceof Date?t.TYPES.DateTime:e instanceof r?t.TYPES.VarBinary:t.TYPES.NVarChar}}_query(e,r){return new Promise((i,s)=>{const o=[],a=this._makeRequest(r,(n,a)=>{if(n)return s(n);r.response=o,t.nextTick(()=>this._chomp(e)),i(r)});a.on("row",e=>{n("request::row"),o.push(e)}),this._assignBindings(a,r.bindings),this._enqueueRequest(a,e)})}_setReqInput(e,t,i){const s=this._typeForBinding(i),o="p".concat(t);let a;"number"==typeof i&&i%1!=0&&(a=this._scaleForBinding(i)),n("request::binding pos=%d type=%s value=%s",t,s.name,i),r.isBuffer(i)&&(a={length:"max"}),e.addParameter(o,s,i,a)}processResponse(e,t){if(null==e)return;let{response:r}=e;const{method:n}=e;if(e.output)return e.output.call(t,r);if(r=r.map(e=>e.reduce((e,t)=>{const r=t.metadata.colName;return e[r]?(Array.isArray(e[r])||(e[r]=[e[r]]),e[r].push(t.value)):e[r]=t.value,e},{})),e.output)return e.output.call(t,r);switch(n){case"select":default:return r;case"first":return r[0];case"pluck":return dE(r,e.pluck);case"insert":case"del":case"update":case"counter":return e.returning&&"@@rowcount"===e.returning?r[0][""]:r}}}Object.assign(i.prototype,{requestQueue:[],dialect:"mssql",driverName:"mssql"}),e.exports=i}).call(this,require("_process"),require("buffer").Buffer)})),u=e((function(e,t){const r=l({});class n extends r{transaction(){return new XN(this,...arguments)}queryCompiler(e,t){return new wk(this,e,t)}tableCompiler(){return new Ek(this,...arguments)}viewCompiler(){return new Ck(this,...arguments)}queryBuilder(){return new Tk(this)}_parseVersion(e){return e.split(" ")[2]}async cancelQuery(e){try{return await this._wrappedCancelQueryCall(null,e)}catch(t){throw this.logger.warn("Connection Error: "+t),t}}_wrappedCancelQueryCall(e,t){if(0!==t.activeQuery.processID||0!==t.activeQuery.secretKey)return t.cancel(t,t.activeQuery)}toArrayPathFromJsonPath(e,t,r){return e.replace(/^(\$\.)/,"").replace(/\[([0-9]+)]/,".$1").split(".").map(function(e){return this.parameter(e,t,r)}.bind(this)).join(", ")}}Object.assign(n.prototype,{driverName:"cockroachdb"}),e.exports=n})),l=e((function(e,t){(function(t){const{promisify:r}=require("util"),{makeEscape:n}=qm,{isString:i}=vb;class s extends jC{constructor(e){super(e),e.returning&&(this.defaultReturning=e.returning),e.searchPath&&(this.searchPath=e.searchPath)}transaction(){return new XN(this,...arguments)}queryBuilder(){return new sk(this)}queryCompiler(e,t){return new ik(this,e,t)}columnCompiler(){return new ok(this,...arguments)}schemaCompiler(){return new gk(this,...arguments)}tableCompiler(){return new pk(this,...arguments)}viewCompiler(){return new mk(this,...arguments)}viewBuilder(){return new yk(this,...arguments)}_driver(){return d({})}wrapIdentifierImpl(e){if("*"===e)return e;let t="";const r=e.match(/(.*?)(\[[0-9]+\])/);return r&&(e=r[1],t=r[2]),`"${e.replace(/"/g,'""')}"${t}`}_acquireOnlyConnection(){const e=new this.driver.Client(this.connectionSettings);return e.connect().then(()=>e)}acquireRawConnection(){const e=this;return this._acquireOnlyConnection().then((function(t){return t.on("error",e=>{t.__knex__disposed=e}),t.on("end",e=>{t.__knex__disposed=e||"Connection ended unexpectedly"}),e.version?t:e.checkVersion(t).then((function(r){return e.version=r,t}))})).then((async function(t){return await e.setSchemaSearchPath(t),t}))}async destroyRawConnection(e){return r(t=>e.end(t))()}checkVersion(e){return new Promise((t,r)=>{e.query("select version();",(e,n)=>{if(e)return r(e);t(this._parseVersion(n.rows[0].version))})})}_parseVersion(e){return/^PostgreSQL (.*?)( |$)/.exec(e)[1]}positionBindings(e){let t=0;return e.replace(/(\\*)(\?)/g,(function(e,r){return r.length%2?"?":(t++,"$"+t)}))}setSchemaSearchPath(e,t){let r=t||this.searchPath;if(!r)return Promise.resolve(!0);if(!Array.isArray(r)&&!i(r))throw new TypeError("knex: Expected searchPath to be Array/String, got: "+typeof r);if(i(r)){if(r.includes(",")){const e=`[${r.split(",").map(e=>`'${e}'`).join(", ")}]`;this.logger.warn(`Detected comma in searchPath "${r}".If you are trying to specify multiple schemas, use Array syntax: ${e}`)}r=[r]}return r=r.map(e=>`"${e}"`).join(","),new Promise((function(t,n){e.query("set search_path to "+r,(function(e){if(e)return n(e);t(!0)}))}))}_stream(e,r,n,i){if(!r.sql)throw new Error("The query is empty");const s=t.browser?void 0:d({}),o=r.sql;return new Promise((function(t,a){const u=e.query(new s(o,r.bindings,i));u.on("error",(function(e){a(e),n.emit("error",e)})),n.on("end",t),u.pipe(n)}))}_query(e,t){if(!t.sql)throw new Error("The query is empty");let r={text:t.sql,values:t.bindings||[]};return t.options&&(r=zE(r,t.options)),new Promise((function(n,i){e.query(r,(function(e,r){if(e)return i(e);t.response=r,n(t)}))}))}processResponse(e,t){const r=e.response;if(e.output)return e.output.call(t,r);if("raw"===e.method)return r;const{returning:n}=e;if("SELECT"===r.command)return"first"===e.method?r.rows[0]:"pluck"===e.method?dE(r.rows,e.pluck):r.rows;if(n){const e=[];for(let t=0,n=r.rows.length;t<n;t++){const n=r.rows[t];e[t]=n}return e}return"UPDATE"===r.command||"DELETE"===r.command?r.rowCount:r}async cancelQuery(e){const t=await this.acquireRawConnection();try{return await this._wrappedCancelQueryCall(t,e)}finally{await this.destroyRawConnection(t).catch(e=>{this.logger.warn("Connection Error: "+e)})}}_wrappedCancelQueryCall(e,t){return this._query(e,{sql:"SELECT pg_cancel_backend($1);",bindings:[t.processID],options:{}})}toPathForJson(e){return e.match(/^{.*}$/)?e:"{"+e.replace(/^(\$\.)/,"").replace(".",",").replace(/\[([0-9]+)]/,",$1")+"}"}}Object.assign(s.prototype,{dialect:"postgresql",driverName:"pg",canCancelQuery:!0,_escapeBinding:n({escapeArray:(e,t)=>t(function e(t,r){let n="{";for(let i=0;i<t.length;i++){i>0&&(n+=",");const s=t[i];null==s?n+="NULL":Array.isArray(s)?n+=e(s,r):n+="number"==typeof s?s:JSON.stringify("string"==typeof s?s:r(s))}return n+"}"}(e,t)),escapeString(e){let t=!1,r="'";for(let n=0;n<e.length;n++){const i=e[n];"'"===i?r+=i+i:"\\"===i?(r+=i+i,t=!0):r+=i}return r+="'",!0===t&&(r="E"+r),r},escapeObject(e,t,r,n=[]){if(e&&"function"==typeof e.toPostgres){if(-1!==(n=n||[]).indexOf(e))throw new Error(`circular reference detected while preparing "${e}" for query`);return n.push(e),t(e.toPostgres(t),n)}return JSON.stringify(e)}})}),e.exports=s}).call(this,require("_process"))})),c=e((function(e,t){const r=h({});class n extends r{_driver(){return d({})}async acquireRawConnection(){return new this.driver(this.connectionSettings.filename)}async destroyRawConnection(e){return e.close()}async _query(e,t){if(!t.sql)throw new Error("The query is empty");if(!e)throw new Error("No connection provided");const r=e.prepare(t.sql),n=this._formatBindings(t.bindings);if(r.reader){const e=await r.all(n);return t.response=e,t}const i=await r.run(n);return t.response=i,t.context={lastID:i.lastInsertRowid,changes:i.changes},t}_formatBindings(e){return e?e.map(e=>e instanceof Date?e.valueOf():"boolean"==typeof e?Number(e):e):[]}}Object.assign(n.prototype,{driverName:"better-sqlite3"}),e.exports=n})),h=e((function(e,t){const{promisify:r}=require("util");class n extends jC{constructor(e){super(e),void 0===e.useNullAsDefault&&this.logger.warn("sqlite does not support inserting default values. Set the `useNullAsDefault` flag to hide this warning. (see docs http://knexjs.org/#Builder-insert).")}_driver(){return d({})}schemaCompiler(){return new sT(this,...arguments)}transaction(){return new YC(this,...arguments)}queryCompiler(e,t){return new nT(this,e,t)}queryBuilder(){return new YN(this)}viewCompiler(e,t){return new fT(this,e,t)}columnCompiler(){return new oT(this,...arguments)}tableCompiler(){return new hT(this,...arguments)}ddl(e,t,r){return new ZN(this,e,t,r)}wrapIdentifierImpl(e){return"*"!==e?`\`${e.replace(/`/g,"``")}\``:"*"}acquireRawConnection(){return new Promise((e,t)=>{let r=this.driver.OPEN_READWRITE|this.driver.OPEN_CREATE;if(this.connectionSettings.flags){if(!Array.isArray(this.connectionSettings.flags))throw new Error("flags must be an array of strings");this.connectionSettings.flags.forEach(e=>{if(!e.startsWith("OPEN_")||!this.driver[e])throw new Error(`flag ${e} not supported by node-sqlite3`);r|=this.driver[e]})}const n=new this.driver.Database(this.connectionSettings.filename,r,r=>{if(r)return t(r);e(n)})})}async destroyRawConnection(e){return r(t=>e.close(t))()}_query(e,t){if(!t.sql)throw new Error("The query is empty");const{method:r}=t;let n;switch(r){case"insert":case"update":case"counter":case"del":n="run";break;default:n="all"}return new Promise((function(r,i){if(!e||!e[n])return i(new Error(`Error calling ${n} on connection.`));e[n](t.sql,t.bindings,(function(e,n){return e?i(e):(t.response=n,t.context=this,r(t))}))}))}_stream(e,t,r){if(!t.sql)throw new Error("The query is empty");const n=this;return new Promise((function(i,s){return r.on("error",s),r.on("end",i),n._query(e,t).then(e=>e.response).then(e=>e.forEach(e=>r.write(e))).catch((function(e){r.emit("error",e)})).then((function(){r.end()}))}))}processResponse(e,t){const r=e.context,{response:n,returning:i}=e;if(e.output)return e.output.call(t,n);switch(e.method){case"select":default:return n;case"first":return n[0];case"pluck":return dE(n,e.pluck);case"insert":if(i){if(n)return n;this.logger.warn("node-sqlite3 does not currently support RETURNING clause")}return[r.lastID];case"del":case"update":case"counter":return r.changes}}poolDefaults(){return Ev({min:1,max:1},super.poolDefaults())}formatter(e){return new EC(this,e)}values(e,t,r){return Array.isArray(e)?Array.isArray(e[0])?`( values ${e.map(e=>`(${this.parameterize(e,void 0,t,r)})`).join(", ")})`:`(${this.parameterize(e,void 0,t,r)})`:e instanceof Hw?`(${this.parameter(e,t,r)})`:this.parameter(e,t,r)}}Object.assign(n.prototype,{dialect:"sqlite3",driverName:"sqlite3"}),e.exports=n})),d=e((function(e,t){})),f=e((function(e,t){var r=1e3,n=6e4,i=60*n,s=24*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var a,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===l&&isFinite(e))return t.long?(a=e,(u=Math.abs(a))>=s?o(a,u,s,"day"):u>=i?o(a,u,i,"hour"):u>=n?o(a,u,n,"minute"):u>=r?o(a,u,r,"second"):a+" ms"):function(e){var t=Math.abs(e);return t>=s?Math.round(e/s)+"d":t>=i?Math.round(e/i)+"h":t>=n?Math.round(e/n)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}})),p=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=void 0;const r=m({}),n=y({}),i=E({});t.default=class{constructor(e,t,r){if(function({schema:e,opts:t,self:r},n,i){if(Array.isArray(n.keyword)?!n.keyword.includes(i):n.keyword!==i)throw new Error("ajv implementation error");const s=n.dependencies;if(null==s?void 0:s.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${i}: ${s.join(",")}`);if(n.validateSchema&&!n.validateSchema(e[i])){const e="keyword value is invalid: "+r.errorsText(n.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=n.schemaRefOrVal(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",a(this.$data,e));else if(this.schemaCode=this.schemaValue,!function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e)}(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",_a.default.errors))}result(e,t,r){this.gen.if(Vo.not(e)),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.result(e,void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(Vo._`${t} !== undefined && (${Vo.or(this.invalid$data(),e)})`)}error(e){(e?Ea.reportExtraError:Ea.reportError)(this,this.def.error)}$dataError(){Ea.reportError(this,this.def.$dataError||Ea.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');Ea.resetErrorsCount(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=Vo.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=Vo.nil,t=Vo.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:i,def:s}=this;r.if(Vo.or(Vo._`${n} === undefined`,t)),e!==Vo.nil&&r.assign(e,!0),(i.length||s.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==Vo.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:n,def:i,it:s}=this;return Vo.or(function(){if(n.length){if(!(t instanceof Vo.Name))throw new Error("ajv implementation error");const e=Array.isArray(n)?n:[n];return Vo._`${r.checkDataTypes(e,t,s.opts.strict,r.DataType.Wrong)}`}return Vo.nil}(),function(){if(i.validateSchema){const r=e.scopeValue("validate$data",{ref:i.validateSchema});return Vo._`!${r}(${t})`}return Vo.nil}())}subschema(e,t){return i.applySubschema(this.it,e,t)}mergeEvaluated(e,t){const{it:r,gen:i}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=n.mergeEvaluated.props(i,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=n.mergeEvaluated.items(i,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,()=>this.mergeEvaluated(e,Vo.Name)),!0}};const s=/^\/(?:[^~]|~0|~1)*$/,o=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function a(e,{dataLevel:t,dataNames:r,dataPathArr:i}){let a,u;if(""===e)return _a.default.rootData;if("/"===e[0]){if(!s.test(e))throw new Error("Invalid JSON-pointer: "+e);a=e,u=_a.default.rootData}else{const n=o.exec(e);if(!n)throw new Error("Invalid JSON-pointer: "+e);const s=+n[1];if(a=n[2],"#"===a){if(s>=t)throw new Error(h("property/index",s));return i[t-s]}if(s>t)throw new Error(h("data",s));if(u=r[t-s],!a)return u}let l=u;const c=a.split("/");for(const s of c)s&&(u=Vo._`${u}${Vo.getProperty(n.unescapeJsonPointer(s))}`,l=Vo._`${l} && ${u}`);return l;function h(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}t.getData=a})),m=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const r=y({});var n;function i(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(wo.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(n=t.DataType||(t.DataType={})),t.getSchemaTypes=function(e){const t=i(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=i,t.coerceAndCheckDataType=function(e,t){const{gen:r,data:i,opts:o}=e,u=function(e,t){return t?e.filter(e=>s.has(e)||"array"===t&&"array"===e):[]}(t,o.coerceTypes),c=t.length>0&&!(0===u.length&&1===t.length&&Co.schemaHasRulesForType(e,t[0]));if(c){const c=a(t,i,o.strict,n.Wrong);r.if(c,()=>{u.length?function(e,t,r){const{gen:n,data:i,opts:o}=e,u=n.let("dataType",Vo._`typeof ${i}`),c=n.let("coerced",Vo._`undefined`);"array"===o.coerceTypes&&n.if(Vo._`${u} == 'object' && Array.isArray(${i}) && ${i}.length == 1`,()=>n.assign(i,Vo._`${i}[0]`).assign(u,Vo._`typeof ${i}`).if(a(t,i,o.strict),()=>n.assign(c,i))),n.if(Vo._`${c} !== undefined`);for(const a of r)(s.has(a)||"array"===a&&"array"===o.coerceTypes)&&h(a);function h(e){switch(e){case"string":return void n.elseIf(Vo._`${u} == "number" || ${u} == "boolean"`).assign(c,Vo._`"" + ${i}`).elseIf(Vo._`${i} === null`).assign(c,Vo._`""`);case"number":return void n.elseIf(Vo._`${u} == "boolean" || ${i} === null
              || (${u} == "string" && ${i} && ${i} == +${i})`).assign(c,Vo._`+${i}`);case"integer":return void n.elseIf(Vo._`${u} === "boolean" || ${i} === null
              || (${u} === "string" && ${i} && ${i} == +${i} && !(${i} % 1))`).assign(c,Vo._`+${i}`);case"boolean":return void n.elseIf(Vo._`${i} === "false" || ${i} === 0 || ${i} === null`).assign(c,!1).elseIf(Vo._`${i} === "true" || ${i} === 1`).assign(c,!0);case"null":return n.elseIf(Vo._`${i} === "" || ${i} === 0 || ${i} === false`),void n.assign(c,null);case"array":n.elseIf(Vo._`${u} === "string" || ${u} === "number"
              || ${u} === "boolean" || ${i} === null`).assign(c,Vo._`[${i}]`)}}n.else(),l(e),n.endIf(),n.if(Vo._`${c} !== undefined`,()=>{n.assign(i,c),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(Vo._`${t} !== undefined`,()=>e.assign(Vo._`${t}[${r}]`,n))}(e,c)})}(e,t,u):l(e)})}return c};const s=new Set(["string","number","integer","boolean","null"]);function o(e,t,r,i=n.Correct){const s=i===n.Correct?Vo.operators.EQ:Vo.operators.NEQ;let o;switch(e){case"null":return Vo._`${t} ${s} null`;case"array":o=Vo._`Array.isArray(${t})`;break;case"object":o=Vo._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=a(Vo._`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=a();break;default:return Vo._`typeof ${t} ${s} ${e}`}return i===n.Correct?o:Vo.not(o);function a(e=Vo.nil){return Vo.and(Vo._`typeof ${t} == "number"`,e,r?Vo._`isFinite(${t})`:Vo.nil)}}function a(e,t,n,i){if(1===e.length)return o(e[0],t,n,i);let s;const a=r.toHash(e);if(a.array&&a.object){const e=Vo._`typeof ${t} != "object"`;s=a.null?e:Vo._`!${t} || ${e}`,delete a.null,delete a.array,delete a.object}else s=Vo.nil;a.number&&delete a.integer;for(const r in a)s=Vo.and(s,o(r,t,n,i));return s}t.checkDataType=o,t.checkDataTypes=a;const u={message:({schema:e})=>Vo.str`should be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?Vo._`{type: ${e}}`:Vo._`{type: ${t}}`};function l(e){const t=function(e){const{gen:t,data:n,schema:i}=e,s=r.schemaRefOrVal(e,i,"type");return{gen:t,keyword:"type",data:n,schema:i.type,schemaCode:s,schemaValue:s,parentSchema:i,params:{},it:e}}(e);Ea.reportError(t,u)}t.reportTypeError=l})),y=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.func=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const r=g({});function n(e,t=e.schema){const{opts:n,self:i}=e;if(!n.strict)return;if("boolean"==typeof t)return;const s=i.RULES.keywords;for(const o in t)s[o]||r.checkStrictMode(e,`unknown keyword: "${o}"`)}function i(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function s(e){return"number"==typeof e?""+e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function o(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function a({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:n}){return(i,s,o,a)=>{const u=void 0===o?s:o instanceof Vo.Name?(s instanceof Vo.Name?e(i,s,o):t(i,s,o),o):s instanceof Vo.Name?(t(i,o,s),s):r(s,o);return a!==Vo.Name||u instanceof Vo.Name?u:n(i,u)}}function u(e,t){if(!0===t)return e.var("props",!0);const r=e.var("props",Vo._`{}`);return void 0!==t&&l(e,r,t),r}function l(e,t,r){Object.keys(r).forEach(r=>e.assign(Vo._`${t}${Vo.getProperty(r)}`,!0))}t.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(n(e,t),!i(t,e.self.RULES.all))},t.checkUnknownRules=n,t.schemaHasRules=i,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},t.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,n,i){if(!i){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return Vo._`${r}`}return Vo._`${e}${t}${Vo.getProperty(n)}`},t.unescapeFragment=function(e){return o(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(s(e))},t.escapeJsonPointer=s,t.unescapeJsonPointer=o,t.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},t.mergeEvaluated={props:a({mergeNames:(e,t,r)=>e.if(Vo._`${r} !== true && ${t} !== undefined`,()=>{e.if(Vo._`${t} === true`,()=>e.assign(r,!0),()=>e.assign(r,Vo._`${r} || {}`).code(Vo._`Object.assign(${r}, ${t})`))}),mergeToName:(e,t,r)=>e.if(Vo._`${r} !== true`,()=>{!0===t?e.assign(r,!0):(e.assign(r,Vo._`${r} || {}`),l(e,r,t))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:u}),items:a({mergeNames:(e,t,r)=>e.if(Vo._`${r} !== true && ${t} !== undefined`,()=>e.assign(r,Vo._`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`)),mergeToName:(e,t,r)=>e.if(Vo._`${r} !== true`,()=>e.assign(r,!0===t||Vo._`${r} > ${t} ? ${r} : ${t}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=u,t.setEvaluated=l,t.func=function(e,t){return e.scopeValue("func",{ref:t,code:t.code})}})),g=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.schemaCxtHasRules=t.subschemaCode=t.validateFunctionCode=void 0;const r=m({}),n=b({}),i=v({}),s=y({});function o({gen:e,validateName:t,schema:r,schemaEnv:n,opts:i},s){i.code.es5?e.func(t,Vo._`${_a.default.data}, ${_a.default.valCxt}`,n.$async,()=>{e.code(Vo._`"use strict"; ${a(r,i)}`),function(e,t){e.if(_a.default.valCxt,()=>{e.var(_a.default.dataPath,Vo._`${_a.default.valCxt}.${_a.default.dataPath}`),e.var(_a.default.parentData,Vo._`${_a.default.valCxt}.${_a.default.parentData}`),e.var(_a.default.parentDataProperty,Vo._`${_a.default.valCxt}.${_a.default.parentDataProperty}`),e.var(_a.default.rootData,Vo._`${_a.default.valCxt}.${_a.default.rootData}`),t.dynamicRef&&e.var(_a.default.dynamicAnchors,Vo._`${_a.default.valCxt}.${_a.default.dynamicAnchors}`)},()=>{e.var(_a.default.dataPath,Vo._`""`),e.var(_a.default.parentData,Vo._`undefined`),e.var(_a.default.parentDataProperty,Vo._`undefined`),e.var(_a.default.rootData,_a.default.data),t.dynamicRef&&e.var(_a.default.dynamicAnchors,Vo._`{}`)})}(e,i),e.code(s)}):e.func(t,Vo._`${_a.default.data}, ${function(e){return Vo._`{${_a.default.dataPath}="", ${_a.default.parentData}, ${_a.default.parentDataProperty}, ${_a.default.rootData}=${_a.default.data}${e.dynamicRef?Vo._`, ${_a.default.dynamicAnchors}={}`:Vo.nil}}={}`}(i)}`,n.$async,()=>e.code(a(r,i)).code(s))}function a(e,t){return"object"==typeof e&&e.$id&&(t.code.source||t.code.process)?Vo._`/*# sourceURL=${e.$id} */`:Vo.nil}function u({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function l(e){return"boolean"!=typeof e.schema}function c(e){s.checkUnknownRules(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:i}=e;t.$ref&&n.ignoreKeywordsWithRef&&s.schemaHasRulesButRef(t,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function h(e,t){if(e.opts.jtd)return n.schemaKeywords(e,[],!1,t);const i=r.getSchemaTypes(e.schema),s=r.coerceAndCheckDataType(e,i);n.schemaKeywords(e,i,!s,t)}function d({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:i}){const s=r.$comment;if(!0===i.$comment)e.code(Vo._`${_a.default.self}.logger.log(${s})`);else if("function"==typeof i.$comment){const r=Vo.str`${n}/$comment`,i=e.scopeValue("root",{ref:t.root});e.code(Vo._`${_a.default.self}.opts.$comment(${s}, ${r}, ${i}.schema)`)}}function f(e,t,r=e.opts.strict){if(r){if(t="strict mode: "+t,!0===r)throw new Error(t);e.self.logger.warn(t)}}t.validateFunctionCode=function(e){l(e)&&(c(e),u(e))?function(e){const{schema:t,opts:r,gen:n}=e;o(e,()=>{r.$comment&&t.$comment&&d(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strict&&f(e,"default is ignored in the schema root")}(e),n.let(_a.default.vErrors,null),n.let(_a.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",Vo._`${r}.evaluated`),t.if(Vo._`${e.evaluated}.dynamicProps`,()=>t.assign(Vo._`${e.evaluated}.props`,Vo._`undefined`)),t.if(Vo._`${e.evaluated}.dynamicItems`,()=>t.assign(Vo._`${e.evaluated}.items`,Vo._`undefined`))}(e),h(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:i,opts:s}=e;r.$async?t.if(Vo._`${_a.default.errors} === 0`,()=>t.return(_a.default.data),()=>t.throw(Vo._`new ${i}(${_a.default.vErrors})`)):(t.assign(Vo._`${n}.errors`,_a.default.vErrors),s.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof Vo.Name&&e.assign(Vo._`${t}.props`,r),n instanceof Vo.Name&&e.assign(Vo._`${t}.items`,n)}(e),t.return(Vo._`${_a.default.errors} === 0`))}(e)})}(e):o(e,()=>xa.topBoolOrEmptySchema(e))},t.subschemaCode=function(e,t){l(e)&&(c(e),u(e))?function(e,t){const{schema:r,gen:n,opts:s}=e;s.$comment&&r.$comment&&d(e),function(e){e.schema.$id&&(e.baseId=i.resolveUrl(e.baseId,e.schema.$id))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=n.const("_errs",_a.default.errors);h(e,o),n.var(t,Vo._`${o} === ${_a.default.errors}`)}(e,t):xa.boolOrEmptySchema(e,t)},t.schemaCxtHasRules=u,t.checkStrictMode=f})),v=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const r=y({}),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!s(e):!!t&&function e(t){let i=0;for(const s in t){if("$ref"===s)return 1/0;if(i++,!n.has(s)&&("object"==typeof t[s]&&r.eachItem(t[s],t=>i+=e(t)),i===1/0))return 1/0}return i}(e)<=t)};const i=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function s(e){for(const t in e){if(i.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(s))return!0;if("object"==typeof r&&s(r))return!0}return!1}function o(e="",t){return!1!==t&&(e=l(e)),a(Ma.parse(e))}function a(e){return Ma.serialize(e).split("#")[0]+"#"}t.getFullPath=o,t._getFullPath=a;const u=/#\/?$/;function l(e){return e?e.replace(u,""):""}t.normalizeId=l,t.resolveUrl=function(e,t){return t=l(t),Ma.resolve(e,t)};const c=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e){if("boolean"==typeof e)return{};const t=l(e.$id),r={"":t},n=o(t,!1),i={},s=new Set;return Ia(e,{allKeys:!0},(e,t,o,h)=>{if(void 0===h)return;const d=n+t;let f=r[h];function p(t){if(t=l(f?Ma.resolve(f,t):t),s.has(t))throw u(t);s.add(t);let r=this.refs[t];return"string"==typeof r&&(r=this.refs[r]),"object"==typeof r?a(e,r.schema,t):t!==l(d)&&("#"===t[0]?(a(e,i[t],t),i[t]=e):this.refs[t]=d),t}function m(e){if("string"==typeof e){if(!c.test(e))throw new Error(`invalid anchor "${e}"`);p.call(this,"#"+e)}}"string"==typeof e.$id&&(f=p.call(this,e.$id)),m.call(this,e.$anchor),m.call(this,e.$dynamicAnchor),r[t]=f}),i;function a(e,t,r){if(void 0!==t&&!ja(e,t))throw u(r)}function u(e){return new Error(`reference "${e}" resolves to more than one schema`)}}})),b=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schemaKeywords=void 0;const r=m({}),n=C({}),i=_({}),s=y({}),o=g({});function a(e,t){const{gen:r,schema:s,opts:{useDefaults:o}}=e;o&&n.assignDefaults(e,t.type),r.block(()=>{for(const r of t.rules)Co.shouldUseRule(s,r)&&i.keywordCode(e,r.keyword,r.definition,t.type)})}function u(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function l(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,o.checkStrictMode(e,t,e.opts.strictTypes)}t.schemaKeywords=function(e,t,n,o){const{gen:c,schema:h,data:d,allErrors:f,opts:p,self:m}=e,{RULES:y}=m;function g(i){Co.shouldUseGroup(h,i)&&(i.type?(c.if(r.checkDataType(i.type,d,p.strict)),a(e,i),1===t.length&&t[0]===i.type&&n&&(c.else(),r.reportTypeError(e)),c.endIf()):a(e,i),f||c.if(Vo._`${_a.default.errors} === ${o||0}`))}!h.$ref||!p.ignoreKeywordsWithRef&&s.schemaHasRulesButRef(h,y)?(p.jtd||function(e,t){!e.schemaEnv.meta&&e.opts.strictTypes&&(function(e,t){t.length&&(e.dataTypes.length?(t.forEach(t=>{u(e.dataTypes,t)||l(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(e=>u(t,e))):e.dataTypes=t)}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&l(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){const r=e.self.RULES.all;for(const n in r){const i=r[n];if("object"==typeof i&&Co.shouldUseRule(e.schema,i)){const{type:r}=i.definition;r.length&&!r.some(e=>{return n=e,(r=t).includes(n)||"number"===n&&r.includes("integer");var r,n})&&l(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),c.block(()=>{for(const e of y.rules)g(e);g(y.post)})):c.block(()=>i.keywordCode(e,"$ref",y.all.$ref.definition))}})),_=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keywordCode=void 0;const r=p({}),n=w({});function i(e,t){var r;const{gen:i,keyword:a,schema:u,parentSchema:l,$data:c,it:h}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(h,t);const d=!c&&t.compile?t.compile.call(h.self,u,l,h):t.validate,f=o(i,a,d),p=i.let("valid");function m(r=(t.async?Vo._`await `:Vo.nil)){const s=h.opts.passContext?_a.default.this:_a.default.self,o=!("compile"in t&&!c||!1===t.schema);i.assign(p,Vo._`${r}${n.callValidateCode(e,f,s,o)}`,t.modifying)}function y(e){var r;i.if(Vo.not(null!==(r=t.valid)&&void 0!==r?r:p),e)}e.block$data(p,(function(){if(!1===t.errors)m(),t.modifying&&s(e),y(()=>e.error());else{const r=t.async?function(){const e=i.let("ruleErrs",null);return i.try(()=>m(Vo._`await `),t=>i.assign(p,!1).if(Vo._`${t} instanceof ${h.ValidationError}`,()=>i.assign(e,Vo._`${t}.errors`),()=>i.throw(t))),e}():function(){const e=Vo._`${f}.errors`;return i.assign(e,null),m(Vo.nil),e}();t.modifying&&s(e),y(()=>function(e,t){const{gen:r}=e;r.if(Vo._`Array.isArray(${t})`,()=>{r.assign(_a.default.vErrors,Vo._`${_a.default.vErrors} === null ? ${t} : ${_a.default.vErrors}.concat(${t})`).assign(_a.default.errors,Vo._`${_a.default.vErrors}.length`),Ea.extendErrors(e)},()=>e.error())}(e,r))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:p)}function s(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,()=>t.assign(r,Vo._`${n.parentData}[${n.parentDataProperty}]`))}function o(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:Vo.stringify(r)})}t.keywordCode=function(e,t,n,s){const a=new r.default(e,n,t);"code"in n?n.code(a,s):a.$data&&n.validate?i(a,n):"macro"in n?function(e,t){const{gen:r,keyword:n,schema:i,parentSchema:s,it:a}=e,u=t.macro.call(a.self,i,s,a),l=o(r,n,u);!1!==a.opts.validateSchema&&a.self.validateSchema(u,!0);const c=r.name("valid");e.subschema({schema:u,schemaPath:Vo.nil,errSchemaPath:`${a.errSchemaPath}/${n}`,topSchemaRef:l,compositeRule:!0},c),e.pass(c,()=>e.error(!0))}(a,n):(n.compile||n.validate)&&i(a,n)}})),w=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const r=y({}),n=E({});function i(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:Vo._`Object.prototype.hasOwnProperty`})}function s(e,t,r){return Vo._`${i(e)}.call(${t}, ${r})`}function o(e,t,r,n){const i=Vo._`${t}${Vo.getProperty(r)} === undefined`;return n?Vo.or(i,Vo.not(s(e,t,r))):i}function a(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}t.checkReportMissingProp=function(e,t){const{gen:r,data:n,it:i}=e;r.if(o(r,n,t,i.opts.ownProperties),()=>{e.setParams({missingProperty:Vo._`${t}`},!0),e.error()})},t.checkMissingProp=function({gen:e,data:t,it:{opts:r}},n,i){return Vo.or(...n.map(n=>Vo.and(o(e,t,n,r.ownProperties),Vo._`${i} = ${n}`)))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.hasPropFunc=i,t.isOwnProperty=s,t.propertyInData=function(e,t,r,n){const i=Vo._`${t}${Vo.getProperty(r)} !== undefined`;return n?Vo._`${i} && ${s(e,t,r)}`:i},t.noPropertyInData=o,t.allSchemaProperties=a,t.schemaProperties=function(e,t){return a(t).filter(n=>!r.alwaysValidSchema(e,t[n]))},t.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:i,errorPath:s},it:o},a,u,l){const c=l?Vo._`${e}, ${t}, ${n}${i}`:t,h=[[_a.default.dataPath,Vo.strConcat(_a.default.dataPath,s)],[_a.default.parentData,o.parentData],[_a.default.parentDataProperty,o.parentDataProperty],[_a.default.rootData,_a.default.rootData]];o.opts.dynamicRef&&h.push([_a.default.dynamicAnchors,_a.default.dynamicAnchors]);const d=Vo._`${c}, ${r.object(...h)}`;return u!==Vo.nil?Vo._`${a}.call(${u}, ${d})`:Vo._`${a}(${d})`},t.usePattern=function(e,t){return e.scopeValue("pattern",{key:t,ref:new RegExp(t,"u"),code:Vo._`new RegExp(${t}, "u")`})},t.validateArray=function(e){const{gen:t,data:r,keyword:i,it:s}=e,o=t.name("valid");if(s.allErrors){const e=t.let("valid",!0);return a(()=>t.assign(e,!1)),e}return t.var(o,!0),a(()=>t.break()),o;function a(s){const a=t.const("len",Vo._`${r}.length`);t.forRange("i",0,a,r=>{e.subschema({keyword:i,dataProp:r,dataPropType:n.Type.Num},o),t.if(Vo.not(o),s)})}},t.validateUnion=function(e){const{gen:t,schema:n,keyword:i,it:s}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(e=>r.alwaysValidSchema(s,e))&&!s.opts.unevaluated)return;const o=t.let("valid",!1),a=t.name("_valid");t.block(()=>n.forEach((r,n)=>{const s=e.subschema({keyword:i,schemaProp:n,compositeRule:!0},a);t.assign(o,Vo._`${o} || ${a}`),e.mergeValidEvaluated(s,a)||t.if(Vo.not(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}})),E=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applySubschema=t.Type=void 0;const r=g({}),n=y({});var i;!function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(i=t.Type||(t.Type={})),t.applySubschema=function(e,t,s){const o=function(e,{keyword:t,schemaProp:r,schema:i,schemaPath:s,errSchemaPath:o,topSchemaRef:a}){if(void 0!==t&&void 0!==i)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const i=e.schema[t];return void 0===r?{schema:i,schemaPath:Vo._`${e.schemaPath}${Vo.getProperty(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:i[r],schemaPath:Vo._`${e.schemaPath}${Vo.getProperty(t)}${Vo.getProperty(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${n.escapeFragment(r)}`}}if(void 0!==i){if(void 0===s||void 0===o||void 0===a)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:i,schemaPath:s,topSchemaRef:a,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}(e,t);!function(e,t,{dataProp:r,dataPropType:s,data:o,dataTypes:a,propertyName:u}){if(void 0!==o&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:l}=t;if(void 0!==r){const{errorPath:o,dataPathArr:a,opts:u}=t;c(l.let("data",Vo._`${t.data}${Vo.getProperty(r)}`,!0)),e.errorPath=Vo.str`${o}${function(e,t,r){if(e instanceof Vo.Name){const n=t===i.Num;return r?n?Vo._`"[" + ${e} + "]"`:Vo._`"['" + ${e} + "']"`:n?Vo._`"/" + ${e}`:Vo._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?Vo.getProperty(e).toString():"/"+n.escapeJsonPointer(e)}(r,s,u.jsPropertySyntax)}`,e.parentDataProperty=Vo._`${r}`,e.dataPathArr=[...a,e.parentDataProperty]}function c(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}void 0!==o&&(c(o instanceof Vo.Name?o:l.let("data",o,!0)),void 0!==u&&(e.propertyName=u)),a&&(e.dataTypes=a)}(o,e,t),function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:i,allErrors:s}){void 0!==n&&(e.compositeRule=n),void 0!==i&&(e.createErrors=i),void 0!==s&&(e.allErrors=s),e.jtdDiscriminator=t,e.jtdMetadata=r}(o,t);const a={...e,...o,items:void 0,props:void 0};return r.subschemaCode(a,s),a}})),C=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const r=g({});function n(e,t,n){const{gen:i,compositeRule:s,data:o,opts:a}=e;if(void 0===n)return;const u=Vo._`${o}${Vo.getProperty(t)}`;if(s)return void r.checkStrictMode(e,"default is ignored for: "+u);let l=Vo._`${u} === undefined`;"empty"===a.useDefaults&&(l=Vo._`${l} || ${u} === null || ${u} === ""`),i.if(l,Vo._`${u} = ${Vo.stringify(n)}`)}t.assignDefaults=function(e,t){const{properties:r,items:i}=e.schema;if("object"===t&&r)for(const s in r)n(e,s,r[s].default);else"array"===t&&Array.isArray(i)&&i.forEach((t,r)=>n(e,r,t.default))}})),T=e((function(e,t){(function(t){e.exports=h;var r=(Vs.Minimatch,to),n=require("events").EventEmitter,i=require("path"),s=require("path").isAbsolute,o=N({}),a=ro.setopts,u=ro.ownProp,l=(require("util"),ro.childrenIgnored),c=ro.isIgnored;function h(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return o(e,t)}return new f(e,t,r)}h.sync=o;var d=h.GlobSync=o.GlobSync;function f(e,t,r){if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new d(e,t)}if(!(this instanceof f))return new f(e,t,r);a(this,e,t),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=io(r),this.on("error",r),this.on("end",(function(e){r(null,e)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return o();for(var s=0;s<n;s++)this._process(this.minimatch.set[s],s,!1,o);function o(){--i._processing,i._processing<=0&&i._finish()}}h.glob=h,h.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}({},t);r.noprocess=!0;var n=new f(e,r).minimatch.set;if(!e)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},h.Glob=f,r(f,n),f.prototype._finish=function(){if(!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();ro.finish(this),this.emit("end",this.found)}},f.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--e&&t._finish()}},f.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),i=this,s=n.length;if(0===s)return t();var o=this.matches[e]=Object.create(null);n.forEach((function(r,n){r=i._makeAbs(r),Ts.realpath(r,i.realpathCache,(function(n,a){n?"stat"===n.syscall?o[r]=!0:i.emit("error",n):o[a]=!0,0==--s&&(i.matches[e]=o,t())}))}))},f.prototype._mark=function(e){return ro.mark(this,e)},f.prototype._makeAbs=function(e){return ro.makeAbs(this,e)},f.prototype.abort=function(){this.aborted=!0,this.emit("abort")},f.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},f.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);for(this._processQueue.length=0,t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},f.prototype._process=function(e,t,r,n){if(!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,r,n]);else{for(var i,o=0;"string"==typeof e[o];)o++;switch(o){case e.length:return void this._processSimple(e.join("/"),t,n);case 0:i=null;break;default:i=e.slice(0,o).join("/")}var a,u=e.slice(o);null===i?a=".":s(i)||s(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(i&&s(i)||(i="/"+i),a=i):a=i;var c=this._makeAbs(a);if(l(this,a))return n();u[0]===Vs.GLOBSTAR?this._processGlobStar(i,a,c,u,t,r,n):this._processReaddir(i,a,c,u,t,r,n)}},f.prototype._processReaddir=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,(function(u,l){return a._processReaddir2(e,t,r,n,i,s,l,o)}))},f.prototype._processReaddir2=function(e,t,r,n,s,o,a,u){if(!a)return u();for(var l=n[0],c=!!this.minimatch.negate,h=l._glob,d=this.dot||"."===h.charAt(0),f=[],p=0;p<a.length;p++)("."!==(y=a[p]).charAt(0)||d)&&(c&&!e?!y.match(l):y.match(l))&&f.push(y);var m=f.length;if(0===m)return u();if(1===n.length&&!this.mark&&!this.stat){for(this.matches[s]||(this.matches[s]=Object.create(null)),p=0;p<m;p++){var y=f[p];e&&(y="/"!==e?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=i.join(this.root,y)),this._emitMatch(s,y)}return u()}for(n.shift(),p=0;p<m;p++)y=f[p],e&&(y="/"!==e?e+"/"+y:e+y),this._process([y].concat(n),s,o,u);u()},f.prototype._emitMatch=function(e,t){if(!this.aborted&&!c(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var r=s(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}},f.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,n=ao("lstat\0"+e,(function(n,i){if(n&&"ENOENT"===n.code)return t();var s=i&&i.isSymbolicLink();r.symlinks[e]=s,s||!i||i.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())}));n&&r.fs.lstat(e,n)}},f.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=ao("readdir\0"+e+"\0"+t,r))){if(t&&!u(this.symlinks,e))return this._readdirInGlobStar(e,r);if(u(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}this.fs.readdir(e,function(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}(this,e,r))}},f.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}},f.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},f.prototype._processGlobStar=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,(function(u,l){a._processGlobStar2(e,t,r,n,i,s,l,o)}))},f.prototype._processGlobStar2=function(e,t,r,n,i,s,o,a){if(!o)return a();var u=n.slice(1),l=e?[e]:[],c=l.concat(u);this._process(c,i,!1,a);var h=this.symlinks[r],d=o.length;if(h&&s)return a();for(var f=0;f<d;f++)if("."!==o[f].charAt(0)||this.dot){var p=l.concat(o[f],u);this._process(p,i,!0,a);var m=l.concat(o[f],n);this._process(m,i,!0,a)}a()},f.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,(function(i,s){n._processSimple2(e,t,i,s,r)}))},f.prototype._processSimple2=function(e,r,n,o,a){if(this.matches[r]||(this.matches[r]=Object.create(null)),!o)return a();if(e&&s(e)&&!this.nomount){var u=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=i.join(this.root,e):(e=i.resolve(this.root,e),u&&(e+="/"))}"win32"===t.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(r,e),a()},f.prototype._stat=function(e,t){var r=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&u(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return t(null,i);if(n&&"FILE"===i)return t()}var s=this.statCache[r];if(void 0!==s){if(!1===s)return t(null,s);var o=s.isDirectory()?"DIR":"FILE";return n&&"FILE"===o?t():t(null,o,s)}var a=this,l=ao("stat\0"+r,(function(n,i){if(i&&i.isSymbolicLink())return a.fs.stat(r,(function(n,s){n?a._stat2(e,r,null,i,t):a._stat2(e,r,n,s,t)}));a._stat2(e,r,n,i,t)}));l&&a.fs.lstat(r,l)},f.prototype._stat2=function(e,t,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,i();var s="/"===e.slice(-1);if(this.statCache[t]=n,"/"===t.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,s&&"FILE"===o?i():i(null,o,n)}}).call(this,require("_process"))})),N=e((function(e,t){(function(t){e.exports=u,u.GlobSync=l;var r=(Vs.Minimatch,T({}).Glob,require("util"),require("path")),n=require("path").isAbsolute,i=ro.setopts,s=ro.ownProp,o=ro.childrenIgnored,a=ro.isIgnored;function u(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new l(e,t).found}function l(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof l))return new l(e,t);if(i(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}l.prototype._finish=function(){if(this.realpath){var e=this;this.matches.forEach((function(t,r){var n=e.matches[r]=Object.create(null);for(var i in t)try{i=e._makeAbs(i),n[Ts.realpathSync(i,e.realpathCache)]=!0}catch(s){if("stat"!==s.syscall)throw s;n[e._makeAbs(i)]=!0}}))}ro.finish(this)},l.prototype._process=function(e,t,r){for(var i,s=0;"string"==typeof e[s];)s++;switch(s){case e.length:return void this._processSimple(e.join("/"),t);case 0:i=null;break;default:i=e.slice(0,s).join("/")}var a,u=e.slice(s);null===i?a=".":n(i)||n(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(i&&n(i)||(i="/"+i),a=i):a=i;var l=this._makeAbs(a);o(this,a)||(u[0]===Vs.GLOBSTAR?this._processGlobStar(i,a,l,u,t,r):this._processReaddir(i,a,l,u,t,r))},l.prototype._processReaddir=function(e,t,n,i,s,o){var a=this._readdir(n,o);if(a){for(var u=i[0],l=!!this.minimatch.negate,c=u._glob,h=this.dot||"."===c.charAt(0),d=[],f=0;f<a.length;f++)("."!==(y=a[f]).charAt(0)||h)&&(l&&!e?!y.match(u):y.match(u))&&d.push(y);var p=d.length;if(0!==p)if(1!==i.length||this.mark||this.stat)for(i.shift(),f=0;f<p;f++){var m;y=d[f],m=e?[e,y]:[y],this._process(m.concat(i),s,o)}else{this.matches[s]||(this.matches[s]=Object.create(null));for(f=0;f<p;f++){var y=d[f];e&&(y="/"!==e.slice(-1)?e+"/"+y:e+y),"/"!==y.charAt(0)||this.nomount||(y=r.join(this.root,y)),this._emitMatch(s,y)}}}},l.prototype._emitMatch=function(e,t){if(!a(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},l.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=this.fs.lstatSync(e)}catch(i){if("ENOENT"===i.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[e]=n,n||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},l.prototype._readdir=function(e,t){if(t&&!s(this.symlinks,e))return this._readdirInGlobStar(e);if(s(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(n){return this._readdirError(e,n),null}},l.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t},l.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},l.prototype._processGlobStar=function(e,t,r,n,i,s){var o=this._readdir(r,s);if(o){var a=n.slice(1),u=e?[e]:[],l=u.concat(a);this._process(l,i,!1);var c=o.length;if(!this.symlinks[r]||!s)for(var h=0;h<c;h++)if("."!==o[h].charAt(0)||this.dot){var d=u.concat(o[h],a);this._process(d,i,!0);var f=u.concat(o[h],n);this._process(f,i,!0)}}},l.prototype._processSimple=function(e,i){var s=this._stat(e);if(this.matches[i]||(this.matches[i]=Object.create(null)),s){if(e&&n(e)&&!this.nomount){var o=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=r.join(this.root,e):(e=r.resolve(this.root,e),o&&(e+="/"))}"win32"===t.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(i,e)}},l.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&s(this.cache,t)){var n=this.cache[t];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var i=this.statCache[t];if(!i){var o;try{o=this.fs.lstatSync(t)}catch(a){if(a&&("ENOENT"===a.code||"ENOTDIR"===a.code))return this.statCache[t]=!1,!1}if(o&&o.isSymbolicLink())try{i=this.fs.statSync(t)}catch(a){i=o}else i=o}return this.statCache[t]=i,n=!0,i&&(n=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||n,(!r||"FILE"!==n)&&n},l.prototype._mark=function(e){return ro.mark(this,e)},l.prototype._makeAbs=function(e){return ro.makeAbs(this,e)}}).call(this,require("_process"))})),k=class extends Error{constructor(e,t){super(e+(t?" caused by: "+t:"")),this.error=t,this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}},O={ConnectionRefused:class extends k{constructor(e){super("Connection refused to Persistr Server"+(e?" at "+e:""))}},Fetch:class extends k{constructor(e){super(e)}},InternalError:class extends k{constructor(e){super(e?"Internal error\nWhat went wrong:\n"+e.message:"Internal error")}},InvalidBearerToken:class extends k{constructor({bearer:e}){super("Invalid bearer token: "+e)}},InvalidCredentials:class extends k{constructor(){super("Invalid credentials")}},PersistrError:k,StatusCode:class extends k{constructor(e,t,r,n){let i=n;try{const e=JSON.parse(n);e&&e.error&&(i=""+e.error)}catch(error){}super(i),this.url=e,this.statusCode=t,this.statusText=r,this.responseText=n}},UnexpectedError:class extends k{constructor(e){super(e)}},UnsupportedFilter:class extends k{constructor({filter:e,on:t}){super(`Unsupported filter '${e}' on ${t}`)}},handle:function(e){return e().catch(e=>{if(e instanceof O.PersistrError)throw e;if(e&&e.error&&"ECONNREFUSED"===e.error.code)throw new O.ConnectionRefused;throw e})}},S=O;(function(e){!function(){"use strict";(function(t){return(t instanceof e?t:e.from(t.toString(),"binary")).toString("base64")})}()}).call(this,require("buffer").Buffer);var x={},$="undefined"!=typeof self?self:this,A=function(){function e(){this.fetch=!1,this.DOMException=$.DOMException}return e.prototype=$,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(CT){return!1}}(),s="FormData"in e,o="ArrayBuffer"in e;if(o)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function m(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():o&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,r,n=f(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=p(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=c(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=c(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),h(e)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var r,n,i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),v.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];w.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(T){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function C(e,r){return new Promise((function(n,s){var o=new b(e,r);if(o.signal&&o.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new w(i,r))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new t.DOMException("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",u)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}C.polyfill=!0,e.fetch||(e.fetch=C,e.Headers=d,e.Request=b,e.Response=w),t.Headers=d,t.Request=b,t.Response=w,t.fetch=C,Object.defineProperty(t,"__esModule",{value:!0})}({})}(A),A.fetch.ponyfill=!0,delete A.fetch.polyfill;var j=A;(x=j.fetch).default=j.fetch,x.fetch=j.fetch,x.Headers=j.Headers,x.Request=j.Request,x.Response=j.Response,x=x;var I,R,P={exports:{}};I=this,R=function(){"use strict";function e(e){return Number.isInteger(e)&&e>=0}function t(e){this.name="ArgumentError",this.message=e}return function(r,n){if(n=n||{},"function"!=typeof r)throw new t("fetch must be a function");if("object"!=typeof n)throw new t("defaults must be an object");if(void 0!==n.retries&&!e(n.retries))throw new t("retries must be a positive integer");if(void 0!==n.retryDelay&&!e(n.retryDelay)&&"function"!=typeof n.retryDelay)throw new t("retryDelay must be a positive integer or a function returning a positive integer");if(void 0!==n.retryOn&&!Array.isArray(n.retryOn)&&"function"!=typeof n.retryOn)throw new t("retryOn property expects an array or function");return n=Object.assign({retries:3,retryDelay:1e3,retryOn:[]},n),function(i,s){var o=n.retries,a=n.retryDelay,u=n.retryOn;if(s&&void 0!==s.retries){if(!e(s.retries))throw new t("retries must be a positive integer");o=s.retries}if(s&&void 0!==s.retryDelay){if(!e(s.retryDelay)&&"function"!=typeof s.retryDelay)throw new t("retryDelay must be a positive integer or a function returning a positive integer");a=s.retryDelay}if(s&&s.retryOn){if(!Array.isArray(s.retryOn)&&"function"!=typeof s.retryOn)throw new t("retryOn property expects an array or function");u=s.retryOn}return new Promise((function(e,t){var n=function(n){var a="undefined"!=typeof Request&&i instanceof Request?i.clone():i;r(a,s).then((function(r){if(Array.isArray(u)&&-1===u.indexOf(r.status))e(r);else if("function"==typeof u)try{return Promise.resolve(u(n,null,r)).then((function(t){t?l(n,null,r):e(r)})).catch(t)}catch(error){t(error)}else n<o?l(n,null,r):e(r)})).catch((function(e){if("function"==typeof u)try{Promise.resolve(u(n,e,null)).then((function(r){r?l(n,e,null):t(e)})).catch((function(e){t(e)}))}catch(e){t(e)}else n<o?l(n,e,null):t(e)}))};function l(e,t,r){var i="function"==typeof a?a(e,t,r):a;setTimeout((function(){n(++e)}),i)}n(0)}))}}},"object"==typeof P.exports?P.exports=R():"function"==typeof define&&define.amd?define(R):(I="undefined"!=typeof globalThis?globalThis:I||self).fetchRetry=R();(P=P.exports)(x,{retryOn:[503],retries:3,retryDelay:function(e,t,r){return Math.pow(7,e+1)}});var M={};function L(){this.jobs=Array.prototype.slice.call(arguments),this.running=!1}L.prototype={add:function(e){return e&&(arguments.length>1?this.jobs=this.jobs.concat(Array.prototype.slice.call(arguments)):this.jobs.push(e)),this},run:function(e){return this.add(e),this.running||this.start(),this},start:function(){this.running=!0,this.next(!1)},success:function(){this.next(!1)},fail:function(e){e=e||"Job failed",this.next(e)},next:function(e){if(this.jobs.length){var t=this.jobs.shift();try{t(e,this)}catch(CT){this.next(CT)}}else this.running=!1}},M=L;var q={};(function(e,t){var r=require("url").parse,n=require("events"),i=require("https"),s=require("http"),o=require("util"),a=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],u=[239,187,191];function l(n,o){var f=l.CONNECTING,p=o&&o.headers,m=!1;Object.defineProperty(this,"readyState",{get:function(){return f}}),Object.defineProperty(this,"url",{get:function(){return n}});var y,g=this;function v(e){f!==l.CLOSED&&(f=l.CONNECTING,N("error",new c("error",{message:e})),C&&(n=C,C=null,m=!1),setTimeout((function(){f!==l.CONNECTING||g.connectionInProgress||(g.connectionInProgress=!0,T())}),g.reconnectInterval))}g.reconnectInterval=1e3,g.connectionInProgress=!1;var b="";p&&p["Last-Event-ID"]&&(b=p["Last-Event-ID"],delete p["Last-Event-ID"]);var _=!1,w="",E="",C=null;function T(){var h=r(n),w="https:"===h.protocol;if(h.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},b&&(h.headers["Last-Event-ID"]=b),p){var E=m?function(e){var t={};for(var r in e)/^(cookie|authorization)$/i.test(r)||(t[r]=e[r]);return t}(p):p;for(var O in E){var S=E[O];S&&(h.headers[O]=S)}}if(h.rejectUnauthorized=!(o&&!o.rejectUnauthorized),o&&void 0!==o.createConnection&&(h.createConnection=o.createConnection),o&&o.proxy){var x=r(o.proxy);w="https:"===x.protocol,h.protocol=w?"https:":"http:",h.path=n,h.headers.Host=h.host,h.hostname=x.hostname,h.host=x.host,h.port=x.port}if(o&&o.https)for(var $ in o.https)if(-1!==a.indexOf($)){var A=o.https[$];void 0!==A&&(h[$]=A)}o&&void 0!==o.withCredentials&&(h.withCredentials=o.withCredentials),(y=(w?i:s).request(h,(function(r){if(g.connectionInProgress=!1,500===r.statusCode||502===r.statusCode||503===r.statusCode||504===r.statusCode)return N("error",new c("error",{status:r.statusCode,message:r.statusMessage})),void v();if(301===r.statusCode||302===r.statusCode||307===r.statusCode){var i=r.headers.location;if(!i)return void N("error",new c("error",{status:r.statusCode,message:r.statusMessage}));var s=d(n),o=d(i);return m=s!==o,307===r.statusCode&&(C=n),n=i,void e.nextTick(T)}if(200!==r.statusCode)return N("error",new c("error",{status:r.statusCode,message:r.statusMessage})),g.close();f=l.OPEN,r.on("close",(function(){r.removeAllListeners("close"),r.removeAllListeners("end"),v()})),r.on("end",(function(){r.removeAllListeners("close"),r.removeAllListeners("end"),v()})),N("open",new c("open"));var a,h=!0,p=0,y=-1;r.on("data",(function(e){a=a?t.concat([a,e]):e,h&&function(e){return u.every((function(t,r){return e[r]===t}))}(a)&&(a=a.slice(u.length)),h=!1;for(var r=0,n=a.length;r<n;){_&&(10===a[r]&&++r,_=!1);for(var i,s=-1,o=y,l=p;s<0&&l<n;++l)58===(i=a[l])?o<0&&(o=l-r):13===i?(_=!0,s=l-r):10===i&&(s=l-r);if(s<0){p=n-r,y=o;break}p=0,y=-1,k(a,r,o,s),r+=s+1}r===n?a=void 0:r>0&&(a=a.slice(r))}))}))).on("error",(function(e){g.connectionInProgress=!1,v(e.message)})),y.setNoDelay&&y.setNoDelay(!0),y.end()}function N(){g.listeners(arguments[0]).length>0&&g.emit.apply(g,arguments)}function k(e,t,r,i){if(0===i){if(w.length>0){var s=E||"message";N(s,new h(s,{data:w.slice(0,-1),lastEventId:b,origin:d(n)})),w=""}E=void 0}else if(r>0){var o,a=r<0,u=e.slice(t,t+(a?i:r)).toString();t+=o=a?i:32!==e[t+r+1]?r+1:r+2;var l=i-o,c=e.slice(t,t+l).toString();if("data"===u)w+=c+"\n";else if("event"===u)E=c;else if("id"===u)b=c;else if("retry"===u){var f=parseInt(c,10);Number.isNaN(f)||(g.reconnectInterval=f)}}}T(),this._close=function(){f!==l.CLOSED&&(f=l.CLOSED,y.abort&&y.abort(),y.xhr&&y.xhr.abort&&y.xhr.abort())}}function c(e,t){if(Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)for(var r in t)t.hasOwnProperty(r)&&Object.defineProperty(this,r,{writable:!1,value:t[r],enumerable:!0})}function h(e,t){for(var r in Object.defineProperty(this,"type",{writable:!1,value:e,enumerable:!0}),t)t.hasOwnProperty(r)&&Object.defineProperty(this,r,{writable:!1,value:t[r],enumerable:!0})}function d(e){return"string"==typeof e&&(e=r(e)),e.protocol&&e.hostname?(e.protocol+"//"+e.host).toLowerCase():"null"}q=l,o.inherits(l,n.EventEmitter),l.prototype.constructor=l,["open","error","message"].forEach((function(e){Object.defineProperty(l.prototype,"on"+e,{get:function(){var t=this.listeners(e)[0];return t?t._listener?t._listener:t:void 0},set:function(t){this.removeAllListeners(e),this.addEventListener(e,t)}})})),Object.defineProperty(l,"CONNECTING",{enumerable:!0,value:0}),Object.defineProperty(l,"OPEN",{enumerable:!0,value:1}),Object.defineProperty(l,"CLOSED",{enumerable:!0,value:2}),l.prototype.CONNECTING=0,l.prototype.OPEN=1,l.prototype.CLOSED=2,l.prototype.close=function(){this._close()},l.prototype.addEventListener=function(e,t){"function"==typeof t&&(t._listener=t,this.on(e,t))},l.prototype.dispatchEvent=function(e){if(!e.type)throw new Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(e.type,e.detail)},l.prototype.removeEventListener=function(e,t){"function"==typeof t&&(t._listener=void 0,this.removeListener(e,t))}}).call(this,require("_process"),require("buffer").Buffer);var D={exports:{}};(function(e,t,r){
/* @preserve
 * The MIT License (MIT)
 * 
 * Copyright (c) 2013-2018 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
!function(e){if("object"==typeof D.exports)D.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;"undefined"!=typeof window?r=window:void 0!==t?r=t:"undefined"!=typeof self&&(r=self),r.Promise=e()}}((function(){return function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var u="function"==typeof _dereq_&&_dereq_;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof _dereq_&&_dereq_,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";t.exports=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}e.any=function(e){return r(e)},e.prototype.any=function(){return r(this)}}},{}],2:[function(t,r,n){"use strict";var i;try{throw new Error}catch(CT){i=CT}var s=t("./schedule"),o=t("./queue");function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=s}function u(e){for(;e.length()>0;)l(e)}function l(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var r=e.shift(),n=e.shift();t.call(r,n)}}a.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(t,r){r?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},a.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(CT){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},a.prototype.invokeLater=function(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()},a.prototype.invoke=function(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()},a.prototype.settlePromises=function(e){this._normalQueue._pushOne(e),this._queueTick()},a.prototype._drainQueues=function(){u(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,u(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},r.exports=a,r.exports.firstLineError=i},{"./queue":26,"./schedule":29}],3:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){var i=!1,s=function(e,t){this._reject(t)},o=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(s,s,null,this,e)},a=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(s){i||(i=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var l=r(s),c=new e(t);c._propagateFrom(this,1);var h=this._target();if(c._setBoundTo(l),l instanceof e){var d={promiseRejectionQueued:!1,promise:c,target:h,bindingPromise:l};h._then(t,o,void 0,c,d),l._then(a,u,void 0,c,d),c._setOnCancel(l)}else c._resolveCallback(h);return c},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,r){return e.resolve(r).bind(t)}}},{}],4:[function(e,t,r){"use strict";var n;"undefined"!=typeof Promise&&(n=Promise);var i=e("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=n)}catch(CT){}return i},t.exports=i},{"./promise":22}],5:[function(e,t,r){"use strict";var n=Object.create;if(n){var i=n(null),s=n(null);i[" size"]=s[" size"]=0}t.exports=function(t){var r=e("./util"),n=r.canEvaluate;function i(e){return function(e,n){var i;if(null!=e&&(i=e[n]),"function"!=typeof i){var s="Object "+r.classString(e)+" has no method '"+r.toString(n)+"'";throw new t.TypeError(s)}return i}(e,this.pop()).apply(e,this)}function s(e){return e[this]}function o(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}r.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(i,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=o;else if(n){var r=(void 0)(e);t=null!==r?r:s}else t=s;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,r){"use strict";t.exports=function(t,r,n,i){var s=e("./util"),o=s.tryCatch,a=s.errorObj,u=t._async;t.prototype.break=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null==r||!r._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(s.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=o(e).call(this._boundValue());n===a&&(this._attachExtraTrace(n.e),u.throwLater(n.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util"),n=e("./es5").keys,i=r.tryCatch,s=r.errorObj;return function(e,o,a){return function(u){var l=a._boundValue();e:for(var c=0;c<e.length;++c){var h=e[c];if(h===Error||null!=h&&h.prototype instanceof Error){if(u instanceof h)return i(o).call(l,u)}else if("function"==typeof h){var d=i(h).call(l,u);if(d===s)return d;if(d)return i(o).call(l,u)}else if(r.isObject(u)){for(var f=n(h),p=0;p<f.length;++p){var m=f[p];if(h[m]!=u[m])continue e}return i(o).call(l,u)}}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t,r){"use strict";t.exports=function(e){var t=!1,r=[];function n(){this._trace=new n.CapturedTrace(i())}function i(){var e=r.length-1;if(e>=0)return r[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},n.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},n.CapturedTrace=null,n.create=function(){if(t)return new n},n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var r=e.prototype._pushContext,s=e.prototype._popContext,o=e._peekContext,a=e.prototype._peekContext,u=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=r,e.prototype._popContext=s,e._peekContext=o,e.prototype._peekContext=a,e.prototype._promiseCreated=u,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},n}},{}],9:[function(t,r,n){"use strict";r.exports=function(r,n,i,s){var o,a,u,l,c=r._async,h=t("./errors").Warning,d=t("./util"),f=t("./es5"),p=d.canAttachTrace,m=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,y=/\((?:timers\.js):\d+:\d+\)/,g=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,v=null,b=null,_=!1,w=!(0==d.env("BLUEBIRD_DEBUG")),E=!(0==d.env("BLUEBIRD_WARNINGS")||!w&&!d.env("BLUEBIRD_WARNINGS")),C=!(0==d.env("BLUEBIRD_LONG_STACK_TRACES")||!w&&!d.env("BLUEBIRD_LONG_STACK_TRACES")),T=0!=d.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(E||!!d.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var e=[];function t(){for(var t=0;t<e.length;++t)e[t]._notifyUnhandledRejection();n()}function n(){e.length=0}l=function(r){e.push(r),setTimeout(t,1)},f.defineProperty(r,"_unhandledRejectionCheck",{value:t}),f.defineProperty(r,"_unhandledRejectionClear",{value:n})}(),r.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},r.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),l(this))},r.prototype._notifyUnhandledRejectionIsHandled=function(){J("rejectionHandled",o,void 0,this)},r.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},r.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},r.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),J("unhandledRejection",a,e,this)}},r.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},r.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},r.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},r.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},r.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},r.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},r.prototype._warn=function(e,t,r){return z(e,t,r||this)},r.onPossiblyUnhandledRejection=function(e){var t=r._getContext();a=d.contextBind(t,e)},r.onUnhandledRejectionHandled=function(e){var t=r._getContext();o=d.contextBind(t,e)};var N=function(){};r.longStackTraces=function(){if(c.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!re.longStackTraces&&K()){var e=r.prototype._captureStackTrace,t=r.prototype._attachExtraTrace,i=r.prototype._dereferenceTrace;re.longStackTraces=!0,N=function(){if(c.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");r.prototype._captureStackTrace=e,r.prototype._attachExtraTrace=t,r.prototype._dereferenceTrace=i,n.deactivateLongStackTraces(),re.longStackTraces=!1},r.prototype._captureStackTrace=U,r.prototype._attachExtraTrace=V,r.prototype._dereferenceTrace=B,n.activateLongStackTraces()}},r.hasLongStackTraces=function(){return re.longStackTraces&&K()};var k={unhandledrejection:{before:function(){var e=d.global.onunhandledrejection;return d.global.onunhandledrejection=null,e},after:function(e){d.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=d.global.onrejectionhandled;return d.global.onrejectionhandled=null,e},after:function(e){d.global.onrejectionhandled=e}}},O=function(){var e=function(e,t){if(!e)return!d.global.dispatchEvent(t);var r;try{return r=e.before(),!d.global.dispatchEvent(t)}finally{e.after(r)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new CustomEvent(t,{detail:r,cancelable:!0});return f.defineProperty(n,"promise",{value:r.promise}),f.defineProperty(n,"reason",{value:r.reason}),e(k[t],n)}}return"function"==typeof Event?(t=new Event("CustomEvent"),d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new Event(t,{cancelable:!0});return n.detail=r,f.defineProperty(n,"promise",{value:r.promise}),f.defineProperty(n,"reason",{value:r.reason}),e(k[t],n)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),d.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!0,r),e(k[t],n)})}catch(CT){}return function(){return!1}}(),S=d.isNode?function(){return e.emit.apply(e,arguments)}:d.global?function(e){var t="on"+e.toLowerCase(),r=d.global[t];return!!r&&(r.apply(d.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function x(e,t){return{promise:t}}var $={promiseCreated:x,promiseFulfilled:x,promiseRejected:x,promiseResolved:x,promiseCancelled:x,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:x},A=function(e){var t=!1;try{t=S.apply(null,arguments)}catch(CT){c.throwLater(CT),t=!0}var r=!1;try{r=O(e,$[e].apply(null,arguments))}catch(CT){c.throwLater(CT),r=!0}return r||t};function j(){return!1}function I(e,t,r){var n=this;try{e(t,r,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+d.toString(e));n._attachCancellationCallback(e)}))}catch(CT){return CT}}function R(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?d.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function P(){return this._onCancelField}function M(e){this._onCancelField=e}function L(){this._cancellationParent=void 0,this._onCancelField=void 0}function q(e,t){if(0!=(1&t)){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}r.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?r.longStackTraces():!e.longStackTraces&&r.hasLongStackTraces()&&N()),"warnings"in e){var t=e.warnings;re.warnings=!!t,T=re.warnings,d.isObject(t)&&"wForgottenReturn"in t&&(T=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!re.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");r.prototype._clearCancellationData=L,r.prototype._propagateFrom=q,r.prototype._onCancel=P,r.prototype._setOnCancel=M,r.prototype._attachCancellationCallback=R,r.prototype._execute=I,D=q,re.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!re.monitoring?(re.monitoring=!0,r.prototype._fireEvent=A):!e.monitoring&&re.monitoring&&(re.monitoring=!1,r.prototype._fireEvent=j)),"asyncHooks"in e&&d.nodeSupportsAsyncResource){var n=re.asyncHooks,o=!!e.asyncHooks;n!==o&&(re.asyncHooks=o,o?i():s())}return r},r.prototype._fireEvent=j,r.prototype._execute=function(e,t,r){try{e(t,r)}catch(CT){return CT}},r.prototype._onCancel=function(){},r.prototype._setOnCancel=function(e){},r.prototype._attachCancellationCallback=function(e){},r.prototype._captureStackTrace=function(){},r.prototype._attachExtraTrace=function(){},r.prototype._dereferenceTrace=function(){},r.prototype._clearCancellationData=function(){},r.prototype._propagateFrom=function(e,t){};var D=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function F(){var e=this._boundTo;return void 0!==e&&e instanceof r?e.isFulfilled()?e.value():void 0:e}function U(){this._trace=new ee(this._peekContext())}function V(e,t){if(p(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=W(e);d.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),d.notEnumerableProp(e,"__stackCleaned__",!0)}}}function B(){this._trace=void 0}function z(e,t,n){if(re.warnings){var i,s=new h(e);if(t)n._attachExtraTrace(s);else if(re.longStackTraces&&(i=r._peekContext()))i.attachExtraTrace(s);else{var o=W(s);s.stack=o.message+"\n"+o.stack.join("\n")}A("warning",s)||Q(s,"",!0)}}function H(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],i="    (No stack trace)"===n||v.test(n),s=i&&Z(n);i&&!s&&(_&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function W(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var n=t[r];if("    (No stack trace)"===n||v.test(n))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:H(t)}}function Q(e,t,r){if("undefined"!=typeof console){var n;if(d.isObject(e)){var i=e.stack;n=t+b(i,e)}else n=t+String(e);"function"==typeof u?u(n,r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}}function J(e,t,r,n){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(n):t(r,n))}catch(CT){c.throwLater(CT)}"unhandledRejection"===e?A(e,r,n)||i||Q(r,"Unhandled rejection "):A(e,n)}function G(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():d.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(CT){}0===t.length&&(t="(empty array)")}return"(<"+function(e){return e.length<41?e:e.substr(0,38)+"..."}(t)+">, no stack trace)"}function K(){return"function"==typeof te}var Z=function(){return!1},Y=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function X(e){var t=e.match(Y);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function ee(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);te(this,ee),t>32&&this.uncycle()}d.inherits(ee,Error),n.CapturedTrace=ee,ee.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],r={},n=0,i=this;void 0!==i;++n)t.push(i),i=i._parent;for(n=(e=this._length=n)-1;n>=0;--n){var s=t[n].stack;void 0===r[s]&&(r[s]=n)}for(n=0;n<e;++n){var o=r[t[n].stack];if(void 0!==o&&o!==n){o>0&&(t[o-1]._parent=void 0,t[o-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var a=n>0?t[n-1]:this;o<e-1?(a._parent=t[o+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,l=n-2;l>=0;--l)t[l]._length=u,u++;return}}}},ee.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=W(e),r=t.message,n=[t.stack],i=this;void 0!==i;)n.push(H(i.stack.split("\n"))),i=i._parent;!function(e){for(var t=e[0],r=1;r<e.length;++r){for(var n=e[r],i=t.length-1,s=t[i],o=-1,a=n.length-1;a>=0;--a)if(n[a]===s){o=a;break}for(a=o;a>=0;--a){var u=n[a];if(t[i]!==u)break;t.pop(),i--}t=n}}(n),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(n),d.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,n)),d.notEnumerableProp(e,"__stackCleaned__",!0)}};var te=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():G(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,v=e,b=t;var r=Error.captureStackTrace;return Z=function(e){return m.test(e)},function(e,t){Error.stackTraceLimit+=6,r(e,t),Error.stackTraceLimit-=6}}var n,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return v=/@/,b=t,_=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(CT){n="stack"in CT}return!("stack"in i)&&n&&"number"==typeof Error.stackTraceLimit?(v=e,b=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(CT){e.stack=CT.stack}Error.stackTraceLimit-=6}):(b=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?G(t):t.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(u=function(e){console.warn(e)},d.isNode&&e.stderr.isTTY?u=function(e,t){var r=t?"\x1b[33m":"\x1b[31m";console.warn(r+e+"\x1b[0m\n")}:d.isNode||"string"!=typeof(new Error).stack||(u=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var re={warnings:E,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return C&&r.longStackTraces(),{asyncHooks:function(){return re.asyncHooks},longStackTraces:function(){return re.longStackTraces},warnings:function(){return re.warnings},cancellation:function(){return re.cancellation},monitoring:function(){return re.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return F},checkForgottenReturns:function(e,t,r,n,i){if(void 0===e&&null!==t&&T){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&n._bitField))return;r&&(r+=" ");var s="",o="";if(t._trace){for(var a=t._trace.stack.split("\n"),u=H(a),l=u.length-1;l>=0;--l){var c=u[l];if(!y.test(c)){var h=c.match(g);h&&(s="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(u.length>0){var d=u[0];for(l=0;l<a.length;++l)if(a[l]===d){l>0&&(o="\n"+a[l-1]);break}}}var f="a promise was created in a "+r+"handler "+s+"but was not returned from it, see http://goo.gl/rRqMUw"+o;n._warn(f,!0,t)}},setBounds:function(e,t){if(K()){for(var r,n,i=(e.stack||"").split("\n"),s=(t.stack||"").split("\n"),o=-1,a=-1,u=0;u<i.length;++u)if(l=X(i[u])){r=l.fileName,o=l.line;break}for(u=0;u<s.length;++u){var l;if(l=X(s[u])){n=l.fileName,a=l.line;break}}o<0||a<0||!r||!n||r!==n||o>=a||(Z=function(e){if(m.test(e))return!0;var t=X(e);return!!(t&&t.fileName===r&&o<=t.line&&t.line<=a)})}},warn:z,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),z(r)},CapturedTrace:ee,fireDomEvent:O,fireGlobalEvent:S}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,t,r){"use strict";t.exports=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1],n=function(){throw t};return this.caught(e,n)},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var n=arguments[1];n instanceof e&&n.suppressUnhandledRejections();var i=function(){return n};return this.caught(r,i)}}},{}],11:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.reduce,n=e.all;function i(){return n(this)}e.prototype.each=function(e){return r(this,e,t,0)._then(i,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,n){return r(e,n,t,0)._then(i,void 0,void 0,e,void 0)},e.mapSeries=function(e,n){return r(e,n,t,t)}}},{}],12:[function(e,t,r){"use strict";var n,i,s=e("./es5"),o=s.freeze,a=e("./util"),u=a.inherits,l=a.notEnumerableProp;function c(e,t){function r(n){if(!(this instanceof r))return new r(n);l(this,"message","string"==typeof n?n:t),l(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(r,Error),r}var h=c("Warning","warning"),d=c("CancellationError","cancellation error"),f=c("TimeoutError","timeout error"),p=c("AggregateError","aggregate error");try{n=TypeError,i=RangeError}catch(CT){n=c("TypeError","type error"),i=c("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<m.length;++y)"function"==typeof Array.prototype[m[y]]&&(p.prototype[m[y]]=Array.prototype[m[y]]);s.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var g=0;function v(e){if(!(this instanceof v))return new v(e);l(this,"name","OperationalError"),l(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(l(this,"message",e.message),l(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}p.prototype.toString=function(){var e=Array(4*g+1).join(" "),t="\n"+e+"AggregateError of:\n";g++,e=Array(4*g+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",i=n.split("\n"),s=0;s<i.length;++s)i[s]=e+i[s];t+=(n=i.join("\n"))+"\n"}return g--,t},u(v,Error);var b=Error.__BluebirdErrorTypes__;b||(b=o({CancellationError:d,TimeoutError:f,OperationalError:v,RejectionError:v,AggregateError:p}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:n,RangeError:i,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:h}},{"./es5":13,"./util":36}],13:[function(e,t,r){var n=function(){"use strict";return void 0===this}();if(n)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!(r&&!r.writable&&!r.set)}};else{var i={}.hasOwnProperty,s={}.toString,o={}.constructor.prototype,a=function(e){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t};t.exports={isArray:function(e){try{return"[object Array]"===s.call(e)}catch(CT){return!1}},keys:a,names:a,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(CT){return o}},isES5:n,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,r){"use strict";t.exports=function(e,t){var r=e.map;e.prototype.filter=function(e,n){return r(this,e,n,t)},e.filter=function(e,n,i){return r(e,n,i,t)}}},{}],15:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=e("./util"),s=t.CancellationError,o=i.errorObj,a=e("./catch_filter")(n);function u(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function l(e){this.finallyHandler=e}function c(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function h(){return f.call(this,this.promise._target()._settledValue())}function d(e){if(!c(this,e))return o.e=e,o}function f(e){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),e);if(u===n)return u;if(void 0!==u){i._setReturnedNonUndefined();var f=r(u,i);if(f instanceof t){if(null!=this.cancelPromise){if(f._isCancelled()){var p=new s("late cancellation observer");return i._attachExtraTrace(p),o.e=p,o}f.isPending()&&f._attachCancellationCallback(new l(this))}return f._then(h,d,void 0,this,void 0)}}}return i.isRejected()?(c(this),o.e=e,o):(c(this),e)}return u.prototype.isFinallyHandler=function(){return 0===this.type},l.prototype._resultCancelled=function(){c(this.finallyHandler)},t.prototype._passThrough=function(e,t,r,n){return"function"!=typeof e?this.then():this._then(r,n,void 0,new u(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,f,f)},t.prototype.tap=function(e){return this._passThrough(e,1,f)},t.prototype.tapCatch=function(e){var r=arguments.length;if(1===r)return this._passThrough(e,1,void 0,f);var n,s=new Array(r-1),o=0;for(n=0;n<r-1;++n){var u=arguments[n];if(!i.isObject(u))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+i.classString(u)));s[o++]=u}s.length=o;var l=arguments[n];return this._passThrough(a(s,l,this),1,void 0,f)},u}},{"./catch_filter":7,"./util":36}],16:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./errors").TypeError,u=e("./util"),l=u.errorObj,c=u.tryCatch,h=[];function d(e,r,i,s){if(o.cancellation()){var a=new t(n),u=this._finallyPromise=new t(n);this._promise=a.lastly((function(){return u})),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new t(n))._captureStackTrace();this._stack=s,this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(d,s),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=c(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),e=c(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},d.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=c(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=c(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(e){var r=this._promise;if(e===l)return this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(e.e,!1);var n=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(n);var s=i(n,this._promise);if(s instanceof t||null!==(s=function(e,r,n){for(var s=0;s<r.length;++s){n._pushContext();var o=c(r[s])(e);if(n._popContext(),o===l){n._pushContext();var a=t.reject(l.e);return n._popContext(),a}var u=i(o,n);if(u instanceof t)return u}return null}(s,this._yieldHandlers,this._promise))){var o=(s=s._target())._bitField;0==(50397184&o)?(this._yieldedPromise=s,s._proxy(this,null)):0!=(33554432&o)?t._async.invoke(this._promiseFulfilled,this,s._value()):0!=(16777216&o)?t._async.invoke(this._promiseRejected,this,s._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,n=d,i=(new Error).stack;return function(){var t=e.apply(this,arguments),s=new n(void 0,void 0,r,i),o=s.promise();return s._generator=t,s._promiseFulfilled(void 0),o}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new a("expecting a function but got "+u.classString(e));h.push(e)},t.spawn=function(e){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return r("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new d(e,this),i=n.promise();return n._run(t.spawn),i}}},{"./errors":12,"./util":36}],17:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s){var o=e("./util");o.canEvaluate,o.tryCatch,o.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var n=[].slice.call(arguments);e&&n.pop();var i=new r(n).promise();return void 0!==e?i.spread(e):i}}},{"./util":36}],18:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./util"),u=a.tryCatch,l=a.errorObj,c=t._async;function h(e,r,n,i){this.constructor$(e),this._promise._captureStackTrace();var o=t._getContext();if(this._callback=a.contextBind(o,r),this._preservedValues=i===s?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],c.invoke(this._asyncInit,this,void 0),a.isArray(e))for(var u=0;u<e.length;++u){var l=e[u];l instanceof t&&l.suppressUnhandledRejections()}}function d(e,r,i,s){if("function"!=typeof r)return n("expecting a function but got "+a.classString(r));var o=0;if(void 0!==i){if("object"!=typeof i||null===i)return t.reject(new TypeError("options argument must be an object but it is "+a.classString(i)));if("number"!=typeof i.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(i.concurrency)));o=i.concurrency}return new h(e,r,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,s).promise()}a.inherits(h,r),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(e,r){var n=this._values,s=this.length(),a=this._preservedValues,c=this._limit;if(r<0){if(n[r=-1*r-1]=e,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return n[r]=e,this._queue.push(r),!1;null!==a&&(a[r]=e);var h=this._promise,d=this._callback,f=h._boundValue();h._pushContext();var p=u(d).call(f,e,r,s),m=h._popContext();if(o.checkForgottenReturns(p,m,null!==a?"Promise.filter":"Promise.map",h),p===l)return this._reject(p.e),!0;var y=i(p,this._promise);if(y instanceof t){var g=(y=y._target())._bitField;if(0==(50397184&g))return c>=1&&this._inFlight++,n[r]=y,y._proxy(this,-1*(r+1)),!1;if(0==(33554432&g))return 0!=(16777216&g)?(this._reject(y._reason()),!0):(this._cancel(),!0);p=y._value()}n[r]=p}return++this._totalResolved>=s&&(null!==a?this._filter(n,a):this._resolve(n),!0)},h.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(r[n],n)}},h.prototype._filter=function(e,t){for(var r=t.length,n=new Array(r),i=0,s=0;s<r;++s)e[s]&&(n[i++]=t[s]);n.length=i,this._resolve(n)},h.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return d(this,e,t,null)},t.map=function(e,t,r,n){return d(e,t,r,n)}}},{"./util":36}],19:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s){var o=e("./util"),a=o.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+o.classString(e));return function(){var n=new t(r);n._captureStackTrace(),n._pushContext();var i=a(e).apply(this,arguments),o=n._popContext();return s.checkForgottenReturns(i,o,"Promise.method",n),n._resolveFromSyncValue(i),n}},t.attempt=t.try=function(e){if("function"!=typeof e)return i("expecting a function but got "+o.classString(e));var n,u=new t(r);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){s.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],c=arguments[2];n=o.isArray(l)?a(e).apply(c,l):a(e).call(c,l)}else n=a(e)();var h=u._popContext();return s.checkForgottenReturns(n,h,"Promise.try",u),u._resolveFromSyncValue(n),u},t.prototype._resolveFromSyncValue=function(e){e===o.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,r){"use strict";var n=e("./util"),i=n.maybeWrapAsError,s=e("./errors").OperationalError,o=e("./es5"),a=/^(?:name|message|stack|cause)$/;function u(e){var t;if(function(e){return e instanceof Error&&o.getPrototypeOf(e)===Error.prototype}(e)){(t=new s(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var r=o.keys(e),i=0;i<r.length;++i){var u=r[i];a.test(u)||(t[u]=e[u])}return t}return n.markAsOriginatingFromRejection(e),e}t.exports=function(e,t){return function(r,n){if(null!==e){if(r){var s=u(i(r));e._attachExtraTrace(s),e._reject(s)}else if(t){var o=[].slice.call(arguments,1);e._fulfill(o)}else e._fulfill(n);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,r){"use strict";t.exports=function(t){var r=e("./util"),n=t._async,i=r.tryCatch,s=r.errorObj;function o(e,t){if(!r.isArray(e))return a.call(this,e,t);var o=i(t).apply(this._boundValue(),[null].concat(e));o===s&&n.throwLater(o.e)}function a(e,t){var r=this._boundValue(),o=void 0===e?i(t).call(r,null):i(t).call(r,null,e);o===s&&n.throwLater(o.e)}function u(e,t){if(!e){var r=new Error(e+"");r.cause=e,e=r}var o=i(t).call(this._boundValue(),e);o===s&&n.throwLater(o.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var r=a;void 0!==t&&Object(t).spread&&(r=o),this._then(r,u,void 0,this,e)}return this}}},{"./util":36}],22:[function(t,r,n){"use strict";r.exports=function(){var n=function(){return new v("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},i=function(){return new I.PromiseInspection(this._target())},s=function(e){return I.reject(new v(e))};function o(){}var a={},u=t("./util");u.setReflectHandler(i);var l=function(){var t=e.domain;return void 0===t?null:t},c=function(){return{domain:l(),async:null}},h=u.isNode&&u.nodeSupportsAsyncResource?t("async_hooks").AsyncResource:null,d=function(){return{domain:l(),async:new h("Bluebird::Promise")}},f=u.isNode?c:function(){return null};u.notEnumerableProp(I,"_getContext",f);var p=t("./es5"),m=t("./async"),y=new m;p.defineProperty(I,"_async",{value:y});var g=t("./errors"),v=I.TypeError=g.TypeError;I.RangeError=g.RangeError;var b=I.CancellationError=g.CancellationError;I.TimeoutError=g.TimeoutError,I.OperationalError=g.OperationalError,I.RejectionError=g.OperationalError,I.AggregateError=g.AggregateError;var _=function(){},w={},E={},C=t("./thenables")(I,_),T=t("./promise_array")(I,_,C,s,o),N=t("./context")(I),k=N.create,O=t("./debuggability")(I,N,(function(){f=d,u.notEnumerableProp(I,"_getContext",d)}),(function(){f=c,u.notEnumerableProp(I,"_getContext",c)})),S=(O.CapturedTrace,t("./finally")(I,C,E)),x=t("./catch_filter")(E),$=t("./nodeback"),A=u.errorObj,j=u.tryCatch;function I(e){e!==_&&function(e,t){if(null==e||e.constructor!==I)throw new v("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new v("expecting a function but got "+u.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function R(e){this.promise._resolveCallback(e)}function P(e){this.promise._rejectCallback(e,!1)}function M(e){var t=new I(_);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return I.prototype.toString=function(){return"[object Promise]"},I.prototype.caught=I.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,n=new Array(t-1),i=0;for(r=0;r<t-1;++r){var o=arguments[r];if(!u.isObject(o))return s("Catch statement predicate: expecting an object but got "+u.classString(o));n[i++]=o}if(n.length=i,"function"!=typeof(e=arguments[r]))throw new v("The last argument to .catch() must be a function, got "+u.toString(e));return this.then(void 0,x(n,e,this))}return this.then(void 0,e)},I.prototype.reflect=function(){return this._then(i,i,void 0,this,void 0)},I.prototype.then=function(e,t){if(O.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+u.classString(e);arguments.length>1&&(r+=", "+u.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},I.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},I.prototype.spread=function(e){return"function"!=typeof e?s("expecting a function but got "+u.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},I.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},I.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new T(this).promise()},I.prototype.error=function(e){return this.caught(u.originatesFromRejection,e)},I.getNewLibraryCopy=r.exports,I.is=function(e){return e instanceof I},I.fromNode=I.fromCallback=function(e){var t=new I(_);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=j(e)($(t,r));return n===A&&t._rejectCallback(n.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},I.all=function(e){return new T(e).promise()},I.cast=function(e){var t=C(e);return t instanceof I||((t=new I(_))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},I.resolve=I.fulfilled=I.cast,I.reject=I.rejected=function(e){var t=new I(_);return t._captureStackTrace(),t._rejectCallback(e,!0),t},I.setScheduler=function(e){if("function"!=typeof e)throw new v("expecting a function but got "+u.classString(e));return y.setScheduler(e)},I.prototype._then=function(e,t,r,n,i){var s=void 0!==i,o=s?i:new I(_),a=this._target(),l=a._bitField;s||(o._propagateFrom(this,3),o._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&l)?this._boundValue():a===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,o));var c=f();if(0!=(50397184&l)){var h,d,p=a._settlePromiseCtx;0!=(33554432&l)?(d=a._rejectionHandler0,h=e):0!=(16777216&l)?(d=a._fulfillmentHandler0,h=t,a._unsetRejectionIsUnhandled()):(p=a._settlePromiseLateCancellationObserver,d=new b("late cancellation observer"),a._attachExtraTrace(d),h=t),y.invoke(p,a,{handler:u.contextBind(c,h),promise:o,receiver:n,value:d})}else a._addCallbacks(e,t,o,n,c);return o},I.prototype._length=function(){return 65535&this._bitField},I.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},I.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},I.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},I.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},I.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},I.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},I.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},I.prototype._isFinal=function(){return(4194304&this._bitField)>0},I.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},I.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},I.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},I.prototype._setAsyncGuaranteed=function(){if(!y.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},I.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},I.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==a)return void 0===t&&this._isBound()?this._boundValue():t},I.prototype._promiseAt=function(e){return this[4*e-4+2]},I.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},I.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},I.prototype._boundValue=function(){},I.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,r=e._rejectionHandler0,n=e._promise0,i=e._receiverAt(0);void 0===i&&(i=a),this._addCallbacks(t,r,n,i,null)},I.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),i=e._promiseAt(t),s=e._receiverAt(t);void 0===s&&(s=a),this._addCallbacks(r,n,i,s,null)},I.prototype._addCallbacks=function(e,t,r,n,i){var s=this._length();if(s>=65531&&(s=0,this._setLength(0)),0===s)this._promise0=r,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=u.contextBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=u.contextBind(i,t));else{var o=4*s-4;this[o+2]=r,this[o+3]=n,"function"==typeof e&&(this[o+0]=u.contextBind(i,e)),"function"==typeof t&&(this[o+1]=u.contextBind(i,t))}return this._setLength(s+1),s},I.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},I.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(n(),!1);var r=C(e,this);if(!(r instanceof I))return this._fulfill(e);t&&this._propagateFrom(r,2);var i=r._target();if(i!==this){var s=i._bitField;if(0==(50397184&s)){var o=this._length();o>0&&i._migrateCallback0(this);for(var a=1;a<o;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&s))this._fulfill(i._value());else if(0!=(16777216&s))this._reject(i._reason());else{var u=new b("late cancellation observer");i._attachExtraTrace(u),this._reject(u)}}else this._reject(n())}},I.prototype._rejectCallback=function(e,t,r){var n=u.ensureErrorObject(e),i=n===e;if(!i&&!r&&O.warnings()){var s="a promise was rejected with a non-error: "+u.classString(e);this._warn(s,!0)}this._attachExtraTrace(n,!!t&&i),this._reject(e)},I.prototype._resolveFromExecutor=function(e){if(e!==_){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,n=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,r)}));r=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)}},I.prototype._settlePromiseFromHandler=function(e,t,r,n){var i=n._bitField;if(0==(65536&i)){var s;n._pushContext(),t===w?r&&"number"==typeof r.length?s=j(e).apply(this._boundValue(),r):(s=A).e=new v("cannot .spread() a non-array: "+u.classString(r)):s=j(e).call(t,r);var o=n._popContext();0==(65536&(i=n._bitField))&&(s===E?n._reject(r):s===A?n._rejectCallback(s.e,!1):(O.checkForgottenReturns(s,o,"",n,this),n._resolveCallback(s)))}},I.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},I.prototype._followee=function(){return this._rejectionHandler0},I.prototype._setFollowee=function(e){this._rejectionHandler0=e},I.prototype._settlePromise=function(e,t,r,n){var s=e instanceof I,a=this._bitField,u=0!=(134217728&a);0!=(65536&a)?(s&&e._invokeInternalOnCancel(),r instanceof S&&r.isFinallyHandler()?(r.cancelPromise=e,j(t).call(r,n)===A&&e._reject(A.e)):t===i?e._fulfill(i.call(r)):r instanceof o?r._promiseCancelled(e):s||e instanceof T?e._cancel():r.cancel()):"function"==typeof t?s?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,n,e)):t.call(r,n,e):r instanceof o?r._isResolved()||(0!=(33554432&a)?r._promiseFulfilled(n,e):r._promiseRejected(n,e)):s&&(u&&e._setAsyncGuaranteed(),0!=(33554432&a)?e._fulfill(n):e._reject(n))},I.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,n=e.receiver,i=e.value;"function"==typeof t?r instanceof I?this._settlePromiseFromHandler(t,n,i,r):t.call(n,i,r):r instanceof I&&r._reject(i)},I.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},I.prototype._settlePromise0=function(e,t,r){var n=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,i,t)},I.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},I.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!=(134217728&t)?this._settlePromises():y.settlePromises(this),this._dereferenceTrace())}},I.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return y.fatalError(e,u.isNode);(65535&t)>0?y.settlePromises(this):this._ensurePossibleRejectionHandled()}},I.prototype._fulfillPromises=function(e,t){for(var r=1;r<e;r++){var n=this._fulfillmentHandlerAt(r),i=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,s,t)}},I.prototype._rejectPromises=function(e,t){for(var r=1;r<e;r++){var n=this._rejectionHandlerAt(r),i=this._promiseAt(r),s=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,s,t)}},I.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},I.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&p.defineProperty(I.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),I.defer=I.pending=function(){return O.deprecated("Promise.defer","new Promise"),{promise:new I(_),resolve:R,reject:P}},u.notEnumerableProp(I,"_makeSelfResolutionError",n),t("./method")(I,_,C,s,O),t("./bind")(I,_,C,O),t("./cancel")(I,T,s,O),t("./direct_resolve")(I),t("./synchronous_inspection")(I),t("./join")(I,T,C,_,y),I.Promise=I,I.version="3.7.2",t("./call_get.js")(I),t("./generators.js")(I,s,_,C,o,O),t("./map.js")(I,T,s,C,_,O),t("./nodeify.js")(I),t("./promisify.js")(I,_),t("./props.js")(I,T,C,s),t("./race.js")(I,_,C,s),t("./reduce.js")(I,T,s,C,_,O),t("./settle.js")(I,T,O),t("./some.js")(I,T,s),t("./timers.js")(I,_,O),t("./using.js")(I,s,C,k,_,O),t("./any.js")(I),t("./each.js")(I,_),t("./filter.js")(I,_),u.toFastProperties(I),u.toFastProperties(I.prototype),M({a:1}),M({b:2}),M({c:3}),M(1),M((function(){})),M(void 0),M(!1),M(new I(_)),O.setBounds(m.firstLineError,u.lastLineError),I}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s){var o=e("./util");function a(e){var n=this._promise=new t(r);e instanceof t&&(n._propagateFrom(e,3),e.suppressUnhandledRejections()),n._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return o.isArray,o.inherits(a,s),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function e(r,s){var a=n(this._values,this._promise);if(a instanceof t){var u=(a=a._target())._bitField;if(this._values=a,0==(50397184&u))return this._promise._setAsyncGuaranteed(),a._then(e,this._reject,void 0,this,s);if(0==(33554432&u))return 0!=(16777216&u)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=o.asArray(a)))0!==a.length?this._iterate(a):-5===s?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(s));else{var l=i("expecting an array or an iterable object but got "+o.classString(a)).reason();this._promise._rejectCallback(l,!1)}},a.prototype._iterate=function(e){var r=this.getActualLength(e.length);this._length=r,this._values=this.shouldCopyValues()?new Array(r):this._values;for(var i=this._promise,s=!1,o=null,a=0;a<r;++a){var u=n(e[a],i);o=u instanceof t?(u=u._target())._bitField:null,s?null!==o&&u.suppressUnhandledRejections():null!==o?0==(50397184&o)?(u._proxy(this,a),this._values[a]=u):s=0!=(33554432&o)?this._promiseFulfilled(u._value(),a):0!=(16777216&o)?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):s=this._promiseFulfilled(u,a)}s||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},a.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var r=0;r<e.length;++r)e[r]instanceof t&&e[r].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},{"./util":36}],24:[function(e,t,r){"use strict";t.exports=function(t,r){var n={},i=e("./util"),s=e("./nodeback"),o=i.withAppended,a=i.maybeWrapAsError,u=i.canEvaluate,l=e("./errors").TypeError,c={__isPromisified__:!0},h=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),d=function(e){return i.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function f(e){return!h.test(e)}function p(e){try{return!0===e.__isPromisified__}catch(CT){return!1}}function m(e,t,r){var n=i.getDataPropertyOrDefault(e,t+r,c);return!!n&&p(n)}var y=u?void 0:function(e,u,l,c,h,d){var f=function(){return this}(),p=e;function m(){var i=u;u===n&&(i=this);var l=new t(r);l._captureStackTrace();var c="string"==typeof p&&this!==f?this[p]:e,h=s(l,d);try{c.apply(i,o(arguments,h))}catch(CT){l._rejectCallback(a(CT),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof p&&(e=c),i.notEnumerableProp(m,"__isPromisified__",!0),m};function g(e,t,r,s,o){for(var a=new RegExp(t.replace(/([$])/,"\\$")+"$"),u=function(e,t,r,n){for(var s=i.inheritedDataKeys(e),o=[],a=0;a<s.length;++a){var u=s[a],c=e[u],h=n===d||d(u);"function"!=typeof c||p(c)||m(e,u,t)||!n(u,c,e,h)||o.push(u,c)}return function(e,t,r){for(var n=0;n<e.length;n+=2){var i=e[n];if(r.test(i))for(var s=i.replace(r,""),o=0;o<e.length;o+=2)if(e[o]===s)throw new l("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(o,t,r),o}(e,t,a,r),c=0,h=u.length;c<h;c+=2){var f=u[c],g=u[c+1],v=f+t;if(s===y)e[v]=y(f,n,f,g,t,o);else{var b=s(g,(function(){return y(f,n,f,g,t,o)}));i.notEnumerableProp(b,"__isPromisified__",!0),e[v]=b}}return i.toFastProperties(e),e}t.promisify=function(e,t){if("function"!=typeof e)throw new l("expecting a function but got "+i.classString(e));if(p(e))return e;var r,s,o,a=(r=e,s=void 0===(t=Object(t)).context?n:t.context,o=!!t.multiArgs,y(r,s,void 0,r,null,o));return i.copyDescriptors(e,a,f),a},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new l("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,n=t.suffix;"string"!=typeof n&&(n="Async");var s=t.filter;"function"!=typeof s&&(s=d);var o=t.promisifier;if("function"!=typeof o&&(o=y),!i.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=i.inheritedDataKeys(e),u=0;u<a.length;++u){var c=e[a[u]];"constructor"!==a[u]&&i.isClass(c)&&(g(c.prototype,n,s,o,r),g(c,n,s,o,r))}return g(e,n,s,o,r)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,r){"use strict";t.exports=function(t,r,n,i){var s,o=e("./util"),a=o.isObject,u=e("./es5");"function"==typeof Map&&(s=Map);var l=function(){var e=0,t=0;function r(r,n){this[e]=r,this[e+t]=n,e++}return function(n){t=n.size,e=0;var i=new Array(2*n.size);return n.forEach(r,i),i}}();function c(e){var t,r=!1;if(void 0!==s&&e instanceof s)t=l(e),r=!0;else{var n=u.keys(e),i=n.length;t=new Array(2*i);for(var o=0;o<i;++o){var a=n[o];t[o]=e[a],t[o+i]=a}}this.constructor$(t),this._isMap=r,this._init$(void 0,r?-6:-3)}function h(e){var r,s=n(e);return a(s)?(r=s instanceof t?s._then(t.props,void 0,void 0,void 0,void 0):new c(s).promise(),s instanceof t&&r._propagateFrom(s,2),r):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}o.inherits(c,r),c.prototype._init=function(){},c.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var r;if(this._isMap)r=function(e){for(var t=new s,r=e.length/2|0,n=0;n<r;++n){var i=e[r+n],o=e[n];t.set(i,o)}return t}(this._values);else{r={};for(var n=this.length(),i=0,o=this.length();i<o;++i)r[this._values[i+n]]=this._values[i]}return this._resolve(r),!0}return!1},c.prototype.shouldCopyValues=function(){return!1},c.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return h(this)},t.props=function(e){return h(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,r){"use strict";function n(e){this._capacity=e,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(e){return this._capacity<e},n.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},n.prototype.push=function(e,t,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(r);var i=this._front+n-3;this._checkCapacity(n);var s=this._capacity-1;this[i+0&s]=e,this[i+1&s]=t,this[i+2&s]=r,this._length=n},n.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,n,i){for(var s=0;s<i;++s)r[s+n]=e[s+0],e[s+0]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=n},{}],27:[function(e,t,r){"use strict";t.exports=function(t,r,n,i){var s=e("./util");function o(e,a){var u,l=n(e);if(l instanceof t)return(u=l).then((function(e){return o(e,u)}));if(null===(e=s.asArray(e)))return i("expecting an array or an iterable object but got "+s.classString(e));var c=new t(r);void 0!==a&&c._propagateFrom(a,3);for(var h=c._fulfill,d=c._reject,f=0,p=e.length;f<p;++f){var m=e[f];(void 0!==m||f in e)&&t.cast(m)._then(h,d,void 0,c,null)}return c}t.race=function(e){return o(e,void 0)},t.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./util"),u=a.tryCatch;function l(e,r,n,i){this.constructor$(e);var o=t._getContext();this._fn=a.contextBind(o,r),void 0!==n&&(n=t.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=i===s?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function h(e,t,r,i){return"function"!=typeof t?n("expecting a function but got "+a.classString(t)):new l(e,t,r,i).promise()}function d(e){this.accum=e,this.array._gotAccum(e);var r=i(this.value,this.array._promise);return r instanceof t?(this.array._currentCancellable=r,r._then(f,void 0,void 0,this,void 0)):f.call(this,r)}function f(e){var r,n=this.array,i=n._promise,s=u(n._fn);i._pushContext(),(r=void 0!==n._eachValues?s.call(i._boundValue(),e,this.index,this.length):s.call(i._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(n._currentCancellable=r);var a=i._popContext();return o.checkForgottenReturns(r,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),r}a.inherits(l,r),l.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==s&&this._eachValues.push(e)},l.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},l.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},l.prototype._iterate=function(e){var r,n;this._values=e;var i=e.length;void 0!==this._initialValue?(r=this._initialValue,n=0):(r=t.resolve(e[0]),n=1),this._currentCancellable=r;for(var s=n;s<i;++s){var o=e[s];o instanceof t&&o.suppressUnhandledRejections()}if(!r.isRejected())for(;n<i;++n){var a={accum:null,value:e[n],index:n,length:i,array:this};r=r._then(d,void 0,void 0,a,void 0),0==(127&n)&&r._setNoAsyncGuarantee()}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(c,c,void 0,r,this)},t.prototype.reduce=function(e,t){return h(this,e,t,null)},t.reduce=function(e,t,r,n){return h(e,t,r,n)}}},{"./util":36}],29:[function(n,i,s){"use strict";var o,a,u,l,c,h=n("./util"),d=h.getNativePromise();if(h.isNode&&"undefined"==typeof MutationObserver){var f=t.setImmediate,p=e.nextTick;o=h.isRecentNode?function(e){f.call(t,e)}:function(t){p.call(e,t)}}else if("function"==typeof d&&"function"==typeof d.resolve){var m=d.resolve();o=function(e){m.then(e)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?void 0!==r?function(e){r(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(a=document.createElement("div"),u={attributes:!0},l=!1,c=document.createElement("div"),new MutationObserver((function(){a.classList.toggle("foo"),l=!1})).observe(c,u),function(e){var t=new MutationObserver((function(){t.disconnect(),e()}));t.observe(a,u),l||(l=!0,c.classList.toggle("foo"))});i.exports=o},{"./util":36}],30:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=t.PromiseInspection;function s(e){this.constructor$(e)}e("./util").inherits(s,r),s.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseFulfilled=function(e,t){var r=new i;return r._bitField=33554432,r._settledValueField=e,this._promiseResolved(t,r)},s.prototype._promiseRejected=function(e,t){var r=new i;return r._bitField=16777216,r._settledValueField=e,this._promiseResolved(t,r)},t.settle=function(e){return n.deprecated(".settle()",".reflect()"),new s(e).promise()},t.allSettled=function(e){return new s(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=e("./util"),s=e("./errors").RangeError,o=e("./errors").AggregateError,a=i.isArray,u={};function l(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(e,t){if((0|t)!==t||t<0)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var r=new l(e),i=r.promise();return r.setHowMany(t),r.init(),i}i.inherits(l,r),l.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=a(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(e){this._howMany=e},l.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},l.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new o,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(e){this._values.push(e)},l.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return c(e,t)},t.prototype.some=function(e){return c(this,e)},t._SomePromiseArray=l}},{"./errors":12,"./util":36}],32:[function(e,t,r){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},s=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},o=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return o.call(this._target())},e.prototype.isRejected=function(){return s.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,r){"use strict";t.exports=function(t,r){var n=e("./util"),i=n.errorObj,s=n.isObject,o={}.hasOwnProperty;return function(e,a){if(s(e)){if(e instanceof t)return e;var u=function(e){try{return function(e){return e.then}(e)}catch(CT){return i.e=CT,i}}(e);if(u===i){a&&a._pushContext();var l=t.reject(u.e);return a&&a._popContext(),l}if("function"==typeof u)return function(e){try{return o.call(e,"_promise0")}catch(CT){return!1}}(e)?(l=new t(r),e._then(l._fulfill,l._reject,void 0,l,null),l):function(e,s,o){var a=new t(r),u=a;o&&o._pushContext(),a._captureStackTrace(),o&&o._popContext();var l=n.tryCatch(s).call(e,(function(e){a&&(a._resolveCallback(e),a=null)}),(function(e){a&&(a._rejectCallback(e,!1,!0),a=null)}));return!1,a&&l===i&&(a._rejectCallback(l.e,!0,!0),a=null),u}(e,u,a)}return e}}},{"./util":36}],34:[function(e,t,r){"use strict";t.exports=function(t,r,n){var i=e("./util"),s=t.TimeoutError;function o(e){this.handle=e}o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(e){return u(+this).thenReturn(e)},u=t.delay=function(e,i){var s,u;return void 0!==i?(s=t.resolve(i)._then(a,null,null,e,void 0),n.cancellation()&&i instanceof t&&s._setOnCancel(i)):(s=new t(r),u=setTimeout((function(){s._fulfill()}),+e),n.cancellation()&&s._setOnCancel(new o(u)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};function l(e){return clearTimeout(this.handle),e}function c(e){throw clearTimeout(this.handle),e}t.prototype.delay=function(e){return u(e,this)},t.prototype.timeout=function(e,t){var r,a;e=+e;var u=new o(setTimeout((function(){r.isPending()&&function(e,t,r){var n;n="string"!=typeof t?t instanceof Error?t:new s("operation timed out"):new s(t),i.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._reject(n),null!=r&&r.cancel()}(r,t,a)}),e));return n.cancellation()?(a=this.then(),(r=a._then(l,c,void 0,u,void 0))._setOnCancel(u)):r=this._then(l,c,void 0,u,void 0),r}}},{"./util":36}],35:[function(e,t,r){"use strict";t.exports=function(t,r,n,i,s,o){var a=e("./util"),u=e("./errors").TypeError,l=e("./util").inherits,c=a.errorObj,h=a.tryCatch,d={};function f(e){setTimeout((function(){throw e}),0)}function p(e,r){var i=0,o=e.length,a=new t(s);return function s(){if(i>=o)return a._fulfill();var u=function(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(e[i++]);if(u instanceof t&&u._isDisposable()){try{u=n(u._getDisposer().tryDispose(r),e.promise)}catch(CT){return f(CT)}if(u instanceof t)return u._then(s,f,null,null,null)}s()}(),a}function m(e,t,r){this._data=e,this._promise=t,this._context=r}function y(e,t,r){this.constructor$(e,t,r)}function g(e){return m.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function v(e){this.length=e,this.promise=null,this[e-1]=null}m.prototype.data=function(){return this._data},m.prototype.promise=function(){return this._promise},m.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},m.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=t!==d?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},m.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},l(y,m),y.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},v.prototype._resultCancelled=function(){for(var e=this.length,r=0;r<e;++r){var n=this[r];n instanceof t&&n.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return r("you must pass at least 2 arguments to Promise.using");var i,s=arguments[e-1];if("function"!=typeof s)return r("expecting a function but got "+a.classString(s));var u=!0;2===e&&Array.isArray(arguments[0])?(e=(i=arguments[0]).length,u=!1):(i=arguments,e--);for(var l=new v(e),d=0;d<e;++d){var f=i[d];if(m.isDisposer(f)){var y=f;(f=f.promise())._setDisposable(y)}else{var b=n(f);b instanceof t&&(f=b._then(g,null,null,{resources:l,index:d},void 0))}l[d]=f}var _=new Array(l.length);for(d=0;d<_.length;++d)_[d]=t.resolve(l[d]).reflect();var w=t.all(_).then((function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return c.e=r.error(),c;if(!r.isFulfilled())return void w.cancel();e[t]=r.value()}E._pushContext(),s=h(s);var n=u?s.apply(void 0,e):s(e),i=E._popContext();return o.checkForgottenReturns(n,i,"Promise.using",E),n})),E=w.lastly((function(){var e=new t.PromiseInspection(w);return p(l,e)}));return l.promise=E,E._setOnCancel(l),E},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new y(e,this,i());throw new u}}},{"./errors":12,"./util":36}],36:[function(r,n,i){"use strict";var s,o=r("./es5"),a="undefined"==typeof navigator,u={e:{}},l="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==this?this:null;function c(){try{var e=s;return s=null,e.apply(this,arguments)}catch(CT){return u.e=CT,u}}function h(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function d(e,t,r){if(h(e))return e;var n={value:r,configurable:!0,enumerable:!1,writable:!0};return o.defineProperty(e,t,n),e}var f=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(o.isES5){var r=Object.getOwnPropertyNames;return function(e){for(var n=[],i=Object.create(null);null!=e&&!t(e);){var s;try{s=r(e)}catch(CT){return n}for(var a=0;a<s.length;++a){var u=s[a];if(!i[u]){i[u]=!0;var l=Object.getOwnPropertyDescriptor(e,u);null!=l&&null==l.get&&null==l.set&&n.push(u)}}e=o.getPrototypeOf(e)}return n}}var n={}.hasOwnProperty;return function(r){if(t(r))return[];var i=[];e:for(var s in r)if(n.call(r,s))i.push(s);else{for(var o=0;o<e.length;++o)if(n.call(e[o],s))continue e;i.push(s)}return i}}(),p=/this\s*\.\s*\S+\s*=/;var m=/^[a-z$_][a-z$_0-9]*$/i;function y(e){try{return e+""}catch(CT){return"[no string representation]"}}function g(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function v(e){return g(e)&&o.propertyIsWritable(e,"stack")}var b="stack"in new Error?function(e){return v(e)?e:new Error(y(e))}:function(e){if(v(e))return e;try{throw new Error(y(e))}catch(t){return t}};function _(e){return{}.toString.call(e)}var w=function(e){return o.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var E="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],n=e[Symbol.iterator]();!(t=n.next()).done;)r.push(t.value);return r};w=function(e){return o.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?E(e):null}}var C,T=void 0!==e&&"[object process]"===_(e).toLowerCase(),N=void 0!==e&&void 0!==e.env;var k,O={setReflectHandler:function(e){C=e},isClass:function(e){try{if("function"==typeof e){var t=o.names(e.prototype),r=o.isES5&&t.length>1,n=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=p.test(e+"")&&o.names(e).length>0;if(r||n||i)return!0}return!1}catch(CT){return!1}},isIdentifier:function(e){return m.test(e)},inheritedDataKeys:f,getDataPropertyOrDefault:function(e,t,r){if(!o.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var n=Object.getOwnPropertyDescriptor(e,t);return null!=n?null==n.get&&null==n.set?n.value:r:void 0},thrower:function(e){throw e},isArray:o.isArray,asArray:w,notEnumerableProp:d,isPrimitive:h,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:g,canEvaluate:a,errorObj:u,tryCatch:function(e){return s=e,c},inherits:function(e,t){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}return n.prototype=t.prototype,e.prototype=new n,e.prototype},withAppended:function(e,t){var r,n=e.length,i=new Array(n+1);for(r=0;r<n;++r)i[r]=e[r];return i[r]=t,i},maybeWrapAsError:function(e){return h(e)?new Error(y(e)):e},toFastProperties:function(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.foo}return n(),n(),e},filledRange:function(e,t,r){for(var n=new Array(e),i=0;i<e;++i)n[i]=t+i+r;return n},toString:y,canAttachTrace:v,ensureErrorObject:b,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{d(e,"isOperational",!0)}catch(t){}},classString:_,copyDescriptors:function(e,t,r){for(var n=o.names(e),i=0;i<n.length;++i){var s=n[i];if(r(s))try{o.defineProperty(t,s,o.getDescriptor(e,s))}catch(a){}}},isNode:T,hasEnvVariables:N,env:function(t){return N?e.env[t]:void 0},global:l,getNativePromise:function(){if("function"==typeof Promise)try{if("[object Promise]"===_(new Promise((function(){}))))return Promise}catch(CT){}},contextBind:function(e,t){if(null===e||"function"!=typeof t||t===C)return t;null!==e.domain&&(t=e.domain.bind(t));var r=e.async;if(null!==r){var n=t;t=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=n,e[1]=this,r.runInAsyncScope.apply(r,e)}}return t}};O.isRecentNode=O.isNode&&(e.versions&&e.versions.node?k=e.versions.node.split(".").map(Number):e.version&&(k=e.version.split(".").map(Number)),0===k[0]&&k[1]>10||k[0]>0),O.nodeSupportsAsyncResource=O.isNode&&function(){var e=!1;try{e="function"==typeof r("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(CT){e=!1}return e}(),O.isNode&&O.toFastProperties(e);try{throw new Error}catch(CT){O.lastLineError=CT}n.exports=O},{"./es5":13,async_hooks:void 0}]},{},[4])(4)})),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("timers").setImmediate);(D=D.exports).config({cancellation:!0});var F={};function U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V(e,t,r){return t&&U(e.prototype,t),r&&U(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B(){return(B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function z(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,W(e,t)}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(CT){return!1}}function J(e,t,r){return(J=Q()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&W(i,r.prototype),i}).apply(null,arguments)}function G(e){var t="function"==typeof Map?new Map:void 0;return(G=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return J(e,arguments,H(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),W(n,e)})(e)}function K(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Z(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(F,"__esModule",{value:!0});var X=function(e){function t(){return e.apply(this,arguments)||this}return z(t,e),t}(G(Error)),ee=function(e){function t(t){return e.call(this,"Invalid DateTime: "+t.toMessage())||this}return z(t,e),t}(X),te=function(e){function t(t){return e.call(this,"Invalid Interval: "+t.toMessage())||this}return z(t,e),t}(X),re=function(e){function t(t){return e.call(this,"Invalid Duration: "+t.toMessage())||this}return z(t,e),t}(X),ne=function(e){function t(){return e.apply(this,arguments)||this}return z(t,e),t}(X),ie=function(e){function t(t){return e.call(this,"Invalid unit "+t)||this}return z(t,e),t}(X),se=function(e){function t(){return e.apply(this,arguments)||this}return z(t,e),t}(X),oe=function(e){function t(){return e.call(this,"Zone is an abstract class")||this}return z(t,e),t}(X),ae="numeric",ue="short",le="long",ce={year:ae,month:ae,day:ae},he={year:ae,month:ue,day:ae},de={year:ae,month:ue,day:ae,weekday:ue},fe={year:ae,month:le,day:ae},pe={year:ae,month:le,day:ae,weekday:le},me={hour:ae,minute:ae},ye={hour:ae,minute:ae,second:ae},ge={hour:ae,minute:ae,second:ae,timeZoneName:ue},ve={hour:ae,minute:ae,second:ae,timeZoneName:le},be={hour:ae,minute:ae,hourCycle:"h23"},_e={hour:ae,minute:ae,second:ae,hourCycle:"h23"},we={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:ue},Ee={hour:ae,minute:ae,second:ae,hourCycle:"h23",timeZoneName:le},Ce={year:ae,month:ae,day:ae,hour:ae,minute:ae},Te={year:ae,month:ae,day:ae,hour:ae,minute:ae,second:ae},Ne={year:ae,month:ue,day:ae,hour:ae,minute:ae},ke={year:ae,month:ue,day:ae,hour:ae,minute:ae,second:ae},Oe={year:ae,month:ue,day:ae,weekday:ue,hour:ae,minute:ae},Se={year:ae,month:le,day:ae,hour:ae,minute:ae,timeZoneName:ue},xe={year:ae,month:le,day:ae,hour:ae,minute:ae,second:ae,timeZoneName:ue},$e={year:ae,month:le,day:ae,weekday:le,hour:ae,minute:ae,timeZoneName:le},Ae={year:ae,month:le,day:ae,weekday:le,hour:ae,minute:ae,second:ae,timeZoneName:le};function je(e){return void 0===e}function Ie(e){return"number"==typeof e}function Re(e){return"number"==typeof e&&e%1==0}function Pe(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(CT){return!1}}function Me(e,t,r){if(0!==e.length)return e.reduce((function(e,n){var i=[t(n),n];return e&&r(e[0],i[0])===e[0]?e:i}),null)[1]}function Le(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function qe(e,t,r){return Re(e)&&e>=t&&e<=r}function De(e,t){return void 0===t&&(t=2),e<0?"-"+(""+-e).padStart(t,"0"):(""+e).padStart(t,"0")}function Fe(e){return je(e)||null===e||""===e?void 0:parseInt(e,10)}function Ue(e){return je(e)||null===e||""===e?void 0:parseFloat(e)}function Ve(e){if(!je(e)&&null!==e&&""!==e){var t=1e3*parseFloat("0."+e);return Math.floor(t)}}function Be(e,t,r){void 0===r&&(r=!1);var n=Math.pow(10,t);return(r?Math.trunc:Math.round)(e*n)/n}function ze(e){return e%4==0&&(e%100!=0||e%400==0)}function He(e){return ze(e)?366:365}function We(e,t){var r,n=(r=t-1)-12*Math.floor(r/12)+1;return 2===n?ze(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function Qe(e){var t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t)).setUTCFullYear(t.getUTCFullYear()-1900),+t}function Je(e){var t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,r=e-1,n=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7;return 4===t||3===n?53:52}function Ge(e){return e>99?e:e>60?1900+e:2e3+e}function Ke(e,t,r,n){void 0===n&&(n=null);var i=new Date(e),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);var o=B({timeZoneName:t},s),a=new Intl.DateTimeFormat(r,o).formatToParts(i).find((function(e){return"timezonename"===e.type.toLowerCase()}));return a?a.value:null}function Ze(e,t){var r=parseInt(e,10);Number.isNaN(r)&&(r=0);var n=parseInt(t,10)||0;return 60*r+(r<0||Object.is(r,-0)?-n:n)}function Ye(e){var t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new se("Invalid unit value "+e);return t}function Xe(e,t){var r={};for(var n in e)if(Le(e,n)){var i=e[n];if(null==i)continue;r[t(n)]=Ye(i)}return r}function et(e,t){var r=Math.trunc(Math.abs(e/60)),n=Math.trunc(Math.abs(e%60)),i=e>=0?"+":"-";switch(t){case"short":return""+i+De(r,2)+":"+De(n,2);case"narrow":return""+i+r+(n>0?":"+n:"");case"techie":return""+i+De(r,2)+De(n,2);default:throw new RangeError("Value format "+t+" is out of range for property format")}}function tt(e){return function(e,t){return["hour","minute","second","millisecond"].reduce((function(t,r){return t[r]=e[r],t}),{})}(e)}var rt=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,nt=["January","February","March","April","May","June","July","August","September","October","November","December"],it=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],st=["J","F","M","A","M","J","J","A","S","O","N","D"];function ot(e){switch(e){case"narrow":return[].concat(st);case"short":return[].concat(it);case"long":return[].concat(nt);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var at=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ut=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],lt=["M","T","W","T","F","S","S"];function ct(e){switch(e){case"narrow":return[].concat(lt);case"short":return[].concat(ut);case"long":return[].concat(at);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var ht=["AM","PM"],dt=["Before Christ","Anno Domini"],ft=["BC","AD"],pt=["B","A"];function mt(e){switch(e){case"narrow":return[].concat(pt);case"short":return[].concat(ft);case"long":return[].concat(dt);default:return null}}function yt(e,t){for(var r,n="",i=Y(e);!(r=i()).done;){var s=r.value;s.literal?n+=s.val:n+=t(s.val)}return n}var gt={D:ce,DD:he,DDD:fe,DDDD:pe,t:me,tt:ye,ttt:ge,tttt:ve,T:be,TT:_e,TTT:we,TTTT:Ee,f:Ce,ff:Ne,fff:Se,ffff:$e,F:Te,FF:ke,FFF:xe,FFFF:Ae},vt=function(){function e(e,t){this.opts=t,this.loc=e,this.systemLoc=null}e.create=function(t,r){return void 0===r&&(r={}),new e(t,r)},e.parseFormat=function(e){for(var t=null,r="",n=!1,i=[],s=0;s<e.length;s++){var o=e.charAt(s);"'"===o?(r.length>0&&i.push({literal:n,val:r}),t=null,r="",n=!n):n||o===t?r+=o:(r.length>0&&i.push({literal:!1,val:r}),r=o,t=o)}return r.length>0&&i.push({literal:n,val:r}),i},e.macroTokenToFormatOpts=function(e){return gt[e]};var t=e.prototype;return t.formatWithSystemDefault=function(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,B({},this.opts,t)).format()},t.formatDateTime=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,B({},this.opts,t)).format()},t.formatDateTimeParts=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,B({},this.opts,t)).formatToParts()},t.resolvedOptions=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,B({},this.opts,t)).resolvedOptions()},t.num=function(e,t){if(void 0===t&&(t=0),this.opts.forceSimple)return De(e,t);var r=B({},this.opts);return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)},t.formatDateTimeFromString=function(t,r){var n=this,i="en"===this.loc.listingMode(),s=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,o=function(e,r){return n.loc.extract(t,e,r)},a=function(e){return t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):""},u=function(e,r){return i?function(e,t){return ot(t)[e.month-1]}(t,e):o(r?{month:e}:{month:e,day:"numeric"},"month")},l=function(e,r){return i?function(e,t){return ct(t)[e.weekday-1]}(t,e):o(r?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},c=function(e){return i?function(e,t){return mt(t)[e.year<0?0:1]}(t,e):o({era:e},"era")};return yt(e.parseFormat(r),(function(r){switch(r){case"S":return n.num(t.millisecond);case"u":case"SSS":return n.num(t.millisecond,3);case"s":return n.num(t.second);case"ss":return n.num(t.second,2);case"uu":return n.num(Math.floor(t.millisecond/10),2);case"uuu":return n.num(Math.floor(t.millisecond/100));case"m":return n.num(t.minute);case"mm":return n.num(t.minute,2);case"h":return n.num(t.hour%12==0?12:t.hour%12);case"hh":return n.num(t.hour%12==0?12:t.hour%12,2);case"H":return n.num(t.hour);case"HH":return n.num(t.hour,2);case"Z":return a({format:"narrow",allowZ:n.opts.allowZ});case"ZZ":return a({format:"short",allowZ:n.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:n.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:n.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:n.loc.locale});case"z":return t.zoneName;case"a":return i?function(e){return ht[e.hour<12?0:1]}(t):o({hour:"numeric",hourCycle:"h12"},"dayperiod");case"d":return s?o({day:"numeric"},"day"):n.num(t.day);case"dd":return s?o({day:"2-digit"},"day"):n.num(t.day,2);case"c":case"E":return n.num(t.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return s?o({month:"numeric",day:"numeric"},"month"):n.num(t.month);case"LL":return s?o({month:"2-digit",day:"numeric"},"month"):n.num(t.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return s?o({month:"numeric"},"month"):n.num(t.month);case"MM":return s?o({month:"2-digit"},"month"):n.num(t.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return s?o({year:"numeric"},"year"):n.num(t.year);case"yy":return s?o({year:"2-digit"},"year"):n.num(t.year.toString().slice(-2),2);case"yyyy":return s?o({year:"numeric"},"year"):n.num(t.year,4);case"yyyyyy":return s?o({year:"numeric"},"year"):n.num(t.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return n.num(t.weekYear.toString().slice(-2),2);case"kkkk":return n.num(t.weekYear,4);case"W":return n.num(t.weekNumber);case"WW":return n.num(t.weekNumber,2);case"o":return n.num(t.ordinal);case"ooo":return n.num(t.ordinal,3);case"q":return n.num(t.quarter);case"qq":return n.num(t.quarter,2);case"X":return n.num(Math.floor(t.ts/1e3));case"x":return n.num(t.ts);default:return function(r){var i=e.macroTokenToFormatOpts(r);return i?n.formatWithSystemDefault(t,i):r}(r)}}))},t.formatDurationFromString=function(t,r){var n,i=this,s=function(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=e.parseFormat(r),a=o.reduce((function(e,t){var r=t.literal,n=t.val;return r?e:e.concat(n)}),[]),u=t.shiftTo.apply(t,a.map(s).filter((function(e){return e})));return yt(o,(n=u,function(e){var t=s(e);return t?i.num(n.get(t),e.length):e}))},e}(),bt=function(){function e(e,t){this.reason=e,this.explanation=t}return e.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},e}(),_t=function(){function e(){}var t=e.prototype;return t.offsetName=function(e,t){throw new oe},t.formatOffset=function(e,t){throw new oe},t.offset=function(e){throw new oe},t.equals=function(e){throw new oe},V(e,[{key:"type",get:function(){throw new oe}},{key:"name",get:function(){throw new oe}},{key:"ianaName",get:function(){return this.name}},{key:"isUniversal",get:function(){throw new oe}},{key:"isValid",get:function(){throw new oe}}]),e}(),wt=null,Et=function(e){function t(){return e.apply(this,arguments)||this}z(t,e);var r=t.prototype;return r.offsetName=function(e,t){return Ke(e,t.format,t.locale)},r.formatOffset=function(e,t){return et(this.offset(e),t)},r.offset=function(e){return-new Date(e).getTimezoneOffset()},r.equals=function(e){return"system"===e.type},V(t,[{key:"type",get:function(){return"system"}},{key:"name",get:function(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return null===wt&&(wt=new t),wt}}]),t}(_t),Ct={},Tt={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6},Nt={},kt=function(e){function t(r){var n;return(n=e.call(this)||this).zoneName=r,n.valid=t.isValidZone(r),n}z(t,e),t.create=function(e){return Nt[e]||(Nt[e]=new t(e)),Nt[e]},t.resetCache=function(){Nt={},Ct={}},t.isValidSpecifier=function(e){return this.isValidZone(e)},t.isValidZone=function(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(CT){return!1}};var r=t.prototype;return r.offsetName=function(e,t){return Ke(e,t.format,t.locale,this.name)},r.formatOffset=function(e,t){return et(this.offset(e),t)},r.offset=function(e){var t=new Date(e);if(isNaN(t))return NaN;var r,n=(r=this.name,Ct[r]||(Ct[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Ct[r]),i=n.formatToParts?function(e,t){for(var r=e.formatToParts(t),n=[],i=0;i<r.length;i++){var s=r[i],o=s.type,a=s.value,u=Tt[o];"era"===o?n[u]=a:je(u)||(n[u]=parseInt(a,10))}return n}(n,t):function(e,t){var r=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),i=n[1],s=n[2];return[n[3],i,s,n[4],n[5],n[6],n[7]]}(n,t),s=i[0],o=i[1],a=i[2],u=i[3],l=i[4],c=i[5],h=i[6];"BC"===u&&(s=1-Math.abs(s));var d=+t,f=d%1e3;return(Qe({year:s,month:o,day:a,hour:24===l?0:l,minute:c,second:h,millisecond:0})-(d-=f>=0?f:1e3+f))/6e4},r.equals=function(e){return"iana"===e.type&&e.name===this.name},V(t,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),t}(_t),Ot=null,St=function(e){function t(t){var r;return(r=e.call(this)||this).fixed=t,r}z(t,e),t.instance=function(e){return 0===e?t.utcInstance:new t(e)},t.parseSpecifier=function(e){if(e){var r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new t(Ze(r[1],r[2]))}return null};var r=t.prototype;return r.offsetName=function(){return this.name},r.formatOffset=function(e,t){return et(this.fixed,t)},r.offset=function(){return this.fixed},r.equals=function(e){return"fixed"===e.type&&e.fixed===this.fixed},V(t,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+et(this.fixed,"narrow")}},{key:"ianaName",get:function(){return 0===this.fixed?"Etc/UTC":"Etc/GMT"+et(-this.fixed,"narrow")}},{key:"isUniversal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}],[{key:"utcInstance",get:function(){return null===Ot&&(Ot=new t(0)),Ot}}]),t}(_t),xt=function(e){function t(t){var r;return(r=e.call(this)||this).zoneName=t,r}z(t,e);var r=t.prototype;return r.offsetName=function(){return null},r.formatOffset=function(){return""},r.offset=function(){return NaN},r.equals=function(){return!1},V(t,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"isUniversal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),t}(_t);function $t(e,t){if(je(e)||null===e)return t;if(e instanceof _t)return e;if("string"==typeof e){var r=e.toLowerCase();return"default"===r?t:"local"===r||"system"===r?Et.instance:"utc"===r||"gmt"===r?St.utcInstance:St.parseSpecifier(r)||kt.create(e)}return Ie(e)?St.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new xt(e)}var At,jt=function(){return Date.now()},It="system",Rt=null,Pt=null,Mt=null,Lt=function(){function e(){}return e.resetCaches=function(){Kt.resetCache(),kt.resetCache()},V(e,null,[{key:"now",get:function(){return jt},set:function(e){jt=e}},{key:"defaultZone",get:function(){return $t(It,Et.instance)},set:function(e){It=e}},{key:"defaultLocale",get:function(){return Rt},set:function(e){Rt=e}},{key:"defaultNumberingSystem",get:function(){return Pt},set:function(e){Pt=e}},{key:"defaultOutputCalendar",get:function(){return Mt},set:function(e){Mt=e}},{key:"throwOnInvalid",get:function(){return At},set:function(e){At=e}}]),e}(),qt=["base"],Dt=["padTo","floor"],Ft={},Ut={};function Vt(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=Ut[r];return n||(n=new Intl.DateTimeFormat(e,t),Ut[r]=n),n}var Bt={},zt={},Ht=null;function Wt(e,t,r,n,i){var s=e.listingMode(r);return"error"===s?null:"en"===s?n(t):i(t)}var Qt=function(){function e(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1,r.padTo,r.floor;var n=K(r,Dt);if(!t||Object.keys(n).length>0){var i=B({useGrouping:!1},r);r.padTo>0&&(i.minimumIntegerDigits=r.padTo),this.inf=function(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=Bt[r];return n||(n=new Intl.NumberFormat(e,t),Bt[r]=n),n}(e,i)}}return e.prototype.format=function(e){if(this.inf){var t=this.floor?Math.floor(e):e;return this.inf.format(t)}return De(this.floor?Math.floor(e):Be(e,3),this.padTo)},e}(),Jt=function(){function e(e,t,r){var n;if(this.opts=r,e.zone.isUniversal){var i=e.offset/60*-1,s=i>=0?"Etc/GMT+"+i:"Etc/GMT"+i;0!==e.offset&&kt.create(s).valid?(n=s,this.dt=e):(n="UTC",r.timeZoneName?this.dt=e:this.dt=0===e.offset?e:Jn.fromMillis(e.ts+60*e.offset*1e3))}else"system"===e.zone.type?this.dt=e:(this.dt=e,n=e.zone.name);var o=B({},this.opts);n&&(o.timeZone=n),this.dtf=Vt(t,o)}var t=e.prototype;return t.format=function(){return this.dtf.format(this.dt.toJSDate())},t.formatToParts=function(){return this.dtf.formatToParts(this.dt.toJSDate())},t.resolvedOptions=function(){return this.dtf.resolvedOptions()},e}(),Gt=function(){function e(e,t,r){this.opts=B({style:"long"},r),!t&&Pe()&&(this.rtf=function(e,t){void 0===t&&(t={});var r=t;r.base;var n=K(r,qt),i=JSON.stringify([e,n]),s=zt[i];return s||(s=new Intl.RelativeTimeFormat(e,t),zt[i]=s),s}(e,r))}var t=e.prototype;return t.format=function(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,r,n){void 0===r&&(r="always"),void 0===n&&(n=!1);var i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===r&&s){var o="days"===e;switch(t){case 1:return o?"tomorrow":"next "+i[e][0];case-1:return o?"yesterday":"last "+i[e][0];case 0:return o?"today":"this "+i[e][0]}}var a=Object.is(t,-0)||t<0,u=Math.abs(t),l=1===u,c=i[e],h=n?l?c[1]:c[2]||c[1]:l?i[e][0]:e;return a?u+" "+h+" ago":"in "+u+" "+h}(t,e,this.opts.numeric,"long"!==this.opts.style)},t.formatToParts=function(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]},e}(),Kt=function(){function e(e,t,r,n){var i=function(e){var t=e.indexOf("-u-");if(-1===t)return[e];var r,n=e.substring(0,t);try{r=Vt(e).resolvedOptions()}catch(CT){r=Vt(n).resolvedOptions()}var i=r;return[n,i.numberingSystem,i.calendar]}(e),s=i[0],o=i[1],a=i[2];this.locale=s,this.numberingSystem=t||o||null,this.outputCalendar=r||a||null,this.intl=function(e,t,r){return r||t?(e+="-u",r&&(e+="-ca-"+r),t&&(e+="-nu-"+t),e):e}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}e.fromOpts=function(t){return e.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)},e.create=function(t,r,n,i){void 0===i&&(i=!1);var s=t||Lt.defaultLocale;return new e(s||(i?"en-US":Ht||(Ht=(new Intl.DateTimeFormat).resolvedOptions().locale)),r||Lt.defaultNumberingSystem,n||Lt.defaultOutputCalendar,s)},e.resetCache=function(){Ht=null,Ut={},Bt={},zt={}},e.fromObject=function(t){var r=void 0===t?{}:t,n=r.locale,i=r.numberingSystem,s=r.outputCalendar;return e.create(n,i,s)};var t=e.prototype;return t.listingMode=function(){var e=this.isEnglish(),t=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e&&t?"en":"intl"},t.clone=function(t){return t&&0!==Object.getOwnPropertyNames(t).length?e.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this},t.redefaultToEN=function(e){return void 0===e&&(e={}),this.clone(B({},e,{defaultToEN:!0}))},t.redefaultToSystem=function(e){return void 0===e&&(e={}),this.clone(B({},e,{defaultToEN:!1}))},t.months=function(e,t,r){var n=this;return void 0===t&&(t=!1),void 0===r&&(r=!0),Wt(this,e,r,ot,(function(){var r=t?{month:e,day:"numeric"}:{month:e},i=t?"format":"standalone";return n.monthsCache[i][e]||(n.monthsCache[i][e]=function(e){for(var t=[],r=1;r<=12;r++){var n=Jn.utc(2016,r,1);t.push(e(n))}return t}((function(e){return n.extract(e,r,"month")}))),n.monthsCache[i][e]}))},t.weekdays=function(e,t,r){var n=this;return void 0===t&&(t=!1),void 0===r&&(r=!0),Wt(this,e,r,ct,(function(){var r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=t?"format":"standalone";return n.weekdaysCache[i][e]||(n.weekdaysCache[i][e]=function(e){for(var t=[],r=1;r<=7;r++){var n=Jn.utc(2016,11,13+r);t.push(e(n))}return t}((function(e){return n.extract(e,r,"weekday")}))),n.weekdaysCache[i][e]}))},t.meridiems=function(e){var t=this;return void 0===e&&(e=!0),Wt(this,void 0,e,(function(){return ht}),(function(){if(!t.meridiemCache){var e={hour:"numeric",hourCycle:"h12"};t.meridiemCache=[Jn.utc(2016,11,13,9),Jn.utc(2016,11,13,19)].map((function(r){return t.extract(r,e,"dayperiod")}))}return t.meridiemCache}))},t.eras=function(e,t){var r=this;return void 0===t&&(t=!0),Wt(this,e,t,mt,(function(){var t={era:e};return r.eraCache[e]||(r.eraCache[e]=[Jn.utc(-40,1,1),Jn.utc(2017,1,1)].map((function(e){return r.extract(e,t,"era")}))),r.eraCache[e]}))},t.extract=function(e,t,r){var n=this.dtFormatter(e,t).formatToParts().find((function(e){return e.type.toLowerCase()===r}));return n?n.value:null},t.numberFormatter=function(e){return void 0===e&&(e={}),new Qt(this.intl,e.forceSimple||this.fastNumbers,e)},t.dtFormatter=function(e,t){return void 0===t&&(t={}),new Jt(e,this.intl,t)},t.relFormatter=function(e){return void 0===e&&(e={}),new Gt(this.intl,this.isEnglish(),e)},t.listFormatter=function(e){return void 0===e&&(e={}),function(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=Ft[r];return n||(n=new Intl.ListFormat(e,t),Ft[r]=n),n}(this.intl,e)},t.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},t.equals=function(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar},V(e,[{key:"fastNumbers",get:function(){return null==this.fastNumbersCached&&(this.fastNumbersCached=(!this.numberingSystem||"latn"===this.numberingSystem)&&("latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(this.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),e}();function Zt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return e+t.source}),"");return RegExp("^"+n+"$")}function Yt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce((function(t,r){var n=t[0],i=t[1],s=t[2],o=r(e,s),a=o[0],u=o[1],l=o[2];return[B({},n,a),u||i,l]}),[{},null,1]).slice(0,2)}}function Xt(e){if(null==e)return[null,null];for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,s=r;i<s.length;i++){var o=s[i],a=o[0],u=o[1],l=a.exec(e);if(l)return u(l)}return[null,null]}function er(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r){var n,i={};for(n=0;n<t.length;n++)i[t[n]]=Fe(e[r+n]);return[i,null,r+n]}}var tr=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,rr=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,nr=RegExp(rr.source+"(?:"+tr.source+"?(?:\\[("+rt.source+")\\])?)?"),ir=RegExp("(?:T"+nr.source+")?"),sr=er("weekYear","weekNumber","weekDay"),or=er("year","ordinal"),ar=RegExp(rr.source+" ?(?:"+tr.source+"|("+rt.source+"))?"),ur=RegExp("(?: "+ar.source+")?");function lr(e,t,r){var n=e[t];return je(n)?r:Fe(n)}function cr(e,t){return[{hours:lr(e,t,0),minutes:lr(e,t+1,0),seconds:lr(e,t+2,0),milliseconds:Ve(e[t+3])},null,t+4]}function hr(e,t){var r=!e[t]&&!e[t+1],n=Ze(e[t+1],e[t+2]);return[{},r?null:St.instance(n),t+3]}function dr(e,t){return[{},e[t]?kt.create(e[t]):null,t+1]}var fr=RegExp("^T?"+rr.source+"$"),pr=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function mr(e){var t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],l=e[8],c="-"===t[0],h=u&&"-"===u[0],d=function(e,t){return void 0===t&&(t=!1),void 0!==e&&(t||e&&c)?-e:e};return[{years:d(Ue(r)),months:d(Ue(n)),weeks:d(Ue(i)),days:d(Ue(s)),hours:d(Ue(o)),minutes:d(Ue(a)),seconds:d(Ue(u),"-0"===u),milliseconds:d(Ve(l),h)}]}var yr={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function gr(e,t,r,n,i,s,o){var a={year:2===t.length?Ge(Fe(t)):Fe(t),month:it.indexOf(r)+1,day:Fe(n),hour:Fe(i),minute:Fe(s)};return o&&(a.second=Fe(o)),e&&(a.weekday=e.length>3?at.indexOf(e)+1:ut.indexOf(e)+1),a}var vr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function br(e){var t,r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],l=e[8],c=e[9],h=e[10],d=e[11],f=gr(r,s,i,n,o,a,u);return t=l?yr[l]:c?0:Ze(h,d),[f,new St(t)]}var _r=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,wr=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Er=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Cr(e){var t=e[1],r=e[2],n=e[3];return[gr(t,e[4],n,r,e[5],e[6],e[7]),St.utcInstance]}function Tr(e){var t=e[1],r=e[2],n=e[3],i=e[4],s=e[5],o=e[6];return[gr(t,e[7],r,n,i,s,o),St.utcInstance]}var Nr=Zt(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,ir),kr=Zt(/(\d{4})-?W(\d\d)(?:-?(\d))?/,ir),Or=Zt(/(\d{4})-?(\d{3})/,ir),Sr=Zt(nr),xr=Yt((function(e,t){return[{year:lr(e,t),month:lr(e,t+1,1),day:lr(e,t+2,1)},null,t+3]}),cr,hr,dr),$r=Yt(sr,cr,hr,dr),Ar=Yt(or,cr,hr,dr),jr=Yt(cr,hr,dr),Ir=Yt(cr),Rr=Zt(/(\d{4})-(\d\d)-(\d\d)/,ur),Pr=Zt(ar),Mr=Yt(cr,hr,dr),Lr={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},qr=B({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},Lr),Dr=B({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},Lr),Fr=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Ur=Fr.slice(0).reverse();function Vr(e,t,r){void 0===r&&(r=!1);var n={values:r?t.values:B({},e.values,t.values||{}),loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new zr(n)}function Br(e,t,r,n,i){var s,o=e[i][r],a=t[r]/o,u=Math.sign(a)!==Math.sign(n[i])&&0!==n[i]&&Math.abs(a)<=1?(s=a)<0?Math.floor(s):Math.ceil(s):Math.trunc(a);n[i]+=u,t[r]-=u*o}var zr=function(){function e(e){var t="longterm"===e.conversionAccuracy||!1,r=t?Dr:qr;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Kt.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}e.fromMillis=function(t,r){return e.fromObject({milliseconds:t},r)},e.fromObject=function(t,r){if(void 0===r&&(r={}),null==t||"object"!=typeof t)throw new se("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new e({values:Xe(t,e.normalizeUnit),loc:Kt.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})},e.fromDurationLike=function(t){if(Ie(t))return e.fromMillis(t);if(e.isDuration(t))return t;if("object"==typeof t)return e.fromObject(t);throw new se("Unknown duration argument "+t+" of type "+typeof t)},e.fromISO=function(t,r){var n=function(e){return Xt(e,[pr,mr])}(t)[0];return n?e.fromObject(n,r):e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.fromISOTime=function(t,r){var n=function(e){return Xt(e,[fr,Ir])}(t)[0];return n?e.fromObject(n,r):e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new se("need to specify a reason the Duration is invalid");var n=t instanceof bt?t:new bt(t,r);if(Lt.throwOnInvalid)throw new re(n);return new e({invalid:n})},e.normalizeUnit=function(e){var t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new ie(e);return t},e.isDuration=function(e){return e&&e.isLuxonDuration||!1};var t=e.prototype;return t.toFormat=function(e,t){void 0===t&&(t={});var r=B({},t,{floor:!1!==t.round&&!1!==t.floor});return this.isValid?vt.create(this.loc,r).formatDurationFromString(this,e):"Invalid Duration"},t.toHuman=function(e){var t=this;void 0===e&&(e={});var r=Fr.map((function(r){var n=t.values[r];return je(n)?null:t.loc.numberFormatter(B({style:"unit",unitDisplay:"long"},e,{unit:r.slice(0,-1)})).format(n)})).filter((function(e){return e}));return this.loc.listFormatter(B({type:"conjunction",style:e.listStyle||"narrow"},e)).format(r)},t.toObject=function(){return this.isValid?B({},this.values):{}},t.toISO=function(){if(!this.isValid)return null;var e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=Be(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e},t.toISOTime=function(e){if(void 0===e&&(e={}),!this.isValid)return null;var t=this.toMillis();if(t<0||t>=864e5)return null;e=B({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},e);var r=this.shiftTo("hours","minutes","seconds","milliseconds"),n="basic"===e.format?"hhmm":"hh:mm";e.suppressSeconds&&0===r.seconds&&0===r.milliseconds||(n+="basic"===e.format?"ss":":ss",e.suppressMilliseconds&&0===r.milliseconds||(n+=".SSS"));var i=r.toFormat(n);return e.includePrefix&&(i="T"+i),i},t.toJSON=function(){return this.toISO()},t.toString=function(){return this.toISO()},t.toMillis=function(){return this.as("milliseconds")},t.valueOf=function(){return this.toMillis()},t.plus=function(t){if(!this.isValid)return this;for(var r,n=e.fromDurationLike(t),i={},s=Y(Fr);!(r=s()).done;){var o=r.value;(Le(n.values,o)||Le(this.values,o))&&(i[o]=n.get(o)+this.get(o))}return Vr(this,{values:i},!0)},t.minus=function(t){if(!this.isValid)return this;var r=e.fromDurationLike(t);return this.plus(r.negate())},t.mapUnits=function(e){if(!this.isValid)return this;for(var t={},r=0,n=Object.keys(this.values);r<n.length;r++){var i=n[r];t[i]=Ye(e(this.values[i],i))}return Vr(this,{values:t},!0)},t.get=function(t){return this[e.normalizeUnit(t)]},t.set=function(t){return this.isValid?Vr(this,{values:B({},this.values,Xe(t,e.normalizeUnit))}):this},t.reconfigure=function(e){var t=void 0===e?{}:e,r=t.locale,n=t.numberingSystem,i=t.conversionAccuracy,s=t.matrix;return Vr(this,{loc:this.loc.clone({locale:r,numberingSystem:n}),matrix:s,conversionAccuracy:i})},t.as=function(e){return this.isValid?this.shiftTo(e).get(e):NaN},t.normalize=function(){if(!this.isValid)return this;var e=this.toObject();return function(e,t){Ur.reduce((function(r,n){return je(t[n])?r:(r&&Br(e,t,r,t,n),n)}),null)}(this.matrix,e),Vr(this,{values:e},!0)},t.rescale=function(){return this.isValid?Vr(this,{values:function(e){for(var t={},r=0,n=Object.entries(e);r<n.length;r++){var i=n[r],s=i[0],o=i[1];0!==o&&(t[s]=o)}return t}(this.normalize().shiftToAll().toObject())},!0):this},t.shiftTo=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!this.isValid)return this;if(0===r.length)return this;r=r.map((function(t){return e.normalizeUnit(t)}));for(var i,s,o={},a={},u=this.toObject(),l=Y(Fr);!(s=l()).done;){var c=s.value;if(r.indexOf(c)>=0){i=c;var h=0;for(var d in a)h+=this.matrix[d][c]*a[d],a[d]=0;Ie(u[c])&&(h+=u[c]);var f=Math.trunc(h);for(var p in o[c]=f,a[c]=(1e3*h-1e3*f)/1e3,u)Fr.indexOf(p)>Fr.indexOf(c)&&Br(this.matrix,u,p,o,c)}else Ie(u[c])&&(a[c]=u[c])}for(var m in a)0!==a[m]&&(o[i]+=m===i?a[m]:a[m]/this.matrix[i][m]);return Vr(this,{values:o},!0).normalize()},t.shiftToAll=function(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this},t.negate=function(){if(!this.isValid)return this;for(var e={},t=0,r=Object.keys(this.values);t<r.length;t++){var n=r[t];e[n]=0===this.values[n]?0:-this.values[n]}return Vr(this,{values:e},!0)},t.equals=function(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(var t,r=Y(Fr);!(t=r()).done;){var n=t.value;if(i=this.values[n],s=e.values[n],!(void 0===i||0===i?void 0===s||0===s:i===s))return!1}var i,s;return!0},V(e,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}(),Hr="Invalid Interval";function Wr(e,t){return e&&e.isValid?t&&t.isValid?t<e?Qr.invalid("end before start","The end of an interval must be after its start, but you had start="+e.toISO()+" and end="+t.toISO()):null:Qr.invalid("missing or invalid end"):Qr.invalid("missing or invalid start")}var Qr=function(){function e(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new se("need to specify a reason the Interval is invalid");var n=t instanceof bt?t:new bt(t,r);if(Lt.throwOnInvalid)throw new te(n);return new e({invalid:n})},e.fromDateTimes=function(t,r){var n=Gn(t),i=Gn(r),s=Wr(n,i);return null==s?new e({start:n,end:i}):s},e.after=function(t,r){var n=zr.fromDurationLike(r),i=Gn(t);return e.fromDateTimes(i,i.plus(n))},e.before=function(t,r){var n=zr.fromDurationLike(r),i=Gn(t);return e.fromDateTimes(i.minus(n),i)},e.fromISO=function(t,r){var n=(t||"").split("/",2),i=n[0],s=n[1];if(i&&s){var o,a,u,l;try{a=(o=Jn.fromISO(i,r)).isValid}catch(s){a=!1}try{l=(u=Jn.fromISO(s,r)).isValid}catch(s){l=!1}if(a&&l)return e.fromDateTimes(o,u);if(a){var c=zr.fromISO(s,r);if(c.isValid)return e.after(o,c)}else if(l){var h=zr.fromISO(i,r);if(h.isValid)return e.before(u,h)}}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.isInterval=function(e){return e&&e.isLuxonInterval||!1};var t=e.prototype;return t.length=function(e){return void 0===e&&(e="milliseconds"),this.isValid?this.toDuration.apply(this,[e]).get(e):NaN},t.count=function(e){if(void 0===e&&(e="milliseconds"),!this.isValid)return NaN;var t=this.start.startOf(e),r=this.end.startOf(e);return Math.floor(r.diff(t,e).get(e))+1},t.hasSame=function(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))},t.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},t.isAfter=function(e){return!!this.isValid&&this.s>e},t.isBefore=function(e){return!!this.isValid&&this.e<=e},t.contains=function(e){return!!this.isValid&&this.s<=e&&this.e>e},t.set=function(t){var r=void 0===t?{}:t,n=r.start,i=r.end;return this.isValid?e.fromDateTimes(n||this.s,i||this.e):this},t.splitAt=function(){var t=this;if(!this.isValid)return[];for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];for(var s=n.map(Gn).filter((function(e){return t.contains(e)})).sort(),o=[],a=this.s,u=0;a<this.e;){var l=s[u]||this.e,c=+l>+this.e?this.e:l;o.push(e.fromDateTimes(a,c)),a=c,u+=1}return o},t.splitBy=function(t){var r=zr.fromDurationLike(t);if(!this.isValid||!r.isValid||0===r.as("milliseconds"))return[];for(var n,i=this.s,s=1,o=[];i<this.e;){var a=this.start.plus(r.mapUnits((function(e){return e*s})));n=+a>+this.e?this.e:a,o.push(e.fromDateTimes(i,n)),i=n,s+=1}return o},t.divideEqually=function(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]},t.overlaps=function(e){return this.e>e.s&&this.s<e.e},t.abutsStart=function(e){return!!this.isValid&&+this.e==+e.s},t.abutsEnd=function(e){return!!this.isValid&&+e.e==+this.s},t.engulfs=function(e){return!!this.isValid&&this.s<=e.s&&this.e>=e.e},t.equals=function(e){return!(!this.isValid||!e.isValid)&&this.s.equals(e.s)&&this.e.equals(e.e)},t.intersection=function(t){if(!this.isValid)return this;var r=this.s>t.s?this.s:t.s,n=this.e<t.e?this.e:t.e;return r>=n?null:e.fromDateTimes(r,n)},t.union=function(t){if(!this.isValid)return this;var r=this.s<t.s?this.s:t.s,n=this.e>t.e?this.e:t.e;return e.fromDateTimes(r,n)},e.merge=function(e){var t=e.sort((function(e,t){return e.s-t.s})).reduce((function(e,t){var r=e[0],n=e[1];return n?n.overlaps(t)||n.abutsStart(t)?[r,n.union(t)]:[r.concat([n]),t]:[r,t]}),[[],null]),r=t[0],n=t[1];return n&&r.push(n),r},e.xor=function(t){for(var r,n,i=null,s=0,o=[],a=t.map((function(e){return[{time:e.s,type:"s"},{time:e.e,type:"e"}]})),u=Y((r=Array.prototype).concat.apply(r,a).sort((function(e,t){return e.time-t.time})));!(n=u()).done;){var l=n.value;1===(s+="s"===l.type?1:-1)?i=l.time:(i&&+i!=+l.time&&o.push(e.fromDateTimes(i,l.time)),i=null)}return e.merge(o)},t.difference=function(){for(var t=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.xor([this].concat(n)).map((function(e){return t.intersection(e)})).filter((function(e){return e&&!e.isEmpty()}))},t.toString=function(){return this.isValid?"["+this.s.toISO()+" \u2013 "+this.e.toISO()+")":Hr},t.toISO=function(e){return this.isValid?this.s.toISO(e)+"/"+this.e.toISO(e):Hr},t.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():Hr},t.toISOTime=function(e){return this.isValid?this.s.toISOTime(e)+"/"+this.e.toISOTime(e):Hr},t.toFormat=function(e,t){var r=(void 0===t?{}:t).separator,n=void 0===r?" \u2013 ":r;return this.isValid?""+this.s.toFormat(e)+n+this.e.toFormat(e):Hr},t.toDuration=function(e,t){return this.isValid?this.e.diff(this.s,e,t):zr.invalid(this.invalidReason)},t.mapEndpoints=function(t){return e.fromDateTimes(t(this.s),t(this.e))},V(e,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}(),Jr=function(){function e(){}return e.hasDST=function(e){void 0===e&&(e=Lt.defaultZone);var t=Jn.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset},e.isValidIANAZone=function(e){return kt.isValidZone(e)},e.normalizeZone=function(e){return $t(e,Lt.defaultZone)},e.months=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj,u=void 0===a?null:a,l=r.outputCalendar,c=void 0===l?"gregory":l;return(u||Kt.create(i,o,c)).months(e)},e.monthsFormat=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj,u=void 0===a?null:a,l=r.outputCalendar,c=void 0===l?"gregory":l;return(u||Kt.create(i,o,c)).months(e,!0)},e.weekdays=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj;return((void 0===a?null:a)||Kt.create(i,o,null)).weekdays(e)},e.weekdaysFormat=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj;return((void 0===a?null:a)||Kt.create(i,o,null)).weekdays(e,!0)},e.meridiems=function(e){var t=(void 0===e?{}:e).locale,r=void 0===t?null:t;return Kt.create(r).meridiems()},e.eras=function(e,t){void 0===e&&(e="short");var r=(void 0===t?{}:t).locale,n=void 0===r?null:r;return Kt.create(n,null,"gregory").eras(e)},e.features=function(){return{relative:Pe()}},e}();function Gr(e,t){var r=function(e){return e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()},n=r(t)-r(e);return Math.floor(zr.fromMillis(n).as("days"))}var Kr={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},Zr={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Yr=Kr.hanidec.replace(/[\[|\]]/g,"").split("");function Xr(e,t){var r=e.numberingSystem;return void 0===t&&(t=""),new RegExp(""+Kr[r||"latn"]+t)}function en(e,t){return void 0===t&&(t=function(e){return e}),{regex:e,deser:function(e){var r=e[0];return t(function(e){var t=parseInt(e,10);if(isNaN(t)){t="";for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(-1!==e[r].search(Kr.hanidec))t+=Yr.indexOf(e[r]);else for(var i in Zr){var s=Zr[i],o=s[0],a=s[1];n>=o&&n<=a&&(t+=n-o)}}return parseInt(t,10)}return t}(r))}}}var tn="[ "+String.fromCharCode(160)+"]",rn=new RegExp(tn,"g");function nn(e){return e.replace(/\./g,"\\.?").replace(rn,tn)}function sn(e){return e.replace(/\./g,"").replace(rn," ").toLowerCase()}function on(e,t){return null===e?null:{regex:RegExp(e.map(nn).join("|")),deser:function(r){var n=r[0];return e.findIndex((function(e){return sn(n)===sn(e)}))+t}}}function an(e,t){return{regex:e,deser:function(e){return Ze(e[1],e[2])},groups:t}}function un(e){return{regex:e,deser:function(e){return e[0]}}}var ln={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}},cn=null;function hn(e,t){var r;return(r=Array.prototype).concat.apply(r,e.map((function(e){return function(e,t){if(e.literal)return e;var r=fn(vt.macroTokenToFormatOpts(e.val),t);return null==r||r.includes(void 0)?e:r}(e,t)})))}function dn(e,t,r){var n=hn(vt.parseFormat(r),e),i=n.map((function(t){return r=t,i=Xr(n=e),s=Xr(n,"{2}"),o=Xr(n,"{3}"),a=Xr(n,"{4}"),u=Xr(n,"{6}"),l=Xr(n,"{1,2}"),c=Xr(n,"{1,3}"),h=Xr(n,"{1,6}"),d=Xr(n,"{1,9}"),f=Xr(n,"{2,4}"),p=Xr(n,"{4,6}"),m=function(e){return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:function(e){return e[0]},literal:!0};var t},(y=function(e){if(r.literal)return m(e);switch(e.val){case"G":return on(n.eras("short",!1),0);case"GG":return on(n.eras("long",!1),0);case"y":return en(h);case"yy":case"kk":return en(f,Ge);case"yyyy":case"kkkk":return en(a);case"yyyyy":return en(p);case"yyyyyy":return en(u);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return en(l);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return en(s);case"MMM":return on(n.months("short",!0,!1),1);case"MMMM":return on(n.months("long",!0,!1),1);case"LLL":return on(n.months("short",!1,!1),1);case"LLLL":return on(n.months("long",!1,!1),1);case"o":case"S":return en(c);case"ooo":case"SSS":return en(o);case"u":return un(d);case"uu":return un(l);case"uuu":case"E":case"c":return en(i);case"a":return on(n.meridiems(),0);case"EEE":return on(n.weekdays("short",!1,!1),1);case"EEEE":return on(n.weekdays("long",!1,!1),1);case"ccc":return on(n.weekdays("short",!0,!1),1);case"cccc":return on(n.weekdays("long",!0,!1),1);case"Z":case"ZZ":return an(new RegExp("([+-]"+l.source+")(?::("+s.source+"))?"),2);case"ZZZ":return an(new RegExp("([+-]"+l.source+")("+s.source+")?"),2);case"z":return un(/[a-z_+-/]{1,256}?/i);default:return m(e)}}(r)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"}).token=r,y;var r,n,i,s,o,a,u,l,c,h,d,f,p,m,y})),s=i.find((function(e){return e.invalidReason}));if(s)return{input:t,tokens:n,invalidReason:s.invalidReason};var o=function(e){return["^"+e.map((function(e){return e.regex})).reduce((function(e,t){return e+"("+t.source+")"}),"")+"$",e]}(i),a=o[0],u=o[1],l=RegExp(a,"i"),c=function(e,t,r){var n=e.match(t);if(n){var i={},s=1;for(var o in r)if(Le(r,o)){var a=r[o],u=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(n.slice(s,s+u))),s+=u}return[n,i]}return[n,{}]}(t,l,u),h=c[0],d=c[1],f=d?function(e){var t,r=null;return je(e.z)||(r=kt.create(e.z)),je(e.Z)||(r||(r=new St(e.Z)),t=e.Z),je(e.q)||(e.M=3*(e.q-1)+1),je(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),je(e.u)||(e.S=Ve(e.u)),[Object.keys(e).reduce((function(t,r){var n=function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(r);return n&&(t[n]=e[r]),t}),{}),r,t]}(d):[null,null,void 0],p=f[0],m=f[1],y=f[2];if(Le(d,"a")&&Le(d,"H"))throw new ne("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:n,regex:l,rawMatches:h,matches:d,result:p,zone:m,specificOffset:y}}function fn(e,t){return e?vt.create(t,e).formatDateTimeParts((cn||(cn=Jn.fromMillis(1555555555555)),cn)).map((function(t){return function(e,t,r){var n=e.type,i=e.value;if("literal"===n)return{literal:!0,val:i};var s=r[n],o=ln[n];return"object"==typeof o&&(o=o[s]),o?{literal:!1,val:o}:void 0}(t,0,e)})):null}var pn=[0,31,59,90,120,151,181,212,243,273,304,334],mn=[0,31,60,91,121,152,182,213,244,274,305,335];function yn(e,t){return new bt("unit out of range","you specified "+t+" (of type "+typeof t+") as a "+e+", which is invalid")}function gn(e,t,r){var n=new Date(Date.UTC(e,t-1,r));e<100&&e>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);var i=n.getUTCDay();return 0===i?7:i}function vn(e,t,r){return r+(ze(e)?mn:pn)[t-1]}function bn(e,t){var r=ze(e)?mn:pn,n=r.findIndex((function(e){return e<t}));return{month:n+1,day:t-r[n]}}function _n(e){var t,r=e.year,n=e.month,i=e.day,s=vn(r,n,i),o=gn(r,n,i),a=Math.floor((s-o+10)/7);return a<1?a=Je(t=r-1):a>Je(r)?(t=r+1,a=1):t=r,B({weekYear:t,weekNumber:a,weekday:o},tt(e))}function wn(e){var t,r=e.weekYear,n=e.weekNumber,i=e.weekday,s=gn(r,1,4),o=He(r),a=7*n+i-s-3;a<1?a+=He(t=r-1):a>o?(t=r+1,a-=He(r)):t=r;var u=bn(t,a);return B({year:t,month:u.month,day:u.day},tt(e))}function En(e){var t=e.year;return B({year:t,ordinal:vn(t,e.month,e.day)},tt(e))}function Cn(e){var t=e.year,r=bn(t,e.ordinal);return B({year:t,month:r.month,day:r.day},tt(e))}function Tn(e){var t=Re(e.year),r=qe(e.month,1,12),n=qe(e.day,1,We(e.year,e.month));return t?r?!n&&yn("day",e.day):yn("month",e.month):yn("year",e.year)}function Nn(e){var t=e.hour,r=e.minute,n=e.second,i=e.millisecond,s=qe(t,0,23)||24===t&&0===r&&0===n&&0===i,o=qe(r,0,59),a=qe(n,0,59),u=qe(i,0,999);return s?o?a?!u&&yn("millisecond",i):yn("second",n):yn("minute",r):yn("hour",t)}var kn="Invalid DateTime";function On(e){return new bt("unsupported zone",'the zone "'+e.name+'" is not supported')}function Sn(e){return null===e.weekData&&(e.weekData=_n(e.c)),e.weekData}function xn(e,t){var r={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new Jn(B({},r,t,{old:r}))}function $n(e,t,r){var n=e-60*t*1e3,i=r.offset(n);if(t===i)return[n,t];n-=60*(i-t)*1e3;var s=r.offset(n);return i===s?[n,i]:[e-60*Math.min(i,s)*1e3,Math.max(i,s)]}function An(e,t){var r=new Date(e+=60*t*1e3);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function jn(e,t,r){return $n(Qe(e),t,r)}function In(e,t){var r=e.o,n=e.c.year+Math.trunc(t.years),i=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),s=B({},e.c,{year:n,month:i,day:Math.min(e.c.day,We(n,i))+Math.trunc(t.days)+7*Math.trunc(t.weeks)}),o=zr.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=$n(Qe(s),r,e.zone),u=a[0],l=a[1];return 0!==o&&(u+=o,l=e.zone.offset(u)),{ts:u,o:l}}function Rn(e,t,r,n,i,s){var o=r.setZone,a=r.zone;if(e&&0!==Object.keys(e).length){var u=t||a,l=Jn.fromObject(e,B({},r,{zone:u,specificOffset:s}));return o?l:l.setZone(a)}return Jn.invalid(new bt("unparsable",'the input "'+i+"\" can't be parsed as "+n))}function Pn(e,t,r){return void 0===r&&(r=!0),e.isValid?vt.create(Kt.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(e,t):null}function Mn(e,t){var r=e.c.year>9999||e.c.year<0,n="";return r&&e.c.year>=0&&(n+="+"),n+=De(e.c.year,r?6:4),t?(n+="-",n+=De(e.c.month),n+="-",n+=De(e.c.day)):(n+=De(e.c.month),n+=De(e.c.day)),n}function Ln(e,t,r,n,i,s){var o=De(e.c.hour);return t?(o+=":",o+=De(e.c.minute),0===e.c.second&&r||(o+=":")):o+=De(e.c.minute),0===e.c.second&&r||(o+=De(e.c.second),0===e.c.millisecond&&n||(o+=".",o+=De(e.c.millisecond,3))),i&&(e.isOffsetFixed&&0===e.offset&&!s?o+="Z":e.o<0?(o+="-",o+=De(Math.trunc(-e.o/60)),o+=":",o+=De(Math.trunc(-e.o%60))):(o+="+",o+=De(Math.trunc(e.o/60)),o+=":",o+=De(Math.trunc(e.o%60)))),s&&(o+="["+e.zone.ianaName+"]"),o}var qn={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Dn={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Fn={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Un=["year","month","day","hour","minute","second","millisecond"],Vn=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Bn=["year","ordinal","hour","minute","second","millisecond"];function zn(e){var t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new ie(e);return t}function Hn(e,t){var r,n,i=$t(t.zone,Lt.defaultZone),s=Kt.fromObject(t),o=Lt.now();if(je(e.year))r=o;else{for(var a,u=Y(Un);!(a=u()).done;){var l=a.value;je(e[l])&&(e[l]=qn[l])}var c=Tn(e)||Nn(e);if(c)return Jn.invalid(c);var h=jn(e,i.offset(o),i);r=h[0],n=h[1]}return new Jn({ts:r,zone:i,loc:s,o:n})}function Wn(e,t,r){var n=!!je(r.round)||r.round,i=function(e,i){return e=Be(e,n||r.calendary?0:2,!0),t.loc.clone(r).relFormatter(r).format(e,i)},s=function(n){return r.calendary?t.hasSame(e,n)?0:t.startOf(n).diff(e.startOf(n),n).get(n):t.diff(e,n).get(n)};if(r.unit)return i(s(r.unit),r.unit);for(var o,a=Y(r.units);!(o=a()).done;){var u=o.value,l=s(u);if(Math.abs(l)>=1)return i(l,u)}return i(e>t?-0:0,r.units[r.units.length-1])}function Qn(e){var t,r={};return e.length>0&&"object"==typeof e[e.length-1]?(r=e[e.length-1],t=Array.from(e).slice(0,e.length-1)):t=Array.from(e),[r,t]}var Jn=function(){function e(e){var t=e.zone||Lt.defaultZone,r=e.invalid||(Number.isNaN(e.ts)?new bt("invalid input"):null)||(t.isValid?null:On(t));this.ts=je(e.ts)?Lt.now():e.ts;var n=null,i=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t)){var s=[e.old.c,e.old.o];n=s[0],i=s[1]}else{var o=t.offset(this.ts);n=An(this.ts,o),n=(r=Number.isNaN(n.year)?new bt("invalid input"):null)?null:n,i=r?null:o}this._zone=t,this.loc=e.loc||Kt.create(),this.invalid=r,this.weekData=null,this.c=n,this.o=i,this.isLuxonDateTime=!0}e.now=function(){return new e({})},e.local=function(){var e=Qn(arguments),t=e[0],r=e[1],n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],u=r[5],l=r[6];return Hn({year:n,month:i,day:s,hour:o,minute:a,second:u,millisecond:l},t)},e.utc=function(){var e=Qn(arguments),t=e[0],r=e[1],n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],u=r[5],l=r[6];return t.zone=St.utcInstance,Hn({year:n,month:i,day:s,hour:o,minute:a,second:u,millisecond:l},t)},e.fromJSDate=function(t,r){void 0===r&&(r={});var n,i=(n=t,"[object Date]"===Object.prototype.toString.call(n)?t.valueOf():NaN);if(Number.isNaN(i))return e.invalid("invalid input");var s=$t(r.zone,Lt.defaultZone);return s.isValid?new e({ts:i,zone:s,loc:Kt.fromObject(r)}):e.invalid(On(s))},e.fromMillis=function(t,r){if(void 0===r&&(r={}),Ie(t))return t<-864e13||t>864e13?e.invalid("Timestamp out of range"):new e({ts:t,zone:$t(r.zone,Lt.defaultZone),loc:Kt.fromObject(r)});throw new se("fromMillis requires a numerical input, but received a "+typeof t+" with value "+t)},e.fromSeconds=function(t,r){if(void 0===r&&(r={}),Ie(t))return new e({ts:1e3*t,zone:$t(r.zone,Lt.defaultZone),loc:Kt.fromObject(r)});throw new se("fromSeconds requires a numerical input")},e.fromObject=function(t,r){void 0===r&&(r={}),t=t||{};var n=$t(r.zone,Lt.defaultZone);if(!n.isValid)return e.invalid(On(n));var i=Lt.now(),s=je(r.specificOffset)?n.offset(i):r.specificOffset,o=Xe(t,zn),a=!je(o.ordinal),u=!je(o.year),l=!je(o.month)||!je(o.day),c=u||l,h=o.weekYear||o.weekNumber,d=Kt.fromObject(r);if((c||a)&&h)throw new ne("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&a)throw new ne("Can't mix ordinal dates with month/day");var f,p,m=h||o.weekday&&!c,y=An(i,s);m?(f=Vn,p=Dn,y=_n(y)):a?(f=Bn,p=Fn,y=En(y)):(f=Un,p=qn);for(var g,v=!1,b=Y(f);!(g=b()).done;){var _=g.value;je(o[_])?o[_]=v?p[_]:y[_]:v=!0}var w=(m?function(e){var t=Re(e.weekYear),r=qe(e.weekNumber,1,Je(e.weekYear)),n=qe(e.weekday,1,7);return t?r?!n&&yn("weekday",e.weekday):yn("week",e.week):yn("weekYear",e.weekYear)}(o):a?function(e){var t=Re(e.year),r=qe(e.ordinal,1,He(e.year));return t?!r&&yn("ordinal",e.ordinal):yn("year",e.year)}(o):Tn(o))||Nn(o);if(w)return e.invalid(w);var E=jn(m?wn(o):a?Cn(o):o,s,n),C=new e({ts:E[0],zone:n,o:E[1],loc:d});return o.weekday&&c&&t.weekday!==C.weekday?e.invalid("mismatched weekday","you can't specify both a weekday of "+o.weekday+" and a date of "+C.toISO()):C},e.fromISO=function(e,t){void 0===t&&(t={});var r=function(e){return Xt(e,[Nr,xr],[kr,$r],[Or,Ar],[Sr,jr])}(e);return Rn(r[0],r[1],t,"ISO 8601",e)},e.fromRFC2822=function(e,t){void 0===t&&(t={});var r=function(e){return Xt(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[vr,br])}(e);return Rn(r[0],r[1],t,"RFC 2822",e)},e.fromHTTP=function(e,t){void 0===t&&(t={});var r=function(e){return Xt(e,[_r,Cr],[wr,Cr],[Er,Tr])}(e);return Rn(r[0],r[1],t,"HTTP",t)},e.fromFormat=function(t,r,n){if(void 0===n&&(n={}),je(t)||je(r))throw new se("fromFormat requires an input string and a format");var i=n,s=i.locale,o=void 0===s?null:s,a=i.numberingSystem,u=void 0===a?null:a,l=function(e,t,r){var n=dn(e,t,r);return[n.result,n.zone,n.specificOffset,n.invalidReason]}(Kt.fromOpts({locale:o,numberingSystem:u,defaultToEN:!0}),t,r),c=l[0],h=l[1],d=l[2],f=l[3];return f?e.invalid(f):Rn(c,h,n,"format "+r,t,d)},e.fromString=function(t,r,n){return void 0===n&&(n={}),e.fromFormat(t,r,n)},e.fromSQL=function(e,t){void 0===t&&(t={});var r=function(e){return Xt(e,[Rr,xr],[Pr,Mr])}(e);return Rn(r[0],r[1],t,"SQL",e)},e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new se("need to specify a reason the DateTime is invalid");var n=t instanceof bt?t:new bt(t,r);if(Lt.throwOnInvalid)throw new ee(n);return new e({invalid:n})},e.isDateTime=function(e){return e&&e.isLuxonDateTime||!1},e.parseFormatForOpts=function(e,t){void 0===t&&(t={});var r=fn(e,Kt.fromObject(t));return r?r.map((function(e){return e?e.val:null})).join(""):null},e.expandFormat=function(e,t){return void 0===t&&(t={}),hn(vt.parseFormat(e),Kt.fromObject(t)).map((function(e){return e.val})).join("")};var t=e.prototype;return t.get=function(e){return this[e]},t.resolvedLocaleOptions=function(e){void 0===e&&(e={});var t=vt.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t.locale,numberingSystem:t.numberingSystem,outputCalendar:t.calendar}},t.toUTC=function(e,t){return void 0===e&&(e=0),void 0===t&&(t={}),this.setZone(St.instance(e),t)},t.toLocal=function(){return this.setZone(Lt.defaultZone)},t.setZone=function(t,r){var n=void 0===r?{}:r,i=n.keepLocalTime,s=void 0!==i&&i,o=n.keepCalendarTime,a=void 0!==o&&o;if((t=$t(t,Lt.defaultZone)).equals(this.zone))return this;if(t.isValid){var u=this.ts;if(s||a){var l=t.offset(this.ts);u=jn(this.toObject(),l,t)[0]}return xn(this,{ts:u,zone:t})}return e.invalid(On(t))},t.reconfigure=function(e){var t=void 0===e?{}:e,r=t.locale,n=t.numberingSystem,i=t.outputCalendar;return xn(this,{loc:this.loc.clone({locale:r,numberingSystem:n,outputCalendar:i})})},t.setLocale=function(e){return this.reconfigure({locale:e})},t.set=function(e){if(!this.isValid)return this;var t,r=Xe(e,zn),n=!je(r.weekYear)||!je(r.weekNumber)||!je(r.weekday),i=!je(r.ordinal),s=!je(r.year),o=!je(r.month)||!je(r.day),a=s||o,u=r.weekYear||r.weekNumber;if((a||i)&&u)throw new ne("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&i)throw new ne("Can't mix ordinal dates with month/day");n?t=wn(B({},_n(this.c),r)):je(r.ordinal)?(t=B({},this.toObject(),r),je(r.day)&&(t.day=Math.min(We(t.year,t.month),t.day))):t=Cn(B({},En(this.c),r));var l=jn(t,this.o,this.zone);return xn(this,{ts:l[0],o:l[1]})},t.plus=function(e){return this.isValid?xn(this,In(this,zr.fromDurationLike(e))):this},t.minus=function(e){return this.isValid?xn(this,In(this,zr.fromDurationLike(e).negate())):this},t.startOf=function(e){if(!this.isValid)return this;var t={},r=zr.normalizeUnit(e);switch(r){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===r&&(t.weekday=1),"quarters"===r){var n=Math.ceil(this.month/3);t.month=3*(n-1)+1}return this.set(t)},t.endOf=function(e){var t;return this.isValid?this.plus((t={},t[e]=1,t)).startOf(e).minus(1):this},t.toFormat=function(e,t){return void 0===t&&(t={}),this.isValid?vt.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):kn},t.toLocaleString=function(e,t){return void 0===e&&(e=ce),void 0===t&&(t={}),this.isValid?vt.create(this.loc.clone(t),e).formatDateTime(this):kn},t.toLocaleParts=function(e){return void 0===e&&(e={}),this.isValid?vt.create(this.loc.clone(e),e).formatDateTimeParts(this):[]},t.toISO=function(e){var t=void 0===e?{}:e,r=t.format,n=void 0===r?"extended":r,i=t.suppressSeconds,s=void 0!==i&&i,o=t.suppressMilliseconds,a=void 0!==o&&o,u=t.includeOffset,l=void 0===u||u,c=t.extendedZone,h=void 0!==c&&c;if(!this.isValid)return null;var d="extended"===n,f=Mn(this,d);return(f+="T")+Ln(this,d,s,a,l,h)},t.toISODate=function(e){var t=(void 0===e?{}:e).format,r=void 0===t?"extended":t;return this.isValid?Mn(this,"extended"===r):null},t.toISOWeekDate=function(){return Pn(this,"kkkk-'W'WW-c")},t.toISOTime=function(e){var t=void 0===e?{}:e,r=t.suppressMilliseconds,n=void 0!==r&&r,i=t.suppressSeconds,s=void 0!==i&&i,o=t.includeOffset,a=void 0===o||o,u=t.includePrefix,l=void 0!==u&&u,c=t.extendedZone,h=void 0!==c&&c,d=t.format,f=void 0===d?"extended":d;return this.isValid?(l?"T":"")+Ln(this,"extended"===f,s,n,a,h):null},t.toRFC2822=function(){return Pn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)},t.toHTTP=function(){return Pn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},t.toSQLDate=function(){return this.isValid?Mn(this,!0):null},t.toSQLTime=function(e){var t=void 0===e?{}:e,r=t.includeOffset,n=void 0===r||r,i=t.includeZone,s=void 0!==i&&i,o=t.includeOffsetSpace,a="HH:mm:ss.SSS";return(s||n)&&((void 0===o||o)&&(a+=" "),s?a+="z":n&&(a+="ZZ")),Pn(this,a,!0)},t.toSQL=function(e){return void 0===e&&(e={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(e):null},t.toString=function(){return this.isValid?this.toISO():kn},t.valueOf=function(){return this.toMillis()},t.toMillis=function(){return this.isValid?this.ts:NaN},t.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},t.toUnixInteger=function(){return this.isValid?Math.floor(this.ts/1e3):NaN},t.toJSON=function(){return this.toISO()},t.toBSON=function(){return this.toJSDate()},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=B({},this.c);return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},t.diff=function(e,t,r){if(void 0===t&&(t="milliseconds"),void 0===r&&(r={}),!this.isValid||!e.isValid)return zr.invalid("created by diffing an invalid DateTime");var n,i=B({locale:this.locale,numberingSystem:this.numberingSystem},r),s=(n=t,Array.isArray(n)?n:[n]).map(zr.normalizeUnit),o=e.valueOf()>this.valueOf(),a=function(e,t,r,n){var i,s=function(e,t,r){for(var n,i,s={},o=0,a=[["years",function(e,t){return t.year-e.year}],["quarters",function(e,t){return t.quarter-e.quarter+4*(t.year-e.year)}],["months",function(e,t){return t.month-e.month+12*(t.year-e.year)}],["weeks",function(e,t){var r=Gr(e,t);return(r-r%7)/7}],["days",Gr]];o<a.length;o++){var u=a[o],l=u[0],c=u[1];if(r.indexOf(l)>=0){var h;n=l;var d,f=c(e,t);(i=e.plus(((h={})[l]=f,h)))>t?(e=e.plus(((d={})[l]=f-1,d)),f-=1):e=i,s[l]=f}}return[e,s,i,n]}(e,t,r),o=s[0],a=s[1],u=s[2],l=s[3],c=t-o,h=r.filter((function(e){return["hours","minutes","seconds","milliseconds"].indexOf(e)>=0}));0===h.length&&(u<t&&(u=o.plus(((i={})[l]=1,i))),u!==o&&(a[l]=(a[l]||0)+c/(u-o)));var d,f=zr.fromObject(a,n);return h.length>0?(d=zr.fromMillis(c,n)).shiftTo.apply(d,h).plus(f):f}(o?this:e,o?e:this,s,i);return o?a.negate():a},t.diffNow=function(t,r){return void 0===t&&(t="milliseconds"),void 0===r&&(r={}),this.diff(e.now(),t,r)},t.until=function(e){return this.isValid?Qr.fromDateTimes(this,e):this},t.hasSame=function(e,t){if(!this.isValid)return!1;var r=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(t)<=r&&r<=n.endOf(t)},t.equals=function(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)},t.toRelative=function(t){if(void 0===t&&(t={}),!this.isValid)return null;var r=t.base||e.fromObject({},{zone:this.zone}),n=t.padding?this<r?-t.padding:t.padding:0,i=["years","months","days","hours","minutes","seconds"],s=t.unit;return Array.isArray(t.unit)&&(i=t.unit,s=void 0),Wn(r,this.plus(n),B({},t,{numeric:"always",units:i,unit:s}))},t.toRelativeCalendar=function(t){return void 0===t&&(t={}),this.isValid?Wn(t.base||e.fromObject({},{zone:this.zone}),this,B({},t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},e.min=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every(e.isDateTime))throw new se("min requires all arguments be DateTimes");return Me(r,(function(e){return e.valueOf()}),Math.min)},e.max=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every(e.isDateTime))throw new se("max requires all arguments be DateTimes");return Me(r,(function(e){return e.valueOf()}),Math.max)},e.fromFormatExplain=function(e,t,r){void 0===r&&(r={});var n=r,i=n.locale,s=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o;return dn(Kt.fromOpts({locale:s,numberingSystem:a,defaultToEN:!0}),e,t)},e.fromStringExplain=function(t,r,n){return void 0===n&&(n={}),e.fromFormatExplain(t,r,n)},V(e,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?Sn(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?Sn(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?Sn(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?En(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?Jr.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?Jr.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?Jr.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?Jr.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.isUniversal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return ze(this.year)}},{key:"daysInMonth",get:function(){return We(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?He(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?Je(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return ce}},{key:"DATE_MED",get:function(){return he}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return de}},{key:"DATE_FULL",get:function(){return fe}},{key:"DATE_HUGE",get:function(){return pe}},{key:"TIME_SIMPLE",get:function(){return me}},{key:"TIME_WITH_SECONDS",get:function(){return ye}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return ge}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return ve}},{key:"TIME_24_SIMPLE",get:function(){return be}},{key:"TIME_24_WITH_SECONDS",get:function(){return _e}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return we}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return Ee}},{key:"DATETIME_SHORT",get:function(){return Ce}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return Te}},{key:"DATETIME_MED",get:function(){return Ne}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return ke}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return Oe}},{key:"DATETIME_FULL",get:function(){return Se}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return xe}},{key:"DATETIME_HUGE",get:function(){return $e}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return Ae}}]),e}();function Gn(e){if(Jn.isDateTime(e))return e;if(e&&e.valueOf&&Ie(e.valueOf()))return Jn.fromJSDate(e);if(e&&"object"==typeof e)return Jn.fromObject(e);throw new se("Unknown datetime argument: "+e+", of type "+typeof e)}F.DateTime=Jn,F.Duration=zr,F.FixedOffsetZone=St,F.IANAZone=kt,F.Info=Jr,F.Interval=Qr,F.InvalidZone=xt,F.Settings=Lt,F.SystemZone=Et,F.VERSION="3.1.0",F.Zone=_t;const{DateTime:Kn}=F;var Zn={};let Yn;Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.default=function(){if(!Yn&&(Yn="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Yn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Yn(Xn)};const Xn=new Uint8Array(16);var ei={};Object.defineProperty(ei,"__esModule",{value:!0}),ei.default=void 0,ei.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.default=void 0;var ri,ni=(ri=ei)&&ri.__esModule?ri:{default:ri};ti.default=function(e){return"string"==typeof e&&ni.default.test(e)};var ii={};Object.defineProperty(ii,"__esModule",{value:!0}),ii.default=void 0,ii.unsafeStringify=ui;var si,oi=(si=ti)&&si.__esModule?si:{default:si};const ai=[];for(let Dx=0;Dx<256;++Dx)ai.push((Dx+256).toString(16).slice(1));function ui(e,t=0){return(ai[e[t+0]]+ai[e[t+1]]+ai[e[t+2]]+ai[e[t+3]]+"-"+ai[e[t+4]]+ai[e[t+5]]+"-"+ai[e[t+6]]+ai[e[t+7]]+"-"+ai[e[t+8]]+ai[e[t+9]]+"-"+ai[e[t+10]]+ai[e[t+11]]+ai[e[t+12]]+ai[e[t+13]]+ai[e[t+14]]+ai[e[t+15]]).toLowerCase()}ii.default=function(e,t=0){const r=ui(e,t);if(!(0,oi.default)(r))throw TypeError("Stringified UUID is invalid");return r};var li={};Object.defineProperty(li,"__esModule",{value:!0}),li.default=void 0;var ci,hi=(ci=Zn)&&ci.__esModule?ci:{default:ci};let di,fi,pi=0,mi=0;li.default=function(e,t,r){let n=t&&r||0;const i=t||new Array(16);let s=(e=e||{}).node||di,o=void 0!==e.clockseq?e.clockseq:fi;if(null==s||null==o){const t=e.random||(e.rng||hi.default)();null==s&&(s=di=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==o&&(o=fi=16383&(t[6]<<8|t[7]))}let a=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:mi+1;const l=a-pi+(u-mi)/1e4;if(l<0&&void 0===e.clockseq&&(o=o+1&16383),(l<0||a>pi)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");pi=a,mi=u,fi=o,a+=122192928e5;const c=(1e4*(268435455&a)+u)%4294967296;i[n++]=c>>>24&255,i[n++]=c>>>16&255,i[n++]=c>>>8&255,i[n++]=255&c;const h=a/4294967296*1e4&268435455;i[n++]=h>>>8&255,i[n++]=255&h,i[n++]=h>>>24&15|16,i[n++]=h>>>16&255,i[n++]=o>>>8|128,i[n++]=255&o;for(let d=0;d<6;++d)i[n+d]=s[d];return t||(0,ii.unsafeStringify)(i)};var yi={};Object.defineProperty(yi,"__esModule",{value:!0}),yi.default=void 0;var gi,vi=(gi=ti)&&gi.__esModule?gi:{default:gi};yi.default=function(e){if(!(0,vi.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};var bi={};Object.defineProperty(bi,"__esModule",{value:!0}),bi.URL=bi.DNS=void 0,bi.default=function(e,t,r){function n(e,n,i,s){var o;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,wi.default)(n)),16!==(null===(o=n)||void 0===o?void 0:o.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(n),a.set(e,n.length),a=r(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=a[e];return i}return(0,ii.unsafeStringify)(a)}try{n.name=e}catch(i){}return n.DNS=Ei,n.URL=Ci,n};var _i,wi=(_i=yi)&&_i.__esModule?_i:{default:_i};const Ei="6ba7b810-9dad-11d1-80b4-00c04fd430c8";bi.DNS=Ei;const Ci="6ba7b811-9dad-11d1-80b4-00c04fd430c8";bi.URL=Ci;var Ti={};function Ni(e){return 14+(e+64>>>9<<4)+1}function ki(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function Oi(e,t,r,n,i,s){return ki((o=ki(ki(t,e),ki(n,s)))<<(a=i)|o>>>32-a,r);var o,a}function Si(e,t,r,n,i,s,o){return Oi(t&r|~t&n,e,t,i,s,o)}function xi(e,t,r,n,i,s,o){return Oi(t&n|r&~n,e,t,i,s,o)}function $i(e,t,r,n,i,s,o){return Oi(t^r^n,e,t,i,s,o)}function Ai(e,t,r,n,i,s,o){return Oi(r^(t|~n),e,t,i,s,o)}Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.default=void 0;Ti.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length;for(let n=0;n<r;n+=8){const r=e[n>>5]>>>n%32&255,i=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[Ni(t)-1]=t;let r=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let o=0;o<e.length;o+=16){const t=r,a=n,u=i,l=s;r=Si(r,n,i,s,e[o],7,-680876936),s=Si(s,r,n,i,e[o+1],12,-389564586),i=Si(i,s,r,n,e[o+2],17,606105819),n=Si(n,i,s,r,e[o+3],22,-1044525330),r=Si(r,n,i,s,e[o+4],7,-176418897),s=Si(s,r,n,i,e[o+5],12,1200080426),i=Si(i,s,r,n,e[o+6],17,-1473231341),n=Si(n,i,s,r,e[o+7],22,-45705983),r=Si(r,n,i,s,e[o+8],7,1770035416),s=Si(s,r,n,i,e[o+9],12,-1958414417),i=Si(i,s,r,n,e[o+10],17,-42063),n=Si(n,i,s,r,e[o+11],22,-1990404162),r=Si(r,n,i,s,e[o+12],7,1804603682),s=Si(s,r,n,i,e[o+13],12,-40341101),i=Si(i,s,r,n,e[o+14],17,-1502002290),n=Si(n,i,s,r,e[o+15],22,1236535329),r=xi(r,n,i,s,e[o+1],5,-165796510),s=xi(s,r,n,i,e[o+6],9,-1069501632),i=xi(i,s,r,n,e[o+11],14,643717713),n=xi(n,i,s,r,e[o],20,-373897302),r=xi(r,n,i,s,e[o+5],5,-701558691),s=xi(s,r,n,i,e[o+10],9,38016083),i=xi(i,s,r,n,e[o+15],14,-660478335),n=xi(n,i,s,r,e[o+4],20,-405537848),r=xi(r,n,i,s,e[o+9],5,568446438),s=xi(s,r,n,i,e[o+14],9,-1019803690),i=xi(i,s,r,n,e[o+3],14,-187363961),n=xi(n,i,s,r,e[o+8],20,1163531501),r=xi(r,n,i,s,e[o+13],5,-1444681467),s=xi(s,r,n,i,e[o+2],9,-51403784),i=xi(i,s,r,n,e[o+7],14,1735328473),n=xi(n,i,s,r,e[o+12],20,-1926607734),r=$i(r,n,i,s,e[o+5],4,-378558),s=$i(s,r,n,i,e[o+8],11,-2022574463),i=$i(i,s,r,n,e[o+11],16,1839030562),n=$i(n,i,s,r,e[o+14],23,-35309556),r=$i(r,n,i,s,e[o+1],4,-1530992060),s=$i(s,r,n,i,e[o+4],11,1272893353),i=$i(i,s,r,n,e[o+7],16,-155497632),n=$i(n,i,s,r,e[o+10],23,-1094730640),r=$i(r,n,i,s,e[o+13],4,681279174),s=$i(s,r,n,i,e[o],11,-358537222),i=$i(i,s,r,n,e[o+3],16,-722521979),n=$i(n,i,s,r,e[o+6],23,76029189),r=$i(r,n,i,s,e[o+9],4,-640364487),s=$i(s,r,n,i,e[o+12],11,-421815835),i=$i(i,s,r,n,e[o+15],16,530742520),n=$i(n,i,s,r,e[o+2],23,-995338651),r=Ai(r,n,i,s,e[o],6,-198630844),s=Ai(s,r,n,i,e[o+7],10,1126891415),i=Ai(i,s,r,n,e[o+14],15,-1416354905),n=Ai(n,i,s,r,e[o+5],21,-57434055),r=Ai(r,n,i,s,e[o+12],6,1700485571),s=Ai(s,r,n,i,e[o+3],10,-1894986606),i=Ai(i,s,r,n,e[o+10],15,-1051523),n=Ai(n,i,s,r,e[o+1],21,-2054922799),r=Ai(r,n,i,s,e[o+8],6,1873313359),s=Ai(s,r,n,i,e[o+15],10,-30611744),i=Ai(i,s,r,n,e[o+6],15,-1560198380),n=Ai(n,i,s,r,e[o+13],21,1309151649),r=Ai(r,n,i,s,e[o+4],6,-145523070),s=Ai(s,r,n,i,e[o+11],10,-1120210379),i=Ai(i,s,r,n,e[o+2],15,718787259),n=Ai(n,i,s,r,e[o+9],21,-343485551),r=ki(r,t),n=ki(n,a),i=ki(i,u),s=ki(s,l)}return[r,n,i,s]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(Ni(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};var ji={};Object.defineProperty(ji,"__esModule",{value:!0}),ji.default=void 0;var Ii=Pi(bi),Ri=Pi(Ti);function Pi(e){return e&&e.__esModule?e:{default:e}}var Mi=(0,Ii.default)("v3",48,Ri.default);ji.default=Mi;var Li={};Object.defineProperty(Li,"__esModule",{value:!0}),Li.default=void 0;var qi={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};Li.default=qi;var Di={};Object.defineProperty(Di,"__esModule",{value:!0}),Di.default=void 0;var Fi=Vi(Li),Ui=Vi(Zn);function Vi(e){return e&&e.__esModule?e:{default:e}}Di.default=function(e,t,r){if(Fi.default.randomUUID&&!t&&!e)return Fi.default.randomUUID();const n=(e=e||{}).random||(e.rng||Ui.default)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return(0,ii.unsafeStringify)(n)};var Bi={};function zi(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function Hi(e,t){return e<<t|e>>>32-t}Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.default=void 0;Bi.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const n=e.length/4+2,i=Math.ceil(n/16),s=new Array(i);for(let o=0;o<i;++o){const t=new Uint32Array(16);for(let r=0;r<16;++r)t[r]=e[64*o+4*r]<<24|e[64*o+4*r+1]<<16|e[64*o+4*r+2]<<8|e[64*o+4*r+3];s[o]=t}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;for(let o=0;o<i;++o){const e=new Uint32Array(80);for(let t=0;t<16;++t)e[t]=s[o][t];for(let t=16;t<80;++t)e[t]=Hi(e[t-3]^e[t-8]^e[t-14]^e[t-16],1);let n=r[0],i=r[1],a=r[2],u=r[3],l=r[4];for(let r=0;r<80;++r){const s=Math.floor(r/20),o=Hi(n,5)+zi(s,i,a,u)+l+t[s]+e[r]>>>0;l=u,u=a,a=Hi(i,30)>>>0,i=n,n=o}r[0]=r[0]+n>>>0,r[1]=r[1]+i>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+l>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.default=void 0;var Qi=Gi(bi),Ji=Gi(Bi);function Gi(e){return e&&e.__esModule?e:{default:e}}var Ki=(0,Qi.default)("v5",80,Ji.default);Wi.default=Ki;var Zi={};Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.default=void 0,Zi.default="00000000-0000-0000-0000-000000000000";var Yi={};Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.default=void 0;var Xi,es=(Xi=ti)&&Xi.__esModule?Xi:{default:Xi};Yi.default=function(e){if(!(0,es.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};var ts={};Object.defineProperty(ts,"__esModule",{value:!0}),Object.defineProperty(ts,"NIL",{enumerable:!0,get:function(){return os.default}}),Object.defineProperty(ts,"parse",{enumerable:!0,get:function(){return cs.default}}),Object.defineProperty(ts,"stringify",{enumerable:!0,get:function(){return ls.default}}),Object.defineProperty(ts,"v1",{enumerable:!0,get:function(){return rs.default}}),Object.defineProperty(ts,"v3",{enumerable:!0,get:function(){return ns.default}}),Object.defineProperty(ts,"v4",{enumerable:!0,get:function(){return is.default}}),Object.defineProperty(ts,"v5",{enumerable:!0,get:function(){return ss.default}}),Object.defineProperty(ts,"validate",{enumerable:!0,get:function(){return us.default}}),Object.defineProperty(ts,"version",{enumerable:!0,get:function(){return as.default}});var rs=hs(li),ns=hs(ji),is=hs(Di),ss=hs(Wi),os=hs(Zi),as=hs(Yi),us=hs(ti),ls=hs(ii),cs=hs(yi);function hs(e){return e&&e.__esModule?e:{default:e}}const{DateTime:ds}=F;var fs=class{constructor(e){this.db=e,this.types={}}async register(e,t,r){const n=this.db;this.types[e]={type:{...t,name:e},toolbox:r},n.events({types:t.events}).each(async e=>{let i=await n.object(e.meta.stream).read()||{};i=await t.on(r,i,e)||{},await n.object(e.meta.stream,{...i,_last:e.meta}).write()})}async create(e,t=ts.v4()){const r=this.db,n=this.types[e],i=n.type;let s={_type:i,id:t};return i.commands.forEach(e=>{s[e]=async function(t){let i=await this._type.do({...n.toolbox,db:r},this,e,t);return i.meta.stream=this.id,await r.stream(this.id).event(i.meta.type,i.data).append()}}),await r.object(s.id,s).write(),s}async get(e,t){const r=await this.db.object(e).read();if(t&&t.plain){let e={...r};return delete e._type,delete e._last,e}const n=this.db,i=this.types[r._type.name],s=i.type;return r._type=s,s.commands.forEach(e=>{r[e]=async function(t){let r=await this._type.do({...i.toolbox,db:n},this,e,t);return r.meta.stream=this.id,await n.stream(this.id).event(r.meta.type,r.data).append()}}),r}};function ps(e){return"reaction_"+e.replace(/[^a-zA-Z0-9]+/gi,"")}var ms=class{constructor(e){this.db=e,this.registrations={},this.cancellations={}}async register(e,t,r){this.db,this.registrations[e]={type:t,toolbox:r},await this.resume(e)}async get(e,t){const r=this.registrations[e],n=r.type;let i=await this.db.object(ps(e)).read()||n.context;n.get&&(i=await n.get({...r.toolbox,db:this.db},i,t));let s={...i};return delete s._type,delete s._last,s}async pause(e){this.registrations[e].type;const t=this.cancellations[e];t&&(t.cancel(),delete this.cancellations[e])}async resume(e){const t=this.registrations[e],r=t.type;if(this.cancellations[e])return;const n=this.db;let i=await n.object(ps(e)).read()||r.context,s={types:r.events};i&&i._last&&i._last.stream&&i._last.id&&(s.after=`${i._last.stream}.${i._last.id}`),this.cancellations[e]={cancel:()=>{}},n.events(s).each(i=>{(async i=>{let s=await n.object(ps(e)).read()||r.context;s=await r.on({...t.toolbox,db:n},s,i)||s,await n.object(ps(e),{...s,_last:i.meta}).write()})(i)},this.cancellations[e])}};function ys(e){return"view_"+e.replace(/[^a-zA-Z0-9]+/gi,"")}var gs=class{constructor(e){this.db=e,this.registrations={},this.cancellations={}}async register(e,t,r){this.db,this.registrations[e]={type:t,toolbox:r},t.extends||await this.resume(e)}async get(e,t){const r=this.registrations[e],n=r.type;if(n.extends){let e=await this.get(n.extends,t);return await n.get({...r.toolbox,db:this.db},e,t)}let i=await this.db.object(ys(e)).read()||n.default;n.get&&(i=await n.get({...r.toolbox,db:this.db},i,t));let s={...i};return delete s._type,delete s._last,s}async refresh(e){this.registrations[e].type.extends||(this.pause(e),this.rewind(e),this.resume(e))}async rewind(e){this.registrations[e].type.extends||await this.db.object(ys(e)).destroy()}async pause(e){if(this.registrations[e].type.extends)return;const t=this.cancellations[e];t&&(t.cancel(),delete this.cancellations[e])}async resume(e){const t=this.registrations[e],r=t.type;if(r.extends)return;if(this.cancellations[e])return;const n=this.db;let i=await n.object(ys(e)).read()||r.default,s={types:r.events};i&&i._last&&i._last.stream&&i._last.id&&(s.after=`${i._last.stream}.${i._last.id}`),this.cancellations[e]={cancel:()=>{}},n.events(s).each(async i=>{let s=await n.object(ys(e)).read()||r.default;s=await r.on({...t.toolbox,db:n},s,i)||s,await n.object(ys(e),{...s,_last:i.meta}).write()},this.cancellations[e])}};(function(e){const t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new s}abort(){this.signal.dispatchEvent("abort")}},n="function"==typeof AbortSignal,i="function"==typeof r.AbortSignal,s=n?AbortSignal:i?r.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if("abort"===e){this.aborted=!0;const t={type:e,target:this};this.onabort(t),this._listeners.forEach(e=>e(t),this)}}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter(e=>e!==t))}},o=new Set,a=(e,t)=>{const r="LRU_CACHE_OPTION_"+e;c(r)&&h(r,e+" option","options."+t,y)},u=(e,t)=>{const r="LRU_CACHE_METHOD_"+e;if(c(r)){const{prototype:n}=y,{get:i}=Object.getOwnPropertyDescriptor(n,e);h(r,e+" method",`cache.${t}()`,i)}},l=(...t)=>{"object"==typeof e&&e&&"function"==typeof e.emitWarning?e.emitWarning(...t):console.error(...t)},c=e=>!o.has(e),h=(e,t,r,n)=>{o.add(e),l(`The ${t} is deprecated. Please use ${r} instead.`,"DeprecationWarning",e,n)},d=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),f=e=>d(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?p:null:null;class p extends Array{constructor(e){super(e),this.fill(0)}}class m{constructor(e){if(0===e)return[];const t=f(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class y{constructor(e={}){const{max:t=0,ttl:r,ttlResolution:n=1,ttlAutopurge:i,updateAgeOnGet:s,updateAgeOnHas:u,allowStale:h,dispose:p,disposeAfter:g,noDisposeOnSet:v,noUpdateTTL:b,maxSize:_=0,maxEntrySize:w=0,sizeCalculation:E,fetchMethod:C,fetchContext:T,noDeleteOnFetchRejection:N,noDeleteOnStaleGet:k}=e,{length:O,maxAge:S,stale:x}=e instanceof y?{}:e;if(0!==t&&!d(t))throw new TypeError("max option must be a nonnegative integer");const $=t?f(t):Array;if(!$)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=_,this.maxEntrySize=w||this.maxSize,this.sizeCalculation=E||O,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=C||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=T,!this.fetchMethod&&void 0!==T)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new $(t),this.prev=new $(t),this.head=0,this.tail=0,this.free=new m(t),this.initialFill=1,this.size=0,"function"==typeof p&&(this.dispose=p),"function"==typeof g?(this.disposeAfter=g,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!v,this.noUpdateTTL=!!b,this.noDeleteOnFetchRejection=!!N,0!==this.maxEntrySize){if(0!==this.maxSize&&!d(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!d(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!h||!!x,this.noDeleteOnStaleGet=!!k,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!u,this.ttlResolution=d(n)||0===n?n:1,this.ttlAutopurge=!!i,this.ttl=r||S||0,this.ttl){if(!d(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";c(e)&&(o.add(e),l("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,y))}x&&a("stale","allowStale"),S&&a("maxAge","ttl"),O&&a("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new p(this.max),this.starts=new p(this.max),this.setItemTTL=(e,r,n=t.now())=>{if(this.starts[e]=0!==r?n:0,this.ttls[e]=r,0!==r&&this.ttlAutopurge){const t=setTimeout(()=>{this.isStale(e)&&this.delete(this.keyList[e])},r+1);t.unref&&t.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?t.now():0};let e=0;const r=()=>{const r=t.now();if(this.ttlResolution>0){e=r;const t=setTimeout(()=>e=0,this.ttlResolution);t.unref&&t.unref()}return r};this.getRemainingTTL=t=>{const n=this.keyMap.get(t);return void 0===n?0:0===this.ttls[n]||0===this.starts[n]?1/0:this.starts[n]+this.ttls[n]-(e||r())},this.isStale=t=>0!==this.ttls[t]&&0!==this.starts[t]&&(e||r())-this.starts[t]>this.ttls[t]}updateItemAge(e){}setItemTTL(e,t,r){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new p(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,r,n)=>{if(!d(r)){if(!n)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(r=n(t,e),!d(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return r},this.addItemSize=(e,t)=>{this.sizes[e]=t;const r=this.maxSize-this.sizes[e];for(;this.calculatedSize>r;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,r,n){if(r||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const r of this.indexes())if(e(this.valList[r],this.keyList[r],this))return this.get(this.keyList[r],t)}forEach(e,t=this){for(const r of this.indexes())e.call(t,this.valList[r],this.keyList[r],this)}rforEach(e,t=this){for(const r of this.rindexes())e.call(t,this.valList[r],this.keyList[r],this)}get prune(){return u("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const r of this.indexes({allowStale:!0})){const n=this.keyList[r],i=this.valList[r],s={value:this.isBackgroundFetch(i)?i.__staleWhileFetching:i};if(this.ttls){s.ttl=this.ttls[r];const e=t.now()-this.starts[r];s.start=Math.floor(Date.now()-e)}this.sizes&&(s.size=this.sizes[r]),e.unshift([n,s])}return e}load(e){this.clear();for(const[r,n]of e){if(n.start){const e=Date.now()-n.start;n.start=t.now()-e}this.set(r,n.value,n)}}dispose(e,t,r){}set(e,t,{ttl:r=this.ttl,start:n,noDisposeOnSet:i=this.noDisposeOnSet,size:s=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:a=this.noUpdateTTL}={}){if(s=this.requireSize(e,t,s,o),this.maxEntrySize&&s>this.maxEntrySize)return this;let u=0===this.size?void 0:this.keyMap.get(e);if(void 0===u)u=this.newIndex(),this.keyList[u]=e,this.valList[u]=t,this.keyMap.set(e,u),this.next[this.tail]=u,this.prev[u]=this.tail,this.tail=u,this.size++,this.addItemSize(u,s),a=!1;else{const r=this.valList[u];t!==r&&(this.isBackgroundFetch(r)?r.__abortController.abort():i||(this.dispose(r,e,"set"),this.disposeAfter&&this.disposed.push([r,e,"set"])),this.removeItemSize(u),this.valList[u]=t,this.addItemSize(u,s)),this.moveToTail(u)}if(0===r||0!==this.ttl||this.ttls||this.initializeTTLTracking(),a||this.setItemTTL(u,r,n),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,r=this.keyList[t],n=this.valList[t];return this.isBackgroundFetch(n)?n.__abortController.abort():(this.dispose(n,r,"evict"),this.disposeAfter&&this.disposed.push([n,r,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(r),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const r=this.keyMap.get(e);return void 0!==r&&!this.isStale(r)&&(t&&this.updateItemAge(r),!0)}peek(e,{allowStale:t=this.allowStale}={}){const r=this.keyMap.get(e);if(void 0!==r&&(t||!this.isStale(r))){const e=this.valList[r];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,n,i){const s=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(s))return s;const o=new r,a={signal:o.signal,options:n,context:i},u=new Promise(t=>t(this.fetchMethod(e,s,a))).then(t=>(o.signal.aborted||this.set(e,t,a.options),t),r=>{if(this.valList[t]===u&&(n.noDeleteOnFetchRejection&&void 0!==u.__staleWhileFetching?this.valList[t]=u.__staleWhileFetching:this.delete(e)),u.__returned===u)throw r});return u.__abortController=o,u.__staleWhileFetching=s,u.__returned=null,void 0===t?(this.set(e,u,a.options),t=this.keyMap.get(e)):this.valList[t]=u,u}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:i=this.ttl,noDisposeOnSet:s=this.noDisposeOnSet,size:o=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:l=this.noDeleteOnFetchRejection,fetchContext:c=this.fetchContext,forceRefresh:h=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:n});const d={allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:n,ttl:i,noDisposeOnSet:s,size:o,sizeCalculation:a,noUpdateTTL:u,noDeleteOnFetchRejection:l};let f=this.keyMap.get(e);if(void 0===f){const t=this.backgroundFetch(e,f,d,c);return t.__returned=t}{const n=this.valList[f];if(this.isBackgroundFetch(n))return t&&void 0!==n.__staleWhileFetching?n.__staleWhileFetching:n.__returned=n;if(!h&&!this.isStale(f))return this.moveToTail(f),r&&this.updateItemAge(f),n;const i=this.backgroundFetch(e,f,d,c);return t&&void 0!==i.__staleWhileFetching?i.__staleWhileFetching:i.__returned=i}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet}={}){const i=this.keyMap.get(e);if(void 0!==i){const s=this.valList[i],o=this.isBackgroundFetch(s);if(this.isStale(i))return o?t?s.__staleWhileFetching:void 0:(n||this.delete(e),t?s:void 0);if(o)return;return this.moveToTail(i),r&&this.updateItemAge(i),s}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return u("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const r=this.keyMap.get(e);if(void 0!==r)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(r);const t=this.valList[r];this.isBackgroundFetch(t)?t.__abortController.abort():(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const r=this.keyList[e];this.dispose(t,r,"delete"),this.disposeAfter&&this.disposed.push([t,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return u("reset","clear"),this.clear}get length(){return((e,t)=>{const r="LRU_CACHE_PROPERTY_length";if(c(r)){const{prototype:e}=y,{get:t}=Object.getOwnPropertyDescriptor(e,"length");h(r,"length property","cache.size",t)}})(),this.size}static get AbortController(){return r}static get AbortSignal(){return s}}y}).call(this,require("_process"));var vs=class{constructor({stream:e,id:t,type:r,data:n}){this.stream=e,this.id=t,this.type=r,this.data=n}get store(){return this.account.store}get account(){return this.db.account}get db(){return this.ns.db}get ns(){return this.stream.ns}async destroy(){return await this.store.events.destroy({db:this.db.name,ns:this.ns.name,stream:this.stream.id,event:this.id})}async read(){return await this.store.events.read({db:this.db.name,ns:this.ns.name,stream:this.stream.id,event:this.id})}async append(){return await this.stream.events().write(this.type,this.data)}};D.config({cancellation:!0});var bs=class{constructor({db:e,cursor:t,ns:r,stream:n,from:i,after:s,to:o,until:a,types:u,filters:l,limit:c}){this._db=e,this.cursor=t,this._ns=r,this.stream=n,this.from=i,this.after=s,this.to=o,this.until=a,this.types=u,this.filters=l||[],this.limit=c,this.shouldRead=!0}get store(){return this.account.store}get account(){return this.db.account}get db(){return this._db||this.ns.db}get ns(){return this._ns||(this.stream?this.stream.ns:void 0)}filter(e){return this.filters.push(e),this}group(e){return this.groupby=e,this.until||(this.until="caught-up"),this}rollup(e){return this.rollupto=e,this}async write(e){var t,r;return 1===arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof String)&&(e={meta:{type:arguments[0]},data:{}}),2===arguments.length&&(e={meta:{type:arguments[0]},data:{...arguments[1]}}),await this.store.events.write({data:e.data,meta:{db:this.db.name,ns:null!==(t=null===(r=this.ns)||void 0===r?void 0:r.name)&&void 0!==t?t:"",stream:this.stream.id,...Object.keys(e.meta).filter(e=>"type"===e||"id"===e).reduce((t,r)=>({...t,[r]:e.meta[r]}),{})}})}async each(e,t){let r={db:this.db.name,cursor:this.cursor?this.cursor.name:void 0,ns:this.ns?this.ns.name:void 0,stream:this.stream?this.stream.id:void 0,from:this.from,after:this.after,to:this.to,until:this.until,types:this.types,filters:this.filters,groupby:this.groupby,rollupto:this.rollupto,limit:this.groupby?void 0:this.limit};Object.keys(r).forEach(e=>{void 0!==r[e]&&0!==r[e].length||delete r[e]}),await this.store.events.find({...r,callback:e,cancellation:t})}},_s=class{constructor(e,t,r){this.id=e||ts.v4(),this.ns=t,r&&(this.created=r.created,this.modified=r.modified,this.size=r.size,this.annotation=r.annotation)}get store(){return this.account.store}get account(){return this.db.account}get db(){return this.ns.db}events(e){return new bs({...e,stream:this})}event(e,t){return new vs({stream:this,id:e,type:e,data:t})}async annotate(e){return this.store.annotations.write({db:this.db.name,ns:this.ns.name,stream:this.id,annotation:e})}annotation(){return new class{constructor(e){this.stream=e}get store(){return this.account.store}get account(){return this.db.account}get db(){return this.ns.db}get ns(){return this.stream.ns}async destroy(){return this.store.annotations.destroy({db:this.db.name,ns:this.ns.name,stream:this.stream.id})}async read(){return this.store.annotations.read({db:this.db.name,ns:this.ns.name,stream:this.stream.id})}}(this)}async destroy(){return this.store.annotations.destroy({db:this.db.name,ns:this.ns.name,stream:this.id})}},ws=class{constructor({db:e,ns:t}){this._db=e,this.ns=t}get store(){return this.account.store}get account(){return this.db.account}get db(){var e;return this._db||(null===(e=this.ns)||void 0===e?void 0:e.db)}stream(e,t){return(void 0!==t.ns?this.db.ns(t.ns):this.ns).stream(e,t)}async each(e){var t;const r=this.store.streams.find({db:this.db.name,ns:null===(t=this.ns)||void 0===t?void 0:t.name});for(const n of r)await e(this.stream(n.id,n))}async all(){var e;return this.store.streams.find({db:this.db.name,ns:null===(e=this.ns)||void 0===e?void 0:e.name})}},Es=class{constructor(e,t){this.name=e,this.db=t}get store(){return this.account.store}get account(){return this.db.account}streams(){return new ws({ns:this})}stream(e,t){return new _s(e,this,t)}events(e){return"string"==typeof e&&(e={types:[e]}),new bs({...e,ns:this})}async create(){return await this.store.namespaces.create({db:this.db.name,ns:this.name}),this}async destroy(){await this.store.namespaces.destroy({db:this.db.name,ns:this.name})}async truncate(){await this.store.namespaces.truncate({db:this.db.name,ns:this.name})}async rename(e){return await this.store.namespaces.rename({db:this.db.name,ns:this.name,to:e}),this.name=e,this}async export(){return await this.streams().each(e=>this.stream(e.id).export()),this}},Cs={};(function(e){var t=require("path"),r="win32"===e.platform,n=require("fs"),i=e.env.NODE_DEBUG&&/fs/.test(e.env.NODE_DEBUG);if(t.normalize,r)var s=/(.*?)(?:[\/\\]+|$)/g;else s=/(.*?)(?:[\/]+|$)/g;if(r)var o=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else o=/^[\/]*/;Cs.realpathSync=function(e,i){if(e=t.resolve(e),i&&Object.prototype.hasOwnProperty.call(i,e))return i[e];var a,u,l,c,h=e,d={},f={};function p(){var t=o.exec(e);a=t[0].length,u=t[0],l=t[0],c="",r&&!f[l]&&(n.lstatSync(l),f[l]=!0)}for(p();a<e.length;){s.lastIndex=a;var m=s.exec(e);if(c=u,u+=m[0],l=c+m[1],a=s.lastIndex,!(f[l]||i&&i[l]===l)){var y;if(i&&Object.prototype.hasOwnProperty.call(i,l))y=i[l];else{var g=n.lstatSync(l);if(!g.isSymbolicLink()){f[l]=!0,i&&(i[l]=l);continue}var v=null;if(!r){var b=g.dev.toString(32)+":"+g.ino.toString(32);d.hasOwnProperty(b)&&(v=d[b])}null===v&&(n.statSync(l),v=n.readlinkSync(l)),y=t.resolve(c,v),i&&(i[l]=y),r||(d[b]=v)}e=t.resolve(y,e.slice(a)),p()}}return i&&(i[h]=e),e},Cs.realpath=function(a,u,l){if("function"!=typeof l&&(l=function(t){return"function"==typeof t?t:function(){var t;if(i){var r=new Error;t=function(e){e&&(r.message=e.message,n(e=r))}}else t=n;return t;function n(t){if(t){if(e.throwDeprecation)throw t;if(!e.noDeprecation){var r="fs: missing callback "+(t.stack||t.message);e.traceDeprecation?console.trace(r):console.error(r)}}}}()}(u),u=null),a=t.resolve(a),u&&Object.prototype.hasOwnProperty.call(u,a))return e.nextTick(l.bind(null,null,u[a]));var c,h,d,f,p=a,m={},y={};function g(){var t=o.exec(a);c=t[0].length,h=t[0],d=t[0],f="",r&&!y[d]?n.lstat(d,(function(e){if(e)return l(e);y[d]=!0,v()})):e.nextTick(v)}function v(){if(c>=a.length)return u&&(u[p]=a),l(null,a);s.lastIndex=c;var t=s.exec(a);return f=h,h+=t[0],d=f+t[1],c=s.lastIndex,y[d]||u&&u[d]===d?e.nextTick(v):u&&Object.prototype.hasOwnProperty.call(u,d)?w(u[d]):n.lstat(d,b)}function b(t,i){if(t)return l(t);if(!i.isSymbolicLink())return y[d]=!0,u&&(u[d]=d),e.nextTick(v);if(!r){var s=i.dev.toString(32)+":"+i.ino.toString(32);if(m.hasOwnProperty(s))return _(null,m[s],d)}n.stat(d,(function(e){if(e)return l(e);n.readlink(d,(function(e,t){r||(m[s]=t),_(e,t)}))}))}function _(e,r,n){if(e)return l(e);var i=t.resolve(f,r);u&&(u[n]=i),w(i)}function w(e){a=t.resolve(e,a.slice(c)),g()}g()}}).call(this,require("_process"));var Ts={};(function(e){Ts=a,a.realpath=a,a.sync=u,a.realpathSync=u,a.monkeypatch=function(){t.realpath=a,t.realpathSync=u},a.unmonkeypatch=function(){t.realpath=r,t.realpathSync=n};var t=require("fs"),r=t.realpath,n=t.realpathSync,i=e.version,s=/^v[0-5]\./.test(i);function o(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function a(e,t,n){if(s)return r(e,t,n);"function"==typeof t&&(n=t,t=null),r(e,t,(function(r,i){o(r)?Cs.realpath(e,t,n):n(r,i)}))}function u(e,t){if(s)return n(e,t);try{return n(e,t)}catch(r){if(o(r))return Cs.realpathSync(e,t);throw r}}}).call(this,require("_process"));var Ns={};(function(e){const t="object"==typeof e&&e&&"win32"===e.platform;Ns=t?{sep:"\\"}:{sep:"/"}}).call(this,require("_process"));var ks={};function Os(e,t,r){e instanceof RegExp&&(e=Ss(e,r)),t instanceof RegExp&&(t=Ss(t,r));var n=xs(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function Ss(e,t){var r=t.match(e);return r?r[0]:null}function xs(e,t,r){var n,i,s,o,a,u=r.indexOf(e),l=r.indexOf(t,u+1),c=u;if(u>=0&&l>0){for(n=[],s=r.length;c>=0&&!a;)c==u?(n.push(c),u=r.indexOf(e,c+1)):1==n.length?a=[n.pop(),l]:((i=n.pop())<s&&(s=i,o=l),l=r.indexOf(t,c+1)),c=u<l&&u>=0?u:l;n.length&&(a=[s,o])}return a}ks=Os,Os.range=xs;var $s=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),function e(t,r){var n=[],i=ks("{","}",t);if(!i)return[t];var s=i.pre,o=i.post.length?e(i.post,!1):[""];if(/\$$/.test(i.pre))for(var a=0;a<o.length;a++){var u=s+"{"+i.body+"}"+o[a];n.push(u)}else{var l,c,h=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),f=h||d,p=i.body.indexOf(",")>=0;if(!f&&!p)return i.post.match(/,.*\}/)?e(t=i.pre+"{"+i.body+Is+i.post):[t];if(f)l=i.body.split(/\.\./);else if(1===(l=function e(t){if(!t)return[""];var r=[],n=ks("{","}",t);if(!n)return t.split(",");var i=n.pre,s=n.body,o=n.post,a=i.split(",");a[a.length-1]+="{"+s+"}";var u=e(o);return o.length&&(a[a.length-1]+=u.shift(),a.push.apply(a,u)),r.push.apply(r,a),r}(i.body)).length&&1===(l=e(l[0],!1).map(qs)).length)return o.map((function(e){return i.pre+l[0]+e}));if(f){var m=Ms(l[0]),y=Ms(l[1]),g=Math.max(l[0].length,l[1].length),v=3==l.length?Math.abs(Ms(l[2])):1,b=Fs;y<m&&(v*=-1,b=Us);var _=l.some(Ds);c=[];for(var w=m;b(w,y);w+=v){var E;if(d)"\\"===(E=String.fromCharCode(w))&&(E="");else if(E=String(w),_){var C=g-E.length;if(C>0){var T=new Array(C+1).join("0");E=w<0?"-"+T+E.slice(1):T+E}}c.push(E)}}else{c=[];for(var N=0;N<l.length;N++)c.push.apply(c,e(l[N],!1))}for(N=0;N<c.length;N++)for(a=0;a<o.length;a++)u=s+c[N]+o[a],(!r||f||u)&&n.push(u)}return n}(function(e){return e.split("\\\\").join(As).split("\\{").join(js).split("\\}").join(Is).split("\\,").join(Rs).split("\\.").join(Ps)}(e),!0).map(Ls)):[]},As="\0SLASH"+Math.random()+"\0",js="\0OPEN"+Math.random()+"\0",Is="\0CLOSE"+Math.random()+"\0",Rs="\0COMMA"+Math.random()+"\0",Ps="\0PERIOD"+Math.random()+"\0";function Ms(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Ls(e){return e.split(As).join("\\").split(js).join("{").split(Is).join("}").split(Rs).join(",").split(Ps).join(".")}function qs(e){return"{"+e+"}"}function Ds(e){return/^-?0\d/.test(e)}function Fs(e,t){return e<=t}function Us(e,t){return e>=t}var Vs={};const Bs=Vs=(e,t,r={})=>(Ys(t),!(!r.nocomment&&"#"===t.charAt(0))&&new eo(t,r).match(e));Vs=Bs,Bs.sep=Ns.sep;const zs=Symbol("globstar **");Bs.GLOBSTAR=zs;const Hs={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Ws=e=>e.split("").reduce((e,t)=>(e[t]=!0,e),{}),Qs=Ws("().*{}+?[]^$\\!"),Js=Ws("[.("),Gs=/\/+/;Bs.filter=(e,t={})=>(r,n,i)=>Bs(r,e,t);const Ks=(e,t={})=>{const r={};return Object.keys(e).forEach(t=>r[t]=e[t]),Object.keys(t).forEach(e=>r[e]=t[e]),r};Bs.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return Bs;const t=Bs,r=(r,n,i)=>t(r,n,Ks(e,i));return(r.Minimatch=class extends t.Minimatch{constructor(t,r){super(t,Ks(e,r))}}).defaults=r=>t.defaults(Ks(e,r)).Minimatch,r.filter=(r,n)=>t.filter(r,Ks(e,n)),r.defaults=r=>t.defaults(Ks(e,r)),r.makeRe=(r,n)=>t.makeRe(r,Ks(e,n)),r.braceExpand=(r,n)=>t.braceExpand(r,Ks(e,n)),r.match=(r,n,i)=>t.match(r,n,Ks(e,i)),r},Bs.braceExpand=(e,t)=>Zs(e,t);const Zs=(e,t={})=>(Ys(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:$s(e)),Ys=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},Xs=Symbol("subparse");Bs.makeRe=(e,t)=>new eo(e,t||{}).makeRe(),Bs.match=(e,t,r={})=>{const n=new eo(t,r);return e=e.filter(e=>n.match(e)),n.options.nonull&&!e.length&&e.push(t),e};class eo{constructor(e,t){Ys(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,r),r=this.globParts=r.map(e=>e.split(Gs)),this.debug(this.pattern,r),r=r.map((e,t,r)=>e.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(e=>-1===e.indexOf(!1)),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,r=0;for(let n=0;n<e.length&&"!"===e.charAt(n);n++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}matchOne(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,s=0,o=e.length,a=t.length;i<o&&s<a;i++,s++){this.debug("matchOne loop");var u,l=t[s],c=e[i];if(this.debug(t,l,c),!1===l)return!1;if(l===zs){this.debug("GLOBSTAR",[t,l,c]);var h=i,d=s+1;if(d===a){for(this.debug("** at the end");i<o;i++)if("."===e[i]||".."===e[i]||!n.dot&&"."===e[i].charAt(0))return!1;return!0}for(;h<o;){var f=e[h];if(this.debug("\nglobstar while",e,h,t,d,f),this.matchOne(e.slice(h),t.slice(d),r))return this.debug("globstar found match!",h,o,f),!0;if("."===f||".."===f||!n.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,h,t,d);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",e,h,t,d),h!==o))}if("string"==typeof l?(u=c===l,this.debug("string match",l,c,u)):(u=c.match(l),this.debug("pattern match",l,c,u)),!u)return!1}if(i===o&&s===a)return!0;if(i===o)return r;if(s===a)return i===o-1&&""===e[i];throw new Error("wtf?")}braceExpand(){return Zs(this.pattern,this.options)}parse(e,t){Ys(e);const r=this.options;if("**"===e){if(!r.noglobstar)return zs;e="*"}if(""===e)return"";let n="",i=!!r.nocase,s=!1;const o=[],a=[];let u,l,c,h,d=!1,f=-1,p=-1;const m="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",y=()=>{if(u){switch(u){case"*":n+="[^/]*?",i=!0;break;case"?":n+="[^/]",i=!0;break;default:n+="\\"+u}this.debug("clearStateChar %j %j",u,n),u=!1}};for(let _,w=0;w<e.length&&(_=e.charAt(w));w++)if(this.debug("%s\t%s %s %j",e,w,n,_),s){if("/"===_)return!1;Qs[_]&&(n+="\\"),n+=_,s=!1}else switch(_){case"/":return!1;case"\\":y(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,w,n,_),d){this.debug("  in class"),"!"===_&&w===p+1&&(_="^"),n+=_;continue}this.debug("call clearStateChar %j",u),y(),u=_,r.noext&&y();continue;case"(":if(d){n+="(";continue}if(!u){n+="\\(";continue}o.push({type:u,start:w-1,reStart:n.length,open:Hs[u].open,close:Hs[u].close}),n+="!"===u?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,n),u=!1;continue;case")":if(d||!o.length){n+="\\)";continue}y(),i=!0,c=o.pop(),n+=c.close,"!"===c.type&&a.push(c),c.reEnd=n.length;continue;case"|":if(d||!o.length){n+="\\|";continue}y(),n+="|";continue;case"[":if(y(),d){n+="\\"+_;continue}d=!0,p=w,f=n.length,n+=_;continue;case"]":if(w===p+1||!d){n+="\\"+_;continue}l=e.substring(p+1,w);try{RegExp("["+l+"]")}catch(b){h=this.parse(l,Xs),n=n.substr(0,f)+"\\["+h[0]+"\\]",i=i||h[1],d=!1;continue}i=!0,d=!1,n+=_;continue;default:y(),!Qs[_]||"^"===_&&d||(n+="\\"),n+=_}for(d&&(l=e.substr(p+1),h=this.parse(l,Xs),n=n.substr(0,f)+"\\["+h[0],i=i||h[1]),c=o.pop();c;c=o.pop()){let e;e=n.slice(c.reStart+c.open.length),this.debug("setting tail",n,c),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,(e,t,r)=>(r||(r="\\"),t+t+r+"|")),this.debug("tail=%j\n   %s",e,e,c,n);const t="*"===c.type?"[^/]*?":"?"===c.type?"[^/]":"\\"+c.type;i=!0,n=n.slice(0,c.reStart)+t+"\\("+e}y(),s&&(n+="\\\\");const g=Js[n.charAt(0)];for(let _=a.length-1;_>-1;_--){const e=a[_],r=n.slice(0,e.reStart),i=n.slice(e.reStart,e.reEnd-8);let s=n.slice(e.reEnd);const o=n.slice(e.reEnd-8,e.reEnd)+s,u=r.split("(").length-1;let l=s;for(let t=0;t<u;t++)l=l.replace(/\)[+*?]?/,"");s=l,n=r+i+s+(""===s&&t!==Xs?"$":"")+o}if(""!==n&&i&&(n="(?=.)"+n),g&&(n=m+n),t===Xs)return[n,i];if(!i)return e.replace(/\\(.)/g,"$1");const v=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+n+"$",v),{_glob:e,_src:n})}catch(b){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,r=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"";let i=e.map(e=>((e=e.map(e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===zs?zs:e._src).reduce((e,t)=>(e[e.length-1]===zs&&t===zs||e.push(t),e),[])).forEach((t,n)=>{t===zs&&e[n-1]!==zs&&(0===n?e.length>1?e[n+1]="(?:\\/|"+r+"\\/)?"+e[n+1]:e[n]=r:n===e.length-1?e[n-1]+="(?:\\/|"+r+")?":(e[n-1]+="(?:\\/|\\/"+r+"\\/)"+e[n+1],e[n+1]=zs))}),e.filter(e=>e!==zs).join("/"))).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(s){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const r=this.options;"/"!==Ns.sep&&(e=e.split(Ns.sep).join("/")),e=e.split(Gs),this.debug(this.pattern,"split",e);const n=this.set;let i;this.debug(this.pattern,"set",n);for(let s=e.length-1;s>=0&&(i=e[s],!i);s--);for(let s=0;s<n.length;s++){const o=n[s];let a=e;if(r.matchBase&&1===o.length&&(a=[i]),this.matchOne(a,o,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}static defaults(e){return Bs.defaults(e).Minimatch}}Bs.Minimatch=eo;var to={};to="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}};var ro={};(function(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}ro.setopts=function(o,l,c){if(c||(c={}),c.matchBase&&-1===l.indexOf("/")){if(c.noglobstar)throw new Error("base matching requires globstar");l="**/"+l}o.silent=!!c.silent,o.pattern=l,o.strict=!1!==c.strict,o.realpath=!!c.realpath,o.realpathCache=c.realpathCache||Object.create(null),o.follow=!!c.follow,o.dot=!!c.dot,o.mark=!!c.mark,o.nodir=!!c.nodir,o.nodir&&(o.mark=!0),o.sync=!!c.sync,o.nounique=!!c.nounique,o.nonull=!!c.nonull,o.nosort=!!c.nosort,o.nocase=!!c.nocase,o.stat=!!c.stat,o.noprocess=!!c.noprocess,o.absolute=!!c.absolute,o.fs=c.fs||r,o.maxLength=c.maxLength||1/0,o.cache=c.cache||Object.create(null),o.statCache=c.statCache||Object.create(null),o.symlinks=c.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(a))}(o,c),o.changedCwd=!1;var h=e.cwd();t(c,"cwd")?(o.cwd=n.resolve(c.cwd),o.changedCwd=o.cwd!==h):o.cwd=n.resolve(h),o.root=c.root||n.resolve(o.cwd,"/"),o.root=n.resolve(o.root),o.cwdAbs=i(o.cwd)?o.cwd:u(o,o.cwd),o.nomount=!!c.nomount,"win32"===e.platform&&(o.root=o.root.replace(/\\/g,"/"),o.cwd=o.cwd.replace(/\\/g,"/"),o.cwdAbs=o.cwdAbs.replace(/\\/g,"/")),c.nonegate=!0,c.nocomment=!0,c.allowWindowsEscape=!0,o.minimatch=new s(l,c),o.options=o.minimatch.options},ro.ownProp=t,ro.makeAbs=u,ro.finish=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var s=e.matches[n];if(s&&0!==Object.keys(s).length){var a=Object.keys(s);t?r.push.apply(r,a):a.forEach((function(e){r[e]=!0}))}else if(e.nonull){var c=e.minimatch.globSet[n];t?r.push(c):r[c]=!0}}if(t||(r=Object.keys(r)),e.nosort||(r=r.sort(o)),e.mark){for(n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter((function(t){var r=!/\/$/.test(t),n=e.cache[t]||e.cache[u(e,t)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r})))}e.ignore.length&&(r=r.filter((function(t){return!l(e,t)}))),e.found=r},ro.mark=function(e,t){var r=u(e,t),n=e.cache[r],i=t;if(n){var s="DIR"===n||Array.isArray(n),o="/"===t.slice(-1);if(s&&!o?i+="/":!s&&o&&(i=i.slice(0,-1)),i!==t){var a=u(e,i);e.statCache[a]=e.statCache[r],e.cache[a]=e.cache[r]}}return i},ro.isIgnored=l,ro.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var r=require("fs"),n=require("path"),i=require("path").isAbsolute,s=Vs.Minimatch;function o(e,t){return e.localeCompare(t,"en")}function a(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new s(r,{dot:!0})}return{matcher:new s(e,{dot:!0}),gmatcher:t}}function u(t,r){var s=r;return s="/"===r.charAt(0)?n.join(t.root,r):i(r)||""===r?r:t.changedCwd?n.resolve(t.cwd,r):n.resolve(r),"win32"===e.platform&&(s=s.replace(/\\/g,"/")),s}function l(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}}).call(this,require("_process"));var no=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach((function(e){n[e]=i[e]})),n}},io={};function so(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function oo(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}(io=no(so)).strict=no(oo),so.proto=so((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return so(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return oo(this)},configurable:!0})}));var ao={};(function(e){var t=Object.create(null);function r(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}ao=no((function(n,i){return t[n]?(t[n].push(i),null):(t[n]=[i],function(n){return io((function i(){var s=t[n],o=s.length,a=r(arguments);try{for(var u=0;u<o;u++)s[u].apply(null,a)}finally{s.length>o?(s.splice(0,o),e.nextTick((function(){i.apply(null,a)}))):delete t[n]}}))}(n))}))}).call(this,require("_process"));const uo=ws,lo=T({}),co=require("path");class ho{constructor(e,t){this.name=e,this.account=t,this.objects=new fs(this),this.reactions=new ms(this),this.views=new gs(this)}get connection(){return this.account.connection}get store(){return this.account.store}use(e){return new ho(e,this.account)}namespaces(){return new class{constructor(e){this.db=e}get store(){return this.account.store}get account(){return this.db.account}namespace(e){return this.ns(e)}ns(e){return new Es(e,this.db)}async each(e){const t=this.store.namespaces.find({db:this.db.name});for(const r of t)await e(this.ns(r.id))}async all(){return this.store.namespaces.find({db:this.db.name})}}(this)}namespace(e){return this.ns(e)}ns(e){return new Es(e,this)}streams(e){return e.ns&&(e.ns=this.ns(e.ns)),new uo({...e,db:this})}events(e){return new bs({...e,db:this})}stream(e){return this.ns("").stream(e)}object(e,t){return new class{constructor(e,t,r){this.db=e,this.id=t,this.data=r}get store(){return this.account.store}get account(){return this.db.account}async write(){return this.store.objects.write({db:this.db.name,id:this.id,data:this.data})}async read(){return this.store.objects.read({db:this.db.name,id:this.id})}async destroy(){return this.store.objects.destroy({db:this.db.name,id:this.id})}}(this,e,t)}async domain({folder:e,tools:t,objects:r,views:n,reactions:i}){this.objects=new fs(this),this.reactions=new ms(this),this.views=new gs(this);const s={...t,docs:e=>({write:async t=>await this.store.documents.write({db:this.name,collection:e,doc:t}),read:async({id:t})=>await this.store.documents.read({db:this.name,collection:e,id:t}),count:async t=>await this.store.documents.count({db:this.name,collection:e,query:t}),find:async(t,r)=>await this.store.documents.find({db:this.name,collection:e,query:t,options:r}),destroy:async({id:t})=>await this.store.documents.destroy({db:this.name,collection:e,id:t})}),db:this};function o(t,r,n,i){return e?lo.sync(t,{...i,cwd:co.resolve(r,n)}).map(e=>{const t={...co.parse(e),relpath:e,abspath:co.resolve(r,n,e)};return t.id=[t.dir.replace("/","."),t.name].join(".").replace(/^\./,""),t}):[]}for(const a of o("**/*.js",e,"objects",{ignore:["**/commands/*","**/events/*"]}))this.objects.register(a.id.replace(/\.index$/,""),require(a.abspath),s);for(const[a,u]of Object.entries(null!=r?r:{}))this.objects.register(a,u,s);for(const a of o("**/*.js",e,"views",{}))this.views.register(a.id,require(a.abspath),s);for(const[a,u]of Object.entries(null!=n?n:{}))this.views.register(a,u,s);for(const a of o("**/*.js",e,"reactions",{}))this.reactions.register(a.id,require(a.abspath),s);for(const[a,u]of Object.entries(null!=i?i:{}))this.reactions.register(a,u,s)}async exists(){let e;try{e=await this.store.databases.find({name:this.name})}catch(error){e=void 0}return null!=e}async notExists(){return!await this.exists()}async create(){const e=await this.account.profile();return await this.store.databases.create({name:this.name,account:e.id}),this}async createIfNotExists(){return await this.notExists()&&await this.create(),this}async destroy(){await this.store.databases.destroy({db:this.name})}async rename(e){return await this.store.databases.rename({db:this.name,to:e}),this.name=e,this}async grant({role:e,email:t}){return await this.store.accounts.grant({db:this.name,role:e,email:t}),this}async revoke({email:e}){return await this.store.accounts.revoke({db:this.name,email:e}),this}}var fo=ho,po=class{constructor(e){this.account=e}get store(){return this.account.store}async each(e){const t=await this.store.databases.find();for(const r of t)await e(r)}async all(){return await this.store.databases.find()}},mo=class{constructor(e,t){this.connection=e,this.name=null==t?void 0:t.name,this.username=null==t?void 0:t.username}get store(){return this.connection.store}db(e){return new fo(e,this)}databases(){return new po(this)}async exists({password:e}){let t;try{t=await this.store.accounts.find({username:this.username,password:e})}catch(error){t=void 0}return null!=t}async notExists({password:e}){return!await this.exists({password:e})}async create({password:e}){var t;return await this.store.accounts.create({name:null!==(t=this.name)&&void 0!==t?t:"",username:this.username,password:e}),this}async createIfNotExists({password:e}){return await this.notExists({password:e})&&await this.create({password:e}),this}async destroy(){return await this.store.accounts.destroy({username:this.username}),this}async activate(){return await this.store.accounts.activate({username:this.username}),this}async deactivate(){return await this.store.accounts.deactivate({username:this.username}),this}async profile(){return await this.store.accounts.find({username:this.username})}},yo=class extends Error{constructor(e,t){super(e),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor),this.status=t||500}};const go=require("fs");var vo={PersistrError:yo,register:function(e){return go.readdirSync(e).forEach(t=>{if(go.statSync(`${e}/${t}`).isDirectory())return register(`${e}/${t}`);const r=""+t;if("index.js"!==r&&r.endsWith(".js")){var n=require(`${e}/${t}`);vo[n.name]=n}}),vo},handle:function(e){return async function(t,r,n){try{await e(t,r,n)}catch(error){r.headersSent&&r.get("content-type").includes("text/event-stream")?(console.error(error.message+"\t"+error.stack),r.write(`event: error\ndata: ${JSON.stringify({message:error.message,name:error.name,status:error.status})}\n\n`)):error instanceof vo.PersistrError?(console.error(error.message+"\t"+error.stack),r.status(error.status).json({error:error.message})):(console.error(error.message+"\t"+error.stack),r.status(500).json({error:"Internal service error",internal:error.message,stack:error.stack}))}}},json:function(e,t,r,n){e?r.status(400).json({error:"Invalid JSON body in request: "+t.originalUrl,internal:e.message,stack:e.stack}):n()}},bo=vo,_o={};(function(e){_o=bo.register(e)}).call(this,"/node_modules/@persistr/server-crypto/src/errors");var wo={};Object.defineProperty(wo,"__esModule",{value:!0}),wo.getRules=wo.isJSONType=void 0;const Eo=new Set(["string","number","integer","boolean","null","object","array"]);wo.isJSONType=function(e){return"string"==typeof e&&Eo.has(e)},wo.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}};var Co={};function To(e,t){return t.rules.some(t=>No(e,t))}function No(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(Co,"__esModule",{value:!0}),Co.shouldUseRule=Co.shouldUseGroup=Co.schemaHasRulesForType=void 0,Co.schemaHasRulesForType=function({schema:e,self:t},r){const n=t.RULES.types[r];return n&&!0!==n&&To(e,n)},Co.shouldUseGroup=To,Co.shouldUseRule=No;var ko={};Object.defineProperty(ko,"__esModule",{value:!0}),ko.getProperty=ko.safeStringify=ko.stringify=ko.strConcat=ko.addCodeArg=ko.str=ko._=ko.nil=ko._Code=ko.Name=ko.IDENTIFIER=ko._CodeOrName=void 0;class Oo{}ko._CodeOrName=Oo,ko.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class So extends Oo{constructor(e){if(super(),!ko.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}ko.Name=So;class xo extends Oo{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof So&&(e[t.str]=(e[t.str]||0)+1),e),{})}}function $o(e,...t){const r=[e[0]];let n=0;for(;n<t.length;)Io(r,t[n]),r.push(e[++n]);return new xo(r)}ko._Code=xo,ko.nil=new xo(""),ko._=$o;const Ao=new xo("+");function jo(e,...t){const r=[Po(e[0])];let n=0;for(;n<t.length;)r.push(Ao),Io(r,t[n]),r.push(Ao,Po(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===Ao){const r=Ro(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new xo(r)}function Io(e,t){var r;t instanceof xo?e.push(...t._items):t instanceof So?e.push(t):e.push("number"==typeof(r=t)||"boolean"==typeof r||null===r?r:Po(Array.isArray(r)?r.join(","):r))}function Ro(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof So||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof So?void 0:`"${e}${t.slice(1)}`}function Po(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ko.str=jo,ko.addCodeArg=Io,ko.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:jo`${e}${t}`},ko.stringify=function(e){return new xo(Po(e))},ko.safeStringify=Po,ko.getProperty=function(e){return"string"==typeof e&&ko.IDENTIFIER.test(e)?new xo("."+e):$o`[${e}]`};var Mo,Lo={};Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.ValueScope=Lo.ValueScopeName=Lo.Scope=Lo.varKinds=Lo.UsedValueState=void 0;class qo extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"}(Mo=Lo.UsedValueState||(Lo.UsedValueState={})),Lo.varKinds={const:new ko.Name("const"),let:new ko.Name("let"),var:new ko.Name("var")};class Do{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof ko.Name?e:this.name(e)}name(e){return new ko.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}Lo.Scope=Do;class Fo extends ko.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:r}){this.value=e,this.scopePath=ko._`.${new ko.Name(t)}[${r}]`}}Lo.ValueScopeName=Fo;const Uo=ko._`\n`;Lo.ValueScope=class extends Do{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?Uo:ko.nil}}get(){return this._scope}name(e){return new Fo(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:i}=n,s=null!==(r=t.key)&&void 0!==r?r:t.ref;let o=this._values[i];if(o){const e=o.get(s);if(e)return e}else o=this._values[i]=new Map;o.set(s,n);const a=this._scope[i]||(this._scope[i]=[]),u=a.length;return a[u]=t.ref,n.setValue(t,{property:i,itemIndex:u}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error(`CodeGen: name "${t}" has no value`);return ko._`${e}${t.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(e,t,r={},n){let i=ko.nil;for(const s in e){const o=e[s];if(!o)continue;const a=r[s]=r[s]||new Map;o.forEach(e=>{if(a.has(e))return;a.set(e,Mo.Started);let r=t(e);if(r){const t=this.opts.es5?Lo.varKinds.var:Lo.varKinds.const;i=ko._`${i}${t} ${e} = ${r};${this.opts._n}`}else{if(!(r=null==n?void 0:n(e)))throw new qo(e);i=ko._`${i}${r}${this.opts._n}`}a.set(e,Mo.Completed)})}return i}};var Vo={};Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.or=Vo.and=Vo.not=Vo.CodeGen=Vo.operators=Vo.varKinds=Vo.ValueScopeName=Vo.ValueScope=Vo.Scope=Vo.Name=Vo.stringify=Vo.getProperty=Vo.nil=Vo.strConcat=Vo.str=Vo._=void 0,Object.defineProperty(Vo,"_",{enumerable:!0,get:function(){return ko._}}),Object.defineProperty(Vo,"str",{enumerable:!0,get:function(){return ko.str}}),Object.defineProperty(Vo,"strConcat",{enumerable:!0,get:function(){return ko.strConcat}}),Object.defineProperty(Vo,"nil",{enumerable:!0,get:function(){return ko.nil}}),Object.defineProperty(Vo,"getProperty",{enumerable:!0,get:function(){return ko.getProperty}}),Object.defineProperty(Vo,"stringify",{enumerable:!0,get:function(){return ko.stringify}}),Object.defineProperty(Vo,"Name",{enumerable:!0,get:function(){return ko.Name}}),Object.defineProperty(Vo,"Scope",{enumerable:!0,get:function(){return Lo.Scope}}),Object.defineProperty(Vo,"ValueScope",{enumerable:!0,get:function(){return Lo.ValueScope}}),Object.defineProperty(Vo,"ValueScopeName",{enumerable:!0,get:function(){return Lo.ValueScopeName}}),Object.defineProperty(Vo,"varKinds",{enumerable:!0,get:function(){return Lo.varKinds}}),Vo.operators={GT:new ko._Code(">"),GTE:new ko._Code(">="),LT:new ko._Code("<"),LTE:new ko._Code("<="),EQ:new ko._Code("==="),NEQ:new ko._Code("!=="),NOT:new ko._Code("!"),OR:new ko._Code("||"),AND:new ko._Code("&&"),ADD:new ko._Code("+")};class Bo{optimizeNodes(){return this}optimizeNames(e,t){return this}}class zo extends Bo{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const r=e?Lo.varKinds.var:this.varKind,n=void 0===this.rhs?"":" = "+this.rhs;return`${r} ${this.name}${n};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=fa(this.rhs,e,t)),this}get names(){return this.rhs instanceof ko._CodeOrName?this.rhs.names:{}}}class Ho extends Bo{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof ko.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=fa(this.rhs,e,t),this}get names(){return da(this.lhs instanceof ko.Name?{}:{...this.lhs.names},this.rhs)}}class Wo extends Ho{constructor(e,t,r,n){super(e,r,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class Qo extends Bo{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return this.label+":"+e}}class Jo extends Bo{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?" "+this.label:""};`+e}}class Go extends Bo{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class Ko extends Bo{constructor(e){super(),this.code=e}render({_n:e}){return this.code+";"+e}optimizeNodes(){return""+this.code?this:void 0}optimizeNames(e,t){return this.code=fa(this.code,e,t),this}get names(){return this.code instanceof ko._CodeOrName?this.code.names:{}}}class Zo extends Bo{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const i=r[n];i.optimizeNames(e,t)||(pa(e,i.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>ha(e,t.names),{})}}class Yo extends Zo{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class Xo extends Zo{}class ea extends Yo{}ea.kind="else";class ta extends Yo{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new ea(e):e}return t?!1===e?t instanceof ta?t:t.nodes:this.nodes.length?this:new ta(ma(e),t instanceof ta?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=fa(this.condition,e,t),this}get names(){const e=super.names;return da(e,this.condition),this.else&&ha(e,this.else.names),e}}ta.kind="if";class ra extends Yo{}ra.kind="for";class na extends ra{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=fa(this.iteration,e,t),this}get names(){return ha(super.names,this.iteration.names)}}class ia extends ra{constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?Lo.varKinds.var:this.varKind,{name:r,from:n,to:i}=this;return`for(${t} ${r}=${n}; ${r}<${i}; ${r}++)`+super.render(e)}get names(){const e=da(super.names,this.from);return da(e,this.to)}}class sa extends ra{constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=fa(this.iterable,e,t),this}get names(){return ha(super.names,this.iterable.names)}}class oa extends Yo{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}oa.kind="func";class aa extends Zo{render(e){return"return "+super.render(e)}}aa.kind="return";class ua extends Yo{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&ha(e,this.catch.names),this.finally&&ha(e,this.finally.names),e}}class la extends Yo{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}la.kind="catch";class ca extends Yo{render(e){return"finally"+super.render(e)}}function ha(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function da(e,t){return t instanceof ko._CodeOrName?ha(e,t.names):e}function fa(e,t,r){return e instanceof ko.Name?i(e):(n=e)instanceof ko._Code&&n._items.some(e=>e instanceof ko.Name&&1===t[e.str]&&void 0!==r[e.str])?new ko._Code(e._items.reduce((e,t)=>(t instanceof ko.Name&&(t=i(t)),t instanceof ko._Code?e.push(...t._items):e.push(t),e),[])):e;var n;function i(e){const n=r[e.str];return void 0===n||1!==t[e.str]?e:(delete t[e.str],n)}}function pa(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function ma(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:ko._`!${ba(e)}`}ca.kind="finally",Vo.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new Lo.Scope({parent:e}),this._nodes=[new Xo]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const i=this._scope.toName(t);return void 0!==r&&n&&(this._constants[i.str]=r),this._leafNode(new zo(e,i,r)),i}const(e,t,r){return this._def(Lo.varKinds.const,e,t,r)}let(e,t,r){return this._def(Lo.varKinds.let,e,t,r)}var(e,t,r){return this._def(Lo.varKinds.var,e,t,r)}assign(e,t,r){return this._leafNode(new Ho(e,t,r))}add(e,t){return this._leafNode(new Wo(e,Vo.operators.ADD,t))}code(e){return"function"==typeof e?e():e!==ko.nil&&this._leafNode(new Ko(e)),this}object(...e){const t=["{"];for(const[r,n]of e)t.length>1&&t.push(","),t.push(r),(r!==n||this.opts.es5)&&(t.push(":"),ko.addCodeArg(t,n));return t.push("}"),new ko._Code(t)}if(e,t,r){if(this._blockNode(new ta(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new ta(e))}else(){return this._elseNode(new ea)}endIf(){return this._endBlockNode(ta,ea)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new na(e),t)}forRange(e,t,r,n,i=(this.opts.es5?Lo.varKinds.var:Lo.varKinds.let)){const s=this._scope.toName(e);return this._for(new ia(i,s,t,r),()=>n(s))}forOf(e,t,r,n=Lo.varKinds.const){const i=this._scope.toName(e);if(this.opts.es5){const e=t instanceof ko.Name?t:this.var("_arr",t);return this.forRange("_i",0,ko._`${e}.length`,t=>{this.var(i,ko._`${e}[${t}]`),r(i)})}return this._for(new sa("of",n,i,t),()=>r(i))}forIn(e,t,r,n=(this.opts.es5?Lo.varKinds.var:Lo.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,ko._`Object.keys(${t})`,r);const i=this._scope.toName(e);return this._for(new sa("in",n,i,t),()=>r(i))}endFor(){return this._endBlockNode(ra)}label(e){return this._leafNode(new Qo(e))}break(e){return this._leafNode(new Jo(e))}return(e){const t=new aa;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(aa)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new ua;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new la(e),t(e)}return r&&(this._currNode=n.finally=new ca,this.code(r)),this._endBlockNode(la,ca)}throw(e){return this._leafNode(new Go(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=ko.nil,r,n){return this._blockNode(new oa(e,t,r)),n&&this.code(n).endFunc(),this}endFunc(){return this._endBlockNode(oa)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof ta))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},Vo.not=ma;const ya=va(Vo.operators.AND);Vo.and=function(...e){return e.reduce(ya)};const ga=va(Vo.operators.OR);function va(e){return(t,r)=>t===ko.nil?r:r===ko.nil?t:ko._`${ba(t)} ${e} ${ba(r)}`}function ba(e){return e instanceof ko.Name?e:ko._`(${e})`}Vo.or=function(...e){return e.reduce(ga)};var _a={};Object.defineProperty(_a,"__esModule",{value:!0});const wa={data:new Vo.Name("data"),valCxt:new Vo.Name("valCxt"),dataPath:new Vo.Name("dataPath"),parentData:new Vo.Name("parentData"),parentDataProperty:new Vo.Name("parentDataProperty"),rootData:new Vo.Name("rootData"),dynamicAnchors:new Vo.Name("dynamicAnchors"),vErrors:new Vo.Name("vErrors"),errors:new Vo.Name("errors"),this:new Vo.Name("this"),self:new Vo.Name("self"),scope:new Vo.Name("scope"),json:new Vo.Name("json"),jsonPos:new Vo.Name("jsonPos"),jsonLen:new Vo.Name("jsonLen"),jsonPart:new Vo.Name("jsonPart")};_a.default=wa;var Ea={};function Ca(e,t){const r=e.const("err",t);e.if(Vo._`${_a.default.vErrors} === null`,()=>e.assign(_a.default.vErrors,Vo._`[${r}]`),Vo._`${_a.default.vErrors}.push(${r})`),e.code(Vo._`${_a.default.errors}++`)}function Ta(e,t){const{gen:r,validateName:n,schemaEnv:i}=e;i.$async?r.throw(Vo._`new ${e.ValidationError}(${t})`):(r.assign(Vo._`${n}.errors`,t),r.return(!1))}Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.extendErrors=Ea.resetErrorsCount=Ea.reportExtraError=Ea.reportError=Ea.keyword$DataError=Ea.keywordError=void 0,Ea.keywordError={message:({keyword:e})=>Vo.str`should pass "${e}" keyword validation`},Ea.keyword$DataError={message:({keyword:e,schemaType:t})=>t?Vo.str`"${e}" keyword must be ${t} ($data)`:Vo.str`"${e}" keyword is invalid ($data)`},Ea.reportError=function(e,t=Ea.keywordError,r){const{it:n}=e,{gen:i,compositeRule:s,allErrors:o}=n,a=ka(e,t);(null!=r?r:s||o)?Ca(i,a):Ta(n,Vo._`[${a}]`)},Ea.reportExtraError=function(e,t=Ea.keywordError){const{it:r}=e,{gen:n,compositeRule:i,allErrors:s}=r;Ca(n,ka(e,t)),i||s||Ta(r,_a.default.vErrors)},Ea.resetErrorsCount=function(e,t){e.assign(_a.default.errors,t),e.if(Vo._`${_a.default.vErrors} !== null`,()=>e.if(t,()=>e.assign(Vo._`${_a.default.vErrors}.length`,t),()=>e.assign(_a.default.vErrors,null)))},Ea.extendErrors=function({gen:e,keyword:t,schemaValue:r,data:n,errsCount:i,it:s}){if(void 0===i)throw new Error("ajv implementation error");const o=e.name("err");e.forRange("i",i,_a.default.errors,i=>{e.const(o,Vo._`${_a.default.vErrors}[${i}]`),e.if(Vo._`${o}.dataPath === undefined`,()=>e.assign(Vo._`${o}.dataPath`,Vo.strConcat(_a.default.dataPath,s.errorPath))),e.assign(Vo._`${o}.schemaPath`,Vo.str`${s.errSchemaPath}/${t}`),s.opts.verbose&&(e.assign(Vo._`${o}.schema`,r),e.assign(Vo._`${o}.data`,n))})};const Na={keyword:new Vo.Name("keyword"),schemaPath:new Vo.Name("schemaPath"),params:new Vo.Name("params"),propertyName:new Vo.Name("propertyName"),message:new Vo.Name("message"),schema:new Vo.Name("schema"),parentSchema:new Vo.Name("parentSchema"),instancePath:new Vo.Name("instancePath")};function ka(e,t){const{createErrors:r,opts:n}=e.it;return!1===r?Vo._`{}`:(n.jtd&&!n.ajvErrors?Oa:Sa)(e,t)}function Oa(e,{message:t}){const{gen:r,keyword:n,it:i}=e,{errorPath:s,errSchemaPath:o,opts:a}=i,u=[[Na.instancePath,Vo.strConcat(_a.default.dataPath,s)],[Na.schemaPath,Vo.str`${o}/${n}`]];return a.messages&&u.push([Na.message,"function"==typeof t?t(e):t]),r.object(...u)}function Sa(e,t){const{gen:r,keyword:n,data:i,schemaValue:s,it:o}=e,{topSchemaRef:a,schemaPath:u,errorPath:l,errSchemaPath:c,propertyName:h,opts:d}=o,{params:f,message:p}=t,m=[[Na.keyword,n],[_a.default.dataPath,Vo.strConcat(_a.default.dataPath,l)],[Na.schemaPath,Vo.str`${c}/${n}`],[Na.params,"function"==typeof f?f(e):f||Vo._`{}`]];return h&&m.push([Na.propertyName,h]),d.messages&&m.push([Na.message,"function"==typeof p?p(e):p]),d.verbose&&m.push([Na.schema,s],[Na.parentSchema,Vo._`${a}${u}`],[_a.default.data,i]),r.object(...m)}var xa={};Object.defineProperty(xa,"__esModule",{value:!0}),xa.boolOrEmptySchema=xa.topBoolOrEmptySchema=void 0;const $a={message:"boolean schema is false"};function Aa(e,t){const{gen:r,data:n}=e,i={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};Ea.reportError(i,$a,t)}xa.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?Aa(e,!1):"object"==typeof r&&!0===r.$async?t.return(_a.default.data):(t.assign(Vo._`${n}.errors`,null),t.return(!0))},xa.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),Aa(e)):r.var(t,!0)};var ja=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;0!=i--;){var o=s[i];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r},Ia={},Ra=Ia=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,n,i,s,o,a,u,l,c){if(i&&"object"==typeof i&&!Array.isArray(i)){for(var h in r(i,s,o,a,u,l,c),i){var d=i[h];if(Array.isArray(d)){if(h in Ra.arrayKeywords)for(var f=0;f<d.length;f++)e(t,r,n,d[f],s+"/"+h+"/"+f,o,s,h,i,f)}else if(h in Ra.propsKeywords){if(d&&"object"==typeof d)for(var p in d)e(t,r,n,d[p],s+"/"+h+"/"+p.replace(/~/g,"~0").replace(/\//g,"~1"),o,s,h,i,p)}else(h in Ra.keywords||t.allKeys&&!(h in Ra.skipKeywords))&&e(t,r,n,d,s+"/"+h,o,s,h,i)}n(i,s,o,a,u,l,c)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};Ra.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},Ra.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},Ra.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},Ra.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};var Pa,Ma={exports:{}};
/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */Pa=function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function s(e){var n=t("[0-9]","[A-Fa-f]"),i=r(r("%[EFef]"+n+"%"+n+n+"%"+n+n)+"|"+r("%[89A-Fa-f]"+n+"%"+n+n)+"|"+r("%"+n+n)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",s),a=e?"[\\uE000-\\uF8FF]":"[]",u=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),l=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),c=r(r(i+"|"+t(u,s,"[\\:]"))+"*"),h=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),d=r(h+"\\."+h+"\\."+h+"\\."+h),f=r(n+"{1,4}"),p=r(r(f+"\\:"+f)+"|"+d),m=r(r(f+"\\:")+"{6}"+p),y=r("\\:\\:"+r(f+"\\:")+"{5}"+p),g=r(r(f)+"?\\:\\:"+r(f+"\\:")+"{4}"+p),v=r(r(r(f+"\\:")+"{0,1}"+f)+"?\\:\\:"+r(f+"\\:")+"{3}"+p),b=r(r(r(f+"\\:")+"{0,2}"+f)+"?\\:\\:"+r(f+"\\:")+"{2}"+p),_=r(r(r(f+"\\:")+"{0,3}"+f)+"?\\:\\:"+f+"\\:"+p),w=r(r(r(f+"\\:")+"{0,4}"+f)+"?\\:\\:"+p),E=r(r(r(f+"\\:")+"{0,5}"+f)+"?\\:\\:"+f),C=r(r(r(f+"\\:")+"{0,6}"+f)+"?\\:\\:"),T=r([m,y,g,v,b,_,w,E,C].join("|")),N=r(r(u+"|"+i)+"+"),k=(r(T+"\\%25"+N),r(T+r("\\%25|\\%(?!"+n+"{2})")+N)),O=r("[vV]"+n+"+\\."+t(u,s,"[\\:]")+"+"),S=r("\\["+r(k+"|"+T+"|"+O)+"\\]"),x=r(r(i+"|"+t(u,s))+"*"),$=r(S+"|"+d+"(?!"+x+")|"+x),A=r("[0-9]*"),j=r(r(c+"@")+"?"+$+r("\\:"+A)+"?"),I=r(i+"|"+t(u,s,"[\\:\\@]")),R=r(I+"*"),P=r(I+"+"),M=r(r(i+"|"+t(u,s,"[\\@]"))+"+"),L=r(r("\\/"+R)+"*"),q=r("\\/"+r(P+L)+"?"),D=r(M+L),F=r(P+L),U="(?!"+I+")",V=(r(L+"|"+q+"|"+D+"|"+F+"|"+U),r(r(I+"|"+t("[\\/\\?]",a))+"*")),B=r(r(I+"|[\\/\\?]")+"*"),z=r(r("\\/\\/"+j+L)+"|"+q+"|"+F+"|"+U),H=r(l+"\\:"+z+r("\\?"+V)+"?"+r("\\#"+B)+"?"),W=r(r("\\/\\/"+j+L)+"|"+q+"|"+D+"|"+U),Q=r(W+r("\\?"+V)+"?"+r("\\#"+B)+"?");return r(H+"|"+Q),r(l+"\\:"+z+r("\\?"+V)+"?"),r(r("\\/\\/("+r("("+c+")@")+"?("+$+")"+r("\\:("+A+")")+"?)")+"?("+L+"|"+q+"|"+F+"|"+U+")"),r("\\?("+V+")"),r("\\#("+B+")"),r(r("\\/\\/("+r("("+c+")@")+"?("+$+")"+r("\\:("+A+")")+"?)")+"?("+L+"|"+q+"|"+D+"|"+U+")"),r("\\?("+V+")"),r("\\#("+B+")"),r(r("\\/\\/("+r("("+c+")@")+"?("+$+")"+r("\\:("+A+")")+"?)")+"?("+L+"|"+q+"|"+F+"|"+U+")"),r("\\?("+V+")"),r("\\#("+B+")"),r("("+c+")@"),r("\\:("+A+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]",a),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,s),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,o),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+d+")$"),IPV6ADDRESS:new RegExp("^\\[?("+T+")"+r(r("\\%25|\\%(?!"+n+"{2})")+"("+N+")")+"?\\]?$")}}var o=s(!1),a=s(!0),u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(u){i=!0,s=u}finally{try{!n&&a.return&&a.return()}finally{if(i)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=2147483647,c=/^xn--/,h=/[^\0-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function y(e){throw new RangeError(f[e])}function g(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}((e=e.replace(d,".")).split("."),t).join(".");return n+i}var v=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},b=function(e,t,r){var n=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;n+=36)e=p(e/35);return p(n+36*e/(e+38))},_=function(e){return g(e,(function(e){return h.test(e)?"xn--"+function(e){var t=[],r=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var s=e.charCodeAt(r++);56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),r--)}else t.push(i)}return t}(e)).length,n=128,i=0,s=72,o=!0,a=!1,u=void 0;try{for(var c,h=e[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var d=c.value;d<128&&t.push(m(d))}}catch(D){a=!0,u=D}finally{try{!o&&h.return&&h.return()}finally{if(a)throw u}}var f=t.length,g=f;for(f&&t.push("-");g<r;){var _=l,w=!0,E=!1,C=void 0;try{for(var T,N=e[Symbol.iterator]();!(w=(T=N.next()).done);w=!0){var k=T.value;k>=n&&k<_&&(_=k)}}catch(D){E=!0,C=D}finally{try{!w&&N.return&&N.return()}finally{if(E)throw C}}var O=g+1;_-n>p((l-i)/O)&&y("overflow"),i+=(_-n)*O,n=_;var S=!0,x=!1,$=void 0;try{for(var A,j=e[Symbol.iterator]();!(S=(A=j.next()).done);S=!0){var I=A.value;if(I<n&&++i>l&&y("overflow"),I==n){for(var R=i,P=36;;P+=36){var M=P<=s?1:P>=s+26?26:P-s;if(R<M)break;var L=R-M,q=36-M;t.push(m(v(M+L%q,0))),R=p(L/q)}t.push(m(v(R,0))),s=b(i,O,g==f),i=0,++g}}}catch(D){x=!0,$=D}finally{try{!S&&j.return&&j.return()}finally{if(x)throw $}}++i,++n}return t.join("")}(e):e}))},w=function(e){return g(e,(function(e){return c.test(e)?function(e){var t,r=[],n=e.length,i=0,s=128,o=72,a=e.lastIndexOf("-");a<0&&(a=0);for(var u=0;u<a;++u)e.charCodeAt(u)>=128&&y("not-basic"),r.push(e.charCodeAt(u));for(var c=a>0?a+1:0;c<n;){for(var h=i,d=1,f=36;;f+=36){c>=n&&y("invalid-input");var m=(t=e.charCodeAt(c++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>p((l-i)/d))&&y("overflow"),i+=m*d;var g=f<=o?1:f>=o+26?26:f-o;if(m<g)break;var v=36-g;d>p(l/v)&&y("overflow"),d*=v}var _=r.length+1;o=b(i-h,_,0==h),p(i/_)>l-s&&y("overflow"),s+=p(i/_),i%=_,r.splice(i++,0,s)}return String.fromCodePoint.apply(String,r)}(e.slice(4).toLowerCase()):e}))},E={};function C(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function T(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var s=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&s)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var o=parseInt(e.substr(r+4,2),16),a=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function N(e,t){function r(e){var r=T(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,C).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,C).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,C).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,C).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,C).replace(t.PCT_ENCODED,i)),e}function k(e){return e.replace(/^0*(.*)/,"$1")||"0"}function O(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=u(r,2)[1];return n?n.split(".").map(k).join("."):e}function S(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=u(r,3),i=n[1],s=n[2];if(i){for(var o=i.toLowerCase().split("::").reverse(),a=u(o,2),l=a[0],c=a[1],h=c?c.split(":").map(k):[],d=l.split(":").map(k),f=t.IPV4ADDRESS.test(d[d.length-1]),p=f?7:8,m=d.length-p,y=Array(p),g=0;g<p;++g)y[g]=h[g]||d[m+g]||"";f&&(y[p-1]=O(y[p-1],t));var v=y.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(v&&v.length>1){var _=y.slice(0,v.index),w=y.slice(v.index+v.length);b=_.join(":")+"::"+w.join(":")}else b=y.join(":");return s&&(b+="%"+s),b}return e}var x=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,$=void 0==="".match(/(){0}/)[1];function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?a:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(x);if(i){$?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=S(O(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var s=E[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||s&&s.unicodeSupport)N(r,n);else{if(r.host&&(t.domainHost||s&&s.domainHost))try{r.host=_(r.host.replace(n.PCT_ENCODED,T).toLowerCase())}catch(CT){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+CT}N(r,o)}s&&s.parse&&s.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function j(e,t){var r=!1!==t.iri?a:o,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(S(O(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var I=/^\.\.?\//,R=/^\/\.(\/|$)/,P=/^\/\.\.(\/|$)/,M=/^\/?(?:.|\n)*?(?=\/|$)/;function L(e){for(var t=[];e.length;)if(e.match(I))e=e.replace(I,"");else if(e.match(R))e=e.replace(R,"/");else if(e.match(P))e=e.replace(P,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(M);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?a:o,n=[],i=E[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?w(e.host):_(e.host.replace(r.PCT_ENCODED,T).toLowerCase())}catch(CT){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+CT}N(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var s=j(e,t);if(void 0!==s&&("suffix"!==t.reference&&n.push("//"),n.push(s),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var u=e.path;t.absolutePath||i&&i.absolutePath||(u=L(u)),void 0===s&&(u=u.replace(/^\/\//,"/%2F")),n.push(u)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function D(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],i={};return n||(e=A(q(e,r),r),t=A(q(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=L(t.path||""),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=L(t.path||""),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=L(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=L(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function F(e,t){return e&&e.toString().replace(t&&t.iri?a.PCT_ENCODED:o.PCT_ENCODED,T)}var U={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},V={scheme:"https",domainHost:U.domainHost,parse:U.parse,serialize:U.serialize};function B(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var z={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=B(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(B(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=u(r,2),i=n[0],s=n[1];e.path=i&&"/"!==i?i:void 0,e.query=s,e.resourceName=void 0}return e.fragment=void 0,e}},H={scheme:"wss",domainHost:z.domainHost,parse:z.parse,serialize:z.serialize},W={},Q="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",J="[0-9A-Fa-f]",G=r(r("%[EFef][0-9A-Fa-f]%"+J+J+"%"+J+J)+"|"+r("%[89A-Fa-f][0-9A-Fa-f]%"+J+J)+"|"+r("%"+J+J)),K=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),Z=new RegExp(Q,"g"),Y=new RegExp(G,"g"),X=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',K),"g"),ee=new RegExp(t("[^]",Q,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),te=ee;function re(e){var t=T(e);return t.match(Z)?t:e}var ne={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,s={},o=r.query.split("&"),a=0,u=o.length;a<u;++a){var l=o[a].split("=");switch(l[0]){case"to":for(var c=l[1].split(","),h=0,d=c.length;h<d;++h)n.push(c[h]);break;case"subject":r.subject=F(l[1],t);break;case"body":r.body=F(l[1],t);break;default:i=!0,s[F(l[0],t)]=F(l[1],t)}}i&&(r.headers=s)}r.query=void 0;for(var f=0,p=n.length;f<p;++f){var m=n[f].split("@");if(m[0]=F(m[0]),t.unicodeSupport)m[1]=F(m[1],t).toLowerCase();else try{m[1]=_(F(m[1],t).toLowerCase())}catch(CT){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+CT}n[f]=m.join("@")}return r},serialize:function(e,t){var r,n=e,s=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(s){for(var o=0,a=s.length;o<a;++o){var u=String(s[o]),l=u.lastIndexOf("@"),c=u.slice(0,l).replace(Y,re).replace(Y,i).replace(X,C),h=u.slice(l+1);try{h=t.iri?w(h):_(F(h,t).toLowerCase())}catch(CT){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+CT}s[o]=c+"@"+h}n.path=s.join(",")}var d=e.headers=e.headers||{};e.subject&&(d.subject=e.subject),e.body&&(d.body=e.body);var f=[];for(var p in d)d[p]!==W[p]&&f.push(p.replace(Y,re).replace(Y,i).replace(ee,C)+"="+d[p].replace(Y,re).replace(Y,i).replace(te,C));return f.length&&(n.query=f.join("&")),n}},ie=/^([^\:]+)\:(.*)/,se={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(ie),n=e;if(r){var i=t.scheme||n.scheme||"urn",s=r[1].toLowerCase(),o=r[2],a=i+":"+(t.nid||s),u=E[a];n.nid=s,n.nss=o,n.path=void 0,u&&(n=u.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),s=E[i];s&&(e=s.serialize(e,t));var o=e,a=e.nss;return o.path=(n||t.nid)+":"+a,o}},oe=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ae={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(oe)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};E[U.scheme]=U,E[V.scheme]=V,E[z.scheme]=z,E[H.scheme]=H,E[ne.scheme]=ne,E[se.scheme]=se,E[ae.scheme]=ae,e.SCHEMES=E,e.pctEncChar=C,e.pctDecChars=T,e.parse=A,e.removeDotSegments=L,e.serialize=q,e.resolveComponents=D,e.resolve=function(e,t,r){var n=function(e,t){var r={scheme:"null"};if(t)for(var n in t)r[n]=t[n];return r}(0,r);return q(D(A(e,n),A(t,n),n,!0),n)},e.normalize=function(e,t){return"string"==typeof e?e=q(A(e,t),t):"object"===n(e)&&(e=A(q(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=q(A(e,r),r):"object"===n(e)&&(e=q(e,r)),"string"==typeof t?t=q(A(t,r),r):"object"===n(t)&&(t=q(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?a.ESCAPE:o.ESCAPE,C)},e.unescapeComponent=F,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof Ma.exports?Pa(Ma.exports):"function"==typeof define&&define.amd?define(["exports"],Pa):Pa(this.URI=this.URI||{}),Ma=Ma.exports;var La={};Object.defineProperty(La,"__esModule",{value:!0}),La.MissingRefError=La.ValidationError=void 0;const qa=v({});class Da extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}La.ValidationError=Da;class Fa extends Error{constructor(e,t,r){super(r||`can't resolve reference ${t} from id ${e}`),this.missingRef=qa.resolveUrl(e,t),this.missingSchema=qa.normalizeId(qa.getFullPath(this.missingRef))}}La.MissingRefError=Fa,La={ValidationError:Da,MissingRefError:Fa};var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.resolveSchema=Ua.getCompilingSchema=Ua.resolveRef=Ua.compileSchema=Ua.SchemaEnv=void 0;const Va=v({}),Ba=y({}),za=g({});class Ha{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:Va.normalizeId(null==r?void 0:r.$id),this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function Wa(e){const t=Ja.call(this,e);if(t)return t;const r=Va.getFullPath(e.root.baseId),{es5:n,lines:i}=this.opts.code,{ownProperties:s}=this.opts,o=new Vo.CodeGen(this.scope,{es5:n,lines:i,ownProperties:s});let a;e.$async&&(a=o.scopeValue("Error",{ref:La.ValidationError,code:Vo._`require("ajv/dist/compile/error_classes").ValidationError`}));const u=o.scopeName("validate");e.validateName=u;const l={gen:o,allErrors:this.opts.allErrors,data:_a.default.data,parentData:_a.default.parentData,parentDataProperty:_a.default.parentDataProperty,dataNames:[_a.default.data],dataPathArr:[Vo.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:Vo.stringify(e.schema)}:{ref:e.schema}),validateName:u,ValidationError:a,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Vo.nil,errSchemaPath:this.opts.jtd?"":"#",errorPath:Vo._`""`,opts:this.opts,self:this};let c;try{this._compilations.add(e),za.validateFunctionCode(l),o.optimize(this.opts.code.optimize);const t=o.toString();c=`${o.scopeRefs(_a.default.scope)}return ${t}`,this.opts.code.process&&(c=this.opts.code.process(c,e));const r=new Function(""+_a.default.self,""+_a.default.scope,c)(this,this.scope.get());if(this.scope.value(u,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:u,validateCode:t,scopeValues:o._values}),this.opts.unevaluated){const{props:e,items:t}=l;r.evaluated={props:e instanceof Vo.Name?void 0:e,items:t instanceof Vo.Name?void 0:t,dynamicProps:e instanceof Vo.Name,dynamicItems:t instanceof Vo.Name},r.source&&(r.source.evaluated=Vo.stringify(r.evaluated))}return e.validate=r,e}catch(CT){throw delete e.validate,delete e.validateName,c&&this.logger.error("Error compiling schema, function code:",c),CT}finally{this._compilations.delete(e)}}function Qa(e){return Va.inlineRef(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Wa.call(this,e)}function Ja(e){for(const n of this._compilations)if(r=e,(t=n).schema===r.schema&&t.root===r.root&&t.baseId===r.baseId)return n;var t,r}function Ga(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||Ka.call(this,e,t)}function Ka(e,t){const r=Ma.parse(t),n=Va._getFullPath(r);let i=Va.getFullPath(e.baseId);if(Object.keys(e.schema).length>0&&n===i)return Ya.call(this,r,e);const s=Va.normalizeId(n),o=this.refs[s]||this.schemas[s];if("string"==typeof o){const t=Ka.call(this,e,o);if("object"!=typeof(null==t?void 0:t.schema))return;return Ya.call(this,r,t)}if("object"==typeof(null==o?void 0:o.schema)){if(o.validate||Wa.call(this,o),s===Va.normalizeId(t)){const{schema:t}=o;return t.$id&&(i=Va.resolveUrl(i,t.$id)),new Ha({schema:t,root:e,baseId:i})}return Ya.call(this,r,o)}}Ua.SchemaEnv=Ha,Ua.compileSchema=Wa,Ua.resolveRef=function(e,t,r){var n;r=Va.resolveUrl(t,r);const i=e.refs[r];if(i)return i;let s=Ga.call(this,e,r);if(void 0===s){const i=null===(n=e.localRefs)||void 0===n?void 0:n[r];i&&(s=new Ha({schema:i,root:e,baseId:t}))}return void 0!==s?e.refs[r]=Qa.call(this,s):void 0},Ua.getCompilingSchema=Ja,Ua.resolveSchema=Ka;const Za=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Ya(e,{baseId:t,schema:r,root:n}){var i;if("/"!==(null===(i=e.fragment)||void 0===i?void 0:i[0]))return;for(const o of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;if(void 0===(r=r[Ba.unescapeFragment(o)]))return;!Za.has(o)&&"object"==typeof r&&r.$id&&(t=Va.resolveUrl(t,r.$id))}let s;if("boolean"!=typeof r&&r.$ref&&!Ba.schemaHasRulesButRef(r,this.RULES)){const e=Va.resolveUrl(t,r.$ref);s=Ka.call(this,n,e)}return s=s||new Ha({schema:r,root:n,baseId:t}),s.schema!==s.root.schema?s:void 0}var Xa={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1},eu={};Object.defineProperty(eu,"__esModule",{value:!0}),eu.CodeGen=eu.Name=eu.nil=eu.stringify=eu.str=eu._=eu.KeywordCxt=void 0;const tu=p({});eu.KeywordCxt=tu.default,Object.defineProperty(eu,"_",{enumerable:!0,get:function(){return Vo._}}),Object.defineProperty(eu,"str",{enumerable:!0,get:function(){return Vo.str}}),Object.defineProperty(eu,"stringify",{enumerable:!0,get:function(){return Vo.stringify}}),Object.defineProperty(eu,"nil",{enumerable:!0,get:function(){return Vo.nil}}),Object.defineProperty(eu,"Name",{enumerable:!0,get:function(){return Vo.Name}}),Object.defineProperty(eu,"CodeGen",{enumerable:!0,get:function(){return Vo.CodeGen}});const ru=v({}),nu=m({}),iu=y({}),su=["removeAdditional","useDefaults","coerceTypes"],ou=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),au={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",schemaId:"JSON Schema draft-04 is not supported in Ajv v7.",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",strictNumbers:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key."},uu={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function lu(e){var t,r,n,i,s,o,a,u,l,c,h,d;const f=null===(t=e.strict)||void 0===t||t,p=!!f&&"log",m=null===(r=e.code)||void 0===r?void 0:r.optimize,y=!0===m||void 0===m?1:m||0;return{strict:f,strictTypes:null!==(n=e.strictTypes)&&void 0!==n?n:p,strictTuples:null!==(i=e.strictTuples)&&void 0!==i?i:p,code:e.code?{...e.code,optimize:y}:{optimize:y},loopRequired:null!==(s=e.loopRequired)&&void 0!==s?s:1/0,loopEnum:null!==(o=e.loopEnum)&&void 0!==o?o:1/0,meta:null===(a=e.meta)||void 0===a||a,messages:null===(u=e.messages)||void 0===u||u,inlineRefs:null===(l=e.inlineRefs)||void 0===l||l,addUsedSchema:null===(c=e.addUsedSchema)||void 0===c||c,validateSchema:null===(h=e.validateSchema)||void 0===h||h,validateFormats:null===(d=e.validateFormats)||void 0===d||d}}class cu{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...lu(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new Vo.ValueScope({scope:{},prefixes:ou,es5:t,lines:r}),this.logger=function(e){if(!1===e)return gu;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=wo.getRules(),hu.call(this,au,e,"NOT SUPPORTED"),hu.call(this,uu,e,"DEPRECATED","warn"),this._metaOpts=yu.call(this),e.formats&&pu.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&mu.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),fu.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t}=this.opts;t&&e&&this.addMetaSchema(Xa,Xa.$id,!1)}defaultMeta(){const{meta:e}=this.opts;return this.opts.defaultMeta="object"==typeof e?e.$id||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,t){await i.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||s.call(this,r)}async function i(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}async function s(e){try{return this._compileSchemaEnv(e)}catch(CT){if(!(CT instanceof La.MissingRefError))throw CT;return o.call(this,CT),await a.call(this,CT.missingSchema),s.call(this,e)}}function o({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function a(e){const r=await u.call(this,e);this.refs[e]||await i.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function u(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let i;if("object"==typeof e&&(i=e.$id,void 0!==i&&"string"!=typeof i))throw new Error("schema id must be string");return t=ru.normalizeId(t||i),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=du.call(this,e));)e=t;if(void 0===t){const r=new Ua.SchemaEnv({schema:{}});if(t=Ua.resolveSchema.call(this,r,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=du.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e.$id;return r&&(r=ru.normalizeId(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(bu.call(this,r,t),!t)return iu.eachItem(r,e=>_u.call(this,e)),this;Eu.call(this,t);const n={...t,type:nu.getJSONTypes(t.type),schemaType:nu.getJSONTypes(t.schemaType)};return iu.eachItem(r,0===n.type.length?e=>_u.call(this,e,n):e=>n.type.forEach(t=>_u.call(this,e,n,t))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.dataPath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let i=e;for(const e of t)i=i[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,s=i[e];n&&s&&(i[e]=Tu(s))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];t&&!t.test(r)||("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r=this.opts.validateSchema,n=this.opts.addUsedSchema){if("object"!=typeof e){if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let i=this._cache.get(e);if(void 0!==i)return i;const s=ru.getSchemaRefs.call(this,e);i=new Ua.SchemaEnv({schema:e,meta:t,localRefs:s}),this._cache.set(i.schema,i);const o=i.baseId;return n&&!o.startsWith("#")&&(o&&this._checkUnique(o),this.refs[o]=i),r&&this.validateSchema(e,!0),i}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Ua.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{Ua.compileSchema.call(this,e)}finally{this.opts=t}}}function hu(e,t,r,n="error"){for(const i in e){const s=i;s in t&&this.logger[n](`${r}: option ${i}. ${e[s]}`)}}function du(e){return e=ru.normalizeId(e),this.schemas[e]||this.refs[e]}function fu(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function pu(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function mu(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function yu(){const e={...this.opts};for(const t of su)delete e[t];return e}eu.default=cu,cu.ValidationError=La.ValidationError,cu.MissingRefError=La.MissingRefError;const gu={log(){},warn(){},error(){}},vu=/^[a-z_$][a-z0-9_$:-]*$/i;function bu(e,t){const{RULES:r}=this;if(iu.eachItem(e,e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!vu.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function _u(e,t,r){var n;const i=null==t?void 0:t.post;if(r&&i)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:s}=this;let o=i?s.post:s.rules.find(({type:e})=>e===r);if(o||(o={type:r,rules:[]},s.rules.push(o)),s.keywords[e]=!0,!t)return;const a={keyword:e,definition:{...t,type:nu.getJSONTypes(t.type),schemaType:nu.getJSONTypes(t.schemaType)}};t.before?wu.call(this,o,a,t.before):o.rules.push(a),s.all[e]=a,null===(n=t.implements)||void 0===n||n.forEach(e=>this.addKeyword(e))}function wu(e,t,r){const n=e.rules.findIndex(e=>e.keyword===r);n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function Eu(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=Tu(t)),e.validateSchema=this.compile(t,!0))}const Cu={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Tu(e){return{anyOf:[e,Cu]}}var Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});const ku={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Nu.default=ku;var Ou={};Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.callRef=Ou.getValidate=void 0;const Su=w({}),xu=y({}),$u={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:i,schemaEnv:s,validateName:o,opts:a,self:u}=n;if("#"===r||"#/"===r)return function(){if(s===s.root)return ju(e,o,s,s.$async);const r=t.scopeValue("root",{ref:s.root});return ju(e,Vo._`${r}.validate`,s.root,s.root.$async)}();const l=Ua.resolveRef.call(u,s.root,i,r);if(void 0===l)throw new La.MissingRefError(i,r);return l instanceof Ua.SchemaEnv?function(t){const r=Au(e,t);ju(e,r,t,t.$async)}(l):function(n){const i=t.scopeValue("schema",!0===a.code.source?{ref:n,code:Vo.stringify(n)}:{ref:n}),s=t.name("valid"),o=e.subschema({schema:n,dataTypes:[],schemaPath:Vo.nil,topSchemaRef:i,errSchemaPath:r},s);e.mergeEvaluated(o),e.ok(s)}(l)}};function Au(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):Vo._`${r.scopeValue("wrapper",{ref:t})}.validate`}function ju(e,t,r,n){const{gen:i,it:s}=e,{allErrors:o,schemaEnv:a,opts:u}=s,l=u.passContext?_a.default.this:Vo.nil;function c(e){const t=Vo._`${e}.errors`;i.assign(_a.default.vErrors,Vo._`${_a.default.vErrors} === null ? ${t} : ${_a.default.vErrors}.concat(${t})`),i.assign(_a.default.errors,Vo._`${_a.default.vErrors}.length`)}function h(e){var t;if(!s.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==s.props)if(n&&!n.dynamicProps)void 0!==n.props&&(s.props=xu.mergeEvaluated.props(i,n.props,s.props));else{const t=i.var("props",Vo._`${e}.evaluated.props`);s.props=xu.mergeEvaluated.props(i,t,s.props,Vo.Name)}if(!0!==s.items)if(n&&!n.dynamicItems)void 0!==n.items&&(s.items=xu.mergeEvaluated.items(i,n.items,s.items));else{const t=i.var("items",Vo._`${e}.evaluated.items`);s.items=xu.mergeEvaluated.items(i,t,s.items,Vo.Name)}}n?function(){if(!a.$async)throw new Error("async schema referenced by sync schema");const r=i.let("valid");i.try(()=>{i.code(Vo._`await ${Su.callValidateCode(e,t,l)}`),h(t),o||i.assign(r,!0)},e=>{i.if(Vo._`!(${e} instanceof ${s.ValidationError})`,()=>i.throw(e)),c(e),o||i.assign(r,!1)}),e.ok(r)}():e.result(Su.callValidateCode(e,t,l),()=>h(t),()=>c(t))}Ou.getValidate=Au,Ou.callRef=ju,Ou.default=$u;var Iu={};Object.defineProperty(Iu,"__esModule",{value:!0});const Ru=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Nu.default,Ou.default];Iu.default=Ru;var Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});const Mu=Vo.operators,Lu={maximum:{okStr:"<=",ok:Mu.LTE,fail:Mu.GT},minimum:{okStr:">=",ok:Mu.GTE,fail:Mu.LT},exclusiveMaximum:{okStr:"<",ok:Mu.LT,fail:Mu.GTE},exclusiveMinimum:{okStr:">",ok:Mu.GT,fail:Mu.LTE}},qu={message:({keyword:e,schemaCode:t})=>Vo.str`should be ${Lu[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>Vo._`{comparison: ${Lu[e].okStr}, limit: ${t}}`},Du={keyword:Object.keys(Lu),type:"number",schemaType:"number",$data:!0,error:qu,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data(Vo._`${r} ${Lu[t].fail} ${n} || isNaN(${r})`)}};Pu.default=Du;var Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});const Uu={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>Vo.str`should be multiple of ${e}`,params:({schemaCode:e})=>Vo._`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:n,it:i}=e,s=i.opts.multipleOfPrecision,o=t.let("res"),a=s?Vo._`Math.abs(Math.round(${o}) - ${o}) > 1e-${s}`:Vo._`${o} !== parseInt(${o})`;e.fail$data(Vo._`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};Fu.default=Uu;var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.default=function(e){const t=e.length;let r,n=0,i=0;for(;i<t;)n++,r=e.charCodeAt(i++),r>=55296&&r<=56319&&i<t&&(r=e.charCodeAt(i),56320==(64512&r)&&i++);return n};var Bu={};Object.defineProperty(Bu,"__esModule",{value:!0});const zu={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxLength"===e?"more":"fewer";return Vo.str`should NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>Vo._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n,it:i}=e,s="maxLength"===t?Vo.operators.GT:Vo.operators.LT;let o;if(!1===i.opts.unicode)o=Vo._`${r}.length`;else{const t=e.gen.scopeValue("func",{ref:Vu.default,code:Vo._`require("ajv/dist/compile/ucs2length").default`});o=Vo._`${t}(${r})`}e.fail$data(Vo._`${o} ${s} ${n}`)}};Bu.default=zu;var Hu={};Object.defineProperty(Hu,"__esModule",{value:!0});const Wu=w({}),Qu={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>Vo.str`should match pattern "${e}"`,params:({schemaCode:e})=>Vo._`{pattern: ${e}}`},code(e){const{gen:t,data:r,$data:n,schema:i,schemaCode:s}=e,o=n?Vo._`(new RegExp(${s}, "u"))`:Wu.usePattern(t,i);e.fail$data(Vo._`!${o}.test(${r})`)}};Hu.default=Qu;var Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});const Gu={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxProperties"===e?"more":"fewer";return Vo.str`should NOT have ${r} than ${t} items`},params:({schemaCode:e})=>Vo._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxProperties"===t?Vo.operators.GT:Vo.operators.LT;e.fail$data(Vo._`Object.keys(${r}).length ${i} ${n}`)}};Ju.default=Gu;var Ku={};Object.defineProperty(Ku,"__esModule",{value:!0});const Zu=w({}),Yu=g({}),Xu={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>Vo.str`should have required property '${e}'`,params:({params:{missingProperty:e}})=>Vo._`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:n,data:i,$data:s,it:o}=e,{opts:a}=o;if(!s&&0===r.length)return;const u=r.length>=a.loopRequired;if(o.allErrors?function(){if(u||s)e.block$data(Vo.nil,l);else for(const t of r)Zu.checkReportMissingProp(e,t)}():function(){const o=t.let("missing");if(u||s){const r=t.let("valid",!0);e.block$data(r,()=>function(r,s){e.setParams({missingProperty:r}),t.forOf(r,n,()=>{t.assign(s,Zu.propertyInData(t,i,r,a.ownProperties)),t.if(Vo.not(s),()=>{e.error(),t.break()})},Vo.nil)}(o,r)),e.ok(r)}else t.if(Zu.checkMissingProp(e,r,o)),Zu.reportMissingProp(e,o),t.else()}(),a.strictRequired){const t=e.parentSchema.properties,{definedProperties:n}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!n.has(e)){const t=`required property "${e}" is not defined at "${o.schemaEnv.baseId+o.errSchemaPath}" (strictRequired)`;Yu.checkStrictMode(o,t,o.opts.strictRequired)}}function l(){t.forOf("prop",n,r=>{e.setParams({missingProperty:r}),t.if(Zu.noPropertyInData(t,i,r,a.ownProperties),()=>e.error())})}}};Ku.default=Xu;var el={};Object.defineProperty(el,"__esModule",{value:!0});const tl={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxItems"===e?"more":"fewer";return Vo.str`should NOT have ${r} than ${t} items`},params:({schemaCode:e})=>Vo._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n}=e,i="maxItems"===t?Vo.operators.GT:Vo.operators.LT;e.fail$data(Vo._`${r}.length ${i} ${n}`)}};el.default=tl;var rl={};Object.defineProperty(rl,"__esModule",{value:!0});const nl=m({}),il={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>Vo.str`should NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>Vo._`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:n,schema:i,parentSchema:s,schemaCode:o,it:a}=e;if(!n&&!i)return;const u=t.let("valid"),l=s.items?nl.getSchemaTypes(s.items):[];function c(n,i){const s=t.name("item"),o=nl.checkDataTypes(l,s,a.opts.strict,nl.DataType.Wrong),c=t.const("indices",Vo._`{}`);t.for(Vo._`;${n}--;`,()=>{t.let(s,Vo._`${r}[${n}]`),t.if(o,Vo._`continue`),l.length>1&&t.if(Vo._`typeof ${s} == "string"`,Vo._`${s} += "_"`),t.if(Vo._`typeof ${c}[${s}] == "number"`,()=>{t.assign(i,Vo._`${c}[${s}]`),e.error(),t.assign(u,!1).break()}).code(Vo._`${c}[${s}] = ${n}`)})}function h(n,i){const s=e.gen.scopeValue("func",{ref:ja,code:Vo._`require("ajv/dist/compile/equal")`}),o=t.name("outer");t.label(o).for(Vo._`;${n}--;`,()=>t.for(Vo._`${i} = ${n}; ${i}--;`,()=>t.if(Vo._`${s}(${r}[${n}], ${r}[${i}])`,()=>{e.error(),t.assign(u,!1).break(o)})))}e.block$data(u,(function(){const n=t.let("i",Vo._`${r}.length`),i=t.let("j");e.setParams({i:n,j:i}),t.assign(u,!0),t.if(Vo._`${n} > 1`,()=>(l.length>0&&!l.some(e=>"object"===e||"array"===e)?c:h)(n,i))}),Vo._`${o} === false`),e.ok(u)}};rl.default=il;var sl={};Object.defineProperty(sl,"__esModule",{value:!0});const ol={keyword:"const",$data:!0,error:{message:"should be equal to constant",params:({schemaCode:e})=>Vo._`{allowedValue: ${e}}`},code(e){const t=e.gen.scopeValue("func",{ref:ja,code:Vo._`require("ajv/dist/compile/equal")`});e.fail$data(Vo._`!${t}(${e.data}, ${e.schemaCode})`)}};sl.default=ol;var al={};Object.defineProperty(al,"__esModule",{value:!0});const ul={keyword:"enum",schemaType:"array",$data:!0,error:{message:"should be equal to one of the allowed values",params:({schemaCode:e})=>Vo._`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:n,schema:i,schemaCode:s,it:o}=e;if(!n&&0===i.length)throw new Error("enum must have non-empty array");const a=i.length>=o.opts.loopEnum,u=e.gen.scopeValue("func",{ref:ja,code:Vo._`require("ajv/dist/compile/equal")`});let l;if(a||n)l=t.let("valid"),e.block$data(l,(function(){t.assign(l,!1),t.forOf("v",s,e=>t.if(Vo._`${u}(${r}, ${e})`,()=>t.assign(l,!0).break()))}));else{if(!Array.isArray(i))throw new Error("ajv implementation error");const e=t.const("vSchema",s);l=Vo.or(...i.map((t,n)=>function(e,t){const n=i[t];return n&&"object"==typeof n?Vo._`${u}(${r}, ${e}[${t}])`:Vo._`${r} === ${n}`}(e,n)))}e.pass(l)}};al.default=ul;var ll={};Object.defineProperty(ll,"__esModule",{value:!0});const cl=[Pu.default,Fu.default,Bu.default,Hu.default,Ju.default,Ku.default,el.default,rl.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},sl.default,al.default];ll.default=cl;var hl={};Object.defineProperty(hl,"__esModule",{value:!0});const dl=E({}),fl=y({}),pl=g({}),ml={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>Vo.str`should NOT have more than ${e} items`,params:({params:{len:e}})=>Vo._`{limit: ${e}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:s}=e,{items:o}=n;if(!Array.isArray(o))return void pl.checkStrictMode(s,'"additionalItems" is ignored when "items" is not an array of schemas');s.items=!0;const a=t.const("len",Vo._`${i}.length`);if(!1===r)e.setParams({len:o.length}),e.pass(Vo._`${a} <= ${o.length}`);else if("object"==typeof r&&!fl.alwaysValidSchema(s,r)){const r=t.var("valid",Vo._`${a} <= ${o.length}`);t.if(Vo.not(r),()=>function(r){t.forRange("i",o.length,a,n=>{e.subschema({keyword:"additionalItems",dataProp:n,dataPropType:dl.Type.Num},r),s.allErrors||t.if(Vo.not(r),()=>t.break())})}(r)),e.ok(r)}}};hl.default=ml;var yl={};Object.defineProperty(yl,"__esModule",{value:!0});const gl=y({}),vl=g({}),bl=w({}),_l={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{gen:t,schema:r,it:n}=e;if(Array.isArray(r))n.opts.unevaluated&&r.length&&!0!==n.items&&(n.items=gl.mergeEvaluated.items(t,r.length,n.items)),function(r){const{parentSchema:i,data:s}=e;if(n.opts.strictTuples&&!function(e,t){return e===t.minItems&&(e===t.maxItems||!1===t.additionalItems)}(r.length,i)){const e=`"items" is ${r.length}-tuple, but minItems or maxItems/additionalItems are not specified or different`;vl.checkStrictMode(n,e,n.opts.strictTuples)}const o=t.name("valid"),a=t.const("len",Vo._`${s}.length`);r.forEach((r,i)=>{gl.alwaysValidSchema(n,r)||(t.if(Vo._`${a} > ${i}`,()=>e.subschema({keyword:"items",schemaProp:i,dataProp:i},o)),e.ok(o))})}(r);else{if(n.items=!0,gl.alwaysValidSchema(n,r))return;e.ok(bl.validateArray(e))}}};yl.default=_l;var wl={};Object.defineProperty(wl,"__esModule",{value:!0});const El=E({}),Cl=y({}),Tl=g({}),Nl={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?Vo.str`should contain at least ${e} valid item(s)`:Vo.str`should contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?Vo._`{minContains: ${e}}`:Vo._`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:s}=e;let o,a;const{minContains:u,maxContains:l}=n;s.opts.next?(o=void 0===u?1:u,a=l):o=1;const c=t.const("len",Vo._`${i}.length`);if(e.setParams({min:o,max:a}),void 0===a&&0===o)return void Tl.checkStrictMode(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==a&&o>a)return Tl.checkStrictMode(s,'"minContains" > "maxContains" is always invalid'),void e.fail();if(Cl.alwaysValidSchema(s,r)){let t=Vo._`${c} >= ${o}`;return void 0!==a&&(t=Vo._`${t} && ${c} <= ${a}`),void e.pass(t)}s.items=!0;const h=t.name("valid");if(void 0===a&&1===o)d(h,()=>t.if(h,()=>t.break()));else{t.let(h,!1);const e=t.name("_valid"),r=t.let("count",0);d(e,()=>t.if(e,()=>function(e){t.code(Vo._`${e}++`),void 0===a?t.if(Vo._`${e} >= ${o}`,()=>t.assign(h,!0).break()):(t.if(Vo._`${e} > ${a}`,()=>t.assign(h,!1).break()),1===o?t.assign(h,!0):t.if(Vo._`${e} >= ${o}`,()=>t.assign(h,!0)))}(r)))}function d(r,n){t.forRange("i",0,c,t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:El.Type.Num,compositeRule:!0},r),n()})}e.result(h,()=>e.reset())}};wl.default=Nl;var kl={};Object.defineProperty(kl,"__esModule",{value:!0}),kl.validateSchemaDeps=kl.validatePropertyDeps=kl.error=void 0;const Ol=y({}),Sl=w({});kl.error={message:({params:{property:e,depsCount:t,deps:r}})=>{const n=1===t?"property":"properties";return Vo.str`should have ${n} ${r} when property ${e} is present`},params:({params:{property:e,depsCount:t,deps:r,missingProperty:n}})=>Vo._`{property: ${e},
    missingProperty: ${n},
    depsCount: ${t},
    deps: ${r}}`};const xl={keyword:"dependencies",type:"object",schemaType:"object",error:kl.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e)"__proto__"!==n&&((Array.isArray(e[n])?t:r)[n]=e[n]);return[t,r]}(e);$l(e,t),Al(e,r)}};function $l(e,t=e.schema){const{gen:r,data:n,it:i}=e;if(0===Object.keys(t).length)return;const s=r.let("missing");for(const o in t){const a=t[o];if(0===a.length)continue;const u=Sl.propertyInData(r,n,o,i.opts.ownProperties);e.setParams({property:o,depsCount:a.length,deps:a.join(", ")}),i.allErrors?r.if(u,()=>{for(const t of a)Sl.checkReportMissingProp(e,t)}):(r.if(Vo._`${u} && (${Sl.checkMissingProp(e,a,s)})`),Sl.reportMissingProp(e,s),r.else())}}function Al(e,t=e.schema){const{gen:r,data:n,keyword:i,it:s}=e,o=r.name("valid");for(const a in t)Ol.alwaysValidSchema(s,t[a])||(r.if(Sl.propertyInData(r,n,a,s.opts.ownProperties),()=>{const t=e.subschema({keyword:i,schemaProp:a},o);e.mergeValidEvaluated(t,o)},()=>r.var(o,!0)),e.ok(o))}kl.validatePropertyDeps=$l,kl.validateSchemaDeps=Al,kl.default=xl;var jl={};Object.defineProperty(jl,"__esModule",{value:!0});const Il=y({}),Rl={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:({params:e})=>Vo.str`property name '${e.propertyName}' is invalid`,params:({params:e})=>Vo._`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:n,it:i}=e;if(Il.alwaysValidSchema(i,r))return;const s=t.name("valid");t.forIn("key",n,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},s),t.if(Vo.not(s),()=>{e.error(!0),i.allErrors||t.break()})}),e.ok(s)}};jl.default=Rl;var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});const Ml=w({}),Ll=E({}),ql=y({}),Dl={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"should NOT have additional properties",params:({params:e})=>Vo._`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:i,errsCount:s,it:o}=e;if(!s)throw new Error("ajv implementation error");const{allErrors:a,opts:u}=o;if(o.props=!0,"all"!==u.removeAdditional&&ql.alwaysValidSchema(o,r))return;const l=Ml.allSchemaProperties(n.properties),c=Ml.allSchemaProperties(n.patternProperties);function h(e){t.code(Vo._`delete ${i}[${e}]`)}function d(n){if("all"===u.removeAdditional||u.removeAdditional&&!1===r)h(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(a||t.break());if("object"==typeof r&&!ql.alwaysValidSchema(o,r)){const r=t.name("valid");"failing"===u.removeAdditional?(f(n,r,!1),t.if(Vo.not(r),()=>{e.reset(),h(n)})):(f(n,r),a||t.if(Vo.not(r),()=>t.break()))}}}function f(t,r,n){const i={keyword:"additionalProperties",dataProp:t,dataPropType:Ll.Type.Str};!1===n&&Object.assign(i,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(i,r)}t.forIn("key",i,e=>{l.length||c.length?t.if(function(e){let r;if(l.length>8){const i=ql.schemaRefOrVal(o,n.properties,"properties");r=Ml.isOwnProperty(t,i,e)}else r=l.length?Vo.or(...l.map(t=>Vo._`${e} === ${t}`)):Vo.nil;return c.length&&(r=Vo.or(r,...c.map(r=>Vo._`${Ml.usePattern(t,r)}.test(${e})`))),Vo.not(r)}(e),()=>d(e)):d(e)}),e.ok(Vo._`${s} === ${_a.default.errors}`)}};Pl.default=Dl;var Fl={};Object.defineProperty(Fl,"__esModule",{value:!0});const Ul=p({}),Vl=w({}),Bl=y({}),zl={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:i,it:s}=e;"all"===s.opts.removeAdditional&&void 0===n.additionalProperties&&Pl.default.code(new Ul.default(s,Pl.default,"additionalProperties"));const o=Vl.allSchemaProperties(r);for(const h of o)s.definedProperties.add(h);s.opts.unevaluated&&o.length&&!0!==s.props&&(s.props=Bl.mergeEvaluated.props(t,Bl.toHash(o),s.props));const a=o.filter(e=>!Bl.alwaysValidSchema(s,r[e]));if(0===a.length)return;const u=t.name("valid");for(const h of a)l(h)?c(h):(t.if(Vl.propertyInData(t,i,h,s.opts.ownProperties)),c(h),s.allErrors||t.else().var(u,!0),t.endIf()),e.it.definedProperties.add(h),e.ok(u);function l(e){return s.opts.useDefaults&&!s.compositeRule&&void 0!==r[e].default}function c(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},u)}}};Fl.default=zl;var Hl={};Object.defineProperty(Hl,"__esModule",{value:!0});const Wl=w({}),Ql=E({}),Jl=g({}),Gl=y({}),Kl={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:i,it:s}=e,{opts:o}=s,a=Wl.schemaProperties(s,r);if(0===a.length)return;const u=o.strict&&!o.allowMatchingProperties&&i.properties,l=t.name("valid");!0===s.props||s.props instanceof Vo.Name||(s.props=Gl.evaluatedPropsToName(t,s.props));const{props:c}=s;function h(e){for(const t in u)new RegExp(e).test(t)&&Jl.checkStrictMode(s,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function d(r){t.forIn("key",n,n=>{t.if(Vo._`${Wl.usePattern(t,r)}.test(${n})`,()=>{e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:n,dataPropType:Ql.Type.Str},l),s.opts.unevaluated&&!0!==c?t.assign(Vo._`${c}[${n}]`,!0):s.allErrors||t.if(Vo.not(l),()=>t.break())})})}!function(){for(const e of a)u&&h(e),s.allErrors?d(e):(t.var(l,!0),d(e),t.if(l))}()}};Hl.default=Kl;var Zl={};Object.defineProperty(Zl,"__esModule",{value:!0});const Yl=y({}),Xl={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if(Yl.alwaysValidSchema(n,r))return void e.fail();const i=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),e.result(i,()=>e.error(),()=>e.reset())},error:{message:"should NOT be valid"}};Zl.default=Xl;var ec={};Object.defineProperty(ec,"__esModule",{value:!0});const tc={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:w({}).validateUnion,error:{message:"should match some schema in anyOf"}};ec.default=tc;var rc={};Object.defineProperty(rc,"__esModule",{value:!0});const nc=y({}),ic={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"should match exactly one schema in oneOf",params:({params:e})=>Vo._`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const i=r,s=t.let("valid",!1),o=t.let("passing",null),a=t.name("_valid");e.setParams({passing:o}),t.block((function(){i.forEach((r,i)=>{let u;nc.alwaysValidSchema(n,r)?t.var(a,!0):u=e.subschema({keyword:"oneOf",schemaProp:i,compositeRule:!0},a),i>0&&t.if(Vo._`${a} && ${s}`).assign(s,!1).assign(o,Vo._`[${o}, ${i}]`).else(),t.if(a,()=>{t.assign(s,!0),t.assign(o,i),u&&e.mergeEvaluated(u,Vo.Name)})})})),e.result(s,()=>e.reset(),()=>e.error(!0))}};rc.default=ic;var sc={};Object.defineProperty(sc,"__esModule",{value:!0});const oc=y({}),ac={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const i=t.name("valid");r.forEach((t,r)=>{if(oc.alwaysValidSchema(n,t))return;const s=e.subschema({keyword:"allOf",schemaProp:r},i);e.ok(i),e.mergeEvaluated(s)})}};sc.default=ac;var uc={};Object.defineProperty(uc,"__esModule",{value:!0});const lc=y({}),cc=g({}),hc={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>Vo.str`should match "${e.ifClause}" schema`,params:({params:e})=>Vo._`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:n}=e;void 0===r.then&&void 0===r.else&&cc.checkStrictMode(n,'"if" without "then" and "else" is ignored');const i=dc(n,"then"),s=dc(n,"else");if(!i&&!s)return;const o=t.let("valid",!0),a=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);e.mergeEvaluated(t)}(),e.reset(),i&&s){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(a,u("then",r),u("else",r))}else i?t.if(a,u("then")):t.if(Vo.not(a),u("else"));function u(r,n){return()=>{const i=e.subschema({keyword:r},a);t.assign(o,a),e.mergeValidEvaluated(i,o),n?t.assign(n,Vo._`${r}`):e.setParams({ifClause:r})}}e.pass(o,()=>e.error(!0))}};function dc(e,t){const r=e.schema[t];return void 0!==r&&!lc.alwaysValidSchema(e,r)}uc.default=hc;var fc={};Object.defineProperty(fc,"__esModule",{value:!0});const pc=g({}),mc={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&pc.checkStrictMode(r,`"${e}" without "if" is ignored`)}};fc.default=mc;var yc={};Object.defineProperty(yc,"__esModule",{value:!0});const gc=[Zl.default,ec.default,rc.default,sc.default,uc.default,fc.default,hl.default,yl.default,wl.default,jl.default,Pl.default,kl.default,Fl.default,Hl.default];yc.default=gc;var vc={};Object.defineProperty(vc,"__esModule",{value:!0});const bc={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>Vo.str`should match format "${e}"`,params:({schemaCode:e})=>Vo._`{format: ${e}}`},code(e,t){const{gen:r,data:n,$data:i,schema:s,schemaCode:o,it:a}=e,{opts:u,errSchemaPath:l,schemaEnv:c,self:h}=a;u.validateFormats&&(i?function(){const i=r.scopeValue("formats",{ref:h.formats,code:u.code.formats}),s=r.const("fDef",Vo._`${i}[${o}]`),a=r.let("fType"),l=r.let("format");r.if(Vo._`typeof ${s} == "object" && !(${s} instanceof RegExp)`,()=>r.assign(a,Vo._`${s}.type || "string"`).assign(l,Vo._`${s}.validate`),()=>r.assign(a,Vo._`"string"`).assign(l,s)),e.fail$data(Vo.or(!1===u.strict?Vo.nil:Vo._`${o} && !${l}`,function(){const e=c.$async?Vo._`(${s}.async ? await ${l}(${n}) : ${l}(${n}))`:Vo._`${l}(${n})`,r=Vo._`(typeof ${l} == "function" ? ${e} : ${l}.test(${n}))`;return Vo._`${l} && ${l} !== true && ${a} === ${t} && !${r}`}()))}():function(){const i=h.formats[s];if(!i)return void function(){if(!1!==u.strict)throw new Error(e());function e(){return`unknown format "${s}" ignored in schema at path "${l}"`}h.logger.warn(e())}();if(!0===i)return;const[o,a,d]=function(e){const t=r.scopeValue("formats",{key:s,ref:e,code:u.code.formats?Vo._`${u.code.formats}${Vo.getProperty(s)}`:void 0});return"object"!=typeof e||e instanceof RegExp?["string",e,t]:[e.type||"string",e.validate,Vo._`${t}.validate`]}(i);o===t&&e.pass(function(){if("object"==typeof i&&!(i instanceof RegExp)&&i.async){if(!c.$async)throw new Error("async format in sync schema");return Vo._`await ${d}(${n})`}return"function"==typeof a?Vo._`${d}(${n})`:Vo._`${d}.test(${n})`}())}())}};vc.default=bc;var _c={};Object.defineProperty(_c,"__esModule",{value:!0});const wc=[vc.default];_c.default=wc;var Ec={};Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.contentVocabulary=Ec.metadataVocabulary=void 0,Ec.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],Ec.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];var Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});const Tc=[Iu.default,ll.default,yc.default,_c.default,Ec.metadataVocabulary,Ec.contentVocabulary];Cc.default=Tc;var Nc={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},kc={};Object.defineProperty(kc,"__esModule",{value:!0}),kc.CodeGen=kc.Name=kc.nil=kc.stringify=kc.str=kc._=kc.KeywordCxt=void 0;const Oc=p({});kc.KeywordCxt=Oc.default,Object.defineProperty(kc,"_",{enumerable:!0,get:function(){return Vo._}}),Object.defineProperty(kc,"str",{enumerable:!0,get:function(){return Vo.str}}),Object.defineProperty(kc,"stringify",{enumerable:!0,get:function(){return Vo.stringify}}),Object.defineProperty(kc,"nil",{enumerable:!0,get:function(){return Vo.nil}}),Object.defineProperty(kc,"Name",{enumerable:!0,get:function(){return Vo.Name}}),Object.defineProperty(kc,"CodeGen",{enumerable:!0,get:function(){return Vo.CodeGen}});const Sc=["/properties"],xc="http://json-schema.org/draft-07/schema";class $c extends eu.default{_addVocabularies(){super._addVocabularies(),Cc.default.forEach(e=>this.addVocabulary(e))}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(Nc,Sc):Nc;this.addMetaSchema(e,xc,!1),this.refs["http://json-schema.org/schema"]=xc}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(xc)?xc:void 0)}}kc.default=$c;var Ac={};function jc(e,t){return{validate:e,compare:t}}Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.formatNames=Ac.fastFormats=Ac.fullFormats=void 0,Ac.fullFormats={date:jc(Pc,Mc),time:jc(qc,Dc),"date-time":jc((function(e){const t=e.split(Fc);return 2===t.length&&Pc(t[0])&&qc(t[1],!0)}),Uc),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return Vc.test(e)&&Bc.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(zc.test(e))return!1;try{return new RegExp(e),!0}catch(CT){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/},Ac.fastFormats={...Ac.fullFormats,date:jc(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,Mc),time:jc(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Dc),"date-time":jc(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Uc),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},Ac.formatNames=Object.keys(Ac.fullFormats);const Ic=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Rc=[0,31,28,31,30,31,30,31,31,30,31,30,31];function Pc(e){const t=Ic.exec(e);if(!t)return!1;const r=+t[1],n=+t[2],i=+t[3];return n>=1&&n<=12&&i>=1&&i<=(2===n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:Rc[n])}function Mc(e,t){if(e&&t)return e>t?1:e<t?-1:0}const Lc=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function qc(e,t){const r=Lc.exec(e);if(!r)return!1;const n=+r[1],i=+r[2],s=+r[3],o=r[5];return(n<=23&&i<=59&&s<=59||23===n&&59===i&&60===s)&&(!t||""!==o)}function Dc(e,t){if(!e||!t)return;const r=Lc.exec(e),n=Lc.exec(t);return r&&n?(e=r[1]+r[2]+r[3]+(r[4]||""))>(t=n[1]+n[2]+n[3]+(n[4]||""))?1:e<t?-1:0:void 0}const Fc=/t|\s/i;function Uc(e,t){if(!e||!t)return;const[r,n]=e.split(Fc),[i,s]=t.split(Fc),o=Mc(r,i);return void 0!==o?o||Dc(n,s):void 0}const Vc=/\/|:/,Bc=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,zc=/[^\\]\\Z/;var Hc={};Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.formatLimitDefinition=void 0;const Wc=p({}),Qc=Vo.operators,Jc={formatMaximum:{okStr:"<=",ok:Qc.LTE,fail:Qc.GT},formatMinimum:{okStr:">=",ok:Qc.GTE,fail:Qc.LT},formatExclusiveMaximum:{okStr:"<",ok:Qc.LT,fail:Qc.GTE},formatExclusiveMinimum:{okStr:">",ok:Qc.GT,fail:Qc.LTE}},Gc={message:({keyword:e,schemaCode:t})=>Vo.str`should be ${Jc[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>Vo._`{comparison: ${Jc[e].okStr}, limit: ${t}}`};Hc.formatLimitDefinition={keyword:Object.keys(Jc),type:"string",schemaType:"string",$data:!0,error:Gc,code(e){const{gen:t,data:r,schemaCode:n,keyword:i,it:s}=e,{opts:o,self:a}=s;if(!o.validateFormats)return;const u=new Wc.default(s,a.RULES.all.format.definition,"format");function l(e){return Vo._`${e}.compare(${r}, ${n}) ${Jc[i].fail} 0`}u.$data?function(){const r=t.scopeValue("formats",{ref:a.formats,code:o.code.formats}),n=t.const("fmt",Vo._`${r}[${u.schemaCode}]`);e.fail$data(Vo.or(Vo._`typeof ${n} != "object"`,Vo._`${n} instanceof RegExp`,Vo._`typeof ${n}.compare != "function"`,l(n)))}():function(){const r=u.schema,n=a.formats[r];if(!n||!0===n)return;if("object"!=typeof n||n instanceof RegExp||"function"!=typeof n.compare)throw new Error(`"${i}": format "${r}" does not define "compare" function`);const s=t.scopeValue("formats",{key:r,ref:n,code:o.code.formats?Vo._`${o.code.formats}${Vo.getProperty(r)}`:void 0});e.fail$data(l(s))}()},dependencies:["format"]},Hc.default=e=>(e.addKeyword(Hc.formatLimitDefinition),e);var Kc={};Object.defineProperty(Kc,"__esModule",{value:!0});const Zc=new Vo.Name("fullFormats"),Yc=new Vo.Name("fastFormats"),Xc=(e,t={keywords:!0})=>{if(Array.isArray(t))return eh(e,t,Ac.fullFormats,Zc),e;const[r,n]="fast"===t.mode?[Ac.fastFormats,Yc]:[Ac.fullFormats,Zc];return eh(e,t.formats||Ac.formatNames,r,n),t.keywords&&Hc.default(e),e};function eh(e,t,r,n){var i,s;null!==(i=(s=e.opts.code).formats)&&void 0!==i||(s.formats=Vo._`require("ajv-formats/dist/formats").${n}`);for(const o of t)e.addFormat(o,r[o])}Xc.get=(e,t="full")=>{const r=("fast"===t?Ac.fastFormats:Ac.fullFormats)[e];if(!r)throw new Error(`Unknown format "${e}"`);return r},Kc.default=Xc,(Kc=Xc).default=Xc;const th=kc.default,rh=require("fs"),nh=require("path"),ih=new th({strict:!0});Kc(ih);var sh={register:function(e,t){t||(t="");const r=nh.join(e,t);return rh.readdirSync(r).forEach(t=>{const n=""+t;if("."===n||".."===n)return sh;if(rh.statSync(`${r}/${t}`).isDirectory())return sh.register(e,nh.relative(e,`${r}/${t}`));if(!n.endsWith(".schema.json"))return sh;let i=nh.relative(e,r)+"/"+n.replace(/\..*$/,""),s=JSON.parse(rh.readFileSync(`${r}/${t}`,"utf8"));ih.addSchema(s,i)}),sh},is:function(e){return{valid:function(t){try{var r=ih.validate(t,e);return r||console.error(ih.errorsText()),r}catch(error){return console.error(error.message+"\t"+error.stack),!1}}}},validate:function(e){return function(t,r,n){try{if(!ih.validate(e,t.body))throw new bo.InvalidRequestBody(t.originalUrl,ih.errorsText())}catch(error){return void(error instanceof bo.ServiceError?r.status(error.status).json({error:error.message}):(console.error(error.message+"\t"+error.stack),r.status(500).json({error:"Internal service error",internal:error.message,stack:error.stack})))}n()}}},oh=sh,ah={};(function(e){ah=oh.register(e)}).call(this,"/node_modules/@persistr/server-crypto/src/schemas");var uh={};(function(e){const t="Could not extract parameters from DER signature";function r(e,t,r){let n=0;for(;t+n<r&&0===e[t+n];)n++;return e[t+n]>=128?--n:n}uh.derToConcat=(r,n)=>{let i=0;if(48!==r[i++])throw new Error(t);let s=r[i++];if(129===s&&(s=r[i++]),s>r.length-i||2!==r[i++])throw new Error(t);let o=r[i++];if(o>r.length-i-2||o>n+1)throw new Error(t);let a=i;if(i+=o,2!==r[i++])throw new Error(t);let u=r[i++];if(u!==r.length-i||u>n+1)throw new Error(t);let l=i;if(i+=u,i!==r.length)throw new Error(t);let c=n-o,h=n-u,d=e.allocUnsafe(c+o+h+u);for(i=0;i<c;i++)d[i]=0;let f=Math.max(-c,0);r.copy(d,i,a+f,a+o),i=n;for(let e=i;i<e+h;i++)d[i]=0;let p=Math.max(-h,0);return r.copy(d,i,l+p,l+u),d},uh.concatToDer=(t,n)=>{let i=r(t,0,n),s=r(t,n,t.length),o=n-i,a=n-s,u=o+a+4,l=u<128,c=e.allocUnsafe((l?2:3)+u),h=0;return c[h++]=48,l?c[h++]=u:(c[h++]=129,c[h++]=255&u),c[h++]=2,c[h++]=o,i<0?(c[h++]=0,h+=t.copy(c,h,0,n)):h+=t.copy(c,h,i,n),c[h++]=2,c[h++]=a,s<0?(c[h++]=0,t.copy(c,h,n)):t.copy(c,h,n+s),c}}).call(this,require("buffer").Buffer);var lh={};function ch(e,t,r){if(!r){if(e)throw e;return t}r(e,t)}lh.buf2b64url=e=>e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),lh.responder=ch,lh.payloadVerifications=(e,t)=>{if(e.audList){if(void 0===e.payload.aud)return e.error={message:"Missing aud claim in payload"},ch(null,e,t);if(!e.audList.includes(e.payload.aud))return e.error={message:"Mismatching aud claim in payload"},ch(null,e,t)}if(e.issList){if(void 0===e.payload.iss)return e.error={message:"Missing iss claim in payload"},ch(null,e,t);if(!e.issList.includes(e.payload.iss))return e.error={message:"Mismatching iss claim in payload"},ch(null,e,t)}let r=Number(e.payload.iat);if(!r)return e.error={message:"Missing or invalid iat claim in payload"},ch(null,e,t);let n=Number(e.payload.exp);if(e.lifetime){let t=r+e.lifetime;(!n||t<n)&&(n=t)}return n&&Date.now()>1e3*n?(e.expired=n,ch(null,e,t)):(e.valid=!0,ch(null,e,t))};var hh={};(function(e){const t=require("crypto"),{responder:r,buf2b64url:n,payloadVerifications:i}=lh,s=/^(HS|RS|ES)(256|384|512)$/;function o(r,i,s){if("string"==typeof s)s=e.from(s,"base64");else if(!(s instanceof e))throw new TypeError("Key must be a buffer or a base64 string");let o=i>>3;if(s.length<o)throw new TypeError(`Key length must be at least ${o} bytes`);let a=t.createHmac("SHA"+i,s);return`${r}.${n(a.update(r).digest())}`}function a(r,n,i,s){if("string"==typeof s)s=e.from(s,"base64");else if(!(s instanceof e))throw new TypeError("Key must be a buffer or a base64 string");let o=i>>3;if(s.length<o)throw new TypeError(`Key length must be at least ${o} bytes`);let a=t.createHmac("SHA"+i,s);return a.update(r),t.timingSafeEqual(a.digest(),e.from(n,"base64"))}function u(r,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----"))throw new TypeError("Key must be a PEM formatted RSA private key");let o=t.createSign("SHA"+i);return`${r}.${n(o.update(r).sign(s))}`}function l(r,n,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----")&&!s.includes("CERTIFICATE-----"))throw new TypeError("Key must be a PEM formatted RSA public key");let o=t.createVerify("SHA"+i);return o.update(r),o.verify(s,n,"base64")}function c(r,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----"))throw new TypeError("Key must be a PEM formatted EC private key");let o=t.createSign("SHA"+i);o.update(r);let a=32;return 384===i?a=48:512===i&&(a=66),`${r}.${n(uh.derToConcat(o.sign(s),a))}`}function h(r,n,i,s){if(s instanceof e)s=s.toString();else if("string"!=typeof s)throw new TypeError("Key must be a buffer or a UTF-8 string");if(!s.includes("-----BEGIN")||!s.includes("KEY-----")&&!s.includes("CERTIFICATE-----"))throw new TypeError("Key must be a PEM formatted EC public key");let o=32;if(384===i?o=48:512===i&&(o=66),(n=e.from(n,"base64")).length!==o<<1)return!1;let a=t.createVerify("SHA"+i);return a.update(r),a.verify(s,uh.concatToDer(n,o))}hh.generate=(t,i,...a)=>{let l,h,d={alg:t};if(a[0].constructor!==Object)l=a[0],h="function"==typeof a[1]?a[1]:void 0;else if(d.kid=a[1],l=a[0][a[1]],h="function"==typeof a[2]?a[2]:void 0,!l)return r(new TypeError("Invalid key identifier"),null,h);let f,p="string"==typeof t?t.match(s):null;if(!p)return r(new TypeError("Unrecognized algorithm"),null,h);f="HS"===p[1]?o:"RS"===p[1]?u:c,i.iat=Math.floor(Date.now()/1e3);let m,y=n(e.from(JSON.stringify(d))),g=n(e.from(JSON.stringify(i)));try{m=f(`${y}.${g}`,+p[2],l)}catch(error){return r(error,null,h)}return r(null,m,h)},hh.verify=(e,t,n)=>{if(e.error)return r(null,e,n);if("string"!=typeof e.header.alg)return e.error={message:"Missing or invalid alg claim in header"},r(null,e,n);let o=e.header.alg.match(s);if(!o)return e.error={message:"Unrecognized algorithm "+e.header.alg},r(null,e,n);if(e.algList&&!e.algList.includes(e.header.alg))return e.error={message:"Unwanted algorithm "+e.header.alg},r(null,e,n);let u,c,d=`${e.parts[0]}.${e.parts[1]}`;u="HS"===o[1]?a:"RS"===o[1]?l:h;try{c=u(d,e.parts[2],+o[2],t)}catch(error){return e.error={message:"Could not verify integrity. "+error.message},r(null,e,n)}return c?i(e,n):(e.error={message:"Integrity check failed"},r(null,e,n))}}).call(this,require("buffer").Buffer);var dh={};(function(e){const t=require("crypto"),{responder:r,buf2b64url:n,payloadVerifications:i}=lh,s=/^(PBES2-HS(256|384|512)\053)?(RSA-OAEP|dir|A(128|192|256)KW)$/,o=/^A(128|192|256)(GCM|CBC-HS(256|384|512))$/;function a(n,i,s,o,a,u){let c,d,p=i[3]?+i[1]>>2:+i[1]>>3,y=i[3]?h:l;if("dir"!==n[0]){c=t.randomBytes(p);let e=n[4]?m:f;try{d=e(c,a,+n[4])}catch(error){return r(error,null,u)}}else{if("string"==typeof a)a=e.from(a,"base64");else if(!(a instanceof e)){let e=new TypeError("Key must be a buffer or a base64 string");return r(e,null,u)}if(a.length<p){let e=new TypeError(`Key must be at least ${p} bytes`);return r(e,null,u)}c=a.slice(0,p),d=""}o.iat=Math.floor(Date.now()/1e3);let g=y(s,c,d,JSON.stringify(o),+i[1]);return r(null,g,u)}function u(t,n,s,o,a){let u,l,h=e.from(t.parts[0]),f=e.from(t.parts[1],"base64"),m=e.from(t.parts[2],"base64"),g=e.from(t.parts[3],"base64"),v=e.from(t.parts[4],"base64"),b=s[3]?+s[1]>>2:+s[1]>>3,_=s[3]?d:c;if("dir"!==n[0]){let e=n[4]?y:p;try{u=e(f,o,+n[4])}catch(error){return t.error={message:"Could not decrypt token. "+error.message},r(null,t,a)}}else{if("string"==typeof o)o=e.from(o,"base64");else if(!(o instanceof e))return t.error={message:"Invalid key"},r(null,t,a);if(o.length<b)return t.error={message:`Invalid key length. Must be at least ${b} bytes`},r(null,t,a);u=o.slice(0,b)}try{l=_(g,h,v,u,m,+s[1])}catch(error){return t.error={message:"Could not decrypt token. "+error.message},r(null,t,a)}try{t.payload=JSON.parse(l)}catch(error){return t.error={message:"Non parsable payload. "+error.message},r(null,t,a)}return i(t,a)}function l(r,i,s,o,a){let u=t.randomBytes(12),l=t.createCipheriv(`id-aes${a}-GCM`,i,u);l.setAutoPadding(!1),l.setAAD(e.from(r));let c=n(e.concat([l.update(o),l.final()])),h=n(l.getAuthTag());return`${r}.${s}.${n(u)}.${c}.${h}`}function c(r,n,i,s,o,a){let u=t.createDecipheriv(`id-aes${a}-GCM`,s,o);return u.setAutoPadding(!1),u.setAAD(n),u.setAuthTag(i),e.concat([u.update(r),u.final()])}function h(r,i,s,o,a){let u=t.randomBytes(16),l=a>>3,c=t.createCipheriv(`AES-${a}-CBC`,i.slice(l),u),h=e.concat([c.update(o),c.final()]),d=r.length<<3,f=e.from(("000000000000000"+d.toString(16)).slice(-16),"hex"),p=t.createHmac("SHA"+(a<<1),i.slice(0,l));p.update(e.from(r)).update(u).update(h).update(f);let m=n(p.digest().slice(0,l));return`${r}.${s}.${n(u)}.${n(h)}.${m}`}function d(r,n,i,s,o,a){let u=a>>3,l=n.length<<3,c=e.from(("000000000000000"+l.toString(16)).slice(-16),"hex"),h=t.createHmac("SHA"+(a<<1),s.slice(0,u));if(h.update(n).update(o).update(r).update(c),!t.timingSafeEqual(h.digest().slice(0,u),i))throw new Error("Authentication of encrypted data failed");let d=s.slice(u),f=t.createDecipheriv(`AES-${a}-CBC`,d,o);return e.concat([f.update(r),f.final()])}function f(r,i){if(i instanceof e)i=i.toString();else if("string"!=typeof i)throw new TypeError("Key must be a buffer or a string");if(!i.includes("-----BEGIN")||!i.includes("KEY-----")&&!i.includes("CERTIFICATE-----"))throw new TypeError("Key must be a PEM formatted RSA public key");let s={key:i,padding:t.constants.RSA_PKCS1_OAEP_PADDING};return n(t.publicEncrypt(s,r))}function p(r,n){if(n instanceof e&&(n=n.toString()),"string"!=typeof n||!n.includes("-----BEGIN")||!n.includes("KEY-----"))throw new TypeError("Key must be a PEM formatted RSA private key");let i={key:n,padding:t.constants.RSA_PKCS1_OAEP_PADDING};return t.privateDecrypt(i,r)}function m(r,i,s){let o=s>>3;if("string"==typeof i)i=e.from(i,"base64");else if(!(i instanceof e))throw new TypeError("Key must be a buffer or a base64-encoded string");if(i.length<o)throw new TypeError(`Key length must be at least ${o} bytes`);i=i.slice(0,o);let a=[];for(let e=0;e<r.length;e+=8)a.push(r.slice(e,e+8));let u=e.alloc(16),l=e.from("A6A6A6A6A6A6A6A6","hex"),c=1;for(let n=0;n<6;n++)for(let r=0;r<a.length;r++){let n=t.createCipheriv("AES"+s,i,u),o=("000000000000000"+c.toString(16)).slice(-16),h=n.update(e.concat([l,a[r]]));l=e.from(o,"hex");for(let e=0;e<8;e++)l[e]^=h[e];a[r]=h.slice(8,16),c++}return n(e.concat([l].concat(a)))}function y(r,n,i){let s=i>>3;if("string"==typeof n)n=e.from(n,"base64");else if(!(n instanceof e))throw new TypeError("Key must be a buffer or a base64 string");if(n.length<s)throw new TypeError(`Key must be at least ${s} bytes`);n=n.slice(0,s);let o=r.slice(0,8),a=[];for(let e=8;e<r.length;e+=8)a.push(r.slice(e,e+8));let u=e.alloc(16),l=6*a.length;for(let c=5;c>=0;c--)for(let r=a.length-1;r>=0;r--){let s=("000000000000000"+l.toString(16)).slice(-16);s=e.from(s,"hex");for(let e=0;e<8;e++)o[e]^=s[e];let c=t.createDecipheriv("AES"+i,n,u).update(e.concat([o,a[r],u]));o=c.slice(0,8),a[r]=c.slice(8,16),l--}if(!o.equals(e.from("A6A6A6A6A6A6A6A6","hex")))throw new Error("Key unwrapping failed");return e.concat(a)}dh.generate=(i,u,l,...c)=>{let h,d,f={alg:i,enc:u};if(c[0].constructor!==Object)h=c[0],d="function"==typeof c[1]?c[1]:void 0;else if(f.kid=c[1],h=c[0][c[1]],d="function"==typeof c[2]?c[2]:void 0,!h)return r(new TypeError("Invalid key identifier"),null,d);let p="string"==typeof i?i.match(s):null;if(!p||p[2]&&+p[2]!=2*p[4]){let e=new TypeError("Unrecognized key management algorithm");return r(e,null,d)}let m,y="string"==typeof u?u.match(o):null;if(!y||y[3]&&+y[3]!=2*y[1]){let e=new TypeError("Unrecognized content encryption algorithm");return r(e,null,d)}if(p[2]){let r=t.randomBytes(16);if(f.p2c=1024,f.p2s=n(r),m=e.concat([e.from(i),e.from([0]),r]),!d){let e=Number(p[2]);h=t.pbkdf2Sync(h,m,f.p2c,e>>4,"sha"+e)}}let g=n(e.from(JSON.stringify(f)));if(!p[2]||!d)return a(p,y,g,l,h,d);let v=Number(p[2]);t.pbkdf2(h,m,f.p2c,v>>4,"sha"+v,(e,t)=>{if(e)return d(e);a(p,y,g,l,t,d)})},dh.verify=(n,i,a)=>{if(n.error)return r(null,n,a);if("string"!=typeof n.header.alg)return n.error={message:"Missing or invalid alg claim in header"},r(null,n,a);if("string"!=typeof n.header.enc)return n.error={message:"Missing or invalid enc claim in header"},r(null,n,a);let l=n.header.alg.match(s);if(!l||l[2]&&+l[2]!=2*l[4])return n.error={message:"Unrecognized key management algorithm "+n.header.alg},r(null,n,a);if(n.algList&&!n.algList.includes(n.header.alg))return n.error={message:"Unwanted key management algorithm "+n.header.alg},r(null,n,a);let c,h,d=n.header.enc.match(o);if(!d||d[3]&&+d[3]!=2*d[1])return n.error={message:"Unrecognized content encryption algorithm "+n.header.enc},r(null,n,a);if(n.encList&&!n.encList.includes(n.header.enc))return n.error={message:"Unwanted content encryption algorithm "+n.header.enc},r(null,n,a);if(l[2]){if(h=n.header.p2c,!Number.isInteger(h)||h<1||h>16384)return n.error={message:"Missing or invalid p2c claim in header"},r(null,n,a);if(!a&&h>1024)return n.error={message:"p2c value too large for synchronous mode"},r(null,n,a);if("string"!=typeof n.header.p2s)return n.error={message:"Missing or invalid p2s claim in header"},r(null,n,a);let s=e.from(n.header.p2s,"base64"),o=n.header.alg;if(c=e.concat([e.from(o),e.from([0]),s]),!a){let e=Number(l[2]);i=t.pbkdf2Sync(i,c,h,e>>4,"sha"+e)}}if(!l[2]||!a)return u(n,l,d,i,a);let f=Number(l[2]);t.pbkdf2(i,c,h,f>>4,"sha"+f,(e,t)=>{if(e)return a(e);u(n,l,d,t,a)})}}).call(this,require("buffer").Buffer);var fh={};(function(e){const{responder:t}=lh;function r(t){if(this.parts="string"==typeof t?t.split("."):[],3===this.parts.length)this.type="JWS";else{if(5!==this.parts.length)return void(this.error={message:"Invalid token"});this.type="JWE"}try{this.header=JSON.parse(e.from(this.parts[0],"base64"))}catch(error){return void(this.error={message:"Non parsable header. "+error.message})}if("JWS"===this.type)try{this.payload=JSON.parse(e.from(this.parts[1],"base64"))}catch(error){this.error={message:"Non parsable payload. "+error.message}}}fh.generate=(e,...t)=>{if(t[0].constructor===Object)return hh.generate(e,...t);if(t[1].constructor===Object)return dh.generate(e,...t);let r=t.length-1;if(!(r>1&&r<5&&"function"==typeof t[r]))throw error;t[r](error)},fh.parse=e=>new r(e),r.prototype.setAlgorithmList=function(e,t){return"string"==typeof e?this.algList=[e]:Array.isArray(e)&&(this.algList=e),"string"==typeof t?this.encList=[t]:Array.isArray(t)&&(this.encList=t),this},r.prototype.setTokenLifetime=function(e){return Number.isInteger(e)&&e>0&&(this.lifetime=e),this},r.prototype.setAudience=function(e){return"string"==typeof e?this.audList=[e]:Array.isArray(e)&&(this.audList=e),this},r.prototype.setIssuer=function(e){return"string"==typeof e?this.issList=[e]:Array.isArray(e)&&(this.issList=e),this},r.prototype.verify=function(e,r){if(r="function"==typeof r?r:void 0,this.error)return t(null,this,r);let n;if(e.constructor!==Object)n=e;else{if(void 0===this.header.kid)return this.error={message:"Missing kid claim in header"},t(null,this,r);if(void 0===e[this.header.kid])return this.error={message:"Key with id not found",kid:this.header.kid},t(null,this,r);n=e[this.header.kid]}return("JWS"===this.type?hh.verify:dh.verify)(this,n,r)}}).call(this,require("buffer").Buffer);var ph={};(function(e){const t=e.env.PERSISTR_SECRET||"";ph={encode:async function(e,r="Bearer"){return new Promise((function(n,i){fh.generate("PBES2-HS512+A256KW","A256GCM",e,t,(e,t)=>{e?i(new _o.TokenGenerationFailed({error:e})):t.error?i(new _o.TokenGenerationFailed({error:t.error})):n([r,t].join(" ").trim())})}))},decode:function(e,r="Bearer"){return new Promise((function(n,i){try{e||i(new _o.InvalidAuthToken({auth:e}));const s=e.split(" ");if(s[0]!==r&&!s[1])return void i(new _o.InvalidAuthToken({auth:e}));const o=s[1];fh.parse(o).setAlgorithmList("PBES2-HS512+A256KW","A256GCM").setIssuer(["api.persistr.com"]).verify(t,(t,s)=>{if(t)i(new _o.InvalidAuthToken({auth:e,error:t}));else if(s.error)i(new _o.InvalidAuthToken({auth:e,error:s.error}));else if("Bearer"===r){if(!ah.is(s).valid("auth/bearer"))return void i(new _o.InvalidBearerToken({token:s}));n({id:s.payload.id,username:s.payload.sub,name:s.payload.name,dbs:s.payload.dbs||[]})}else if("Apikey"===r){if(!ah.is(s).valid("auth/apikey"))return void i(new _o.InvalidApiKeyToken({token:s}));n({user:s.payload.user.toString("utf8"),ts:s.payload.ts})}else i(new _o.UnknownTokenScheme({scheme:r}))})}catch(error){i(new _o.InvalidAuthToken({auth:e}))}}))}}}).call(this,require("_process"));var mh={};function yh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gh(e,t,r){return t&&yh(e.prototype,t),r&&yh(e,r),e}function vh(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function bh(e){return(bh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _h(e,t){return(_h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(CT){return!1}}function Eh(e,t,r){return(Eh=wh()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_h(i,r.prototype),i}).apply(null,arguments)}function Ch(e){var t="function"==typeof Map?new Map:void 0;return(Ch=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Eh(e,arguments,bh(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_h(n,e)})(e)}function Th(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nh(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return Th(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Th(e,void 0):void 0}}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}Object.defineProperty(mh,"__esModule",{value:!0});var kh=function(e){function t(){return e.apply(this,arguments)||this}return vh(t,e),t}(Ch(Error)),Oh=function(e){function t(t){return e.call(this,"Invalid DateTime: "+t.toMessage())||this}return vh(t,e),t}(kh),Sh=function(e){function t(t){return e.call(this,"Invalid Interval: "+t.toMessage())||this}return vh(t,e),t}(kh),xh=function(e){function t(t){return e.call(this,"Invalid Duration: "+t.toMessage())||this}return vh(t,e),t}(kh),$h=function(e){function t(){return e.apply(this,arguments)||this}return vh(t,e),t}(kh),Ah=function(e){function t(t){return e.call(this,"Invalid unit "+t)||this}return vh(t,e),t}(kh),jh=function(e){function t(){return e.apply(this,arguments)||this}return vh(t,e),t}(kh),Ih=function(e){function t(){return e.call(this,"Zone is an abstract class")||this}return vh(t,e),t}(kh),Rh="numeric",Ph={year:Rh,month:Rh,day:Rh},Mh={year:Rh,month:"short",day:Rh},Lh={year:Rh,month:"short",day:Rh,weekday:"short"},qh={year:Rh,month:"long",day:Rh},Dh={year:Rh,month:"long",day:Rh,weekday:"long"},Fh={hour:Rh,minute:Rh},Uh={hour:Rh,minute:Rh,second:Rh},Vh={hour:Rh,minute:Rh,second:Rh,timeZoneName:"short"},Bh={hour:Rh,minute:Rh,second:Rh,timeZoneName:"long"},zh={hour:Rh,minute:Rh,hour12:!1},Hh={hour:Rh,minute:Rh,second:Rh,hour12:!1},Wh={hour:Rh,minute:Rh,second:Rh,hour12:!1,timeZoneName:"short"},Qh={hour:Rh,minute:Rh,second:Rh,hour12:!1,timeZoneName:"long"},Jh={year:Rh,month:Rh,day:Rh,hour:Rh,minute:Rh},Gh={year:Rh,month:Rh,day:Rh,hour:Rh,minute:Rh,second:Rh},Kh={year:Rh,month:"short",day:Rh,hour:Rh,minute:Rh},Zh={year:Rh,month:"short",day:Rh,hour:Rh,minute:Rh,second:Rh},Yh={year:Rh,month:"short",day:Rh,weekday:"short",hour:Rh,minute:Rh},Xh={year:Rh,month:"long",day:Rh,hour:Rh,minute:Rh,timeZoneName:"short"},ed={year:Rh,month:"long",day:Rh,hour:Rh,minute:Rh,second:Rh,timeZoneName:"short"},td={year:Rh,month:"long",day:Rh,weekday:"long",hour:Rh,minute:Rh,timeZoneName:"long"},rd={year:Rh,month:"long",day:Rh,weekday:"long",hour:Rh,minute:Rh,second:Rh,timeZoneName:"long"};function nd(e){return void 0===e}function id(e){return"number"==typeof e}function sd(e){return"number"==typeof e&&e%1==0}function od(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(CT){return!1}}function ad(){return!nd(Intl.DateTimeFormat.prototype.formatToParts)}function ud(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(CT){return!1}}function ld(e,t,r){if(0!==e.length)return e.reduce((function(e,n){var i=[t(n),n];return e&&r(e[0],i[0])===e[0]?e:i}),null)[1]}function cd(e,t){return t.reduce((function(t,r){return t[r]=e[r],t}),{})}function hd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function dd(e,t,r){return sd(e)&&e>=t&&e<=r}function fd(e,t){void 0===t&&(t=2);var r=e<0?"-":"",n=r?-1*e:e;return""+r+(n.toString().length<t?("0".repeat(t)+n).slice(-t):n.toString())}function pd(e){return nd(e)||null===e||""===e?void 0:parseInt(e,10)}function md(e){if(!nd(e)&&null!==e&&""!==e){var t=1e3*parseFloat("0."+e);return Math.floor(t)}}function yd(e,t,r){void 0===r&&(r=!1);var n=Math.pow(10,t);return(r?Math.trunc:Math.round)(e*n)/n}function gd(e){return e%4==0&&(e%100!=0||e%400==0)}function vd(e){return gd(e)?366:365}function bd(e,t){var r,n=(r=t-1)-12*Math.floor(r/12)+1;return 2===n?gd(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function _d(e){var t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t)).setUTCFullYear(t.getUTCFullYear()-1900),+t}function wd(e){var t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,r=e-1,n=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7;return 4===t||3===n?53:52}function Ed(e){return e>99?e:e>60?1900+e:2e3+e}function Cd(e,t,r,n){void 0===n&&(n=null);var i=new Date(e),s={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);var o=Object.assign({timeZoneName:t},s),a=od();if(a&&ad()){var u=new Intl.DateTimeFormat(r,o).formatToParts(i).find((function(e){return"timezonename"===e.type.toLowerCase()}));return u?u.value:null}if(a){var l=new Intl.DateTimeFormat(r,s).format(i);return new Intl.DateTimeFormat(r,o).format(i).substring(l.length).replace(/^[, \u200e]+/,"")}return null}function Td(e,t){var r=parseInt(e,10);Number.isNaN(r)&&(r=0);var n=parseInt(t,10)||0;return 60*r+(r<0||Object.is(r,-0)?-n:n)}function Nd(e){var t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new jh("Invalid unit value "+e);return t}function kd(e,t,r){var n={};for(var i in e)if(hd(e,i)){if(r.indexOf(i)>=0)continue;var s=e[i];if(null==s)continue;n[t(i)]=Nd(s)}return n}function Od(e,t){var r=Math.trunc(Math.abs(e/60)),n=Math.trunc(Math.abs(e%60)),i=e>=0?"+":"-";switch(t){case"short":return""+i+fd(r,2)+":"+fd(n,2);case"narrow":return""+i+r+(n>0?":"+n:"");case"techie":return""+i+fd(r,2)+fd(n,2);default:throw new RangeError("Value format "+t+" is out of range for property format")}}function Sd(e){return cd(e,["hour","minute","second","millisecond"])}var xd=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function $d(e){return JSON.stringify(e,Object.keys(e).sort())}var Ad=["January","February","March","April","May","June","July","August","September","October","November","December"],jd=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Id=["J","F","M","A","M","J","J","A","S","O","N","D"];function Rd(e){switch(e){case"narrow":return[].concat(Id);case"short":return[].concat(jd);case"long":return[].concat(Ad);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Pd=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Md=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Ld=["M","T","W","T","F","S","S"];function qd(e){switch(e){case"narrow":return[].concat(Ld);case"short":return[].concat(Md);case"long":return[].concat(Pd);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var Dd=["AM","PM"],Fd=["Before Christ","Anno Domini"],Ud=["BC","AD"],Vd=["B","A"];function Bd(e){switch(e){case"narrow":return[].concat(Vd);case"short":return[].concat(Ud);case"long":return[].concat(Fd);default:return null}}function zd(e,t){for(var r,n="",i=Nh(e);!(r=i()).done;){var s=r.value;s.literal?n+=s.val:n+=t(s.val)}return n}var Hd={D:Ph,DD:Mh,DDD:qh,DDDD:Dh,t:Fh,tt:Uh,ttt:Vh,tttt:Bh,T:zh,TT:Hh,TTT:Wh,TTTT:Qh,f:Jh,ff:Kh,fff:Xh,ffff:td,F:Gh,FF:Zh,FFF:ed,FFFF:rd},Wd=function(){function e(e,t){this.opts=t,this.loc=e,this.systemLoc=null}e.create=function(t,r){return void 0===r&&(r={}),new e(t,r)},e.parseFormat=function(e){for(var t=null,r="",n=!1,i=[],s=0;s<e.length;s++){var o=e.charAt(s);"'"===o?(r.length>0&&i.push({literal:n,val:r}),t=null,r="",n=!n):n||o===t?r+=o:(r.length>0&&i.push({literal:!1,val:r}),r=o,t=o)}return r.length>0&&i.push({literal:n,val:r}),i},e.macroTokenToFormatOpts=function(e){return Hd[e]};var t=e.prototype;return t.formatWithSystemDefault=function(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTime=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTimeParts=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).formatToParts()},t.resolvedOptions=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).resolvedOptions()},t.num=function(e,t){if(void 0===t&&(t=0),this.opts.forceSimple)return fd(e,t);var r=Object.assign({},this.opts);return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)},t.formatDateTimeFromString=function(t,r){var n=this,i="en"===this.loc.listingMode(),s=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&ad(),o=function(e,r){return n.loc.extract(t,e,r)},a=function(e){return t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):""},u=function(e,r){return i?function(e,t){return Rd(t)[e.month-1]}(t,e):o(r?{month:e}:{month:e,day:"numeric"},"month")},l=function(e,r){return i?function(e,t){return qd(t)[e.weekday-1]}(t,e):o(r?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},c=function(e){return i?function(e,t){return Bd(t)[e.year<0?0:1]}(t,e):o({era:e},"era")};return zd(e.parseFormat(r),(function(r){switch(r){case"S":return n.num(t.millisecond);case"u":case"SSS":return n.num(t.millisecond,3);case"s":return n.num(t.second);case"ss":return n.num(t.second,2);case"m":return n.num(t.minute);case"mm":return n.num(t.minute,2);case"h":return n.num(t.hour%12==0?12:t.hour%12);case"hh":return n.num(t.hour%12==0?12:t.hour%12,2);case"H":return n.num(t.hour);case"HH":return n.num(t.hour,2);case"Z":return a({format:"narrow",allowZ:n.opts.allowZ});case"ZZ":return a({format:"short",allowZ:n.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:n.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:n.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:n.loc.locale});case"z":return t.zoneName;case"a":return i?function(e){return Dd[e.hour<12?0:1]}(t):o({hour:"numeric",hour12:!0},"dayperiod");case"d":return s?o({day:"numeric"},"day"):n.num(t.day);case"dd":return s?o({day:"2-digit"},"day"):n.num(t.day,2);case"c":case"E":return n.num(t.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return s?o({month:"numeric",day:"numeric"},"month"):n.num(t.month);case"LL":return s?o({month:"2-digit",day:"numeric"},"month"):n.num(t.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return s?o({month:"numeric"},"month"):n.num(t.month);case"MM":return s?o({month:"2-digit"},"month"):n.num(t.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return s?o({year:"numeric"},"year"):n.num(t.year);case"yy":return s?o({year:"2-digit"},"year"):n.num(t.year.toString().slice(-2),2);case"yyyy":return s?o({year:"numeric"},"year"):n.num(t.year,4);case"yyyyyy":return s?o({year:"numeric"},"year"):n.num(t.year,6);case"G":return c("short");case"GG":return c("long");case"GGGGG":return c("narrow");case"kk":return n.num(t.weekYear.toString().slice(-2),2);case"kkkk":return n.num(t.weekYear,4);case"W":return n.num(t.weekNumber);case"WW":return n.num(t.weekNumber,2);case"o":return n.num(t.ordinal);case"ooo":return n.num(t.ordinal,3);case"q":return n.num(t.quarter);case"qq":return n.num(t.quarter,2);case"X":return n.num(Math.floor(t.ts/1e3));case"x":return n.num(t.ts);default:return function(r){var i=e.macroTokenToFormatOpts(r);return i?n.formatWithSystemDefault(t,i):r}(r)}}))},t.formatDurationFromString=function(t,r){var n,i=this,s=function(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},o=e.parseFormat(r),a=o.reduce((function(e,t){var r=t.literal,n=t.val;return r?e:e.concat(n)}),[]),u=t.shiftTo.apply(t,a.map(s).filter((function(e){return e})));return zd(o,(n=u,function(e){var t=s(e);return t?i.num(n.get(t),e.length):e}))},e}(),Qd=function(){function e(e,t){this.reason=e,this.explanation=t}return e.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},e}(),Jd=function(){function e(){}var t=e.prototype;return t.offsetName=function(e,t){throw new Ih},t.formatOffset=function(e,t){throw new Ih},t.offset=function(e){throw new Ih},t.equals=function(e){throw new Ih},gh(e,[{key:"type",get:function(){throw new Ih}},{key:"name",get:function(){throw new Ih}},{key:"universal",get:function(){throw new Ih}},{key:"isValid",get:function(){throw new Ih}}]),e}(),Gd=null,Kd=function(e){function t(){return e.apply(this,arguments)||this}vh(t,e);var r=t.prototype;return r.offsetName=function(e,t){return Cd(e,t.format,t.locale)},r.formatOffset=function(e,t){return Od(this.offset(e),t)},r.offset=function(e){return-new Date(e).getTimezoneOffset()},r.equals=function(e){return"local"===e.type},gh(t,[{key:"type",get:function(){return"local"}},{key:"name",get:function(){return od()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return null===Gd&&(Gd=new t),Gd}}]),t}(Jd),Zd=RegExp("^"+xd.source+"$"),Yd={},Xd={year:0,month:1,day:2,hour:3,minute:4,second:5},ef={},tf=function(e){function t(r){var n;return(n=e.call(this)||this).zoneName=r,n.valid=t.isValidZone(r),n}vh(t,e),t.create=function(e){return ef[e]||(ef[e]=new t(e)),ef[e]},t.resetCache=function(){ef={},Yd={}},t.isValidSpecifier=function(e){return!(!e||!e.match(Zd))},t.isValidZone=function(e){try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(CT){return!1}},t.parseGMTOffset=function(e){if(e){var t=e.match(/^Etc\/GMT(0|[+-]\d{1,2})$/i);if(t)return-60*parseInt(t[1])}return null};var r=t.prototype;return r.offsetName=function(e,t){return Cd(e,t.format,t.locale,this.name)},r.formatOffset=function(e,t){return Od(this.offset(e),t)},r.offset=function(e){var t=new Date(e);if(isNaN(t))return NaN;var r,n=(r=this.name,Yd[r]||(Yd[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),Yd[r]),i=n.formatToParts?function(e,t){for(var r=e.formatToParts(t),n=[],i=0;i<r.length;i++){var s=r[i],o=s.type,a=s.value,u=Xd[o];nd(u)||(n[u]=parseInt(a,10))}return n}(n,t):function(e,t){var r=e.format(t).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r),i=n[1],s=n[2];return[n[3],i,s,n[4],n[5],n[6]]}(n,t),s=i[0],o=i[1],a=i[2],u=i[3],l=+t,c=l%1e3;return(_d({year:s,month:o,day:a,hour:24===u?0:u,minute:i[4],second:i[5],millisecond:0})-(l-=c>=0?c:1e3+c))/6e4},r.equals=function(e){return"iana"===e.type&&e.name===this.name},gh(t,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),t}(Jd),rf=null,nf=function(e){function t(t){var r;return(r=e.call(this)||this).fixed=t,r}vh(t,e),t.instance=function(e){return 0===e?t.utcInstance:new t(e)},t.parseSpecifier=function(e){if(e){var r=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new t(Td(r[1],r[2]))}return null},gh(t,null,[{key:"utcInstance",get:function(){return null===rf&&(rf=new t(0)),rf}}]);var r=t.prototype;return r.offsetName=function(){return this.name},r.formatOffset=function(e,t){return Od(this.fixed,t)},r.offset=function(){return this.fixed},r.equals=function(e){return"fixed"===e.type&&e.fixed===this.fixed},gh(t,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+Od(this.fixed,"narrow")}},{key:"universal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}]),t}(Jd),sf=function(e){function t(t){var r;return(r=e.call(this)||this).zoneName=t,r}vh(t,e);var r=t.prototype;return r.offsetName=function(){return null},r.formatOffset=function(){return""},r.offset=function(){return NaN},r.equals=function(){return!1},gh(t,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),t}(Jd);function of(e,t){var r;if(nd(e)||null===e)return t;if(e instanceof Jd)return e;if("string"==typeof e){var n=e.toLowerCase();return"local"===n?t:"utc"===n||"gmt"===n?nf.utcInstance:null!=(r=tf.parseGMTOffset(e))?nf.instance(r):tf.isValidSpecifier(n)?tf.create(e):nf.parseSpecifier(n)||new sf(e)}return id(e)?nf.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new sf(e)}var af=function(){return Date.now()},uf=null,lf=null,cf=null,hf=null,df=!1,ff=function(){function e(){}return e.resetCaches=function(){Cf.resetCache(),tf.resetCache()},gh(e,null,[{key:"now",get:function(){return af},set:function(e){af=e}},{key:"defaultZoneName",get:function(){return e.defaultZone.name},set:function(e){uf=e?of(e):null}},{key:"defaultZone",get:function(){return uf||Kd.instance}},{key:"defaultLocale",get:function(){return lf},set:function(e){lf=e}},{key:"defaultNumberingSystem",get:function(){return cf},set:function(e){cf=e}},{key:"defaultOutputCalendar",get:function(){return hf},set:function(e){hf=e}},{key:"throwOnInvalid",get:function(){return df},set:function(e){df=e}}]),e}(),pf={};function mf(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=pf[r];return n||(n=new Intl.DateTimeFormat(e,t),pf[r]=n),n}var yf={},gf={};var vf=null;function bf(e,t,r,n,i){var s=e.listingMode(r);return"error"===s?null:"en"===s?n(t):i(t)}var _f=function(){function e(e,t,r){if(this.padTo=r.padTo||0,this.floor=r.floor||!1,!t&&od()){var n={useGrouping:!1};r.padTo>0&&(n.minimumIntegerDigits=r.padTo),this.inf=function(e,t){void 0===t&&(t={});var r=JSON.stringify([e,t]),n=yf[r];return n||(n=new Intl.NumberFormat(e,t),yf[r]=n),n}(e,n)}}return e.prototype.format=function(e){if(this.inf){var t=this.floor?Math.floor(e):e;return this.inf.format(t)}return fd(this.floor?Math.floor(e):yd(e,3),this.padTo)},e}(),wf=function(){function e(e,t,r){var n;if(this.opts=r,this.hasIntl=od(),e.zone.universal&&this.hasIntl){var i=e.offset/60*-1,s=i>=0?"Etc/GMT+"+i:"Etc/GMT"+i,o=tf.isValidZone(s);0!==e.offset&&o?(n=s,this.dt=e):(n="UTC",r.timeZoneName?this.dt=e:this.dt=0===e.offset?e:ym.fromMillis(e.ts+60*e.offset*1e3))}else"local"===e.zone.type?this.dt=e:(this.dt=e,n=e.zone.name);if(this.hasIntl){var a=Object.assign({},this.opts);n&&(a.timeZone=n),this.dtf=mf(t,a)}}var t=e.prototype;return t.format=function(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());var e=function(e){switch($d(cd(e,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case $d(Ph):return"M/d/yyyy";case $d(Mh):return"LLL d, yyyy";case $d(Lh):return"EEE, LLL d, yyyy";case $d(qh):return"LLLL d, yyyy";case $d(Dh):return"EEEE, LLLL d, yyyy";case $d(Fh):return"h:mm a";case $d(Uh):return"h:mm:ss a";case $d(Vh):case $d(Bh):return"h:mm a";case $d(zh):return"HH:mm";case $d(Hh):return"HH:mm:ss";case $d(Wh):case $d(Qh):return"HH:mm";case $d(Jh):return"M/d/yyyy, h:mm a";case $d(Kh):return"LLL d, yyyy, h:mm a";case $d(Xh):return"LLLL d, yyyy, h:mm a";case $d(td):return"EEEE, LLLL d, yyyy, h:mm a";case $d(Gh):return"M/d/yyyy, h:mm:ss a";case $d(Zh):return"LLL d, yyyy, h:mm:ss a";case $d(Yh):return"EEE, d LLL yyyy, h:mm a";case $d(ed):return"LLLL d, yyyy, h:mm:ss a";case $d(rd):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return"EEEE, LLLL d, yyyy, h:mm a"}}(this.opts),t=Cf.create("en-US");return Wd.create(t).formatDateTimeFromString(this.dt,e)},t.formatToParts=function(){return this.hasIntl&&ad()?this.dtf.formatToParts(this.dt.toJSDate()):[]},t.resolvedOptions=function(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}},e}(),Ef=function(){function e(e,t,r){this.opts=Object.assign({style:"long"},r),!t&&ud()&&(this.rtf=function(e,t){void 0===t&&(t={});var r=t,n=(r.base,function(e,t){if(null==e)return{};var r,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(r,["base"])),i=JSON.stringify([e,n]),s=gf[i];return s||(s=new Intl.RelativeTimeFormat(e,t),gf[i]=s),s}(e,r))}var t=e.prototype;return t.format=function(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,r,n){void 0===r&&(r="always"),void 0===n&&(n=!1);var i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===r&&s){var o="days"===e;switch(t){case 1:return o?"tomorrow":"next "+i[e][0];case-1:return o?"yesterday":"last "+i[e][0];case 0:return o?"today":"this "+i[e][0]}}var a=Object.is(t,-0)||t<0,u=Math.abs(t),l=1===u,c=i[e],h=n?l?c[1]:c[2]||c[1]:l?i[e][0]:e;return a?u+" "+h+" ago":"in "+u+" "+h}(t,e,this.opts.numeric,"long"!==this.opts.style)},t.formatToParts=function(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]},e}(),Cf=function(){function e(e,t,r,n){var i=function(e){var t=e.indexOf("-u-");if(-1===t)return[e];var r,n=e.substring(0,t);try{r=mf(e).resolvedOptions()}catch(CT){r=mf(n).resolvedOptions()}var i=r;return[n,i.numberingSystem,i.calendar]}(e),s=i[0],o=i[1],a=i[2];this.locale=s,this.numberingSystem=t||o||null,this.outputCalendar=r||a||null,this.intl=function(e,t,r){return od()?r||t?(e+="-u",r&&(e+="-ca-"+r),t&&(e+="-nu-"+t),e):e:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}e.fromOpts=function(t){return e.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)},e.create=function(t,r,n,i){void 0===i&&(i=!1);var s=t||ff.defaultLocale;return new e(s||(i?"en-US":function(){if(vf)return vf;if(od()){var e=(new Intl.DateTimeFormat).resolvedOptions().locale;return vf=e&&"und"!==e?e:"en-US"}return vf="en-US"}()),r||ff.defaultNumberingSystem,n||ff.defaultOutputCalendar,s)},e.resetCache=function(){vf=null,pf={},yf={},gf={}},e.fromObject=function(t){var r=void 0===t?{}:t,n=r.locale,i=r.numberingSystem,s=r.outputCalendar;return e.create(n,i,s)};var t=e.prototype;return t.listingMode=function(e){void 0===e&&(e=!0);var t=od()&&ad(),r=this.isEnglish(),n=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return t||r&&n||e?!t||r&&n?"en":"intl":"error"},t.clone=function(t){return t&&0!==Object.getOwnPropertyNames(t).length?e.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this},t.redefaultToEN=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!0}))},t.redefaultToSystem=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!1}))},t.months=function(e,t,r){var n=this;return void 0===t&&(t=!1),void 0===r&&(r=!0),bf(this,e,r,Rd,(function(){var r=t?{month:e,day:"numeric"}:{month:e},i=t?"format":"standalone";return n.monthsCache[i][e]||(n.monthsCache[i][e]=function(e){for(var t=[],r=1;r<=12;r++){var n=ym.utc(2016,r,1);t.push(e(n))}return t}((function(e){return n.extract(e,r,"month")}))),n.monthsCache[i][e]}))},t.weekdays=function(e,t,r){var n=this;return void 0===t&&(t=!1),void 0===r&&(r=!0),bf(this,e,r,qd,(function(){var r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=t?"format":"standalone";return n.weekdaysCache[i][e]||(n.weekdaysCache[i][e]=function(e){for(var t=[],r=1;r<=7;r++){var n=ym.utc(2016,11,13+r);t.push(e(n))}return t}((function(e){return n.extract(e,r,"weekday")}))),n.weekdaysCache[i][e]}))},t.meridiems=function(e){var t=this;return void 0===e&&(e=!0),bf(this,void 0,e,(function(){return Dd}),(function(){if(!t.meridiemCache){var e={hour:"numeric",hour12:!0};t.meridiemCache=[ym.utc(2016,11,13,9),ym.utc(2016,11,13,19)].map((function(r){return t.extract(r,e,"dayperiod")}))}return t.meridiemCache}))},t.eras=function(e,t){var r=this;return void 0===t&&(t=!0),bf(this,e,t,Bd,(function(){var t={era:e};return r.eraCache[e]||(r.eraCache[e]=[ym.utc(-40,1,1),ym.utc(2017,1,1)].map((function(e){return r.extract(e,t,"era")}))),r.eraCache[e]}))},t.extract=function(e,t,r){var n=this.dtFormatter(e,t).formatToParts().find((function(e){return e.type.toLowerCase()===r}));return n?n.value:null},t.numberFormatter=function(e){return void 0===e&&(e={}),new _f(this.intl,e.forceSimple||this.fastNumbers,e)},t.dtFormatter=function(e,t){return void 0===t&&(t={}),new wf(e,this.intl,t)},t.relFormatter=function(e){return void 0===e&&(e={}),new Ef(this.intl,this.isEnglish(),e)},t.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||od()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},t.equals=function(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar},gh(e,[{key:"fastNumbers",get:function(){return null==this.fastNumbersCached&&(this.fastNumbersCached=(!this.numberingSystem||"latn"===this.numberingSystem)&&("latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||od()&&"latn"===new Intl.DateTimeFormat(this.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),e}();function Tf(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return e+t.source}),"");return RegExp("^"+n+"$")}function Nf(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return t.reduce((function(t,r){var n=t[0],i=t[1],s=t[2],o=r(e,s),a=o[0],u=o[1],l=o[2];return[Object.assign(n,a),i||u,l]}),[{},null,1]).slice(0,2)}}function kf(e){if(null==e)return[null,null];for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,s=r;i<s.length;i++){var o=s[i],a=o[0],u=o[1],l=a.exec(e);if(l)return u(l)}return[null,null]}function Of(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r){var n,i={};for(n=0;n<t.length;n++)i[t[n]]=pd(e[r+n]);return[i,null,r+n]}}var Sf=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,xf=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,$f=RegExp(""+xf.source+Sf.source+"?"),Af=RegExp("(?:T"+$f.source+")?"),jf=Of("weekYear","weekNumber","weekDay"),If=Of("year","ordinal"),Rf=RegExp(xf.source+" ?(?:"+Sf.source+"|("+xd.source+"))?"),Pf=RegExp("(?: "+Rf.source+")?");function Mf(e,t,r){var n=e[t];return nd(n)?r:pd(n)}function Lf(e,t){return[{year:Mf(e,t),month:Mf(e,t+1,1),day:Mf(e,t+2,1)},null,t+3]}function qf(e,t){return[{hours:Mf(e,t,0),minutes:Mf(e,t+1,0),seconds:Mf(e,t+2,0),milliseconds:md(e[t+3])},null,t+4]}function Df(e,t){var r=!e[t]&&!e[t+1],n=Td(e[t+1],e[t+2]);return[{},r?null:nf.instance(n),t+3]}function Ff(e,t){return[{},e[t]?tf.create(e[t]):null,t+1]}var Uf=RegExp("^T?"+xf.source+"$"),Vf=/^-?P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,9}))?S)?)?)$/;function Bf(e){var t=e[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],l=e[8],c="-"===t[0],h=u&&"-"===u[0],d=function(e,t){return void 0===t&&(t=!1),void 0!==e&&(t||e&&c)?-e:e};return[{years:d(pd(r)),months:d(pd(n)),weeks:d(pd(i)),days:d(pd(s)),hours:d(pd(o)),minutes:d(pd(a)),seconds:d(pd(u),"-0"===u),milliseconds:d(md(l),h)}]}var zf={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Hf(e,t,r,n,i,s,o){var a={year:2===t.length?Ed(pd(t)):pd(t),month:jd.indexOf(r)+1,day:pd(n),hour:pd(i),minute:pd(s)};return o&&(a.second=pd(o)),e&&(a.weekday=e.length>3?Pd.indexOf(e)+1:Md.indexOf(e)+1),a}var Wf=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Qf(e){var t,r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],l=e[8],c=e[9],h=e[10],d=e[11],f=Hf(r,s,i,n,o,a,u);return t=l?zf[l]:c?0:Td(h,d),[f,new nf(t)]}var Jf=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Gf=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Kf=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Zf(e){var t=e[1],r=e[2],n=e[3];return[Hf(t,e[4],n,r,e[5],e[6],e[7]),nf.utcInstance]}function Yf(e){var t=e[1],r=e[2],n=e[3],i=e[4],s=e[5],o=e[6];return[Hf(t,e[7],r,n,i,s,o),nf.utcInstance]}var Xf=Tf(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Af),ep=Tf(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Af),tp=Tf(/(\d{4})-?(\d{3})/,Af),rp=Tf($f),np=Nf(Lf,qf,Df),ip=Nf(jf,qf,Df),sp=Nf(If,qf,Df),op=Nf(qf,Df),ap=Nf(qf),up=Tf(/(\d{4})-(\d\d)-(\d\d)/,Pf),lp=Tf(Rf),cp=Nf(Lf,qf,Df,Ff),hp=Nf(qf,Df,Ff),dp={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},fp=Object.assign({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},dp),pp=Object.assign({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},dp),mp=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],yp=mp.slice(0).reverse();function gp(e,t,r){void 0===r&&(r=!1);var n={values:r?t.values:Object.assign({},e.values,t.values||{}),loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy};return new bp(n)}function vp(e,t,r,n,i){var s,o=e[i][r],a=t[r]/o,u=Math.sign(a)!==Math.sign(n[i])&&0!==n[i]&&Math.abs(a)<=1?(s=a)<0?Math.floor(s):Math.ceil(s):Math.trunc(a);n[i]+=u,t[r]-=u*o}var bp=function(){function e(e){var t="longterm"===e.conversionAccuracy||!1;this.values=e.values,this.loc=e.loc||Cf.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?pp:fp,this.isLuxonDuration=!0}e.fromMillis=function(t,r){return e.fromObject(Object.assign({milliseconds:t},r))},e.fromObject=function(t){if(null==t||"object"!=typeof t)throw new jh("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new e({values:kd(t,e.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:Cf.fromObject(t),conversionAccuracy:t.conversionAccuracy})},e.fromISO=function(t,r){var n=function(e){return kf(e,[Vf,Bf])}(t)[0];if(n){var i=Object.assign(n,r);return e.fromObject(i)}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.fromISOTime=function(t,r){var n=function(e){return kf(e,[Uf,ap])}(t)[0];if(n){var i=Object.assign(n,r);return e.fromObject(i)}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new jh("need to specify a reason the Duration is invalid");var n=t instanceof Qd?t:new Qd(t,r);if(ff.throwOnInvalid)throw new xh(n);return new e({invalid:n})},e.normalizeUnit=function(e){var t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new Ah(e);return t},e.isDuration=function(e){return e&&e.isLuxonDuration||!1};var t=e.prototype;return t.toFormat=function(e,t){void 0===t&&(t={});var r=Object.assign({},t,{floor:!1!==t.round&&!1!==t.floor});return this.isValid?Wd.create(this.loc,r).formatDurationFromString(this,e):"Invalid Duration"},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.values);return e.includeConfig&&(t.conversionAccuracy=this.conversionAccuracy,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toISO=function(){if(!this.isValid)return null;var e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=yd(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e},t.toISOTime=function(e){if(void 0===e&&(e={}),!this.isValid)return null;var t=this.toMillis();if(t<0||t>=864e5)return null;e=Object.assign({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},e);var r=this.shiftTo("hours","minutes","seconds","milliseconds"),n="basic"===e.format?"hhmm":"hh:mm";e.suppressSeconds&&0===r.seconds&&0===r.milliseconds||(n+="basic"===e.format?"ss":":ss",e.suppressMilliseconds&&0===r.milliseconds||(n+=".SSS"));var i=r.toFormat(n);return e.includePrefix&&(i="T"+i),i},t.toJSON=function(){return this.toISO()},t.toString=function(){return this.toISO()},t.toMillis=function(){return this.as("milliseconds")},t.valueOf=function(){return this.toMillis()},t.plus=function(e){if(!this.isValid)return this;for(var t,r=_p(e),n={},i=Nh(mp);!(t=i()).done;){var s=t.value;(hd(r.values,s)||hd(this.values,s))&&(n[s]=r.get(s)+this.get(s))}return gp(this,{values:n},!0)},t.minus=function(e){if(!this.isValid)return this;var t=_p(e);return this.plus(t.negate())},t.mapUnits=function(e){if(!this.isValid)return this;for(var t={},r=0,n=Object.keys(this.values);r<n.length;r++){var i=n[r];t[i]=Nd(e(this.values[i],i))}return gp(this,{values:t},!0)},t.get=function(t){return this[e.normalizeUnit(t)]},t.set=function(t){return this.isValid?gp(this,{values:Object.assign(this.values,kd(t,e.normalizeUnit,[]))}):this},t.reconfigure=function(e){var t=void 0===e?{}:e,r=t.locale,n=t.numberingSystem,i=t.conversionAccuracy,s={loc:this.loc.clone({locale:r,numberingSystem:n})};return i&&(s.conversionAccuracy=i),gp(this,s)},t.as=function(e){return this.isValid?this.shiftTo(e).get(e):NaN},t.normalize=function(){if(!this.isValid)return this;var e=this.toObject();return function(e,t){yp.reduce((function(r,n){return nd(t[n])?r:(r&&vp(e,t,r,t,n),n)}),null)}(this.matrix,e),gp(this,{values:e},!0)},t.shiftTo=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!this.isValid)return this;if(0===r.length)return this;r=r.map((function(t){return e.normalizeUnit(t)}));for(var i,s,o={},a={},u=this.toObject(),l=Nh(mp);!(s=l()).done;){var c=s.value;if(r.indexOf(c)>=0){i=c;var h=0;for(var d in a)h+=this.matrix[d][c]*a[d],a[d]=0;id(u[c])&&(h+=u[c]);var f=Math.trunc(h);for(var p in o[c]=f,a[c]=h-f,u)mp.indexOf(p)>mp.indexOf(c)&&vp(this.matrix,u,p,o,c)}else id(u[c])&&(a[c]=u[c])}for(var m in a)0!==a[m]&&(o[i]+=m===i?a[m]:a[m]/this.matrix[i][m]);return gp(this,{values:o},!0).normalize()},t.negate=function(){if(!this.isValid)return this;for(var e={},t=0,r=Object.keys(this.values);t<r.length;t++){var n=r[t];e[n]=-this.values[n]}return gp(this,{values:e},!0)},t.equals=function(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(var t,r=Nh(mp);!(t=r()).done;){var n=t.value;if(i=this.values[n],s=e.values[n],!(void 0===i||0===i?void 0===s||0===s:i===s))return!1}var i,s;return!0},gh(e,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}();function _p(e){if(id(e))return bp.fromMillis(e);if(bp.isDuration(e))return e;if("object"==typeof e)return bp.fromObject(e);throw new jh("Unknown duration argument "+e+" of type "+typeof e)}var wp=function(){function e(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new jh("need to specify a reason the Interval is invalid");var n=t instanceof Qd?t:new Qd(t,r);if(ff.throwOnInvalid)throw new Sh(n);return new e({invalid:n})},e.fromDateTimes=function(t,r){var n=gm(t),i=gm(r),s=function(e,t){return e&&e.isValid?t&&t.isValid?t<e?wp.invalid("end before start","The end of an interval must be after its start, but you had start="+e.toISO()+" and end="+t.toISO()):null:wp.invalid("missing or invalid end"):wp.invalid("missing or invalid start")}(n,i);return null==s?new e({start:n,end:i}):s},e.after=function(t,r){var n=_p(r),i=gm(t);return e.fromDateTimes(i,i.plus(n))},e.before=function(t,r){var n=_p(r),i=gm(t);return e.fromDateTimes(i.minus(n),i)},e.fromISO=function(t,r){var n=(t||"").split("/",2),i=n[0],s=n[1];if(i&&s){var o,a,u,l;try{a=(o=ym.fromISO(i,r)).isValid}catch(s){a=!1}try{l=(u=ym.fromISO(s,r)).isValid}catch(s){l=!1}if(a&&l)return e.fromDateTimes(o,u);if(a){var c=bp.fromISO(s,r);if(c.isValid)return e.after(o,c)}else if(l){var h=bp.fromISO(i,r);if(h.isValid)return e.before(u,h)}}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.isInterval=function(e){return e&&e.isLuxonInterval||!1};var t=e.prototype;return t.length=function(e){return void 0===e&&(e="milliseconds"),this.isValid?this.toDuration.apply(this,[e]).get(e):NaN},t.count=function(e){if(void 0===e&&(e="milliseconds"),!this.isValid)return NaN;var t=this.start.startOf(e),r=this.end.startOf(e);return Math.floor(r.diff(t,e).get(e))+1},t.hasSame=function(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))},t.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},t.isAfter=function(e){return!!this.isValid&&this.s>e},t.isBefore=function(e){return!!this.isValid&&this.e<=e},t.contains=function(e){return!!this.isValid&&this.s<=e&&this.e>e},t.set=function(t){var r=void 0===t?{}:t,n=r.start,i=r.end;return this.isValid?e.fromDateTimes(n||this.s,i||this.e):this},t.splitAt=function(){var t=this;if(!this.isValid)return[];for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];for(var s=n.map(gm).filter((function(e){return t.contains(e)})).sort(),o=[],a=this.s,u=0;a<this.e;){var l=s[u]||this.e,c=+l>+this.e?this.e:l;o.push(e.fromDateTimes(a,c)),a=c,u+=1}return o},t.splitBy=function(t){var r=_p(t);if(!this.isValid||!r.isValid||0===r.as("milliseconds"))return[];for(var n,i=this.s,s=1,o=[];i<this.e;){var a=this.start.plus(r.mapUnits((function(e){return e*s})));n=+a>+this.e?this.e:a,o.push(e.fromDateTimes(i,n)),i=n,s+=1}return o},t.divideEqually=function(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]},t.overlaps=function(e){return this.e>e.s&&this.s<e.e},t.abutsStart=function(e){return!!this.isValid&&+this.e==+e.s},t.abutsEnd=function(e){return!!this.isValid&&+e.e==+this.s},t.engulfs=function(e){return!!this.isValid&&this.s<=e.s&&this.e>=e.e},t.equals=function(e){return!(!this.isValid||!e.isValid)&&this.s.equals(e.s)&&this.e.equals(e.e)},t.intersection=function(t){if(!this.isValid)return this;var r=this.s>t.s?this.s:t.s,n=this.e<t.e?this.e:t.e;return r>=n?null:e.fromDateTimes(r,n)},t.union=function(t){if(!this.isValid)return this;var r=this.s<t.s?this.s:t.s,n=this.e>t.e?this.e:t.e;return e.fromDateTimes(r,n)},e.merge=function(e){var t=e.sort((function(e,t){return e.s-t.s})).reduce((function(e,t){var r=e[0],n=e[1];return n?n.overlaps(t)||n.abutsStart(t)?[r,n.union(t)]:[r.concat([n]),t]:[r,t]}),[[],null]),r=t[0],n=t[1];return n&&r.push(n),r},e.xor=function(t){for(var r,n,i=null,s=0,o=[],a=t.map((function(e){return[{time:e.s,type:"s"},{time:e.e,type:"e"}]})),u=Nh((r=Array.prototype).concat.apply(r,a).sort((function(e,t){return e.time-t.time})));!(n=u()).done;){var l=n.value;1===(s+="s"===l.type?1:-1)?i=l.time:(i&&+i!=+l.time&&o.push(e.fromDateTimes(i,l.time)),i=null)}return e.merge(o)},t.difference=function(){for(var t=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.xor([this].concat(n)).map((function(e){return t.intersection(e)})).filter((function(e){return e&&!e.isEmpty()}))},t.toString=function(){return this.isValid?"["+this.s.toISO()+" \u2013 "+this.e.toISO()+")":"Invalid Interval"},t.toISO=function(e){return this.isValid?this.s.toISO(e)+"/"+this.e.toISO(e):"Invalid Interval"},t.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():"Invalid Interval"},t.toISOTime=function(e){return this.isValid?this.s.toISOTime(e)+"/"+this.e.toISOTime(e):"Invalid Interval"},t.toFormat=function(e,t){var r=(void 0===t?{}:t).separator,n=void 0===r?" \u2013 ":r;return this.isValid?""+this.s.toFormat(e)+n+this.e.toFormat(e):"Invalid Interval"},t.toDuration=function(e,t){return this.isValid?this.e.diff(this.s,e,t):bp.invalid(this.invalidReason)},t.mapEndpoints=function(t){return e.fromDateTimes(t(this.s),t(this.e))},gh(e,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}(),Ep=function(){function e(){}return e.hasDST=function(e){void 0===e&&(e=ff.defaultZone);var t=ym.now().setZone(e).set({month:12});return!e.universal&&t.offset!==t.set({month:6}).offset},e.isValidIANAZone=function(e){return tf.isValidSpecifier(e)&&tf.isValidZone(e)},e.normalizeZone=function(e){return of(e,ff.defaultZone)},e.months=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj,u=void 0===a?null:a,l=r.outputCalendar,c=void 0===l?"gregory":l;return(u||Cf.create(i,o,c)).months(e)},e.monthsFormat=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj,u=void 0===a?null:a,l=r.outputCalendar,c=void 0===l?"gregory":l;return(u||Cf.create(i,o,c)).months(e,!0)},e.weekdays=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj;return((void 0===a?null:a)||Cf.create(i,o,null)).weekdays(e)},e.weekdaysFormat=function(e,t){void 0===e&&(e="long");var r=void 0===t?{}:t,n=r.locale,i=void 0===n?null:n,s=r.numberingSystem,o=void 0===s?null:s,a=r.locObj;return((void 0===a?null:a)||Cf.create(i,o,null)).weekdays(e,!0)},e.meridiems=function(e){var t=(void 0===e?{}:e).locale,r=void 0===t?null:t;return Cf.create(r).meridiems()},e.eras=function(e,t){void 0===e&&(e="short");var r=(void 0===t?{}:t).locale,n=void 0===r?null:r;return Cf.create(n,null,"gregory").eras(e)},e.features=function(){var e=!1,t=!1,r=!1,n=!1;if(od()){e=!0,t=ad(),n=ud();try{r="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(CT){r=!1}}return{intl:e,intlTokens:t,zones:r,relative:n}},e}();function Cp(e,t){var r=function(e){return e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()},n=r(t)-r(e);return Math.floor(bp.fromMillis(n).as("days"))}var Tp={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},Np={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},kp=Tp.hanidec.replace(/[\[|\]]/g,"").split("");function Op(e,t){var r=e.numberingSystem;return void 0===t&&(t=""),new RegExp(""+Tp[r||"latn"]+t)}function Sp(e,t){return void 0===t&&(t=function(e){return e}),{regex:e,deser:function(e){var r=e[0];return t(function(e){var t=parseInt(e,10);if(isNaN(t)){t="";for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(-1!==e[r].search(Tp.hanidec))t+=kp.indexOf(e[r]);else for(var i in Np){var s=Np[i],o=s[0],a=s[1];n>=o&&n<=a&&(t+=n-o)}}return parseInt(t,10)}return t}(r))}}}var xp="( |"+String.fromCharCode(160)+")",$p=new RegExp(xp,"g");function Ap(e){return e.replace(/\./g,"\\.?").replace($p,xp)}function jp(e){return e.replace(/\./g,"").replace($p," ").toLowerCase()}function Ip(e,t){return null===e?null:{regex:RegExp(e.map(Ap).join("|")),deser:function(r){var n=r[0];return e.findIndex((function(e){return jp(n)===jp(e)}))+t}}}function Rp(e,t){return{regex:e,deser:function(e){return Td(e[1],e[2])},groups:t}}function Pp(e){return{regex:e,deser:function(e){return e[0]}}}var Mp={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}},Lp=null;function qp(e,t,r){var n=function(e,t){var r;return(r=Array.prototype).concat.apply(r,e.map((function(e){return function(e,t){if(e.literal)return e;var r=Wd.macroTokenToFormatOpts(e.val);if(!r)return e;var n=Wd.create(t,r).formatDateTimeParts((Lp||(Lp=ym.fromMillis(1555555555555)),Lp)).map((function(e){return function(e,t,r){var n=e.type,i=e.value;if("literal"===n)return{literal:!0,val:i};var s=r[n],o=Mp[n];return"object"==typeof o&&(o=o[s]),o?{literal:!1,val:o}:void 0}(e,0,r)}));return n.includes(void 0)?e:n}(e,t)})))}(Wd.parseFormat(r),e),i=n.map((function(t){return r=t,i=Op(n=e),s=Op(n,"{2}"),o=Op(n,"{3}"),a=Op(n,"{4}"),u=Op(n,"{6}"),l=Op(n,"{1,2}"),c=Op(n,"{1,3}"),h=Op(n,"{1,6}"),d=Op(n,"{1,9}"),f=Op(n,"{2,4}"),p=Op(n,"{4,6}"),m=function(e){return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:function(e){return e[0]},literal:!0};var t},(y=function(e){if(r.literal)return m(e);switch(e.val){case"G":return Ip(n.eras("short",!1),0);case"GG":return Ip(n.eras("long",!1),0);case"y":return Sp(h);case"yy":case"kk":return Sp(f,Ed);case"yyyy":case"kkkk":return Sp(a);case"yyyyy":return Sp(p);case"yyyyyy":return Sp(u);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return Sp(l);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return Sp(s);case"MMM":return Ip(n.months("short",!0,!1),1);case"MMMM":return Ip(n.months("long",!0,!1),1);case"LLL":return Ip(n.months("short",!1,!1),1);case"LLLL":return Ip(n.months("long",!1,!1),1);case"o":case"S":return Sp(c);case"ooo":case"SSS":return Sp(o);case"u":return Pp(d);case"a":return Ip(n.meridiems(),0);case"E":case"c":return Sp(i);case"EEE":return Ip(n.weekdays("short",!1,!1),1);case"EEEE":return Ip(n.weekdays("long",!1,!1),1);case"ccc":return Ip(n.weekdays("short",!0,!1),1);case"cccc":return Ip(n.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Rp(new RegExp("([+-]"+l.source+")(?::("+s.source+"))?"),2);case"ZZZ":return Rp(new RegExp("([+-]"+l.source+")("+s.source+")?"),2);case"z":return Pp(/[a-z_+-/]{1,256}?/i);default:return m(e)}}(r)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"}).token=r,y;var r,n,i,s,o,a,u,l,c,h,d,f,p,m,y})),s=i.find((function(e){return e.invalidReason}));if(s)return{input:t,tokens:n,invalidReason:s.invalidReason};var o=function(e){return["^"+e.map((function(e){return e.regex})).reduce((function(e,t){return e+"("+t.source+")"}),"")+"$",e]}(i),a=o[0],u=o[1],l=RegExp(a,"i"),c=function(e,t,r){var n=e.match(t);if(n){var i={},s=1;for(var o in r)if(hd(r,o)){var a=r[o],u=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(n.slice(s,s+u))),s+=u}return[n,i]}return[n,{}]}(t,l,u),h=c[0],d=c[1],f=d?function(e){var t;return t=nd(e.Z)?nd(e.z)?null:tf.create(e.z):new nf(e.Z),nd(e.q)||(e.M=3*(e.q-1)+1),nd(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),nd(e.u)||(e.S=md(e.u)),[Object.keys(e).reduce((function(t,r){var n=function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(r);return n&&(t[n]=e[r]),t}),{}),t]}(d):[null,null],p=f[0],m=f[1];if(hd(d,"a")&&hd(d,"H"))throw new $h("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:n,regex:l,rawMatches:h,matches:d,result:p,zone:m}}var Dp=[0,31,59,90,120,151,181,212,243,273,304,334],Fp=[0,31,60,91,121,152,182,213,244,274,305,335];function Up(e,t){return new Qd("unit out of range","you specified "+t+" (of type "+typeof t+") as a "+e+", which is invalid")}function Vp(e,t,r){var n=new Date(Date.UTC(e,t-1,r)).getUTCDay();return 0===n?7:n}function Bp(e,t,r){return r+(gd(e)?Fp:Dp)[t-1]}function zp(e,t){var r=gd(e)?Fp:Dp,n=r.findIndex((function(e){return e<t}));return{month:n+1,day:t-r[n]}}function Hp(e){var t,r=e.year,n=e.month,i=e.day,s=Bp(r,n,i),o=Vp(r,n,i),a=Math.floor((s-o+10)/7);return a<1?a=wd(t=r-1):a>wd(r)?(t=r+1,a=1):t=r,Object.assign({weekYear:t,weekNumber:a,weekday:o},Sd(e))}function Wp(e){var t,r=e.weekYear,n=e.weekNumber,i=e.weekday,s=Vp(r,1,4),o=vd(r),a=7*n+i-s-3;a<1?a+=vd(t=r-1):a>o?(t=r+1,a-=vd(r)):t=r;var u=zp(t,a),l=u.month,c=u.day;return Object.assign({year:t,month:l,day:c},Sd(e))}function Qp(e){var t=e.year,r=Bp(t,e.month,e.day);return Object.assign({year:t,ordinal:r},Sd(e))}function Jp(e){var t=e.year,r=zp(t,e.ordinal),n=r.month,i=r.day;return Object.assign({year:t,month:n,day:i},Sd(e))}function Gp(e){var t=sd(e.year),r=dd(e.month,1,12),n=dd(e.day,1,bd(e.year,e.month));return t?r?!n&&Up("day",e.day):Up("month",e.month):Up("year",e.year)}function Kp(e){var t=e.hour,r=e.minute,n=e.second,i=e.millisecond,s=dd(t,0,23)||24===t&&0===r&&0===n&&0===i,o=dd(r,0,59),a=dd(n,0,59),u=dd(i,0,999);return s?o?a?!u&&Up("millisecond",i):Up("second",n):Up("minute",r):Up("hour",t)}function Zp(e){return new Qd("unsupported zone",'the zone "'+e.name+'" is not supported')}function Yp(e){return null===e.weekData&&(e.weekData=Hp(e.c)),e.weekData}function Xp(e,t){var r={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new ym(Object.assign({},r,t,{old:r}))}function em(e,t,r){var n=e-60*t*1e3,i=r.offset(n);if(t===i)return[n,t];n-=60*(i-t)*1e3;var s=r.offset(n);return i===s?[n,i]:[e-60*Math.min(i,s)*1e3,Math.max(i,s)]}function tm(e,t){var r=new Date(e+=60*t*1e3);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function rm(e,t,r){return em(_d(e),t,r)}function nm(e,t){var r=e.o,n=e.c.year+Math.trunc(t.years),i=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),s=Object.assign({},e.c,{year:n,month:i,day:Math.min(e.c.day,bd(n,i))+Math.trunc(t.days)+7*Math.trunc(t.weeks)}),o=bp.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=em(_d(s),r,e.zone),u=a[0],l=a[1];return 0!==o&&(u+=o,l=e.zone.offset(u)),{ts:u,o:l}}function im(e,t,r,n,i){var s=r.setZone,o=r.zone;if(e&&0!==Object.keys(e).length){var a=t||o,u=ym.fromObject(Object.assign(e,r,{zone:a,setZone:void 0}));return s?u:u.setZone(o)}return ym.invalid(new Qd("unparsable",'the input "'+i+"\" can't be parsed as "+n))}function sm(e,t,r){return void 0===r&&(r=!0),e.isValid?Wd.create(Cf.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(e,t):null}function om(e,t){var r=t.suppressSeconds,n=void 0!==r&&r,i=t.suppressMilliseconds,s=void 0!==i&&i,o=t.includeOffset,a=t.includePrefix,u=void 0!==a&&a,l=t.includeZone,c=void 0!==l&&l,h=t.spaceZone,d=void 0!==h&&h,f=t.format,p=void 0===f?"extended":f,m="basic"===p?"HHmm":"HH:mm";n&&0===e.second&&0===e.millisecond||(m+="basic"===p?"ss":":ss",s&&0===e.millisecond||(m+=".SSS")),(c||o)&&d&&(m+=" "),c?m+="z":o&&(m+="basic"===p?"ZZZ":"ZZ");var y=sm(e,m);return u&&(y="T"+y),y}var am={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},um={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},lm={ordinal:1,hour:0,minute:0,second:0,millisecond:0},cm=["year","month","day","hour","minute","second","millisecond"],hm=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],dm=["year","ordinal","hour","minute","second","millisecond"];function fm(e){var t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new Ah(e);return t}function pm(e,t){for(var r,n=Nh(cm);!(r=n()).done;){var i=r.value;nd(e[i])&&(e[i]=am[i])}var s=Gp(e)||Kp(e);if(s)return ym.invalid(s);var o=ff.now(),a=rm(e,t.offset(o),t),u=a[0],l=a[1];return new ym({ts:u,zone:t,o:l})}function mm(e,t,r){var n=!!nd(r.round)||r.round,i=function(e,i){return e=yd(e,n||r.calendary?0:2,!0),t.loc.clone(r).relFormatter(r).format(e,i)},s=function(n){return r.calendary?t.hasSame(e,n)?0:t.startOf(n).diff(e.startOf(n),n).get(n):t.diff(e,n).get(n)};if(r.unit)return i(s(r.unit),r.unit);for(var o,a=Nh(r.units);!(o=a()).done;){var u=o.value,l=s(u);if(Math.abs(l)>=1)return i(l,u)}return i(e>t?-0:0,r.units[r.units.length-1])}var ym=function(){function e(e){var t=e.zone||ff.defaultZone,r=e.invalid||(Number.isNaN(e.ts)?new Qd("invalid input"):null)||(t.isValid?null:Zp(t));this.ts=nd(e.ts)?ff.now():e.ts;var n=null,i=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t)){var s=[e.old.c,e.old.o];n=s[0],i=s[1]}else{var o=t.offset(this.ts);n=tm(this.ts,o),n=(r=Number.isNaN(n.year)?new Qd("invalid input"):null)?null:n,i=r?null:o}this._zone=t,this.loc=e.loc||Cf.create(),this.invalid=r,this.weekData=null,this.c=n,this.o=i,this.isLuxonDateTime=!0}e.now=function(){return new e({})},e.local=function(t,r,n,i,s,o,a){return nd(t)?e.now():pm({year:t,month:r,day:n,hour:i,minute:s,second:o,millisecond:a},ff.defaultZone)},e.utc=function(t,r,n,i,s,o,a){return nd(t)?new e({ts:ff.now(),zone:nf.utcInstance}):pm({year:t,month:r,day:n,hour:i,minute:s,second:o,millisecond:a},nf.utcInstance)},e.fromJSDate=function(t,r){void 0===r&&(r={});var n,i=(n=t,"[object Date]"===Object.prototype.toString.call(n)?t.valueOf():NaN);if(Number.isNaN(i))return e.invalid("invalid input");var s=of(r.zone,ff.defaultZone);return s.isValid?new e({ts:i,zone:s,loc:Cf.fromObject(r)}):e.invalid(Zp(s))},e.fromMillis=function(t,r){if(void 0===r&&(r={}),id(t))return t<-864e13||t>864e13?e.invalid("Timestamp out of range"):new e({ts:t,zone:of(r.zone,ff.defaultZone),loc:Cf.fromObject(r)});throw new jh("fromMillis requires a numerical input, but received a "+typeof t+" with value "+t)},e.fromSeconds=function(t,r){if(void 0===r&&(r={}),id(t))return new e({ts:1e3*t,zone:of(r.zone,ff.defaultZone),loc:Cf.fromObject(r)});throw new jh("fromSeconds requires a numerical input")},e.fromObject=function(t){var r=of(t.zone,ff.defaultZone);if(!r.isValid)return e.invalid(Zp(r));var n=ff.now(),i=r.offset(n),s=kd(t,fm,["zone","locale","outputCalendar","numberingSystem"]),o=!nd(s.ordinal),a=!nd(s.year),u=!nd(s.month)||!nd(s.day),l=a||u,c=s.weekYear||s.weekNumber,h=Cf.fromObject(t);if((l||o)&&c)throw new $h("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&o)throw new $h("Can't mix ordinal dates with month/day");var d,f,p=c||s.weekday&&!l,m=tm(n,i);p?(d=hm,f=um,m=Hp(m)):o?(d=dm,f=lm,m=Qp(m)):(d=cm,f=am);for(var y,g=!1,v=Nh(d);!(y=v()).done;){var b=y.value;nd(s[b])?s[b]=g?f[b]:m[b]:g=!0}var _=(p?function(e){var t=sd(e.weekYear),r=dd(e.weekNumber,1,wd(e.weekYear)),n=dd(e.weekday,1,7);return t?r?!n&&Up("weekday",e.weekday):Up("week",e.week):Up("weekYear",e.weekYear)}(s):o?function(e){var t=sd(e.year),r=dd(e.ordinal,1,vd(e.year));return t?!r&&Up("ordinal",e.ordinal):Up("year",e.year)}(s):Gp(s))||Kp(s);if(_)return e.invalid(_);var w=rm(p?Wp(s):o?Jp(s):s,i,r),E=new e({ts:w[0],zone:r,o:w[1],loc:h});return s.weekday&&l&&t.weekday!==E.weekday?e.invalid("mismatched weekday","you can't specify both a weekday of "+s.weekday+" and a date of "+E.toISO()):E},e.fromISO=function(e,t){void 0===t&&(t={});var r=function(e){return kf(e,[Xf,np],[ep,ip],[tp,sp],[rp,op])}(e);return im(r[0],r[1],t,"ISO 8601",e)},e.fromRFC2822=function(e,t){void 0===t&&(t={});var r=function(e){return kf(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[Wf,Qf])}(e);return im(r[0],r[1],t,"RFC 2822",e)},e.fromHTTP=function(e,t){void 0===t&&(t={});var r=function(e){return kf(e,[Jf,Zf],[Gf,Zf],[Kf,Yf])}(e);return im(r[0],r[1],t,"HTTP",t)},e.fromFormat=function(t,r,n){if(void 0===n&&(n={}),nd(t)||nd(r))throw new jh("fromFormat requires an input string and a format");var i=n,s=i.locale,o=void 0===s?null:s,a=i.numberingSystem,u=void 0===a?null:a,l=function(e,t,r){var n=qp(e,t,r);return[n.result,n.zone,n.invalidReason]}(Cf.fromOpts({locale:o,numberingSystem:u,defaultToEN:!0}),t,r),c=l[0],h=l[1],d=l[2];return d?e.invalid(d):im(c,h,n,"format "+r,t)},e.fromString=function(t,r,n){return void 0===n&&(n={}),e.fromFormat(t,r,n)},e.fromSQL=function(e,t){void 0===t&&(t={});var r=function(e){return kf(e,[up,cp],[lp,hp])}(e);return im(r[0],r[1],t,"SQL",e)},e.invalid=function(t,r){if(void 0===r&&(r=null),!t)throw new jh("need to specify a reason the DateTime is invalid");var n=t instanceof Qd?t:new Qd(t,r);if(ff.throwOnInvalid)throw new Oh(n);return new e({invalid:n})},e.isDateTime=function(e){return e&&e.isLuxonDateTime||!1};var t=e.prototype;return t.get=function(e){return this[e]},t.resolvedLocaleOpts=function(e){void 0===e&&(e={});var t=Wd.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t.locale,numberingSystem:t.numberingSystem,outputCalendar:t.calendar}},t.toUTC=function(e,t){return void 0===e&&(e=0),void 0===t&&(t={}),this.setZone(nf.instance(e),t)},t.toLocal=function(){return this.setZone(ff.defaultZone)},t.setZone=function(t,r){var n=void 0===r?{}:r,i=n.keepLocalTime,s=void 0!==i&&i,o=n.keepCalendarTime,a=void 0!==o&&o;if((t=of(t,ff.defaultZone)).equals(this.zone))return this;if(t.isValid){var u=this.ts;if(s||a){var l=t.offset(this.ts);u=rm(this.toObject(),l,t)[0]}return Xp(this,{ts:u,zone:t})}return e.invalid(Zp(t))},t.reconfigure=function(e){var t=void 0===e?{}:e,r=t.locale,n=t.numberingSystem,i=t.outputCalendar;return Xp(this,{loc:this.loc.clone({locale:r,numberingSystem:n,outputCalendar:i})})},t.setLocale=function(e){return this.reconfigure({locale:e})},t.set=function(e){if(!this.isValid)return this;var t,r=kd(e,fm,[]),n=!nd(r.weekYear)||!nd(r.weekNumber)||!nd(r.weekday),i=!nd(r.ordinal),s=!nd(r.year),o=!nd(r.month)||!nd(r.day),a=s||o,u=r.weekYear||r.weekNumber;if((a||i)&&u)throw new $h("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&i)throw new $h("Can't mix ordinal dates with month/day");n?t=Wp(Object.assign(Hp(this.c),r)):nd(r.ordinal)?(t=Object.assign(this.toObject(),r),nd(r.day)&&(t.day=Math.min(bd(t.year,t.month),t.day))):t=Jp(Object.assign(Qp(this.c),r));var l=rm(t,this.o,this.zone);return Xp(this,{ts:l[0],o:l[1]})},t.plus=function(e){return this.isValid?Xp(this,nm(this,_p(e))):this},t.minus=function(e){return this.isValid?Xp(this,nm(this,_p(e).negate())):this},t.startOf=function(e){if(!this.isValid)return this;var t={},r=bp.normalizeUnit(e);switch(r){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===r&&(t.weekday=1),"quarters"===r){var n=Math.ceil(this.month/3);t.month=3*(n-1)+1}return this.set(t)},t.endOf=function(e){var t;return this.isValid?this.plus((t={},t[e]=1,t)).startOf(e).minus(1):this},t.toFormat=function(e,t){return void 0===t&&(t={}),this.isValid?Wd.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):"Invalid DateTime"},t.toLocaleString=function(e){return void 0===e&&(e=Ph),this.isValid?Wd.create(this.loc.clone(e),e).formatDateTime(this):"Invalid DateTime"},t.toLocaleParts=function(e){return void 0===e&&(e={}),this.isValid?Wd.create(this.loc.clone(e),e).formatDateTimeParts(this):[]},t.toISO=function(e){return void 0===e&&(e={}),this.isValid?this.toISODate(e)+"T"+this.toISOTime(e):null},t.toISODate=function(e){var t=(void 0===e?{}:e).format,r="basic"===(void 0===t?"extended":t)?"yyyyMMdd":"yyyy-MM-dd";return this.year>9999&&(r="+"+r),sm(this,r)},t.toISOWeekDate=function(){return sm(this,"kkkk-'W'WW-c")},t.toISOTime=function(e){var t=void 0===e?{}:e,r=t.suppressMilliseconds,n=void 0!==r&&r,i=t.suppressSeconds,s=void 0!==i&&i,o=t.includeOffset,a=void 0===o||o,u=t.includePrefix,l=void 0!==u&&u,c=t.format;return om(this,{suppressSeconds:s,suppressMilliseconds:n,includeOffset:a,includePrefix:l,format:void 0===c?"extended":c})},t.toRFC2822=function(){return sm(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)},t.toHTTP=function(){return sm(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},t.toSQLDate=function(){return sm(this,"yyyy-MM-dd")},t.toSQLTime=function(e){var t=void 0===e?{}:e,r=t.includeOffset,n=void 0===r||r,i=t.includeZone;return om(this,{includeOffset:n,includeZone:void 0!==i&&i,spaceZone:!0})},t.toSQL=function(e){return void 0===e&&(e={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(e):null},t.toString=function(){return this.isValid?this.toISO():"Invalid DateTime"},t.valueOf=function(){return this.toMillis()},t.toMillis=function(){return this.isValid?this.ts:NaN},t.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},t.toJSON=function(){return this.toISO()},t.toBSON=function(){return this.toJSDate()},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.c);return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},t.diff=function(e,t,r){if(void 0===t&&(t="milliseconds"),void 0===r&&(r={}),!this.isValid||!e.isValid)return bp.invalid(this.invalid||e.invalid,"created by diffing an invalid DateTime");var n,i=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},r),s=(n=t,Array.isArray(n)?n:[n]).map(bp.normalizeUnit),o=e.valueOf()>this.valueOf(),a=function(e,t,r,n){var i,s=function(e,t,r){for(var n,i,s={},o=0,a=[["years",function(e,t){return t.year-e.year}],["quarters",function(e,t){return t.quarter-e.quarter}],["months",function(e,t){return t.month-e.month+12*(t.year-e.year)}],["weeks",function(e,t){var r=Cp(e,t);return(r-r%7)/7}],["days",Cp]];o<a.length;o++){var u=a[o],l=u[0],c=u[1];if(r.indexOf(l)>=0){var h;n=l;var d,f=c(e,t);(i=e.plus(((h={})[l]=f,h)))>t?(e=e.plus(((d={})[l]=f-1,d)),f-=1):e=i,s[l]=f}}return[e,s,i,n]}(e,t,r),o=s[0],a=s[1],u=s[2],l=s[3],c=t-o,h=r.filter((function(e){return["hours","minutes","seconds","milliseconds"].indexOf(e)>=0}));0===h.length&&(u<t&&(u=o.plus(((i={})[l]=1,i))),u!==o&&(a[l]=(a[l]||0)+c/(u-o)));var d,f=bp.fromObject(Object.assign(a,n));return h.length>0?(d=bp.fromMillis(c,n)).shiftTo.apply(d,h).plus(f):f}(o?this:e,o?e:this,s,i);return o?a.negate():a},t.diffNow=function(t,r){return void 0===t&&(t="milliseconds"),void 0===r&&(r={}),this.diff(e.now(),t,r)},t.until=function(e){return this.isValid?wp.fromDateTimes(this,e):this},t.hasSame=function(e,t){if(!this.isValid)return!1;var r=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(t)<=r&&r<=n.endOf(t)},t.equals=function(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)},t.toRelative=function(t){if(void 0===t&&(t={}),!this.isValid)return null;var r=t.base||e.fromObject({zone:this.zone}),n=t.padding?this<r?-t.padding:t.padding:0,i=["years","months","days","hours","minutes","seconds"],s=t.unit;return Array.isArray(t.unit)&&(i=t.unit,s=void 0),mm(r,this.plus(n),Object.assign(t,{numeric:"always",units:i,unit:s}))},t.toRelativeCalendar=function(t){return void 0===t&&(t={}),this.isValid?mm(t.base||e.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},e.min=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every(e.isDateTime))throw new jh("min requires all arguments be DateTimes");return ld(r,(function(e){return e.valueOf()}),Math.min)},e.max=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.every(e.isDateTime))throw new jh("max requires all arguments be DateTimes");return ld(r,(function(e){return e.valueOf()}),Math.max)},e.fromFormatExplain=function(e,t,r){void 0===r&&(r={});var n=r,i=n.locale,s=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o;return qp(Cf.fromOpts({locale:s,numberingSystem:a,defaultToEN:!0}),e,t)},e.fromStringExplain=function(t,r,n){return void 0===n&&(n={}),e.fromFormatExplain(t,r,n)},gh(e,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?Yp(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?Yp(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?Yp(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?Qp(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?Ep.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?Ep.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?Ep.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?Ep.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.universal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return gd(this.year)}},{key:"daysInMonth",get:function(){return bd(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?vd(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?wd(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return Ph}},{key:"DATE_MED",get:function(){return Mh}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return Lh}},{key:"DATE_FULL",get:function(){return qh}},{key:"DATE_HUGE",get:function(){return Dh}},{key:"TIME_SIMPLE",get:function(){return Fh}},{key:"TIME_WITH_SECONDS",get:function(){return Uh}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return Vh}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return Bh}},{key:"TIME_24_SIMPLE",get:function(){return zh}},{key:"TIME_24_WITH_SECONDS",get:function(){return Hh}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return Wh}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return Qh}},{key:"DATETIME_SHORT",get:function(){return Jh}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return Gh}},{key:"DATETIME_MED",get:function(){return Kh}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return Zh}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return Yh}},{key:"DATETIME_FULL",get:function(){return Xh}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return ed}},{key:"DATETIME_HUGE",get:function(){return td}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return rd}}]),e}();function gm(e){if(ym.isDateTime(e))return e;if(e&&e.valueOf&&id(e.valueOf()))return ym.fromJSDate(e);if(e&&"object"==typeof e)return ym.fromObject(e);throw new jh("Unknown datetime argument: "+e+", of type "+typeof e)}mh.DateTime=ym,mh.Duration=bp,mh.FixedOffsetZone=nf,mh.IANAZone=tf,mh.Info=Ep,mh.Interval=wp,mh.InvalidZone=sf,mh.LocalZone=Kd,mh.Settings=ff,mh.VERSION="1.28.0",mh.Zone=Jd;const{DateTime:vm}=mh;var bm={generate:async function(e){return await ph.encode({iss:"api.persistr.com",user:e,ts:vm.local().toMillis()},"")}},_m={};(function(e){"use strict";var t=require("crypto");_m=function(r){return{hash:function(n,i){if(void 0===i&&n instanceof Function&&(i=n,n=void 0),!r)return i("No password provided");"string"==typeof n&&(n=new e(n,"hex"));var s=function(){t.pbkdf2(r,n,1e4,64,"sha1",(function(e,t){if(e)return i(e);var r="pbkdf2$10000$"+t.toString("hex")+"$"+n.toString("hex");i(null,r)}))};n?s():t.randomBytes(64,(function(e,t){if(e)return i(e);n=t,s()}))},verifyAgainst:function(e,t){if(!e||!r)return t(null,!1);var n=e.split("$");return 4===n.length&&n[2]&&n[3]?"pbkdf2"!==n[0]||n[1]!==1e4.toString()?t("Wrong algorithm and/or iterations"):void this.hash(n[3],(function(r,n){if(r)return t(r);t(null,n===e)})):t("Hash not formatted correctly")}}}}).call(this,require("buffer").Buffer);var wm=_m,Em={jwt:ph,keys:bm,passwords:{hash:async function(e){return new Promise((function(t,r){wm(e).hash((function(e,r){t(r)}))}))},verify:async function({password:e,against:t}){return new Promise((function(r,n){""!==e||""!==t?wm(e).verifyAgainst(t,(function(e,t){r(!e&&!!t)})):r(!0)}))}}},Cm={};(function(e){const t=require("fs"),r=require("path"),n=[],i=(e,n,s)=>{const o=r.resolve(e,...n);t.readdirSync(o).forEach(a=>{if(t.statSync(`${o}/${a}`).isDirectory())return i(e,[...n,a],s);a.toLowerCase().endsWith(".js")&&s(e,n,o,a,r.resolve(o,a))})};i(r.resolve(e),[],(e,t,i,s,o)=>{const a=r.parse(s);".js"===a.ext&&"index"!==a.name&&n.push({name:t.join("."),method:a.name,module:require(o)})}),Cm=n}).call(this,"/node_modules/@persistr/store/src/entities");var Tm={};Object.defineProperty(Tm,"__esModule",{value:!0});class Nm extends Error{}Tm.TimeoutError=Nm;var km={};Object.defineProperty(km,"__esModule",{value:!0}),km.PromiseInspection=class{constructor(e){this._value=e.value,this._error=e.error}value(){return this._value}reason(){return this._error}isRejected(){return!!this._error}isFulfilled(){return!!this._value}};var Om={};function Sm(e){return"number"==typeof e&&e===Math.round(e)&&e>0}Object.defineProperty(Om,"__esModule",{value:!0}),Om.defer=function(){let e=null,t=null;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}},Om.now=function(){return Date.now()},Om.duration=function(e,t){return Math.abs(t-e)},Om.checkOptionalTime=function(e){return void 0===e||Sm(e)},Om.checkRequiredTime=Sm,Om.delay=function(e){return new Promise(t=>setTimeout(t,e))},Om.reflect=function(e){return e.then(e=>new km.PromiseInspection({value:e})).catch(e=>new km.PromiseInspection({error:e}))},Om.tryPromise=function(e){try{const t=e();return Promise.resolve(t)}catch(t){return Promise.reject(t)}};var xm={};Object.defineProperty(xm,"__esModule",{value:!0}),xm.PendingOperation=class{constructor(e){var t,r;this.timeoutMillis=e,this.deferred=Om.defer(),this.possibleTimeoutCause=null,this.isRejected=!1,this.promise=(t=this.deferred.promise,r=e,new Promise((e,n)=>{const i=setTimeout(()=>n(new Tm.TimeoutError),r);t.then(t=>{clearTimeout(i),e(t)}).catch(e=>{clearTimeout(i),n(e)})})).catch(e=>(e instanceof Tm.TimeoutError&&(e=this.possibleTimeoutCause?new Tm.TimeoutError(this.possibleTimeoutCause.message):new Tm.TimeoutError("operation timed out for an unknown reason")),this.isRejected=!0,Promise.reject(e)))}abort(){this.reject(new Error("aborted"))}reject(e){this.deferred.reject(e)}resolve(e){this.deferred.resolve(e)}};var $m={};Object.defineProperty($m,"__esModule",{value:!0});class Am{constructor(e){this.resource=e,this.resource=e,this.timestamp=Om.now(),this.deferred=Om.defer()}get promise(){return this.deferred.promise}resolve(){return this.deferred.resolve(void 0),new Am(this.resource)}}$m.Resource=Am;var jm={};Object.defineProperty(jm,"__esModule",{value:!0});const Im=require("events"),Rm=require("timers");function Pm(e,t){const r=e.indexOf(t);return-1!==r&&(e.splice(r,1),!0)}jm.Pool=class{constructor(e){if(this.destroyed=!1,this.emitter=new Im.EventEmitter,!(e=e||{}).create)throw new Error("Tarn: opt.create function most be provided");if(!e.destroy)throw new Error("Tarn: opt.destroy function most be provided");if("number"!=typeof e.min||e.min<0||e.min!==Math.round(e.min))throw new Error("Tarn: opt.min must be an integer >= 0");if("number"!=typeof e.max||e.max<=0||e.max!==Math.round(e.max))throw new Error("Tarn: opt.max must be an integer > 0");if(e.min>e.max)throw new Error("Tarn: opt.max is smaller than opt.min");if(!Om.checkOptionalTime(e.acquireTimeoutMillis))throw new Error("Tarn: invalid opt.acquireTimeoutMillis "+JSON.stringify(e.acquireTimeoutMillis));if(!Om.checkOptionalTime(e.createTimeoutMillis))throw new Error("Tarn: invalid opt.createTimeoutMillis "+JSON.stringify(e.createTimeoutMillis));if(!Om.checkOptionalTime(e.destroyTimeoutMillis))throw new Error("Tarn: invalid opt.destroyTimeoutMillis "+JSON.stringify(e.destroyTimeoutMillis));if(!Om.checkOptionalTime(e.idleTimeoutMillis))throw new Error("Tarn: invalid opt.idleTimeoutMillis "+JSON.stringify(e.idleTimeoutMillis));if(!Om.checkOptionalTime(e.reapIntervalMillis))throw new Error("Tarn: invalid opt.reapIntervalMillis "+JSON.stringify(e.reapIntervalMillis));if(!Om.checkOptionalTime(e.createRetryIntervalMillis))throw new Error("Tarn: invalid opt.createRetryIntervalMillis "+JSON.stringify(e.createRetryIntervalMillis));const t={create:!0,validate:!0,destroy:!0,log:!0,min:!0,max:!0,acquireTimeoutMillis:!0,createTimeoutMillis:!0,destroyTimeoutMillis:!0,idleTimeoutMillis:!0,reapIntervalMillis:!0,createRetryIntervalMillis:!0,propagateCreateError:!0};for(const r of Object.keys(e))if(!t[r])throw new Error("Tarn: unsupported option opt."+r);this.creator=e.create,this.destroyer=e.destroy,this.validate="function"==typeof e.validate?e.validate:()=>!0,this.log=e.log||(()=>{}),this.acquireTimeoutMillis=e.acquireTimeoutMillis||3e4,this.createTimeoutMillis=e.createTimeoutMillis||3e4,this.destroyTimeoutMillis=e.destroyTimeoutMillis||5e3,this.idleTimeoutMillis=e.idleTimeoutMillis||3e4,this.reapIntervalMillis=e.reapIntervalMillis||1e3,this.createRetryIntervalMillis=e.createRetryIntervalMillis||200,this.propagateCreateError=!!e.propagateCreateError,this.min=e.min,this.max=e.max,this.used=[],this.free=[],this.pendingCreates=[],this.pendingAcquires=[],this.pendingDestroys=[],this.pendingValidations=[],this.destroyed=!1,this.interval=null,this.eventId=1}numUsed(){return this.used.length}numFree(){return this.free.length}numPendingAcquires(){return this.pendingAcquires.length}numPendingValidations(){return this.pendingValidations.length}numPendingCreates(){return this.pendingCreates.length}acquire(){const e=this.eventId++;this._executeEventHandlers("acquireRequest",e);const t=new xm.PendingOperation(this.acquireTimeoutMillis);return this.pendingAcquires.push(t),t.promise=t.promise.then(t=>(this._executeEventHandlers("acquireSuccess",e,t),t)).catch(r=>(this._executeEventHandlers("acquireFail",e,r),Pm(this.pendingAcquires,t),Promise.reject(r))),this._tryAcquireOrCreate(),t}release(e){this._executeEventHandlers("release",e);for(let t=0,r=this.used.length;t<r;++t){const r=this.used[t];if(r.resource===e)return this.used.splice(t,1),this.free.push(r.resolve()),this._tryAcquireOrCreate(),!0}return!1}isEmpty(){return 0===[this.numFree(),this.numUsed(),this.numPendingAcquires(),this.numPendingValidations(),this.numPendingCreates()].reduce((e,t)=>e+t)}check(){const e=Om.now(),t=[],r=this.min-this.used.length,n=this.free.length-r;let i=0;this.free.forEach(r=>{Om.duration(e,r.timestamp)>=this.idleTimeoutMillis&&i<n?(i++,this._destroy(r.resource)):t.push(r)}),this.free=t,this.isEmpty()&&this._stopReaping()}destroy(){const e=this.eventId++;return this._executeEventHandlers("poolDestroyRequest",e),this._stopReaping(),this.destroyed=!0,Om.reflect(Promise.all(this.pendingCreates.map(e=>Om.reflect(e.promise))).then(()=>new Promise((e,t)=>{if(0===this.numPendingValidations())return void e();const r=setInterval(()=>{0===this.numPendingValidations()&&(Rm.clearInterval(r),e())},100)})).then(()=>Promise.all(this.used.map(e=>Om.reflect(e.promise)))).then(()=>Promise.all(this.pendingAcquires.map(e=>(e.abort(),Om.reflect(e.promise))))).then(()=>Promise.all(this.free.map(e=>Om.reflect(this._destroy(e.resource))))).then(()=>Promise.all(this.pendingDestroys.map(e=>e.promise))).then(()=>{this.free=[],this.pendingAcquires=[]})).then(t=>(this._executeEventHandlers("poolDestroySuccess",e),this.emitter.removeAllListeners(),t))}on(e,t){this.emitter.on(e,t)}removeListener(e,t){this.emitter.removeListener(e,t)}removeAllListeners(e){this.emitter.removeAllListeners(e)}_tryAcquireOrCreate(){this.destroyed||(this._hasFreeResources()?this._doAcquire():this._shouldCreateMoreResources()&&this._doCreate())}_hasFreeResources(){return this.free.length>0}_doAcquire(){for(;this._canAcquire();){const e=this.pendingAcquires.shift(),t=this.free.pop();if(void 0===t||void 0===e){const e="this.free was empty while trying to acquire resource";throw this.log("Tarn: "+e,"warn"),new Error("Internal error, should never happen. "+e)}this.pendingValidations.push(e),this.used.push(t);const r=new xm.PendingOperation(this.acquireTimeoutMillis);e.promise.catch(e=>{r.abort()}),r.promise.catch(e=>(this.log("Tarn: resource validator threw an exception "+e.stack,"warn"),!1)).then(r=>{try{r&&!e.isRejected?(this._startReaping(),e.resolve(t.resource)):(Pm(this.used,t),r?this.free.push(t):(this._destroy(t.resource),setTimeout(()=>{this._tryAcquireOrCreate()},0)),e.isRejected||this.pendingAcquires.unshift(e))}finally{Pm(this.pendingValidations,e)}}),this._validateResource(t.resource).then(e=>{r.resolve(e)}).catch(e=>{r.reject(e)})}}_canAcquire(){return this.free.length>0&&this.pendingAcquires.length>0}_validateResource(e){try{return Promise.resolve(this.validate(e))}catch(t){return Promise.reject(t)}}_shouldCreateMoreResources(){return this.used.length+this.pendingCreates.length<this.max&&this.pendingCreates.length<this.pendingAcquires.length}_doCreate(){const e=this.pendingAcquires.slice();this._create().promise.then(()=>(this._tryAcquireOrCreate(),null)).catch(t=>{this.propagateCreateError&&0!==this.pendingAcquires.length&&this.pendingAcquires[0].reject(t),e.forEach(e=>{e.possibleTimeoutCause=t}),Om.delay(this.createRetryIntervalMillis).then(()=>this._tryAcquireOrCreate())})}_create(){const e=this.eventId++;this._executeEventHandlers("createRequest",e);const t=new xm.PendingOperation(this.createTimeoutMillis);var r;return t.promise=t.promise.catch(r=>{throw Pm(this.pendingCreates,t)&&this._executeEventHandlers("createFail",e,r),r}),this.pendingCreates.push(t),(r=this.creator,new Promise((e,t)=>{const n=(r,n)=>{r?t(r):e(n)};Om.tryPromise(()=>r(n)).then(t=>{t&&e(t)}).catch(e=>{t(e)})})).then(r=>t.isRejected?(this.destroyer(r),null):(Pm(this.pendingCreates,t),this.free.push(new $m.Resource(r)),t.resolve(r),this._executeEventHandlers("createSuccess",e,r),null)).catch(r=>(t.isRejected||(Pm(this.pendingCreates,t)&&this._executeEventHandlers("createFail",e,r),t.reject(r)),null)),t}_destroy(e){const t=this.eventId++;this._executeEventHandlers("destroyRequest",t,e);const r=new xm.PendingOperation(this.destroyTimeoutMillis);return Promise.resolve().then(()=>this.destroyer(e)).then(()=>{r.resolve(e)}).catch(e=>{r.reject(e)}),this.pendingDestroys.push(r),r.promise.then(r=>(this._executeEventHandlers("destroySuccess",t,e),r)).catch(r=>this._logDestroyerError(t,e,r)).then(e=>{const t=this.pendingDestroys.findIndex(e=>e===r);return this.pendingDestroys.splice(t,1),e})}_logDestroyerError(e,t,r){this._executeEventHandlers("destroyFail",e,t,r),this.log("Tarn: resource destroyer threw an exception "+r.stack,"warn")}_startReaping(){this.interval||(this._executeEventHandlers("startReaping"),this.interval=setInterval(()=>this.check(),this.reapIntervalMillis))}_stopReaping(){null!==this.interval&&(this._executeEventHandlers("stopReaping"),Rm.clearInterval(this.interval)),this.interval=null}_executeEventHandlers(e,...t){this.emitter.listeners(e).forEach(r=>{try{r(...t)}catch(n){this.log(`Tarn: event handler "${e}" threw an exception ${n.stack}`,"warn")}})}};var Mm={};
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
function Lm(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}Object.defineProperty(Mm,"__esModule",{value:!0}),Mm.Pool=jm.Pool,Mm.TimeoutError=Tm.TimeoutError,Mm={Pool:jm.Pool,TimeoutError:Tm.TimeoutError};var qm={};(function(e){const t=/[\0\b\t\n\r\x1a"'\\]/g,r={"\0":"\\0","\b":"\\b","\t":"\\t","\n":"\\n","\r":"\\r","\x1a":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};function n(e){return function t(r,n={}){return e(r,t,n)}}function i(e,t,r){return e&&"function"==typeof e.toSQL?e.toSQL(r):JSON.stringify(e)}function s(e,t,r){let n="";for(let i=0;i<e.length;i++){const o=e[i];Array.isArray(o)?n+=(0===i?"":", ")+"("+s(o,t,r)+")":n+=(0===i?"":", ")+t(o,r)}return n}function o(e){return"X"+a(e.toString("hex"))}function a(e,n,i){let s,o=t.lastIndex=0,a="";for(;s=t.exec(e);)a+=e.slice(o,s.index)+r[s[0]],o=t.lastIndex;return 0===o?"'"+e+"'":o<e.length?"'"+a+e.slice(o)+"'":"'"+a+"'"}function u(e,t,r={}){const n=r.timeZone||"local",i=new Date(e);let s,o,a,u,c,h,d;if("local"===n)s=i.getFullYear(),o=i.getMonth()+1,a=i.getDate(),u=i.getHours(),c=i.getMinutes(),h=i.getSeconds(),d=i.getMilliseconds();else{const e=function(e){if("Z"===e)return 0;const t=e.match(/([+\-\s])(\d\d):?(\d\d)?/);return!!t&&("-"==t[1]?-1:1)*(parseInt(t[2],10)+(t[3]?parseInt(t[3],10):0)/60)*60}(n);!1!==e&&0!==e&&i.setTime(i.getTime()+6e4*e),s=i.getUTCFullYear(),o=i.getUTCMonth()+1,a=i.getUTCDate(),u=i.getUTCHours(),c=i.getUTCMinutes(),h=i.getUTCSeconds(),d=i.getUTCMilliseconds()}return l(s,4)+"-"+l(o,2)+"-"+l(a,2)+" "+l(u,2)+":"+l(c,2)+":"+l(h,2)+"."+l(d,3)}function l(e,t){for(e=e.toString();e.length<t;)e="0"+e;return e}qm={arrayToList:s,bufferToString:o,dateToString:u,escapeString:a,charsRegex:t,charsMap:r,escapeObject:i,makeEscape:function(t={}){const r=t.escapeDate||u,l=t.escapeArray||s,c=t.escapeBuffer||o,h=t.escapeString||a,d=t.escapeObject||i,f=t.wrap||n;function p(t,n,i){if(null==t)return"NULL";switch(typeof t){case"boolean":return t?"true":"false";case"number":return t+"";case"object":if(!(t instanceof Date))return Array.isArray(t)?l(t,n,i):e.isBuffer(t)?c(t,n,i):d(t,n,i);t=r(t,n,i)}return h(t,n,i)}return f?f(p):p}}}).call(this,{isBuffer:function(e){return null!=e&&(Lm(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&Lm(e.slice(0,0))}(e)||!!e._isBuffer)}});var Dm=function(e,t){return e===t||e!=e&&t!=t},Fm=function(e,t){for(var r=e.length;r--;)if(Dm(e[r][0],t))return r;return-1},Um=Array.prototype.splice,Vm={};function Bm(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Bm.prototype.clear=function(){this.__data__=[],this.size=0},Bm.prototype.delete=function(e){var t=this.__data__,r=Fm(t,e);return!(r<0||(r==t.length-1?t.pop():Um.call(t,r,1),--this.size,0))},Bm.prototype.get=function(e){var t=this.__data__,r=Fm(t,e);return r<0?void 0:t[r][1]},Bm.prototype.has=function(e){return Fm(this.__data__,e)>-1},Bm.prototype.set=function(e,t){var r=this.__data__,n=Fm(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Vm=Bm;var zm={};(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;zm=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Hm,Wm="object"==typeof self&&self&&self.Object===Object&&self,Qm=zm||Wm||Function("return this")(),Jm=Qm.Symbol,Gm=Object.prototype,Km=Gm.hasOwnProperty,Zm=Gm.toString,Ym=Jm?Jm.toStringTag:void 0,Xm=Object.prototype.toString,ey=Jm?Jm.toStringTag:void 0,ty=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ey&&ey in Object(e)?function(e){var t=Km.call(e,Ym),r=e[Ym];try{e[Ym]=void 0;var n=!0}catch(CT){}var i=Zm.call(e);return n&&(t?e[Ym]=r:delete e[Ym]),i}(e):function(e){return Xm.call(e)}(e)},ry=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},ny=function(e){if(!ry(e))return!1;var t=ty(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},iy=Qm["__core-js_shared__"],sy=(Hm=/[^.]+$/.exec(iy&&iy.keys&&iy.keys.IE_PROTO||""))?"Symbol(src)_1."+Hm:"",oy=Function.prototype.toString,ay=function(e){if(null!=e){try{return oy.call(e)}catch(CT){}try{return e+""}catch(CT){}}return""},uy=/^\[object .+?Constructor\]$/,ly=Function.prototype,cy=Object.prototype,hy=ly.toString,dy=cy.hasOwnProperty,fy=RegExp("^"+hy.call(dy).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),py=function(e){return!(!ry(e)||(t=e,sy&&sy in t))&&(ny(e)?fy:uy).test(ay(e));var t},my=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return py(r)?r:void 0},yy=my(Qm,"Map"),gy=my(Object,"create"),vy=Object.prototype.hasOwnProperty,by=Object.prototype.hasOwnProperty,_y={};function wy(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}wy.prototype.clear=function(){this.__data__=gy?gy(null):{},this.size=0},wy.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},wy.prototype.get=function(e){var t=this.__data__;if(gy){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return vy.call(t,e)?t[e]:void 0},wy.prototype.has=function(e){var t=this.__data__;return gy?void 0!==t[e]:by.call(t,e)},wy.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=gy&&void 0===t?"__lodash_hash_undefined__":t,this},_y=wy;var Ey=function(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map},Cy={};function Ty(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ty.prototype.clear=function(){this.size=0,this.__data__={hash:new _y,map:new(yy||Vm),string:new _y}},Ty.prototype.delete=function(e){var t=Ey(this,e).delete(e);return this.size-=t?1:0,t},Ty.prototype.get=function(e){return Ey(this,e).get(e)},Ty.prototype.has=function(e){return Ey(this,e).has(e)},Ty.prototype.set=function(e,t){var r=Ey(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Cy=Ty;var Ny={};function ky(e){var t=this.__data__=new Vm(e);this.size=t.size}ky.prototype.clear=function(){this.__data__=new Vm,this.size=0},ky.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ky.prototype.get=function(e){return this.__data__.get(e)},ky.prototype.has=function(e){return this.__data__.has(e)},ky.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Vm){var n=r.__data__;if(!yy||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Cy(n)}return r.set(e,t),this.size=r.size,this},Ny=ky;var Oy=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Sy=function(){try{var e=my(Object,"defineProperty");return e({},"",{}),e}catch(CT){}}(),xy=function(e,t,r){"__proto__"==t&&Sy?Sy(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},$y=Object.prototype.hasOwnProperty,Ay=function(e,t,r){var n=e[t];$y.call(e,t)&&Dm(n,r)&&(void 0!==r||t in e)||xy(e,t,r)},jy=function(e,t,r,n){var i=!r;r||(r={});for(var s=-1,o=t.length;++s<o;){var a=t[s],u=n?n(r[a],e[a],a,r,e):void 0;void 0===u&&(u=e[a]),i?xy(r,a,u):Ay(r,a,u)}return r},Iy=function(e){return null!=e&&"object"==typeof e},Ry=function(e){return Iy(e)&&"[object Arguments]"==ty(e)},Py=Object.prototype,My=Py.hasOwnProperty,Ly=Py.propertyIsEnumerable,qy=Ry(function(){return arguments}())?Ry:function(e){return Iy(e)&&My.call(e,"callee")&&!Ly.call(e,"callee")},Dy=Array.isArray,Fy={exports:{}},Uy="object"==typeof Fy.exports&&Fy.exports&&!Fy.exports.nodeType&&Fy.exports,Vy=Uy&&Fy&&!Fy.nodeType&&Fy,By=Vy&&Vy.exports===Uy?Qm.Buffer:void 0,zy=(By?By.isBuffer:void 0)||function(){return!1};Fy.exports=zy,Fy=Fy.exports;var Hy,Wy=/^(?:0|[1-9]\d*)$/,Qy=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Wy.test(e))&&e>-1&&e%1==0&&e<t},Jy=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Gy={};Gy["[object Float32Array]"]=Gy["[object Float64Array]"]=Gy["[object Int8Array]"]=Gy["[object Int16Array]"]=Gy["[object Int32Array]"]=Gy["[object Uint8Array]"]=Gy["[object Uint8ClampedArray]"]=Gy["[object Uint16Array]"]=Gy["[object Uint32Array]"]=!0,Gy["[object Arguments]"]=Gy["[object Array]"]=Gy["[object ArrayBuffer]"]=Gy["[object Boolean]"]=Gy["[object DataView]"]=Gy["[object Date]"]=Gy["[object Error]"]=Gy["[object Function]"]=Gy["[object Map]"]=Gy["[object Number]"]=Gy["[object Object]"]=Gy["[object RegExp]"]=Gy["[object Set]"]=Gy["[object String]"]=Gy["[object WeakMap]"]=!1,Hy=function(e){return Iy(e)&&Jy(e.length)&&!!Gy[ty(e)]};var Ky=function(e){return function(t){return e(t)}},Zy={exports:{}},Yy="object"==typeof Zy.exports&&Zy.exports&&!Zy.exports.nodeType&&Zy.exports,Xy=Yy&&Zy&&!Zy.nodeType&&Zy,eg=Xy&&Xy.exports===Yy&&zm.process,tg=function(){try{return Xy&&Xy.require&&Xy.require("util").types||eg&&eg.binding&&eg.binding("util")}catch(CT){}}();Zy.exports=tg;var rg=(Zy=Zy.exports)&&Zy.isTypedArray,ng=rg?Ky(rg):Hy,ig=Object.prototype.hasOwnProperty,sg=function(e,t){var r=Dy(e),n=!r&&qy(e),i=!r&&!n&&Fy(e),s=!r&&!n&&!i&&ng(e),o=r||n||i||s,a=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],u=a.length;for(var l in e)!t&&!ig.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Qy(l,u))||a.push(l);return a},og=Object.prototype,ag=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||og)},ug=function(e,t){return function(r){return e(t(r))}},lg=ug(Object.keys,Object),cg=Object.prototype.hasOwnProperty,hg=function(e){if(!ag(e))return lg(e);var t=[];for(var r in Object(e))cg.call(e,r)&&"constructor"!=r&&t.push(r);return t},dg=function(e){return null!=e&&Jy(e.length)&&!ny(e)},fg=function(e){return dg(e)?sg(e):hg(e)},pg=Object.prototype.hasOwnProperty,mg=function(e){if(!ry(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=ag(e),r=[];for(var n in e)("constructor"!=n||!t&&pg.call(e,n))&&r.push(n);return r},yg=function(e){return dg(e)?sg(e,!0):mg(e)},gg={exports:{}},vg="object"==typeof gg.exports&&gg.exports&&!gg.exports.nodeType&&gg.exports,bg=vg&&gg&&!gg.nodeType&&gg,_g=bg&&bg.exports===vg?Qm.Buffer:void 0,wg=_g?_g.allocUnsafe:void 0;gg.exports=function(e,t){if(t)return e.slice();var r=e.length,n=wg?wg(r):new e.constructor(r);return e.copy(n),n},gg=gg.exports;var Eg=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},Cg=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s},Tg=function(){return[]},Ng=Object.prototype.propertyIsEnumerable,kg=Object.getOwnPropertySymbols,Og=kg?function(e){return null==e?[]:(e=Object(e),Cg(kg(e),(function(t){return Ng.call(e,t)})))}:Tg,Sg=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},xg=ug(Object.getPrototypeOf,Object),$g=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Sg(t,Og(e)),e=xg(e);return t}:Tg,Ag=function(e,t,r){var n=t(e);return Dy(e)?n:Sg(n,r(e))},jg=function(e){return Ag(e,fg,Og)},Ig=function(e){return Ag(e,yg,$g)},Rg=my(Qm,"DataView"),Pg=my(Qm,"Promise"),Mg=my(Qm,"Set"),Lg=my(Qm,"WeakMap"),qg={},Dg=ay(Rg),Fg=ay(yy),Ug=ay(Pg),Vg=ay(Mg),Bg=ay(Lg),zg=ty;(Rg&&"[object DataView]"!=zg(new Rg(new ArrayBuffer(1)))||yy&&"[object Map]"!=zg(new yy)||Pg&&"[object Promise]"!=zg(Pg.resolve())||Mg&&"[object Set]"!=zg(new Mg)||Lg&&"[object WeakMap]"!=zg(new Lg))&&(zg=function(e){var t=ty(e),r="[object Object]"==t?e.constructor:void 0,n=r?ay(r):"";if(n)switch(n){case Dg:return"[object DataView]";case Fg:return"[object Map]";case Ug:return"[object Promise]";case Vg:return"[object Set]";case Bg:return"[object WeakMap]"}return t}),qg=zg;var Hg,Wg=Object.prototype.hasOwnProperty,Qg=Qm.Uint8Array,Jg=function(e){var t=new e.constructor(e.byteLength);return new Qg(t).set(new Qg(e)),t},Gg=/\w*$/,Kg=Jm?Jm.prototype:void 0,Zg=Kg?Kg.valueOf:void 0,Yg=function(e,t){var r=t?Jg(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},Xg=function(e,t,r){var n,i,s,o=e.constructor;switch(t){case"[object ArrayBuffer]":return Jg(e);case"[object Boolean]":case"[object Date]":return new o(+e);case"[object DataView]":return function(e,t){var r=t?Jg(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Yg(e,r);case"[object Map]":case"[object Set]":return new o;case"[object Number]":case"[object String]":return new o(e);case"[object RegExp]":return(s=new(i=e).constructor(i.source,Gg.exec(i))).lastIndex=i.lastIndex,s;case"[object Symbol]":return n=e,Zg?Object(Zg.call(n)):{}}},ev=Object.create,tv=function(){function e(){}return function(t){if(!ry(t))return{};if(ev)return ev(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),rv=function(e){return"function"!=typeof e.constructor||ag(e)?{}:tv(xg(e))},nv=Zy&&Zy.isMap,iv=nv?Ky(nv):function(e){return Iy(e)&&"[object Map]"==qg(e)},sv=Zy&&Zy.isSet,ov=sv?Ky(sv):function(e){return Iy(e)&&"[object Set]"==qg(e)},av={};av["[object Arguments]"]=av["[object Array]"]=av["[object ArrayBuffer]"]=av["[object DataView]"]=av["[object Boolean]"]=av["[object Date]"]=av["[object Float32Array]"]=av["[object Float64Array]"]=av["[object Int8Array]"]=av["[object Int16Array]"]=av["[object Int32Array]"]=av["[object Map]"]=av["[object Number]"]=av["[object Object]"]=av["[object RegExp]"]=av["[object Set]"]=av["[object String]"]=av["[object Symbol]"]=av["[object Uint8Array]"]=av["[object Uint8ClampedArray]"]=av["[object Uint16Array]"]=av["[object Uint32Array]"]=!0,av["[object Error]"]=av["[object Function]"]=av["[object WeakMap]"]=!1,Hg=function e(t,r,n,i,s,o){var a,u=1&r,l=2&r,c=4&r;if(n&&(a=s?n(t,i,s,o):n(t)),void 0!==a)return a;if(!ry(t))return t;var h=Dy(t);if(h){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Wg.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!u)return Eg(t,a)}else{var d=qg(t),f="[object Function]"==d||"[object GeneratorFunction]"==d;if(Fy(t))return gg(t,u);if("[object Object]"==d||"[object Arguments]"==d||f&&!s){if(a=l||f?{}:rv(t),!u)return l?function(e,t){return jy(e,$g(e),t)}(t,function(e,t){return e&&jy(t,yg(t),e)}(a,t)):function(e,t){return jy(e,Og(e),t)}(t,function(e,t){return e&&jy(t,fg(t),e)}(a,t))}else{if(!av[d])return s?t:{};a=Xg(t,d,u)}}o||(o=new Ny);var p=o.get(t);if(p)return p;o.set(t,a),ov(t)?t.forEach((function(i){a.add(e(i,r,n,i,t,o))})):iv(t)&&t.forEach((function(i,s){a.set(s,e(i,r,n,s,t,o))}));var m=h?void 0:(c?l?Ig:jg:l?yg:fg)(t);return Oy(m||t,(function(i,s){m&&(i=t[s=i]),Ay(a,s,e(i,r,n,s,t,o))})),a};var uv,lv,cv,hv=function(e){return e},dv=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},fv=Math.max,pv=function(e){return function(){return e}},mv=Sy?function(e,t){return Sy(e,"toString",{configurable:!0,enumerable:!1,value:pv(t),writable:!0})}:hv,yv=Date.now,gv=(uv=mv,lv=0,cv=0,function(){var e=yv(),t=16-(e-cv);if(cv=e,t>0){if(++lv>=800)return arguments[0]}else lv=0;return uv.apply(void 0,arguments)}),vv=function(e,t){return gv(function(e,t,r){return t=fv(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,s=fv(n.length-t,0),o=Array(s);++i<s;)o[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(o),dv(e,this,a)}}(e,t,hv),e+"")},bv=function(e,t,r){if(!ry(r))return!1;var n=typeof t;return!!("number"==n?dg(r)&&Qy(t,r.length):"string"==n&&t in r)&&Dm(r[t],e)},_v=Object.prototype,wv=_v.hasOwnProperty,Ev=vv((function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&bv(t[0],t[1],i)&&(n=1);++r<n;)for(var s=t[r],o=yg(s),a=-1,u=o.length;++a<u;){var l=o[a],c=e[l];(void 0===c||Dm(c,_v[l])&&!wv.call(e,l))&&(e[l]=s[l])}return e})),Cv=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},Tv=function(e){return"symbol"==typeof e||Iy(e)&&"[object Symbol]"==ty(e)},Nv=Jm?Jm.prototype:void 0,kv=Nv?Nv.toString:void 0,Ov=function(e){return null==e?"":function e(t){if("string"==typeof t)return t;if(Dy(t))return Cv(t,e)+"";if(Tv(t))return kv?kv.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}(e)},Sv=0,xv=function(e){var t=++Sv;return Ov(e)+t},$v={};class Av extends Error{constructor(e){super(e),this.name="KnexTimeoutError"}}$v.KnexTimeoutError=Av,$v.timeout=function(e,t){return new Promise((function(r,n){const i=setTimeout((function(){n(new Av("operation timed out"))}),t);e.then((function(e){clearTimeout(i),r(e)}),(function(e){clearTimeout(i),n(e)}))}))};var jv={ensureConnectionCallback:function(e){e.client.emit("start",e.builder),e.builder.emit("start",e.builder);const t=e.builder.toSQL();return e.builder._debug&&e.client.logger.debug(t),Array.isArray(t)?e.queryArray(t):e.query(t)},ensureConnectionStreamCallback:function(e,t){try{const r=e.builder.toSQL();if(Array.isArray(r)&&t.hasHandler)throw new Error("The stream may only be used with a single query statement.");return e.client.stream(e.connection,r,t.stream,t.options)}catch(CT){throw t.stream.emit("error",CT),CT}}};const{KnexTimeoutError:Iv}=$v,{timeout:Rv}=$v,{ensureConnectionCallback:Pv,ensureConnectionStreamCallback:Mv}=jv;let Lv;class qv{constructor(e,t){this.client=e,this.builder=t,this.queries=[],this.connection=void 0}async run(){const e=this;try{const t=await this.ensureConnection(Pv);return e.builder.emit("end"),t}catch(t){throw e.builder._events&&e.builder._events.error&&e.builder.emit("error",t),t}}stream(e,t){const r="function"==typeof e&&1===arguments.length,n=r?{}:e,i=r?e:t,s="function"==typeof i;Lv=Lv||require("stream").Transform;const o=this.builder.queryContext();let a;const u=new Lv({objectMode:!0,transform:(e,t,r)=>{r(null,this.client.postProcessResponse(e,o))},destroy(){a&&a.destroy&&a.destroy(new Error("stream destroyed"))}});u.on("pipe",e=>{a=e});const l=this.ensureConnection(Mv,{options:n,hasHandler:s,stream:u}).catch(e=>{this.connection||u.emit("error",e)});return s?(i(u),l):u}pipe(e,t){return this.stream(t).pipe(e)}async query(e){const{__knexUid:t,__knexTxId:r}=this.connection;this.builder.emit("query",Object.assign({__knexUid:t,__knexTxId:r},e));const n=this,i=this.builder.queryContext();null!==e&&"object"==typeof e&&(e.queryContext=i);let s=this.client.query(this.connection,e);return e.timeout&&(s=Rv(s,e.timeout)),s.then(e=>this.client.processResponse(e,n)).then(n=>{const s=this.client.postProcessResponse(n,i);return this.builder.emit("query-response",s,Object.assign({__knexUid:t,__knexTxId:r},e),this.builder),this.client.emit("query-response",s,Object.assign({__knexUid:t,__knexTxId:r},e),this.builder),s}).catch(t=>{if(!(t instanceof Iv))return Promise.reject(t);const{timeout:r,sql:n,bindings:i}=e;let s;return e.cancelOnTimeout?s=this.client.cancelQuery(this.connection):(this.connection.__knex__disposed=t,s=Promise.resolve()),s.catch(e=>{throw this.connection.__knex__disposed=t,Object.assign(e,{message:`After query timeout of ${r}ms exceeded, cancelling of query failed.`,sql:n,bindings:i,timeout:r})}).then(()=>{throw Object.assign(t,{message:`Defined query timeout of ${r}ms exceeded when running query.`,sql:n,bindings:i,timeout:r})})}).catch(n=>{throw this.builder.emit("query-error",n,Object.assign({__knexUid:t,__knexTxId:r,queryContext:i},e)),n})}async queryArray(e){if(1===e.length){const t=e[0];if(!t.statementsProducer)return this.query(t);const r=await t.statementsProducer(void 0,this.connection),n=r.sql.map(e=>({sql:e,bindings:t.bindings})),i=r.pre.map(e=>({sql:e,bindings:t.bindings})),s=r.post.map(e=>({sql:e,bindings:t.bindings}));let o=[];await this.queryArray(i);try{await this.client.transaction(async e=>{const t=new qv(e.client,this.builder);if(t.connection=this.connection,o=await t.queryArray(n),r.check&&(await e.raw(r.check)).length>0)throw new Error("FOREIGN KEY constraint failed")},{connection:this.connection})}finally{await this.queryArray(s)}return o}const t=[];for(const r of e)t.push(await this.queryArray([r]));return t}async ensureConnection(e,t){if(this.builder._connection&&(this.connection=this.builder._connection),this.connection)return e(this,t);let r;try{r=await this.client.acquireConnection()}catch(error){if(!(error instanceof Iv))return Promise.reject(error);throw this.builder&&(error.sql=this.builder.sql,error.bindings=this.builder.bindings),error}try{return this.connection=r,await e(this,t)}finally{await this.client.releaseConnection(r)}}}var Dv=qv,Fv={};(function(e){Fv.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Fv.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),e.splice(n,0,t)},Fv.save=function(e){try{e?Fv.storage.setItem("debug",e):Fv.storage.removeItem("debug")}catch(error){}},Fv.load=function(){let t;try{t=Fv.storage.getItem("debug")}catch(error){}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},Fv.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},Fv.storage=function(){try{return localStorage}catch(error){}}(),Fv.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),Fv.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],Fv.log=console.debug||console.log||(()=>{}),Fv=function(e){function t(e){let n,i,s,o=null;function a(...e){if(!a.enabled)return;const r=a,i=Number(new Date),s=i-(n||i);r.diff=s,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];n=s.call(r,t),e.splice(o,1),o--}return n}),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=f({}),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}(Fv);const{formatters:t}=Fv;t.j=function(e){try{return JSON.stringify(e)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}}).call(this,require("_process"));var Uv=function(){},Vv={};(function(e){Vv=class{constructor(e){this.client=e}now(e){return"number"==typeof e?this.client.raw(`CURRENT_TIMESTAMP(${e})`):this.client.raw("CURRENT_TIMESTAMP")}uuidToBin(t,r=!0){const n=e.from(t.replace(/-/g,""),"hex");return r?e.concat([n.slice(6,8),n.slice(4,6),n.slice(0,4),n.slice(8,16)]):e.concat([n.slice(0,4),n.slice(4,6),n.slice(6,8),n.slice(8,16)])}binToUuid(t,r=!0){const n=e.from(t,"hex");return r?[n.toString("hex",4,8),n.toString("hex",2,4),n.toString("hex",0,2),n.toString("hex",8,10),n.toString("hex",10,16)].join("-"):[n.toString("hex",0,4),n.toString("hex",4,6),n.toString("hex",6,8),n.toString("hex",8,10),n.toString("hex",10,16)].join("-")}}}).call(this,require("buffer").Buffer);var Bv,zv=["with","withRecursive","withMaterialized","withNotMaterialized","select","as","columns","column","from","fromJS","fromRaw","into","withSchema","table","distinct","join","joinRaw","innerJoin","leftJoin","leftOuterJoin","rightJoin","rightOuterJoin","outerJoin","fullOuterJoin","crossJoin","where","andWhere","orWhere","whereNot","orWhereNot","whereLike","andWhereLike","orWhereLike","whereILike","andWhereILike","orWhereILike","whereRaw","whereWrapped","havingWrapped","orWhereRaw","whereExists","orWhereExists","whereNotExists","orWhereNotExists","whereIn","orWhereIn","whereNotIn","orWhereNotIn","whereNull","orWhereNull","whereNotNull","orWhereNotNull","whereBetween","whereNotBetween","andWhereBetween","andWhereNotBetween","orWhereBetween","orWhereNotBetween","groupBy","groupByRaw","orderBy","orderByRaw","union","unionAll","intersect","having","havingRaw","orHaving","orHavingRaw","offset","limit","count","countDistinct","min","max","sum","sumDistinct","avg","avgDistinct","increment","decrement","first","debug","pluck","clearSelect","clearWhere","clearGroup","clearOrder","clearHaving","insert","update","returning","del","delete","truncate","transacting","connection","jsonExtract","jsonSet","jsonInsert","jsonRemove","whereJsonObject","orWhereJsonObject","andWhereJsonObject","whereNotJsonObject","orWhereNotJsonObject","andWhereNotJsonObject","whereJsonPath","orWhereJsonPath","andWhereJsonPath","whereJsonSupersetOf","orWhereJsonSupersetOf","andWhereJsonSupersetOf","whereJsonNotSupersetOf","orWhereJsonNotSupersetOf","andWhereJsonNotSupersetOf","whereJsonSubsetOf","orWhereJsonSubsetOf","andWhereJsonSubsetOf","whereJsonNotSubsetOf","orWhereJsonNotSubsetOf","andWhereJsonNotSubsetOf"],Hv=function(e,t,r){(void 0!==r&&!Dm(e[t],r)||void 0===r&&!(t in e))&&xy(e,t,r)},Wv=function(e,t,r){for(var n=-1,i=Object(e),s=r(e),o=s.length;o--;){var a=s[Bv?o:++n];if(!1===t(i[a],a,i))break}return e},Qv=Function.prototype,Jv=Object.prototype,Gv=Qv.toString,Kv=Jv.hasOwnProperty,Zv=Gv.call(Object),Yv=function(e){if(!Iy(e)||"[object Object]"!=ty(e))return!1;var t=xg(e);if(null===t)return!0;var r=Kv.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Gv.call(r)==Zv},Xv=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},eb=function(e,t,r,n,i,s,o){var a,u=Xv(e,r),l=Xv(t,r),c=o.get(l);if(c)Hv(e,r,c);else{var h=s?s(u,l,r+"",e,t,o):void 0,d=void 0===h;if(d){var f=Dy(l),p=!f&&Fy(l),m=!f&&!p&&ng(l);h=l,f||p||m?Dy(u)?h=u:Iy(a=u)&&dg(a)?h=Eg(u):p?(d=!1,h=gg(l,!0)):m?(d=!1,h=Yg(l,!0)):h=[]:Yv(l)||qy(l)?(h=u,qy(u)?h=function(e){return jy(e,yg(e))}(u):ry(u)&&!ny(u)||(h=rv(l))):d=!1}d&&(o.set(l,h),i(h,l,n,s,o),o.delete(l)),Hv(e,r,h)}},tb=function(e){return vv((function(t,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,o=i>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,o&&bv(r[0],r[1],o)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n,s)}return t}))},rb=tb((function(e,t,r){!function e(t,r,n,i,s){t!==r&&Wv(r,(function(o,a){if(s||(s=new Ny),ry(o))eb(t,r,a,n,e,i,s);else{var u=i?i(Xv(t,a),o,a+"",t,r,s):void 0;void 0===u&&(u=o),Hv(t,a,u)}}),yg)}(e,t,r)})),nb=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s},ib=/\s/,sb=/^\s+/,ob=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&ib.test(e.charAt(t)););return t}(e)+1).replace(sb,""):e},ab=/^[-+]0x[0-9a-f]+$/i,ub=/^0b[01]+$/i,lb=/^0o[0-7]+$/i,cb=parseInt,hb=function(e){return e?1/0===(e=function(e){if("number"==typeof e)return e;if(Tv(e))return NaN;if(ry(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ry(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ob(e);var r=ub.test(e);return r||lb.test(e)?cb(e.slice(2),r?2:8):ab.test(e)?NaN:+e}(e))||-1/0===e?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},db=function(e){var t=hb(e),r=t%1;return t==t?r?t-r:t:0},fb=Math.ceil,pb=Math.max,mb=Jm?Jm.isConcatSpreadable:void 0,yb=function(e){return Dy(e)||qy(e)||!!(mb&&e&&e[mb])},gb=function(e){return null!=e&&e.length?function e(t,r,n,i,s){var o=-1,a=t.length;for(n||(n=yb),s||(s=[]);++o<a;){var u=t[o];r>0&&n(u)?r>1?e(u,r-1,n,i,s):Sg(s,u):i||(s[s.length]=u)}return s}(e,1):[]},vb={isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isUndefined:function(e){return void 0===e},isObject:function(e){return"object"==typeof e&&null!==e},isFunction:function(e){return"function"==typeof e}};const{isNumber:bb}=vb;var _b=function(e,t,r,n=1e3){let i,s=null;if(!bb(n)||n<1)throw new TypeError("Invalid chunkSize: "+n);if(!Array.isArray(r))throw new TypeError("Invalid batch: Expected array, got "+typeof r);const o=function(e,t,r){t=(r?bv(e,t,r):void 0===t)?1:pb(db(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,s=0,o=Array(fb(n/t));i<n;)o[s++]=nb(e,i,i+=t);return o}(r,n);return Object.assign(Promise.resolve().then(async()=>{return await(r=1,new Promise(e=>setTimeout(e,r))),n=async e=>{const r=[];for(const n of o)r.push(await e(t).insert(n,i));return gb(r)},s?n(s):e.transaction(n);var r,n}),{returning(e){return i=e,this},transacting(e){return s=e,this}})};const{EventEmitter:wb}=require("events"),{Migrator:Eb}=Uv,{isObject:Cb}=vb,Tb={client:{get(){return this.context.client},set(e){this.context.client=e},configurable:!0},userParams:{get(){return this.context.userParams},set(e){this.context.userParams=e},configurable:!0},schema:{get(){return this.client.schemaBuilder()},configurable:!0},migrate:{get(){return new Eb(this)},configurable:!0},seed:{get(){return new Uv(this)},configurable:!0},fn:{get(){return new Vv(this.client)},configurable:!0}},Nb=["raw","batchInsert","transaction","transactionProvider","initialize","destroy","ref","withUserParams","queryBuilder","disableProcessing","enableProcessing"];for(const Dx of Nb)Tb[Dx]={value:function(...e){return this.context[Dx](...e)},configurable:!0};function kb(e,t,r){t.listeners(e).forEach(t=>{r.on(e,t)})}function Ob(e,t){for(let n=0;n<zv.length;n++){const t=zv[n];e[t]=function(){const e=this.queryBuilder();return e[t].apply(e,arguments)}}Object.defineProperties(e,Tb),function(e){const t=e.context||{};Object.assign(t,{queryBuilder(){return this.client.queryBuilder()},raw(){return this.client.raw.apply(this.client,arguments)},batchInsert(e,t,r=1e3){return _b(this,e,t,r)},transaction(e,t){!t&&Cb(e)&&(t=e,e=null);const r=Object.assign({},t);return r.userParams=this.userParams||{},void 0===r.doNotRejectOnRollback&&(r.doNotRejectOnRollback=!0),this._transaction(e,r)},_transaction(e,t,r=null){return e?this.client.transaction(e,t,r):new Promise((e,n)=>{this.client.transaction(e,t,r).catch(n)})},transactionProvider(e){let t;return()=>(t||(t=this.transaction(void 0,e)),t)},initialize(e){return this.client.initializePool(e)},destroy(e){return this.client.destroy(e)},ref(e){return this.client.ref(e)},disableProcessing(){this.userParams.isProcessingDisabled||(this.userParams.wrapIdentifier=this.client.config.wrapIdentifier,this.userParams.postProcessResponse=this.client.config.postProcessResponse,this.client.config.wrapIdentifier=null,this.client.config.postProcessResponse=null,this.userParams.isProcessingDisabled=!0)},enableProcessing(){this.userParams.isProcessingDisabled&&(this.client.config.wrapIdentifier=this.userParams.wrapIdentifier,this.client.config.postProcessResponse=this.userParams.postProcessResponse,this.userParams.isProcessingDisabled=!1)},withUserParams(t){const r=function(e){const t=Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e)),r={},n=((e,t)=>xb(r,e,t)).bind(t);return Object.assign(n,e),n.context=r,n}(e);return this.client&&(r.client=Object.create(this.client.constructor.prototype),rb(r.client,this.client),r.client.config=Object.assign({},this.client.config)),Ob(r,r.client),kb("query",e,r),kb("query-error",e,r),kb("query-response",e,r),kb("start",e,r),r.userParams=t,r}}),e.context||(e.context=t)}(e),e.client=t,e.userParams={};const r=new wb;for(const n in r)e[n]=r[n];e._internalListeners&&e._internalListeners.forEach(({eventName:t,listener:r})=>{e.client.removeListener(t,r)}),e._internalListeners=[],Sb(e,"start",t=>{e.emit("start",t)}),Sb(e,"query",t=>{e.emit("query",t)}),Sb(e,"query-error",(t,r)=>{e.emit("query-error",t,r)}),Sb(e,"query-response",(t,r,n)=>{e.emit("query-response",t,r,n)})}function Sb(e,t,r){e.client.on(t,r),e._internalListeners.push({eventName:t,listener:r})}function xb(e,t,r){const n=e.queryBuilder();return t||e.client.logger.warn("calling knex without a tableName is deprecated. Use knex.queryBuilder() instead."),t?n.table(t,r):n}var $b=function(e){function t(e,r){return xb(t.context,e,r)}return Ob(t,e),t},Ab=Promise.prototype.finally?e=>Object.assign(e,{finally(e){return this.then().finally(e)}}):Uv,jb={};const{EventEmitter:Ib}=require("events"),{callbackify:Rb}=require("util"),{timeout:Pb,KnexTimeoutError:Mb}=$v,Lb=Fv("knex:tx"),qb=["read uncommitted","read committed","snapshot","repeatable read","serializable"];class Db extends Ib{constructor(e,t,r={userParams:{},doNotRejectOnRollback:!0},n=null){super(),this.userParams=r.userParams,this.doNotRejectOnRollback=r.doNotRejectOnRollback;const i=this.txid=xv("trx");this.client=e,this.logger=e.logger,this.outerTx=n,this.trxClient=void 0,this._completed=!1,this._debug=e.config&&e.config.debug,r.isolationLevel&&this.setIsolationLevel(r.isolationLevel),Lb("%s: Starting %s transaction",i,n?"nested":"top level"),this._lastChild=Promise.resolve();const s=(n?n._lastChild:Promise.resolve()).then(()=>this._evaluateContainer(r,t));this._promise=s.then(e=>e),n&&(n._lastChild=s.catch(()=>{}))}isCompleted(){return this._completed||this.outerTx&&this.outerTx.isCompleted()||!1}begin(e){return(this.isolationLevel?this.query(e,`SET TRANSACTION ISOLATION LEVEL ${this.isolationLevel};`):Promise.resolve()).then(()=>this.query(e,"BEGIN;"))}savepoint(e){return this.query(e,`SAVEPOINT ${this.txid};`)}commit(e,t){return this.query(e,"COMMIT;",1,t)}release(e,t){return this.query(e,`RELEASE SAVEPOINT ${this.txid};`,1,t)}setIsolationLevel(e){if(!qb.includes(e))throw new Error("Invalid isolationLevel, supported isolation levels are: "+JSON.stringify(qb));return this.isolationLevel=e,this}rollback(e,t){return Pb(this.query(e,"ROLLBACK",2,t),5e3).catch(e=>{if(!(e instanceof Mb))return Promise.reject(e);this._rejecter(t)})}rollbackTo(e,t){return Pb(this.query(e,"ROLLBACK TO SAVEPOINT "+this.txid,2,t),5e3).catch(e=>{if(!(e instanceof Mb))return Promise.reject(e);this._rejecter(t)})}query(e,t,r,n){const i=this.trxClient.query(e,t).catch(e=>{r=2,n=e,this._completed=!0,Lb("%s error running transaction query",this.txid)}).then(e=>{if(1===r&&this._resolver(n),2===r){if(void 0===n){if(this.doNotRejectOnRollback&&/^ROLLBACK\b/i.test(t))return void this._resolver();n=new Error("Transaction rejected with non-error: "+n)}this._rejecter(n)}return e});return 1!==r&&2!==r||(this._completed=!0),i}debug(e){return this._debug=!arguments.length||e,this}async _evaluateContainer(e,t){return this.acquireConnection(e,e=>{const r=this.trxClient=function(e,t,r){const n=Object.create(t.constructor.prototype);n.version=t.version,n.config=t.config,n.driver=t.driver,n.connectionSettings=t.connectionSettings,n.transacting=!0,n.valueForUndefined=t.valueForUndefined,n.logger=t.logger,n.on("start",(function(r){e.emit("start",r),t.emit("start",r)})),n.on("query",(function(r){e.emit("query",r),t.emit("query",r)})),n.on("query-error",(function(r,n){e.emit("query-error",r,n),t.emit("query-error",r,n)})),n.on("query-response",(function(r,n,i){e.emit("query-response",r,n,i),t.emit("query-response",r,n,i)}));const i=n.query;n.query=function(t,s){const o=e.isCompleted();return new Promise((function(a,u){try{if(t!==r)throw new Error("Invalid connection for transaction query.");o&&Fb(e,s),a(i.call(n,t,s))}catch(CT){u(CT)}}))};const s=n.stream;return n.stream=function(t,i,o,a){const u=e.isCompleted();return new Promise((function(l,c){try{if(t!==r)throw new Error("Invalid connection for transaction query.");u&&Fb(e,i),l(s.call(n,t,i,o,a))}catch(CT){c(CT)}}))},n.acquireConnection=function(){return Promise.resolve(r)},n.releaseConnection=function(){return Promise.resolve()},n}(this,this.client,e),n=this.client.transacting?this.savepoint(e):this.begin(e),i=new Promise((e,t)=>{this._resolver=e,this._rejecter=t});return n.then(()=>function(e,t,r){const n=$b(r);return n.context.withUserParams=()=>{throw new Error("Cannot set user params on a transaction - it can only inherit params from main knex instance")},n.isTransaction=!0,n.userParams=e.userParams||{},n.context.transaction=function(t,r){return r?void 0===r.doNotRejectOnRollback&&(r.doNotRejectOnRollback=!0):r={doNotRejectOnRollback:!0},this._transaction(t,r,e)},n.savepoint=function(e,t){return n.transaction(e,t)},e.client.transacting?(n.commit=r=>e.release(t,r),n.rollback=r=>e.rollbackTo(t,r)):(n.commit=r=>e.commit(t,r),n.rollback=r=>e.rollback(t,r)),n.isCompleted=()=>e.isCompleted(),n}(this,e,r)).then(e=>{let r;e.executionPromise=i;try{r=t(e)}catch(n){r=Promise.reject(n)}return r&&r.then&&"function"==typeof r.then&&r.then(t=>e.commit(t)).catch(t=>e.rollback(t)),null}).catch(e=>this._rejecter(e)),i})}async acquireConnection(e,t){const r=e&&e.connection,n=r||await this.client.acquireConnection();try{return n.__knexTxId=this.txid,await t(n)}finally{r?Lb("%s: not releasing external connection",this.txid):(Lb("%s: releasing connection",this.txid),this.client.releaseConnection(n))}}then(e,t){return this._promise.then(e,t)}catch(...e){return this._promise.catch(...e)}asCallback(e){return Rb(()=>this._promise)(e),this._promise}}function Fb(e,t){const r="string"==typeof t?t:t&&t.sql;throw Lb("%s: Transaction completed: %s",e.txid,r),new Error("Transaction query already complete, run with DEBUG=knex:tx for more info")}Ab(Db.prototype),jb=Db;const Ub=Fv("knex:query"),Vb=Fv("knex:bindings"),{isString:Bb}=vb;function zb(e,t,r,n){t=null==t?[]:[].concat(t);let i=0;return e.replace(/\\?\?/g,e=>{if("\\?"===e)return"?";if(i===t.length)return e;const s=t[i++];return n._escapeBinding(s,{timeZone:r})})}var Hb={enrichQueryObject:function(e,t,r){const n=Bb(t)?{sql:t}:t;n.bindings=r.prepBindings(n.bindings),n.sql=r.positionBindings(n.sql);const{__knexUid:i,__knexTxId:s}=e;var o,a;return r.emit("query",Object.assign({__knexUid:i,__knexTxId:s},n)),o=n.sql,a=s,Ub(o.replace(/%/g,"%%"),a),Vb(n.bindings,s),n},executeQuery:function(e,t,r){return r._query(e,t).catch(n=>{throw n.message=zb(t.sql,t.bindings,void 0,r)+" - "+n.message,r.emit("query-error",n,Object.assign({__knexUid:e.__knexUid,__knexTxId:e.__knexUid},t)),n})},formatQuery:zb},Wb=Object.prototype.hasOwnProperty,Qb=tb((function(e,t){if(ag(t)||dg(t))jy(t,fg(t),e);else for(var r in t)Wb.call(t,r)&&Ay(e,r,t[r])})),Jb=function(e){return Hg(e,4)},Gb=function(e,t){return e&&Wv(e,t,fg)},Kb=function(e,t){return function(r,n){if(null==r)return r;if(!dg(r))return e(r,n);for(var i=r.length,s=t?i:-1,o=Object(r);(t?s--:++s<i)&&!1!==n(o[s],s,o););return r}}(Gb),Zb=function(e,t){return(Dy(e)?Oy:Kb)(e,"function"==typeof(r=t)?r:hv);var r},Yb=Object.prototype.hasOwnProperty,Xb=function(e){if(null==e)return!0;if(dg(e)&&(Dy(e)||"string"==typeof e||"function"==typeof e.splice||Fy(e)||ng(e)||qy(e)))return!e.length;var t=qg(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(ag(e))return!hg(e).length;for(var r in e)if(Yb.call(e,r))return!1;return!0},e_=function(e,t){var r=[];return Kb(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r},t_={};function r_(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Cy;++t<r;)this.add(e[t])}r_.prototype.add=r_.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},r_.prototype.has=function(e){return this.__data__.has(e)},t_=r_;var n_=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},i_=function(e,t){return e.has(t)},s_=function(e,t,r,n,i,s){var o=1&r,a=e.length,u=t.length;if(a!=u&&!(o&&u>a))return!1;var l=s.get(e),c=s.get(t);if(l&&c)return l==t&&c==e;var h=-1,d=!0,f=2&r?new t_:void 0;for(s.set(e,t),s.set(t,e);++h<a;){var p=e[h],m=t[h];if(n)var y=o?n(m,p,h,t,e,s):n(p,m,h,e,t,s);if(void 0!==y){if(y)continue;d=!1;break}if(f){if(!n_(t,(function(e,t){if(!i_(f,t)&&(p===e||i(p,e,r,n,s)))return f.push(t)}))){d=!1;break}}else if(p!==m&&!i(p,m,r,n,s)){d=!1;break}}return s.delete(e),s.delete(t),d},o_=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r},a_=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},u_=Jm?Jm.prototype:void 0,l_=u_?u_.valueOf:void 0,c_=Object.prototype.hasOwnProperty,h_="[object Object]",d_=Object.prototype.hasOwnProperty,f_=function(e,t,r,n,i,s){var o=Dy(e),a=Dy(t),u=o?"[object Array]":qg(e),l=a?"[object Array]":qg(t),c=(u="[object Arguments]"==u?h_:u)==h_,h=(l="[object Arguments]"==l?h_:l)==h_,d=u==l;if(d&&Fy(e)){if(!Fy(t))return!1;o=!0,c=!1}if(d&&!c)return s||(s=new Ny),o||ng(e)?s_(e,t,r,n,i,s):function(e,t,r,n,i,s,o){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new Qg(e),new Qg(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Dm(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=o_;case"[object Set]":var u=1&n;if(a||(a=a_),e.size!=t.size&&!u)return!1;var l=o.get(e);if(l)return l==t;n|=2,o.set(e,t);var c=s_(a(e),a(t),n,i,s,o);return o.delete(e),c;case"[object Symbol]":if(l_)return l_.call(e)==l_.call(t)}return!1}(e,t,u,r,n,i,s);if(!(1&r)){var f=c&&d_.call(e,"__wrapped__"),p=h&&d_.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,y=p?t.value():t;return s||(s=new Ny),i(m,y,r,n,s)}}return!!d&&(s||(s=new Ny),function(e,t,r,n,i,s){var o=1&r,a=jg(e),u=a.length;if(u!=jg(t).length&&!o)return!1;for(var l=u;l--;){var c=a[l];if(!(o?c in t:c_.call(t,c)))return!1}var h=s.get(e),d=s.get(t);if(h&&d)return h==t&&d==e;var f=!0;s.set(e,t),s.set(t,e);for(var p=o;++l<u;){var m=e[c=a[l]],y=t[c];if(n)var g=o?n(y,m,c,t,e,s):n(m,y,c,e,t,s);if(!(void 0===g?m===y||i(m,y,r,n,s):g)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var v=e.constructor,b=t.constructor;v==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(f=!1)}return s.delete(e),s.delete(t),f}(e,t,r,n,i,s))},p_=function e(t,r,n,i,s){return t===r||(null==t||null==r||!Iy(t)&&!Iy(r)?t!=t&&r!=r:f_(t,r,n,i,e,s))},m_=function(e){return e==e&&!ry(e)},y_=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},g_=function(e){var t=function(e){for(var t=fg(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,m_(i)]}return t}(e);return 1==t.length&&t[0][2]?y_(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var i=r.length,s=i,o=!n;if(null==e)return!s;for(e=Object(e);i--;){var a=r[i];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<s;){var u=(a=r[i])[0],l=e[u],c=a[1];if(o&&a[2]){if(void 0===l&&!(u in e))return!1}else{var h=new Ny;if(n)var d=n(l,c,u,e,t,h);if(!(void 0===d?p_(c,l,3,n,h):d))return!1}}return!0}(r,e,t)}},v_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,b_=/^\w*$/,__=function(e,t){if(Dy(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Tv(e))||b_.test(e)||!v_.test(e)||null!=t&&e in Object(t)},w_={};function E_(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=e.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(E_.Cache||Cy),r}E_.Cache=Cy,w_=E_;var C_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,T_=/\\(\\)?/g,N_=function(e){var t=w_(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(C_,(function(e,r,n,i){t.push(n?i.replace(T_,"$1"):r||e)})),t})),k_=function(e,t){return Dy(e)?e:__(e,t)?[e]:N_(Ov(e))},O_=function(e){if("string"==typeof e||Tv(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},S_=function(e,t){for(var r=0,n=(t=k_(t,e)).length;null!=e&&r<n;)e=e[O_(t[r++])];return r&&r==n?e:void 0},x_=function(e,t){return null!=e&&t in Object(e)},$_=function(e,t,r){for(var n=-1,i=(t=k_(t,e)).length,s=!1;++n<i;){var o=O_(t[n]);if(!(s=null!=e&&r(e,o)))break;e=e[o]}return s||++n!=i?s:!!(i=null==e?0:e.length)&&Jy(i)&&Qy(o,i)&&(Dy(e)||qy(e))},A_=function(e,t){return __(e)&&m_(t)?y_(O_(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:S_(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?function(e,t){return null!=e&&$_(e,t,x_)}(r,e):p_(t,n,3)}},j_=function(e){return __(e)?(t=O_(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return S_(t,e)}}(e);var t},I_=function(e){return"function"==typeof e?e:null==e?hv:"object"==typeof e?Dy(e)?A_(e[0],e[1]):g_(e):j_(e)},R_=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},P_=function(e){var t=null==e?0:e.length;return t?nb(e,1,t):[]},M_=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),L_="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",q_="\\ud83c[\\udffb-\\udfff]",D_="[^\\ud800-\\udfff]",F_="(?:\\ud83c[\\udde6-\\uddff]){2}",U_="[\\ud800-\\udbff][\\udc00-\\udfff]",V_="(?:"+L_+"|"+q_+")?",B_="[\\ufe0e\\ufe0f]?"+V_+"(?:\\u200d(?:"+[D_,F_,U_].join("|")+")[\\ufe0e\\ufe0f]?"+V_+")*",z_="(?:"+[D_+L_+"?",L_,F_,U_,"[\\ud800-\\udfff]"].join("|")+")",H_=RegExp(q_+"(?="+q_+")|"+z_+B_,"g"),W_=function(e){return function(e){return M_.test(e)}(e)?function(e){return e.match(H_)||[]}(e):function(e){return e.split("")}(e)},Q_=function(e){return null==e?[]:function(e,t){return Cv(t,(function(t){return e[t]}))}(e,fg(e))},J_=Jm?Jm.iterator:void 0,G_=function(e){if(!e)return[];if(dg(e))return function(e){return"string"==typeof e||!Dy(e)&&Iy(e)&&"[object String]"==ty(e)}(e)?W_(e):Eg(e);if(J_&&e[J_])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[J_]());var t=qg(e);return("[object Map]"==t?o_:"[object Set]"==t?a_:Q_)(e)};const K_=Object.freeze({pg:"postgres",postgresql:"postgres",sqlite:"sqlite3"}),Z_=Object.freeze(["mssql","mysql","mysql2","oracledb","postgres","pgnative","redshift","sqlite3","cockroachdb","better-sqlite3"].concat(Object.keys(K_))),Y_=Object.freeze({MsSQL:"mssql",MySQL:"mysql",MySQL2:"mysql2",Oracle:"oracledb",PostgreSQL:"pg",PgNative:"pgnative",Redshift:"pg-redshift",SQLite:"sqlite3",CockroachDB:"cockroachdb",BetterSQLite3:"better-sqlite3"});var X_={CLIENT_ALIASES:K_,SUPPORTED_CLIENTS:Z_,POOL_CONFIG_OPTIONS:Object.freeze(["maxWaitingClients","testOnBorrow","fifo","priorityRange","autostart","evictionRunIntervalMillis","numTestsPerRun","softIdleTimeoutMillis","Promise"]),COMMA_NO_PAREN_REGEX:/,[\s](?![^(]*\))/g,DRIVER_NAMES:Y_};const{CLIENT_ALIASES:ew}=X_,{isFunction:tw}=vb;function rw(e){let t=!1;if(ng(e))return!1;if(e&&tw(e.toSQL))return t;if(Array.isArray(e))for(let r=0;r<e.length&&!t;r++)t=rw(e[r]);else Yv(e)?Object.keys(e).forEach(r=>{t||(t=rw(e[r]))}):t=void 0===e;return t}var nw={addQueryContext:function(e){e.prototype.queryContext=function(e){return void 0===e?this._queryContext:(this._queryContext=e,this)}},containsUndefined:rw,getUndefinedIndices:function(e){const t=[];return Array.isArray(e)?e.forEach((e,r)=>{rw(e)&&t.push(r)}):Yv(e)?Object.keys(e).forEach(r=>{rw(e[r])&&t.push(r)}):t.push(0),t},normalizeArr:function(...e){return Array.isArray(e[0])?e[0]:e},resolveClientNameWithAliases:function(e){return ew[e]||e},toNumber:function(e,t){if(null==e)return t;const r=parseInt(e,10);return isNaN(r)?t:r}},iw={};function sw(e,t,r,n,i){if("function"==typeof r)return{type:"onWrapped",value:r,bool:t};switch(arguments.length){case 3:return{type:"onRaw",value:r,bool:t};case 4:return{type:e,column:r,operator:"=",value:n,bool:t};default:return{type:e,column:r,operator:n,value:i,bool:t}}}class ow{constructor(e,t,r){this.schema=r,this.table=e,this.joinType=t,this.and=this,this.clauses=[]}get or(){return this._bool("or")}on(e){if("object"==typeof e&&"function"!=typeof e.toSQL){const t=Object.keys(e);let r=-1;const n="or"===this._bool()?"orOn":"on";for(;++r<t.length;)this[n](t[r],e[t[r]]);return this}const t=sw("onBasic",this._bool(),...arguments);return t&&this.clauses.push(t),this}orOn(e,t,r){return this._bool("or").on.apply(this,arguments)}onJsonPathEquals(e,t,r,n){return this.clauses.push({type:"onJsonPathEquals",columnFirst:e,jsonPathFirst:t,columnSecond:r,jsonPathSecond:n,bool:this._bool(),not:this._not()}),this}orOnJsonPathEquals(e,t,r,n){return this._bool("or").onJsonPathEquals.apply(this,arguments)}using(e){return this.clauses.push({type:"onUsing",column:e,bool:this._bool()})}onVal(e){if("object"==typeof e&&"function"!=typeof e.toSQL){const t=Object.keys(e);let r=-1;const n="or"===this._bool()?"orOnVal":"onVal";for(;++r<t.length;)this[n](t[r],e[t[r]]);return this}const t=sw("onVal",this._bool(),...arguments);return t&&this.clauses.push(t),this}andOnVal(){return this.onVal(...arguments)}orOnVal(){return this._bool("or").onVal(...arguments)}onBetween(e,t){return this.clauses.push({type:"onBetween",column:e,value:t,bool:this._bool(),not:this._not()}),this}onNotBetween(e,t){return this._not(!0).onBetween(e,t)}orOnBetween(e,t){return this._bool("or").onBetween(e,t)}orOnNotBetween(e,t){return this._bool("or")._not(!0).onBetween(e,t)}onIn(e,t){return Array.isArray(t)&&0===t.length?this.on(1,"=",0):(this.clauses.push({type:"onIn",column:e,value:t,not:this._not(),bool:this._bool()}),this)}onNotIn(e,t){return this._not(!0).onIn(e,t)}orOnIn(e,t){return this._bool("or").onIn(e,t)}orOnNotIn(e,t){return this._bool("or")._not(!0).onIn(e,t)}onNull(e){return this.clauses.push({type:"onNull",column:e,not:this._not(),bool:this._bool()}),this}orOnNull(e){return this._bool("or").onNull(e)}onNotNull(e){return this._not(!0).onNull(e)}orOnNotNull(e){return this._not(!0)._bool("or").onNull(e)}onExists(e){return this.clauses.push({type:"onExists",value:e,not:this._not(),bool:this._bool()}),this}orOnExists(e){return this._bool("or").onExists(e)}onNotExists(e){return this._not(!0).onExists(e)}orOnNotExists(e){return this._not(!0)._bool("or").onExists(e)}type(e){return this.joinType=e,this}_bool(e){if(1===arguments.length)return this._boolFlag=e,this;const t=this._boolFlag||"and";return this._boolFlag="and",t}_not(e){if(1===arguments.length)return this._notFlag=e,this;const t=this._notFlag;return this._notFlag=!1,t}}Object.assign(ow.prototype,{grouping:"join"}),ow.prototype.andOn=ow.prototype.on,ow.prototype.andOnIn=ow.prototype.onIn,ow.prototype.andOnNotIn=ow.prototype.onNotIn,ow.prototype.andOnNull=ow.prototype.onNull,ow.prototype.andOnNotNull=ow.prototype.onNotNull,ow.prototype.andOnExists=ow.prototype.onExists,ow.prototype.andOnNotExists=ow.prototype.onNotExists,ow.prototype.andOnBetween=ow.prototype.onBetween,ow.prototype.andOnNotBetween=ow.prototype.onNotBetween,ow.prototype.andOnJsonPathEquals=ow.prototype.onJsonPathEquals,iw=ow;var aw=function(e,t){e.client.config.asyncStackTraces&&(e._asyncStack={error:new Error,lines:t})};const{callbackify:uw}=require("util"),{formatQuery:lw}=Hb;var cw={augmentWithBuilderInterface:function(e){e.prototype.toQuery=function(e){let t=this.toSQL(this._method,e);return Array.isArray(t)||(t=[t]),t.length?t.map(t=>lw(t.sql,t.bindings,e,this.client)).reduce((e,t)=>e.concat(e.endsWith(";")?"\n":";\n",t)):""},e.prototype.then=function(){let e=this.client.runner(this).run();return this.client.config.asyncStackTraces&&(e=e.catch(e=>{e.originalStack=e.stack;const t=e.stack.split("\n")[0],{error:r,lines:n}=this._asyncStack,i=r.stack.split("\n").slice(n);throw i.unshift(t),e.stack=i.join("\n"),e})),e.then.apply(e,arguments)},e.prototype.options=function(e){return this._options=this._options||[],this._options.push(Jb(e)||{}),this},e.prototype.connection=function(e){return this._connection=e,this.client.processPassedConnection(e),this},e.prototype.debug=function(e){return this._debug=!arguments.length||e,this},e.prototype.transacting=function(e){if(e&&e.client&&(e.client.transacting?this.client=e.client:e.client.logger.warn("Invalid transaction value: "+e.client)),Xb(e))throw this.client.logger.error("Invalid value on transacting call, potential bug"),Error("Invalid transacting value (null, undefined or empty object)");return this},e.prototype.stream=function(e){return this.client.runner(this).stream(e)},e.prototype.pipe=function(e,t){return this.client.runner(this).pipe(e,t)},e.prototype.asCallback=function(e){const t=this.then();return uw(()=>t)(e),t},e.prototype.catch=function(e){return this.then().catch(e)},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:()=>"object"}),Ab(e.prototype)}};const{EventEmitter:hw}=require("events"),{addQueryContext:dw,normalizeArr:fw}=nw,{isBoolean:pw,isNumber:mw,isObject:yw,isString:gw,isFunction:vw}=vb,{lockMode:bw,waitMode:_w}={lockMode:{forShare:"forShare",forUpdate:"forUpdate",forNoKeyUpdate:"forNoKeyUpdate",forKeyShare:"forKeyShare"},waitMode:{skipLocked:"skipLocked",noWait:"noWait"}},{augmentWithBuilderInterface:ww}=cw,Ew=new Set(["pluck","first","select"]),Cw=new Set(["with","select","columns","hintComments","where","union","join","group","order","having","limit","offset","counter","counters"]),Tw=new Set([bw.forShare,bw.forUpdate,bw.forNoKeyUpdate,bw.forKeyShare]);class Nw extends hw{constructor(e){super(),this.client=e,this.and=this,this._single={},this._statements=[],this._method="select",e.config&&(aw(this,5),this._debug=e.config.debug),this._joinFlag="inner",this._boolFlag="and",this._notFlag=!1,this._asColumnFlag=!1}toString(){return this.toQuery()}toSQL(e,t){return this.client.queryCompiler(this).toSQL(e||this._method,t)}clone(){const e=new this.constructor(this.client);return e._method=this._method,e._single=Jb(this._single),e._statements=Jb(this._statements),e._debug=this._debug,void 0!==this._options&&(e._options=Jb(this._options)),void 0!==this._queryContext&&(e._queryContext=Jb(this._queryContext)),void 0!==this._connection&&(e._connection=this._connection),e}timeout(e,{cancel:t}={}){return mw(e)&&e>0&&(this._timeout=e,t&&(this.client.assertCanCancelQuery(),this._cancelOnTimeout=!0)),this}isValidStatementArg(e){return"function"==typeof e||e instanceof Nw||e&&e.isRawInstance}_validateWithArgs(e,t,r,n){const[i,s]=void 0===r?[t,void 0]:[r,t];if("string"!=typeof e)throw new Error(n+"() first argument must be a string");if(!this.isValidStatementArg(i)||void 0!==s){if(!(Array.isArray(s)&&s.length>0&&s.every(e=>"string"==typeof e)))throw new Error(n+"() second argument must be a statement or non-empty column name list.");if(!this.isValidStatementArg(i))throw new Error(n+"() third argument must be a function / QueryBuilder or a raw when its second argument is a column name list")}}with(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r)}withMaterialized(e,t,r){throw new Error("With materialized is not supported by this dialect")}withNotMaterialized(e,t,r){throw new Error("With materialized is not supported by this dialect")}withWrapped(e,t,r,n){const[i,s]=void 0===r?[t,void 0]:[r,t],o={grouping:"with",type:"withWrapped",alias:e,columnList:s,value:i};return void 0!==n&&(o.materialized=n),this._statements.push(o),this}withRecursive(e,t,r){return this._validateWithArgs(e,t,r,"withRecursive"),this.withRecursiveWrapped(e,t,r)}withRecursiveWrapped(e,t,r){return this.withWrapped(e,t,r),this._statements[this._statements.length-1].recursive=!0,this}columns(e){return e||0===e?(this._statements.push({grouping:"columns",value:fw(...arguments)}),this):this}as(e){return this._single.as=e,this}hintComment(e){if((e=Array.isArray(e)?e:[e]).some(e=>!gw(e)))throw new Error("Hint comment must be a string");if(e.some(e=>e.includes("/*")||e.includes("*/")))throw new Error('Hint comment cannot include "/*" or "*/"');if(e.some(e=>e.includes("?")))throw new Error('Hint comment cannot include "?"');return this._statements.push({grouping:"hintComments",value:e}),this}withSchema(e){return this._single.schema=e,this}table(e,t={}){return this._single.table=e,this._single.only=!0===t.only,this}distinct(...e){return this._statements.push({grouping:"columns",value:fw(...e),distinct:!0}),this}distinctOn(...e){if(Xb(e))throw new Error("distinctOn requires at least on argument");return this._statements.push({grouping:"columns",value:fw(...e),distinctOn:!0}),this}join(e,t,...r){let n;const i=e instanceof Nw||"function"==typeof e?void 0:this._single.schema,s=this._joinType();return"function"==typeof t?(n=new iw(e,s,i),t.call(n,n)):"raw"===s?n=new iw(this.client.raw(e,t),"raw"):(n=new iw(e,s,i),t&&n.on(t,...r)),this._statements.push(n),this}using(e){throw new Error("'using' function is only available in PostgreSQL dialect with Delete statements.")}innerJoin(...e){return this._joinType("inner").join(...e)}leftJoin(...e){return this._joinType("left").join(...e)}leftOuterJoin(...e){return this._joinType("left outer").join(...e)}rightJoin(...e){return this._joinType("right").join(...e)}rightOuterJoin(...e){return this._joinType("right outer").join(...e)}outerJoin(...e){return this._joinType("outer").join(...e)}fullOuterJoin(...e){return this._joinType("full outer").join(...e)}crossJoin(...e){return this._joinType("cross").join(...e)}joinRaw(...e){return this._joinType("raw").join(...e)}get or(){return this._bool("or")}get not(){return this._not(!0)}where(e,t,r){const n=arguments.length;if(!1===e||!0===e)return this.where(1,"=",e?1:0);if("function"==typeof e)return this.whereWrapped(e);if(yw(e)&&!e.isRawInstance)return this._objectWhere(e);if(e&&e.isRawInstance&&1===n)return this.whereRaw(e);if(2===n&&(r=t,t="=",null===r))return this.whereNull(e);const i=(""+t).toLowerCase().trim();if(3===n){if("in"===i||"not in"===i)return this._not("not in"===i).whereIn(e,r);if("between"===i||"not between"===i)return this._not("not between"===i).whereBetween(e,r)}return null!==r||"is"!==i&&"is not"!==i?(this._statements.push({grouping:"where",type:"whereBasic",column:e,operator:t,value:r,not:this._not(),bool:this._bool(),asColumn:this._asColumnFlag}),this):this._not("is not"===i).whereNull(e)}whereColumn(...e){return this._asColumnFlag=!0,this.where(...e),this._asColumnFlag=!1,this}orWhere(e,...t){this._bool("or");const r=e;return yw(r)&&!r.isRawInstance?this.whereWrapped((function(){for(const e in r)this.andWhere(e,r[e])})):this.where(e,...t)}orWhereColumn(e,...t){this._bool("or");const r=e;return yw(r)&&!r.isRawInstance?this.whereWrapped((function(){for(const e in r)this.andWhereColumn(e,"=",r[e])})):this.whereColumn(e,...t)}whereNot(e,...t){return t.length>=2&&("in"!==t[0]&&"between"!==t[0]||this.client.logger.warn('whereNot is not suitable for "in" and "between" type subqueries. You should use "not in" and "not between" instead.')),this._not(!0).where(e,...t)}whereNotColumn(...e){return this._not(!0).whereColumn(...e)}orWhereNot(...e){return this._bool("or").whereNot(...e)}orWhereNotColumn(...e){return this._bool("or").whereNotColumn(...e)}_objectWhere(e){const t=this._bool(),r=this._not()?"Not":"";for(const n in e)this[t+"Where"+r](n,e[n]);return this}whereRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"where",type:"whereRaw",value:r,not:this._not(),bool:this._bool()}),this}orWhereRaw(e,t){return this._bool("or").whereRaw(e,t)}whereWrapped(e){return this._statements.push({grouping:"where",type:"whereWrapped",value:e,not:this._not(),bool:this._bool()}),this}whereExists(e){return this._statements.push({grouping:"where",type:"whereExists",value:e,not:this._not(),bool:this._bool()}),this}orWhereExists(e){return this._bool("or").whereExists(e)}whereNotExists(e){return this._not(!0).whereExists(e)}orWhereNotExists(e){return this._bool("or").whereNotExists(e)}whereIn(e,t){return Array.isArray(t)&&Xb(t)?this.where(this._not()):(this._statements.push({grouping:"where",type:"whereIn",column:e,value:t,not:this._not(),bool:this._bool()}),this)}orWhereIn(e,t){return this._bool("or").whereIn(e,t)}whereNotIn(e,t){return this._not(!0).whereIn(e,t)}orWhereNotIn(e,t){return this._bool("or")._not(!0).whereIn(e,t)}whereNull(e){return this._statements.push({grouping:"where",type:"whereNull",column:e,not:this._not(),bool:this._bool()}),this}orWhereNull(e){return this._bool("or").whereNull(e)}whereNotNull(e){return this._not(!0).whereNull(e)}orWhereNotNull(e){return this._bool("or").whereNotNull(e)}whereBetween(e,t){return this._statements.push({grouping:"where",type:"whereBetween",column:e,value:t,not:this._not(),bool:this._bool()}),this}whereNotBetween(e,t){return this._not(!0).whereBetween(e,t)}orWhereBetween(e,t){return this._bool("or").whereBetween(e,t)}orWhereNotBetween(e,t){return this._bool("or").whereNotBetween(e,t)}_whereLike(e,t,r){return this._statements.push({grouping:"where",type:e,column:t,value:r,not:this._not(),bool:this._bool(),asColumn:this._asColumnFlag}),this}whereLike(e,t){return this._whereLike("whereLike",e,t)}orWhereLike(e,t){return this._bool("or")._whereLike("whereLike",e,t)}whereILike(e,t){return this._whereLike("whereILike",e,t)}orWhereILike(e,t){return this._bool("or")._whereLike("whereILike",e,t)}groupBy(e){return e&&e.isRawInstance?this.groupByRaw.apply(this,arguments):(this._statements.push({grouping:"group",type:"groupByBasic",value:fw(...arguments)}),this)}groupByRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"group",type:"groupByRaw",value:r}),this}orderBy(e,t,r=""){return Array.isArray(e)?this._orderByArray(e):(this._statements.push({grouping:"order",type:"orderByBasic",value:e,direction:t,nulls:r}),this)}_orderByArray(e){for(let t=0;t<e.length;t++){const r=e[t];yw(r)?this._statements.push({grouping:"order",type:"orderByBasic",value:r.column,direction:r.order,nulls:r.nulls}):gw(r)&&this._statements.push({grouping:"order",type:"orderByBasic",value:r})}return this}orderByRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"order",type:"orderByRaw",value:r}),this}_union(e,t){let r=t[0],n=t[1];if(1===t.length||2===t.length&&pw(n)){Array.isArray(r)||(r=[r]);for(let t=0,i=r.length;t<i;t++)this._statements.push({grouping:"union",clause:e,value:r[t],wrap:n||!1})}else r=G_(t).slice(0,t.length-1),n=t[t.length-1],pw(n)||(r.push(n),n=!1),this._union(e,[r,n]);return this}union(...e){return this._union("union",e)}unionAll(...e){return this._union("union all",e)}intersect(e,t){if(1===arguments.length||2===arguments.length&&pw(t)){Array.isArray(e)||(e=[e]);for(let r=0,n=e.length;r<n;r++)this._statements.push({grouping:"union",clause:"intersect",value:e[r],wrap:t||!1})}else e=G_(arguments).slice(0,arguments.length-1),pw(t=arguments[arguments.length-1])||(e.push(t),t=!1),this.intersect(e,t);return this}having(e,t,r){return e.isRawInstance&&1===arguments.length?this.havingRaw(e):"function"==typeof e?this.havingWrapped(e):(this._statements.push({grouping:"having",type:"havingBasic",column:e,operator:t,value:r,bool:this._bool(),not:this._not()}),this)}orHaving(e,...t){this._bool("or");const r=e;return yw(r)&&!r.isRawInstance?this.havingWrapped((function(){for(const e in r)this.andHaving(e,r[e])})):this.having(e,...t)}havingWrapped(e){return this._statements.push({grouping:"having",type:"havingWrapped",value:e,bool:this._bool(),not:this._not()}),this}havingNull(e){return this._statements.push({grouping:"having",type:"havingNull",column:e,not:this._not(),bool:this._bool()}),this}orHavingNull(e){return this._bool("or").havingNull(e)}havingNotNull(e){return this._not(!0).havingNull(e)}orHavingNotNull(e){return this._not(!0)._bool("or").havingNull(e)}havingExists(e){return this._statements.push({grouping:"having",type:"havingExists",value:e,not:this._not(),bool:this._bool()}),this}orHavingExists(e){return this._bool("or").havingExists(e)}havingNotExists(e){return this._not(!0).havingExists(e)}orHavingNotExists(e){return this._not(!0)._bool("or").havingExists(e)}havingBetween(e,t){return this._statements.push({grouping:"having",type:"havingBetween",column:e,value:t,not:this._not(),bool:this._bool()}),this}orHavingBetween(e,t){return this._bool("or").havingBetween(e,t)}havingNotBetween(e,t){return this._not(!0).havingBetween(e,t)}orHavingNotBetween(e,t){return this._not(!0)._bool("or").havingBetween(e,t)}havingIn(e,t){return Array.isArray(t)&&Xb(t)?this.where(this._not()):(this._statements.push({grouping:"having",type:"havingIn",column:e,value:t,not:this._not(),bool:this._bool()}),this)}orHavingIn(e,t){return this._bool("or").havingIn(e,t)}havingNotIn(e,t){return this._not(!0).havingIn(e,t)}orHavingNotIn(e,t){return this._bool("or")._not(!0).havingIn(e,t)}havingRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this._statements.push({grouping:"having",type:"havingRaw",value:r,bool:this._bool(),not:this._not()}),this}orHavingRaw(e,t){return this._bool("or").havingRaw(e,t)}_setSkipBinding(e,t){let r=t;yw(t)&&(r=t.skipBinding),this._single.skipBinding=this._single.skipBinding||{},this._single.skipBinding[e]=r}offset(e,t){if(null==e||e.isRawInstance||e instanceof Nw)this._single.offset=e;else{const t=parseInt(e,10);if(isNaN(t))this.client.logger.warn("A valid integer must be provided to offset");else{if(t<0)throw new Error("A non-negative integer must be provided to offset.");this._single.offset=t}}return this._setSkipBinding("offset",t),this}limit(e,t){const r=parseInt(e,10);return isNaN(r)?this.client.logger.warn("A valid integer must be provided to limit"):(this._single.limit=r,this._setSkipBinding("limit",t)),this}count(e,t){return this._aggregate("count",e||"*",t)}min(e,t){return this._aggregate("min",e,t)}max(e,t){return this._aggregate("max",e,t)}sum(e,t){return this._aggregate("sum",e,t)}avg(e,t){return this._aggregate("avg",e,t)}countDistinct(...e){let t;return e.length>1&&Yv((n=null==(r=e)?0:r.length)?r[n-1]:void 0)&&([t]=e.splice(e.length-1,1)),e.length?1===e.length&&(e=e[0]):e="*",this._aggregate("count",e,{...t,distinct:!0});var r,n}sumDistinct(e,t){return this._aggregate("sum",e,{...t,distinct:!0})}avgDistinct(e,t){return this._aggregate("avg",e,{...t,distinct:!0})}increment(e,t=1){if(yw(e)){for(const t in e)this._counter(t,e[t]);return this}return this._counter(e,t)}decrement(e,t=1){if(yw(e)){for(const t in e)this._counter(t,-e[t]);return this}return this._counter(e,-t)}clearCounters(){return this._single.counter={},this}first(...e){if(this._method&&"select"!==this._method)throw new Error(`Cannot chain .first() on "${this._method}" query`);return this.select(fw(...e)),this._method="first",this.limit(1),this}connection(e){return this._connection=e,this.client.processPassedConnection(e),this}pluck(e){if(this._method&&"select"!==this._method)throw new Error(`Cannot chain .pluck() on "${this._method}" query`);return this._method="pluck",this._single.pluck=e,this._statements.push({grouping:"columns",type:"pluck",value:e}),this}clearSelect(){return this._clearGrouping("columns"),this}clearWhere(){return this._clearGrouping("where"),this}clearGroup(){return this._clearGrouping("group"),this}clearOrder(){return this._clearGrouping("order"),this}clearHaving(){return this._clearGrouping("having"),this}clear(e){if(!Cw.has(e))throw new Error(`Knex Error: unknown statement '${e}'`);return e.startsWith("counter")?this.clearCounters():("select"===e&&(e="columns"),this._clearGrouping(e),this)}insert(e,t,r){return this._method="insert",Xb(t)||this.returning(t,r),this._single.insert=e,this}update(e,t,r){let n;const i=this._single.update||{};if(this._method="update",gw(e))Yv(t)?i[e]=JSON.stringify(t):i[e]=t,arguments.length>2&&(n=arguments[2]);else{const t=Object.keys(e);this._single.update&&this.client.logger.warn("Update called multiple times with objects.");let r=-1;for(;++r<t.length;)i[t[r]]=e[t[r]];n=arguments[1]}return Xb(n)||this.returning(n,r),this._single.update=i,this}returning(e,t){return this._single.returning=e,this._single.options=t,this}onConflict(e){return"string"==typeof e&&(e=[e]),new kw(this,e||!0)}delete(e,t){return this._method="del",Xb(e)||this.returning(e,t),this}truncate(e){return this._method="truncate",e&&(this._single.table=e),this}columnInfo(e){return this._method="columnInfo",this._single.columnInfo=e,this}forUpdate(...e){return this._single.lock=bw.forUpdate,1===e.length&&Array.isArray(e[0])?this._single.lockTables=e[0]:this._single.lockTables=e,this}forShare(...e){return this._single.lock=bw.forShare,this._single.lockTables=e,this}forNoKeyUpdate(...e){return this._single.lock=bw.forNoKeyUpdate,this._single.lockTables=e,this}forKeyShare(...e){return this._single.lock=bw.forKeyShare,this._single.lockTables=e,this}skipLocked(){if(!this._isSelectQuery())throw new Error(`Cannot chain .skipLocked() on "${this._method}" query!`);if(!this._hasLockMode())throw new Error(".skipLocked() can only be used after a call to .forShare() or .forUpdate()!");if(this._single.waitMode===_w.noWait)throw new Error(".skipLocked() cannot be used together with .noWait()!");return this._single.waitMode=_w.skipLocked,this}noWait(){if(!this._isSelectQuery())throw new Error(`Cannot chain .noWait() on "${this._method}" query!`);if(!this._hasLockMode())throw new Error(".noWait() can only be used after a call to .forShare() or .forUpdate()!");if(this._single.waitMode===_w.skipLocked)throw new Error(".noWait() cannot be used together with .skipLocked()!");return this._single.waitMode=_w.noWait,this}fromJS(e){return Zb(e,(e,t)=>{"function"!=typeof this[t]&&this.client.logger.warn("Knex Error: unknown key "+t),Array.isArray(e)?this[t].apply(this,e):this[t](e)}),this}fromRaw(e,t){const r=e.isRawInstance?e:this.client.raw(e,t);return this.from(r)}modify(e){return e.apply(this,[this].concat(P_(arguments))),this}upsert(e,t,r){throw new Error("Upsert is not yet supported for dialect "+this.client.dialect)}_json(e,t){return this._statements.push({grouping:"columns",type:"json",method:e,params:t}),this}jsonExtract(){const e=arguments[0];let t,r,n=!0;return arguments.length>=2&&(t=arguments[1]),arguments.length>=3&&(r=arguments[2]),4===arguments.length&&(n=arguments[3]),2===arguments.length&&Array.isArray(arguments[0])&&pw(arguments[1])&&(n=arguments[1]),this._json("jsonExtract",{column:e,path:t,alias:r,singleValue:n})}jsonSet(e,t,r,n){return this._json("jsonSet",{column:e,path:t,value:r,alias:n})}jsonInsert(e,t,r,n){return this._json("jsonInsert",{column:e,path:t,value:r,alias:n})}jsonRemove(e,t,r){return this._json("jsonRemove",{column:e,path:t,alias:r})}_isJsonObject(e){return yw(e)&&!(e instanceof Nw)}_whereJsonWrappedValue(e,t,r){const n={grouping:"where",type:e,column:t,value:r,not:this._not(),bool:this._bool(),asColumn:this._asColumnFlag};arguments[3]&&(n.operator=arguments[3]),arguments[4]&&(n.jsonPath=arguments[4]),this._statements.push(n)}whereJsonObject(e,t){return this._whereJsonWrappedValue("whereJsonObject",e,t),this}orWhereJsonObject(e,t,r){return this._bool("or").whereJsonObject(e,t,r)}whereNotJsonObject(e,t){return this._not(!0)._whereJsonWrappedValue("whereJsonObject",e,t),this}orWhereNotJsonObject(e,t,r){return this._not(!0)._bool("or").whereJsonObject(e,t,r)}whereJsonPath(e,t,r,n){return this._whereJsonWrappedValue("whereJsonPath",e,n,r,t),this}orWhereJsonPath(e,t,r,n){return this._bool("or").whereJsonPath(e,t,r,n)}whereJsonSupersetOf(e,t){return this._whereJsonWrappedValue("whereJsonSupersetOf",e,t),this}whereJsonNotSupersetOf(e,t){return this._not(!0).whereJsonSupersetOf(e,t),this}orWhereJsonSupersetOf(e,t){return this._whereJsonWrappedValue("whereJsonSupersetOf",e,t),this}orWhereJsonNotSupersetOf(e,t){return this._not(!0)._bool("or").whereJsonSupersetOf(e,t),this}whereJsonSubsetOf(e,t){return this._whereJsonWrappedValue("whereJsonSubsetOf",e,t),this}whereJsonNotSubsetOf(e,t){return this._not(!0).whereJsonSubsetOf(e,t),this}orWhereJsonSubsetOf(e,t){return this._whereJsonWrappedValue("whereJsonSubsetOf",e,t),this}orWhereJsonNotSubsetOf(e,t){return this._not(!0)._bool("or").whereJsonSubsetOf(e,t),this}whereJsonHasNone(e,t){return this._not(!0).whereJsonHasAll(e,t),this}_analytic(e,t,r){let n;const{schema:i}=this._single,s=this._analyticMethod();if(e="string"==typeof e?e:null,vw(t))n=new class{constructor(e,t,r,n,i){this.schema=t,this.type="analytic",this.method=e,this.order=n||[],this.partitions=i||[],this.alias=r,this.and=this,this.grouping="columns"}partitionBy(e,t){return Array.isArray(e)?this.partitions=this.partitions.concat(e):this.partitions.push({column:e,order:t}),this}orderBy(e,t){return Array.isArray(e)?this.order=this.order.concat(e):this.order.push({column:e,order:t}),this}}(s,i,e),t.call(n,n);else if(t.isRawInstance)n={grouping:"columns",type:"analytic",method:s,raw:t,alias:e};else{const i=Array.isArray(t)?t:[t];let o=r||[];o=Array.isArray(o)?o:[o],n={grouping:"columns",type:"analytic",method:s,order:i,alias:e,partitions:o}}return this._statements.push(n),this}rank(...e){return this._analyticMethod("rank")._analytic(...e)}denseRank(...e){return this._analyticMethod("dense_rank")._analytic(...e)}rowNumber(...e){return this._analyticMethod("row_number")._analytic(...e)}_counter(e,t){return t=parseFloat(t),this._method="update",this._single.counter=this._single.counter||{},this._single.counter[e]=t,this}_bool(e){if(1===arguments.length)return this._boolFlag=e,this;const t=this._boolFlag;return this._boolFlag="and",t}_not(e){if(1===arguments.length)return this._notFlag=e,this;const t=this._notFlag;return this._notFlag=!1,t}_joinType(e){if(1===arguments.length)return this._joinFlag=e,this;const t=this._joinFlag||"inner";return this._joinFlag="inner",t}_analyticMethod(e){return 1===arguments.length?(this._analyticFlag=e,this):this._analyticFlag||"row_number"}_aggregate(e,t,r={}){return this._statements.push({grouping:"columns",type:t.isRawInstance?"aggregateRaw":"aggregate",method:e,value:t,aggregateDistinct:r.distinct||!1,alias:r.as}),this}_clearGrouping(e){var t,r;e in this._single?this._single[e]=void 0:this._statements=(t=this._statements,r={grouping:e},(Dy(t)?Cg:e_)(t,R_(I_(r))))}_isSelectQuery(){return Ew.has(this._method)}_hasLockMode(){return Tw.has(this._single.lock)}}Nw.prototype.select=Nw.prototype.columns,Nw.prototype.column=Nw.prototype.columns,Nw.prototype.andWhereNot=Nw.prototype.whereNot,Nw.prototype.andWhereNotColumn=Nw.prototype.whereNotColumn,Nw.prototype.andWhere=Nw.prototype.where,Nw.prototype.andWhereColumn=Nw.prototype.whereColumn,Nw.prototype.andWhereRaw=Nw.prototype.whereRaw,Nw.prototype.andWhereBetween=Nw.prototype.whereBetween,Nw.prototype.andWhereNotBetween=Nw.prototype.whereNotBetween,Nw.prototype.andWhereJsonObject=Nw.prototype.whereJsonObject,Nw.prototype.andWhereNotJsonObject=Nw.prototype.whereJsonObject,Nw.prototype.andWhereJsonPath=Nw.prototype.whereJsonPath,Nw.prototype.andWhereLike=Nw.prototype.whereLike,Nw.prototype.andWhereILike=Nw.prototype.whereILike,Nw.prototype.andHaving=Nw.prototype.having,Nw.prototype.andHavingIn=Nw.prototype.havingIn,Nw.prototype.andHavingNotIn=Nw.prototype.havingNotIn,Nw.prototype.andHavingNull=Nw.prototype.havingNull,Nw.prototype.andHavingNotNull=Nw.prototype.havingNotNull,Nw.prototype.andHavingExists=Nw.prototype.havingExists,Nw.prototype.andHavingNotExists=Nw.prototype.havingNotExists,Nw.prototype.andHavingBetween=Nw.prototype.havingBetween,Nw.prototype.andHavingNotBetween=Nw.prototype.havingNotBetween,Nw.prototype.from=Nw.prototype.table,Nw.prototype.into=Nw.prototype.table,Nw.prototype.del=Nw.prototype.delete,ww(Nw),dw(Nw),Nw.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(Nw.prototype,e))throw new Error(`Can't extend QueryBuilder with existing method ('${e}').`);Qb(Nw.prototype,{[e]:t})};class kw{constructor(e,t){this.builder=e,this._columns=t}ignore(){return this.builder._single.onConflict=this._columns,this.builder._single.ignore=!0,this.builder}merge(e){return this.builder._single.onConflict=this._columns,this.builder._single.merge={updates:e},this.builder}then(){throw new Error("Incomplete onConflict clause. .onConflict() must be directly followed by either .merge() or .ignore()")}}var Ow=Nw,Sw=function(e,t,r,n){var i=-1,s=null==e?0:e.length;for(n&&s&&(r=e[++i]);++i<s;)r=t(r,e[i],i,e);return r},xw=function(e,t,r,n,i){return i(e,(function(e,i,s){r=n?(n=!1,e):t(r,e,i,s)})),r},$w=function(e,t,r){var n=Dy(e)?Sw:xw,i=arguments.length<3;return n(e,I_(t),r,i,Kb)};const{isObject:Aw}=vb;var jw={compileCallback:function(e,t,r,n){const i=r.queryBuilder();return e.call(i,i),r.queryCompiler(i,n.bindings).toSQL(t||i._method||"select")},wrapAsIdentifier:function(e,t,r){const n=t.queryContext();return r.wrapIdentifier((e||"").trim(),n)},formatDefault:function(e,t,r){return void 0===e?"":null===e?"null":e&&e.isRawInstance?e.toQuery():"bool"===t?("false"===e&&(e=0),`'${e?1:0}'`):"json"!==t&&"jsonb"!==t||!Aw(e)?r._escapeBinding(e.toString()):`'${JSON.stringify(e)}'`}};const{compileCallback:Iw,wrapAsIdentifier:Rw}=jw,Pw=["asc","desc"],Mw=function(e,t,r){var n=Dy(e),i=n||Fy(e)||ng(e);if(t=I_(t),null==r){var s=e&&e.constructor;r=i?n?new s:[]:ry(e)&&ny(s)?tv(xg(e)):{}}return(i?Oy:Gb)(e,(function(e,n,i){return t(r,e,n,i)})),r}(["=","<",">","<=",">=","<>","!=","like","not like","between","not between","ilike","not ilike","exists","not exist","rlike","not rlike","regexp","not regexp","match","&","|","^","<<",">>","~","~=","~*","!~","!~*","#","&&","@>","<@","||","&<","&>","-|-","@@","!!",["?","\\?"],["?|","\\?|"],["?&","\\?&"]],(e,t)=>{Array.isArray(t)?e[t[0]]=t[1]:e[t]=t},{});function Lw(e,t,r,n,i){const s=qw(e,t,r,n,i);if(s)return s;switch(typeof e){case"function":return Fw(Iw(e,void 0,n,i),!0,r,n);case"object":return function(e,t,r,n){const i=[];for(const s in e){const o=e[s];if("function"==typeof o){const e=Iw(o,void 0,r,n);e.as=s,i.push(Fw(e,!0,t,r))}else o instanceof Ow?i.push(r.alias(`(${Lw(o,void 0,t,r,n)})`,Rw(s,t,r))):i.push(r.alias(Lw(o,void 0,t,r,n),Rw(s,t,r)))}return i.join(", ")}(e,r,n,i);case"number":return e;default:return Dw(e+"",r,n)}}function qw(e,t,r,n,i){let s;return e instanceof Ow?(s=n.queryCompiler(e).toSQL(),s.bindings&&i.bindings.push(...s.bindings),Fw(s,t,r,n)):e&&e.isRawInstance?(e.client=n,r._queryContext&&(e.queryContext=()=>r._queryContext),s=e.toSQL(),s.bindings&&i.bindings.push(...s.bindings),s.sql):void(t&&i.bindings.push(e))}function Dw(e,t,r){const n=e.toLowerCase().indexOf(" as ");if(-1!==n){const i=e.slice(0,n),s=e.slice(n+4);return r.alias(Dw(i,t,r),Rw(s,t,r))}const i=[];let s=-1;const o=e.split(".");for(;++s<o.length;)e=o[s],0===s&&o.length>1?i.push(Dw((e||"").trim(),t,r)):i.push(Rw(e,t,r));return i.join(".")}function Fw(e,t,r,n){let i=e.sql||"";return i&&("select"===e.method||"first"===e.method)&&(t||e.as)&&(i=`(${i})`,e.as)?n.alias(i,Dw(e.as,r,n)):i}var Uw={columnize:function(e,t,r,n){const i=Array.isArray(e)?e:[e];let s="",o=-1;for(;++o<i.length;)o>0&&(s+=", "),s+=Lw(i[o],void 0,t,r,n);return s},direction:function(e,t,r,n){return qw(e,void 0,t,r,n)||(-1!==Pw.indexOf((e||"").toLowerCase())?e:"asc")},operator:function(e,t,r,n){const i=qw(e,void 0,t,r,n);if(i)return i;const s=Mw[(e||"").toLowerCase()];if(!s)throw new TypeError(`The operator "${e}" is not permitted`);return s},outputQuery:Fw,rawOrFn:function(e,t,r,n,i){return"function"==typeof e?Fw(Iw(e,t,n,i),void 0,r,n):qw(e,void 0,r,n,i)||""},unwrapRaw:qw,wrap:Lw,wrapString:Dw};const{columnize:Vw}=Uw;var Bw={replaceKeyBindings:function(e,t){const r={bindings:[]},n=e,i=e.bindings;return{method:"raw",sql:e.sql.replace(/\\?(:(\w+):(?=::)|:(\w+):(?!:)|:(\w+))/g,(function(e,s,o,a,u){if(e!==s)return s;const l=o||a||u,c=e.trim(),h=":"===c[c.length-1],d=i[l];return void 0===d?(Object.prototype.hasOwnProperty.call(i,l)&&r.bindings.push(d),e):h?e.replace(s,Vw(d,n,t,r)):e.replace(s,t.parameter(d,n,r))})),bindings:r.bindings}},replaceRawArrBindings:function(e,t){const r={bindings:[]},n=e,i=e.bindings.length,s=e.bindings;let o=0;const a=e.sql.replace(/\\?\?\??/g,(function(e){if("\\?"===e)return e;const i=s[o++];return"??"===e?Vw(i,n,t,r):t.parameter(i,n,r)}));if(i!==o)throw new Error(`Expected ${i} bindings, saw ${o}`);return{method:"raw",sql:a,bindings:r.bindings}}},zw={nanoid:function(e=21){let t="",r=e;for(;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},nanonum:function(e=21){let t="",r=e;for(;r--;)t+="0123456789"[10*Math.random()|0];return t}},Hw={};const{EventEmitter:Ww}=require("events"),{replaceRawArrBindings:Qw,replaceKeyBindings:Jw}=Bw,{nanoid:Gw}=zw,{isNumber:Kw,isObject:Zw}=vb,{augmentWithBuilderInterface:Yw}=cw,Xw=Fv("knex:bindings");class eE extends Ww{constructor(e){super(),this.client=e,this.sql="",this.bindings=[],this._wrappedBefore=void 0,this._wrappedAfter=void 0,e&&e.config&&(this._debug=e.config.debug,aw(this,4))}set(e,t){return this.sql=e,this.bindings=Zw(t)&&!t.toSQL||void 0===t?t:[t],this}timeout(e,{cancel:t}={}){return Kw(e)&&e>0&&(this._timeout=e,t&&(this.client.assertCanCancelQuery(),this._cancelOnTimeout=!0)),this}wrap(e,t){return this._wrappedBefore=e,this._wrappedAfter=t,this}toString(){return this.toQuery()}toSQL(e,t){let r;if(r=Array.isArray(this.bindings)?Qw(this,this.client):this.bindings&&Yv(this.bindings)?Jw(this,this.client):{method:"raw",sql:this.sql,bindings:void 0===this.bindings?[]:[this.bindings]},this._wrappedBefore&&(r.sql=this._wrappedBefore+r.sql),this._wrappedAfter&&(r.sql=r.sql+this._wrappedAfter),r.options=$w(this._options,Qb,{}),this._timeout&&(r.timeout=this._timeout,this._cancelOnTimeout&&(r.cancelOnTimeout=this._cancelOnTimeout)),r.bindings=r.bindings||[],nw.containsUndefined(r.bindings)){const e=nw.getUndefinedIndices(this.bindings);throw Xw(r.bindings),new Error(`Undefined binding(s) detected for keys [${e}] when compiling RAW query: ${r.sql}`)}return r.__knexQueryUid=Gw(),Object.defineProperties(r,{toNative:{value:()=>({sql:this.client.positionBindings(r.sql),bindings:this.client.prepBindings(r.bindings)}),enumerable:!1}}),r}}eE.prototype.isRawInstance=!0,Yw(eE),nw.addQueryContext(eE),Hw=eE;var tE,rE,nE=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var s=e[t];s&&(i[n++]=s)}return i},iE=function(e,t,r,n){for(var i=-1,s=null==e?0:e.length;++i<s;){var o=e[i];t(n,o,r(o),e)}return n},sE=function(e,t,r,n){return Kb(e,(function(e,i,s){t(n,e,r(e),s)})),n},oE=Object.prototype.hasOwnProperty,aE=(tE=function(e,t,r){oE.call(e,r)?e[r].push(t):xy(e,r,[t])},function(e,t){var r=Dy(e)?iE:sE,n=rE?rE():{};return r(e,tE,I_(t),n)}),uE=Object.prototype.hasOwnProperty,lE=function(e,t){return null!=e&&uE.call(e,t)},cE=function(e,t){return null!=e&&$_(e,t,lE)},hE=function(e,t){var r=-1,n=dg(e)?Array(e.length):[];return Kb(e,(function(e,i,s){n[++r]=t(e,i,s)})),n},dE=function(e,t){return(Dy(e)?Cv:hE)(e,I_(t))},fE=function(e,t,r,n){if(!ry(e))return e;for(var i=-1,s=(t=k_(t,e)).length,o=s-1,a=e;null!=a&&++i<s;){var u=O_(t[i]),l=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=o){var c=a[u];void 0===(l=n?n(c,u,a):void 0)&&(l=ry(c)?c:Qy(t[i+1])?[]:{})}Ay(a,u,l),a=a[u]}return e},pE=function(e,t){if(null==e)return{};var r=Cv(Ig(e),(function(e){return[e]}));return t=I_(t),function(e,t,r){for(var n=-1,i=t.length,s={};++n<i;){var o=t[n],a=S_(e,o);r(a,o)&&fE(s,k_(o,e),a)}return s}(e,r,(function(e,r){return t(e,r[0])}))};const{nanoid:mE}=zw,{isString:yE,isUndefined:gE}=vb,{columnize:vE,direction:bE,operator:_E,wrap:wE,unwrapRaw:EE,rawOrFn:CE}=Uw,TE=Fv("knex:bindings"),NE=["columns","join","where","union","group","having","order","limit","offset","lock","waitMode"];var kE=class{constructor(e,t,r){this.client=e,this.method=t._method||"select",this.options=t._options,this.single=t._single,this.timeout=t._timeout||!1,this.cancelOnTimeout=t._cancelOnTimeout||!1,this.grouped=aE(t._statements,"grouping"),this.formatter=e.formatter(t),this._emptyInsertValue="default values",this.first=this.select,this.bindings=r||[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.builder=this.formatter.builder}toSQL(e,t){this._undefinedInWhereClause=!1,this.undefinedBindingsInfo=[];const r=this[e=e||this.method]()||"",n={method:e,options:$w(this.options,Qb,{}),timeout:this.timeout,cancelOnTimeout:this.cancelOnTimeout,bindings:this.bindingsHolder.bindings||[],__knexQueryUid:mE()};if(Object.defineProperties(n,{toNative:{value:()=>({sql:this.client.positionBindings(n.sql),bindings:this.client.prepBindings(n.bindings)}),enumerable:!1}}),yE(r)?n.sql=r:Qb(n,r),"select"!==e&&"first"!==e||this.single.as&&(n.as=this.single.as),this._undefinedInWhereClause)throw TE(n.bindings),new Error(`Undefined binding(s) detected when compiling ${e.toUpperCase()}. Undefined column(s): [${this.undefinedBindingsInfo.join(", ")}] query: ${n.sql}`);return n}select(){let e=this.with(),t="";const r=[],n=[];NE.forEach(e=>{const i=this[e](this);switch(e){case"union":t=i;break;case"columns":case"join":case"where":r.push(i);break;default:n.push(i)}});const i=this.grouped.union&&this.grouped.union.map(e=>e.wrap).some(e=>e);if(this.onlyUnions()){const i=nE(r.concat(n)).join(" ");e+=t+(i?" "+i:"")}else{const s=(i?"(":"")+nE(r).join(" ")+(i?")":""),o=nE(n).join(" ");e+=s+(t?" "+t:"")+(o?" "+o:o)}return e}pluck(){let e=this.single.pluck;return-1!==e.indexOf(".")&&(e=e.split(".").slice(-1)[0]),{sql:this.select(),pluck:e}}insert(){const e=this.single.insert||[],t=this.with()+`insert into ${this.tableName} `,r=this._insertBody(e);return""===r?"":t+r}_onConflictClause(e){return e instanceof Hw?this.formatter.wrap(e):`(${this.formatter.columnize(e)})`}_buildInsertValues(e){let t="",r=-1;for(;++r<e.values.length;)0!==r&&(t+="), ("),t+=this.client.parameterize(e.values[r],this.client.valueForUndefined,this.builder,this.bindingsHolder);return t}_insertBody(e){let t="";if(Array.isArray(e)){if(0===e.length)return""}else if("object"==typeof e&&Xb(e))return t+this._emptyInsertValue;const r=this._prepInsert(e);return"string"==typeof r?t+=r:r.columns.length?(t+="("+vE(r.columns,this.builder,this.client,this.bindingsHolder),t+=") values ("+this._buildInsertValues(r)+")"):1===e.length&&e[0]?t+=this._emptyInsertValue:t="",t}update(){const e=this.with(),{tableName:t}=this,r=this._prepUpdate(this.single.update),n=this.where();return e+`update ${this.single.only?"only ":""}${t} set `+r.join(", ")+(n?" "+n:"")}_hintComments(){let e=this.grouped.hintComments||[];return e=e.map(e=>nE(e.value).join(" ")),e=nE(e).join(" "),e?`/*+ ${e} */ `:""}columns(){let e="";if(this.onlyUnions())return"";const t=this._hintComments(),r=this.grouped.columns||[];let n=-1,i=[];if(r)for(;++n<r.length;){const t=r[n];t.distinct&&(e="distinct "),t.distinctOn?e=this.distinctOn(t.value):"aggregate"===t.type?i.push(...this.aggregate(t)):"aggregateRaw"===t.type?i.push(this.aggregateRaw(t)):"analytic"===t.type?i.push(this.analytic(t)):"json"===t.type?i.push(this.json(t)):t.value&&t.value.length>0&&i.push(vE(t.value,this.builder,this.client,this.bindingsHolder))}return 0===i.length&&(i=["*"]),`${this.onlyJson()?"":"select "}${t}${e}`+i.join(", ")+(this.tableName?` from ${this.single.only?"only ":""}${this.tableName}`:"")}_aggregate(e,{aliasSeparator:t=" as ",distinctParentheses:r}={}){const n=e.value,i=e.method,s=e.aggregateDistinct?"distinct ":"",o=e=>wE(e,void 0,this.builder,this.client,this.bindingsHolder),a=(e,r)=>r?e+t+o(r):e,u=(e,t)=>{let n=e.map(o).join(", ");if(s){const e=r?"(":" ",t=r?")":"";n=s.trim()+e+n+t}return a(`${i}(${n})`,t)},l=(e,t)=>{const r=`${i}(${s+o(e)})`;return a(r,t)};if(Array.isArray(n))return[u(n)];if("object"==typeof n){if(e.alias)throw new Error("When using an object explicit alias can not be used");return Object.entries(n).map(([e,t])=>Array.isArray(t)?u(t,e):l(t,e))}const c=n.toLowerCase().indexOf(" as ");let h=n,{alias:d}=e;if(-1!==c){if(h=n.slice(0,c),d)throw new Error("Found multiple aliases for same column: "+h);d=n.slice(c+4)}return[l(h,d)]}aggregate(e){return this._aggregate(e)}aggregateRaw(e){const t=e.aggregateDistinct?"distinct ":"";return`${e.method}(${t+EE(e.value,void 0,this.builder,this.client,this.bindingsHolder)})`}_joinTable(e){return!e.schema||e.table instanceof Hw?e.table:`${e.schema}.${e.table}`}join(){let e="",t=-1;const r=this.grouped.join;if(!r)return"";for(;++t<r.length;){const n=r[t],i=this._joinTable(n);if(t>0&&(e+=" "),"raw"===n.joinType)e+=EE(n.table,void 0,this.builder,this.client,this.bindingsHolder);else{e+=n.joinType+" join "+wE(i,void 0,this.builder,this.client,this.bindingsHolder);let t=-1;for(;++t<n.clauses.length;){const r=n.clauses[t];e+=t>0?` ${r.bool} `:` ${"onUsing"===r.type?"using":"on"} `;const i=this[r.type](r);i&&(e+=i)}}}return e}onBetween(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"between")+" "+e.value.map(e=>this.client.parameter(e,this.builder,this.bindingsHolder)).join(" and ")}onNull(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" is "+this._not(e,"null")}onExists(e){return this._not(e,"exists")+" ("+CE(e.value,void 0,this.builder,this.client,this.bindingsHolder)+")"}onIn(e){if(Array.isArray(e.column))return this.multiOnIn(e);let t;return t=e.value instanceof Hw?this.client.parameter(e.value,this.builder,this.formatter):this.client.parameterize(e.value,void 0,this.builder,this.bindingsHolder),wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"in ")+this.wrap(t)}multiOnIn(e){let t=-1,r=`(${vE(e.column,this.builder,this.client,this.bindingsHolder)}) `;for(r+=this._not(e,"in ")+"((";++t<e.value.length;)0!==t&&(r+="),("),r+=this.client.parameterize(e.value[t],void 0,this.builder,this.bindingsHolder);return r+"))"}where(){const e=this.grouped.where;if(!e)return;const t=[];let r=-1;for(;++r<e.length;){const n=e[r];Object.prototype.hasOwnProperty.call(n,"value")&&nw.containsUndefined(n.value)&&(this.undefinedBindingsInfo.push(n.column),this._undefinedInWhereClause=!0);const i=this[n.type](n);i&&(0===t.length?t[0]="where":t.push(n.bool),t.push(i))}return t.length>1?t.join(" "):""}group(){return this._groupsOrders("group")}order(){return this._groupsOrders("order")}having(){const e=this.grouped.having;if(!e)return"";const t=["having"];for(let r=0,n=e.length;r<n;r++){const n=e[r],i=this[n.type](n);i&&(0===t.length&&(t[0]="where"),(t.length>1||1===t.length&&"having"!==t[0])&&t.push(n.bool),t.push(i))}return t.length>1?t.join(" "):""}havingRaw(e){return this._not(e,"")+EE(e.value,void 0,this.builder,this.client,this.bindingsHolder)}havingWrapped(e){const t=CE(e.value,"where",this.builder,this.client,this.bindingsHolder);return t&&this._not(e,"")+"("+t.slice(6)+")"||""}havingBasic(e){return this._not(e,"")+wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+_E(e.operator,this.builder,this.client,this.bindingsHolder)+" "+this.client.parameter(e.value,this.builder,this.bindingsHolder)}havingNull(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" is "+this._not(e,"null")}havingExists(e){return this._not(e,"exists")+" ("+CE(e.value,void 0,this.builder,this.client,this.bindingsHolder)+")"}havingBetween(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"between")+" "+e.value.map(e=>this.client.parameter(e,this.builder,this.bindingsHolder)).join(" and ")}havingIn(e){return Array.isArray(e.column)?this.multiHavingIn(e):wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"in ")+this.wrap(this.client.parameterize(e.value,void 0,this.builder,this.bindingsHolder))}multiHavingIn(e){return this.multiOnIn(e)}union(){const e=this.onlyUnions(),t=this.grouped.union;if(!t)return"";let r="";for(let n=0,i=t.length;n<i;n++){const i=t[n];n>0&&(r+=" "),(n>0||!e)&&(r+=i.clause+" ");const s=CE(i.value,void 0,this.builder,this.client,this.bindingsHolder);if(s){const e=i.wrap;e&&(r+="("),r+=s,e&&(r+=")")}}return r}onlyUnions(){return(!this.grouped.columns||!!this.grouped.columns[0].value)&&this.grouped.union&&!this.tableName}_getValueOrParameterFromAttribute(e,t){return!0===this.single.skipBinding[e]?null!=t?t:this.single[e]:this.client.parameter(this.single[e],this.builder,this.bindingsHolder)}onlyJson(){return!this.tableName&&this.grouped.columns&&1===this.grouped.columns.length&&"json"===this.grouped.columns[0].type}limit(){return this.single.limit||0===this.single.limit?"limit "+this._getValueOrParameterFromAttribute("limit"):""}offset(){return this.single.offset?"offset "+this._getValueOrParameterFromAttribute("offset"):""}del(){const{tableName:e}=this,t=this.with(),r=this.where(),n=this.join();return t+`delete ${n?e+" ":""}from ${this.single.only?"only ":""}${e}`+(n?" "+n:"")+(r?" "+r:"")}truncate(){return"truncate "+this.tableName}lock(){if(this.single.lock)return this[this.single.lock]()}waitMode(){if(this.single.waitMode)return this[this.single.waitMode]()}skipLocked(){throw new Error(".skipLocked() is currently only supported on MySQL 8.0+ and PostgreSQL 9.5+")}noWait(){throw new Error(".noWait() is currently only supported on MySQL 8.0+, MariaDB 10.3.0+ and PostgreSQL 9.5+")}distinctOn(e){throw new Error(".distinctOn() is currently only supported on PostgreSQL")}onWrapped(e){const t=this,r=new iw;e.value.call(r,r);let n="";for(let i=0;i<r.clauses.length;i++){const e=r.clauses[i];i>0&&(n+=` ${e.bool} `);const s=t[e.type](e);s&&(n+=s)}return n.length?`(${n})`:""}onBasic(e){const t=e.value instanceof Ow;return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+_E(e.operator,this.builder,this.client,this.bindingsHolder)+" "+(t?"(":"")+wE(e.value,void 0,this.builder,this.client,this.bindingsHolder)+(t?")":"")}onVal(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+_E(e.operator,this.builder,this.client,this.bindingsHolder)+" "+this.client.parameter(e.value,this.builder,this.bindingsHolder)}onRaw(e){return EE(e.value,void 0,this.builder,this.client,this.bindingsHolder)}onUsing(e){return"("+vE(e.column,this.builder,this.client,this.bindingsHolder)+")"}_valueClause(e){return e.asColumn?wE(e.value,void 0,this.builder,this.client,this.bindingsHolder):this.client.parameter(e.value,this.builder,this.bindingsHolder)}_columnClause(e){let t;return t=Array.isArray(e.column)?`(${vE(e.column,this.builder,this.client,this.bindingsHolder)})`:wE(e.column,void 0,this.builder,this.client,this.bindingsHolder),t}whereIn(e){const t=this.client.values(e.value,this.builder,this.bindingsHolder);return`${this._columnClause(e)} ${this._not(e,"in ")}${t}`}whereLike(e){return`${this._columnClause(e)} ${this._not(e,"like ")}${this._valueClause(e)}`}whereILike(e){return`${this._columnClause(e)} ${this._not(e,"ilike ")}${this._valueClause(e)}`}whereNull(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" is "+this._not(e,"null")}whereBasic(e){return this._not(e,"")+wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+_E(e.operator,this.builder,this.client,this.bindingsHolder)+" "+this._valueClause(e)}whereExists(e){return this._not(e,"exists")+" ("+CE(e.value,void 0,this.builder,this.client,this.bindingsHolder)+")"}whereWrapped(e){const t=CE(e.value,"where",this.builder,this.client,this.bindingsHolder);return t&&this._not(e,"")+"("+t.slice(6)+")"||""}whereBetween(e){return wE(e.column,void 0,this.builder,this.client,this.bindingsHolder)+" "+this._not(e,"between")+" "+e.value.map(e=>this.client.parameter(e,this.builder,this.bindingsHolder)).join(" and ")}whereRaw(e){return this._not(e,"")+EE(e.value,void 0,this.builder,this.client,this.bindingsHolder)}_jsonWrapValue(e){if(!this.builder._isJsonObject(e))try{return JSON.stringify(JSON.parse(e.replace(/\n|\t/g,"")))}catch(CT){return e}return JSON.stringify(e)}_jsonValueClause(e){return e.value=this._jsonWrapValue(e.value),this._valueClause(e)}whereJsonObject(e){return`${this._columnClause(e)} ${e.not?"!=":"="} ${this._jsonValueClause(e)}`}wrap(e){return"("!==e.charAt(0)?`(${e})`:e}json(e){return this[e.method](e.params)}analytic(e){let t="";const r=this;return t+=e.method+"() over (",e.raw?t+=e.raw:(e.partitions.length&&(t+="partition by ",t+=dE(e.partitions,(function(e){return yE(e)?r.formatter.columnize(e):r.formatter.columnize(e.column)+(e.order?" "+e.order:"")})).join(", ")+" "),t+="order by ",t+=dE(e.order,(function(e){return yE(e)?r.formatter.columnize(e):r.formatter.columnize(e.column)+(e.order?" "+e.order:"")})).join(", ")),t+=")",e.alias&&(t+=" as "+e.alias),t}with(){if(!this.grouped.with||!this.grouped.with.length)return"";const e=this.grouped.with;if(!e)return;const t=[];let r=-1,n=!1;for(;++r<e.length;){const i=e[r];i.recursive&&(n=!0);const s=this[i.type](i);t.push(s)}return`with ${n?"recursive ":""}${t.join(", ")} `}withWrapped(e){const t=CE(e.value,void 0,this.builder,this.client,this.bindingsHolder),r=e.columnList?"("+vE(e.columnList,this.builder,this.client,this.bindingsHolder)+")":"",n=void 0===e.materialized?"":e.materialized?"materialized ":"not materialized ";return t&&vE(e.alias,this.builder,this.client,this.bindingsHolder)+r+" as "+n+"("+t+")"||""}_not(e,t){return e.not?"not "+t:t}_prepInsert(e){const t=CE(e,void 0,this.builder,this.client,this.bindingsHolder);if(t)return t;let r=[];const n=[];Array.isArray(e)||(e=e?[e]:[]);let i=-1;for(;++i<e.length&&null!=e[i];){0===i&&(r=Object.keys(e[i]).sort());const t=new Array(r.length),s=Object.keys(e[i]);let o=-1;for(;++o<s.length;){const a=s[o];let u=r.indexOf(a);if(-1===u){r=r.concat(a).sort(),u=r.indexOf(a);let e=-1;for(;++e<n.length;)n[e].splice(u,0,void 0);t.splice(u,0,void 0)}t[u]=e[i][a]}n.push(t)}return{columns:r,values:n}}_prepUpdate(e={}){const{counter:t={}}=this.single;for(const s of Object.keys(t)){if(cE(e,s)){this.client.logger.warn("increment/decrement called for a column that has already been specified in main .update() call. Ignoring increment/decrement and using value from .update() call.");continue}let r=t[s];const n=r<0?"-":"+";"-"===n&&(r=-r),e[s]=this.client.raw(`?? ${n} ?`,[s,r])}e=pE(e,R_(I_(gE)));const r=[],n=Object.keys(e);let i=-1;for(;++i<n.length;)r.push(wE(n[i],void 0,this.builder,this.client,this.bindingsHolder)+" = "+this.client.parameter(e[n[i]],this.builder,this.bindingsHolder));if(Xb(r))throw new Error(["Empty .update() call detected!","Update data does not contain any values to update.","This will result in a faulty query.",this.single.table?`Table: ${this.single.table}.`:"",this.single.update?`Columns: ${Object.keys(this.single.update)}.`:""].join(" "));return r}_formatGroupsItemValue(e,t){const{formatter:r}=this;let n,i="";return"last"===t?i=" is null":"first"===t&&(i=" is not null"),n=e instanceof Hw?EE(e,void 0,this.builder,this.client,this.bindingsHolder):e instanceof Ow||t?"("+r.columnize(e)+i+")":r.columnize(e),n}_basicGroupOrder(e,t){return this._formatGroupsItemValue(e.value,e.nulls)+("order"===t&&"orderByRaw"!==e.type?" "+bE(e.direction,this.builder,this.client,this.bindingsHolder):"")}_groupOrder(e,t){return this._basicGroupOrder(e,t)}_groupOrderNulls(e,t){const r=this._formatGroupsItemValue(e.value),n="order"===t&&"orderByRaw"!==e.type?" "+bE(e.direction,this.builder,this.client,this.bindingsHolder):"";return!e.nulls||e.value instanceof Hw?r+n:`${r}${n||""} nulls ${e.nulls}`}_groupsOrders(e){const t=this.grouped[e];if(!t)return"";const r=t.map(t=>this._groupOrder(t,e));return r.length?e+" by "+r.join(", "):""}get tableName(){if(!this._tableName){let e=this.single.table;const t=this.single.schema;if(e&&t){const r=e instanceof Hw,n="function"==typeof e;e instanceof Ow||r||n||(e=`${t}.${e}`)}this._tableName=e?wE(e,e instanceof Ow,this.builder,this.client,this.bindingsHolder):""}return this._tableName}_jsonPathWrap(e){return this.client.parameter(e.path||e[1],this.builder,this.bindingsHolder)}_jsonExtract(e,t){let r;return r=Array.isArray(t.column)?t.column:[t],Array.isArray(e)||(e=[e]),r.map(t=>{let r=`${vE(t.column||t[0],this.builder,this.client,this.bindingsHolder)}, ${this._jsonPathWrap(t)}`;e.forEach(e=>{r=e+"("+r+")"});const n=t.alias||t[2];return n?this.client.alias(r,this.formatter.wrap(n)):r}).join(", ")}_jsonSet(e,t){const r=`${e}(${vE(t.column,this.builder,this.client,this.bindingsHolder)}, ${this.client.parameter(t.path,this.builder,this.bindingsHolder)}, ${this.client.parameter(t.value,this.builder,this.bindingsHolder)})`;return t.alias?this.client.alias(r,this.formatter.wrap(t.alias)):r}_whereJsonPath(e,t){return`${e}(${this._columnClause(t)}, ${this._jsonPathWrap({path:t.jsonPath})}) ${_E(t.operator,this.builder,this.client,this.bindingsHolder)} ${this._jsonValueClause(t)}`}_onJsonPathEquals(e,t){return e+"("+wE(t.columnFirst,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.parameter(t.jsonPathFirst,this.builder,this.bindingsHolder)+") = "+e+"("+wE(t.columnSecond,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.parameter(t.jsonPathSecond,this.builder,this.bindingsHolder)+")"}},OE={};const{EventEmitter:SE}=require("events"),{addQueryContext:xE}=nw,{augmentWithBuilderInterface:$E}=cw;class AE extends SE{constructor(e){super(),this.client=e,this._sequence=[],e.config&&(this._debug=e.config.debug,aw(this,4))}withSchema(e){return this._schema=e,this}toString(){return this.toQuery()}toSQL(){return this.client.schemaCompiler(this).toSQL()}async generateDdlCommands(){return await this.client.schemaCompiler(this).generateDdlCommands()}}["createTable","createTableIfNotExists","createTableLike","createView","createViewOrReplace","createMaterializedView","refreshMaterializedView","dropView","dropViewIfExists","dropMaterializedView","dropMaterializedViewIfExists","createSchema","createSchemaIfNotExists","dropSchema","dropSchemaIfExists","createExtension","createExtensionIfNotExists","dropExtension","dropExtensionIfExists","table","alterTable","view","alterView","hasTable","hasColumn","dropTable","renameTable","renameView","dropTableIfExists","raw"].forEach((function(e){AE.prototype[e]=function(){return"createTableIfNotExists"===e&&this.client.logger.warn(["Use async .hasTable to check if table exists and then use plain .createTable. Since ",'.createTableIfNotExists actually just generates plain "CREATE TABLE IF NOT EXIST..." ',"query it will not work correctly if there are any alter table queries generated for ","columns afterwards. To not break old migrations this function is left untouched for now",", but it should not be used when writing new code and it is removed from documentation."].join("")),"table"===e&&(e="alterTable"),"view"===e&&(e="alterView"),this._sequence.push({method:e,args:G_(arguments)}),this}})),AE.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(AE.prototype,e))throw new Error(`Can't extend SchemaBuilder with existing method ('${e}').`);Qb(AE.prototype,{[e]:t})},$E(AE),xE(AE),OE=AE;const{isString:jE}=vb;var IE={pushAdditional:function(e){const t=new this.constructor(this.client,this.tableCompiler,this.columnBuilder);e.call(t,P_(arguments)),this.sequence.additional=(this.sequence.additional||[]).concat(t.sequence)},pushQuery:function(e){e&&(jE(e)&&(e={sql:e}),e.bindings||(e.bindings=this.bindingsHolder.bindings),this.sequence.push(e),this.formatter=this.client.formatter(this._commonBuilder),this.bindings=[],this.formatter.bindings=this.bindings)},unshiftQuery:function(e){e&&(jE(e)&&(e={sql:e}),e.bindings||(e.bindings=this.bindingsHolder.bindings),this.sequence.unshift(e),this.formatter=this.client.formatter(this._commonBuilder),this.bindings=[],this.formatter.bindings=this.bindings)}},RE={};const{pushQuery:PE,pushAdditional:ME,unshiftQuery:LE}=IE;class qE{constructor(e,t){this.builder=t,this._commonBuilder=this.builder,this.client=e,this.schema=t._schema,this.bindings=[],this.bindingsHolder=this,this.formatter=e.formatter(t),this.formatter.bindings=this.bindings,this.sequence=[]}createSchema(){BE("createSchema")}createSchemaIfNotExists(){BE("createSchemaIfNotExists")}dropSchema(){BE("dropSchema")}dropSchemaIfExists(){BE("dropSchemaIfExists")}dropTable(e){this.pushQuery(this.dropTablePrefix+this.formatter.wrap(VE(this.schema,e)))}dropTableIfExists(e){this.pushQuery(this.dropTablePrefix+"if exists "+this.formatter.wrap(VE(this.schema,e)))}dropView(e){this._dropView(e,!1,!1)}dropViewIfExists(e){this._dropView(e,!0,!1)}dropMaterializedView(e){throw new Error("materialized views are not supported by this dialect.")}dropMaterializedViewIfExists(e){throw new Error("materialized views are not supported by this dialect.")}renameView(e,t){throw new Error("rename view is not supported by this dialect (instead drop then create another view).")}refreshMaterializedView(){throw new Error("materialized views are not supported by this dialect.")}_dropView(e,t,r){this.pushQuery((r?this.dropMaterializedViewPrefix:this.dropViewPrefix)+(t?"if exists ":"")+this.formatter.wrap(VE(this.schema,e)))}raw(e,t){this.sequence.push(this.client.raw(e,t).toSQL())}toSQL(){const e=this.builder._sequence;for(let t=0,r=e.length;t<r;t++){const r=e[t];this[r.method].apply(this,r.args)}return this.sequence}async generateDdlCommands(){const e=this.toSQL();return{pre:[],sql:Array.isArray(e)?e:[e],check:null,post:[]}}}function DE(e){const t=this.builder.queryContext();void 0!==t&&void 0===e.queryContext()&&e.queryContext(t),e.setSchema(this.schema);const r=e.toSQL();for(let n=0,i=r.length;n<i;n++)this.sequence.push(r[n])}function FE(e){return"createLike"===e?function(t,r,n){const i=this.client.tableBuilder(e,t,r,n);DE.call(this,i)}:function(t,r){const n=this.client.tableBuilder(e,t,null,r);DE.call(this,n)}}function UE(e){return function(t,r){const n=this.client.viewBuilder(e,t,r);DE.call(this,n)}}function VE(e,t){return e?`${e}.${t}`:t}function BE(e){throw new Error(e+" is not supported for this dialect (only PostgreSQL supports it currently).")}qE.prototype.dropTablePrefix="drop table ",qE.prototype.dropViewPrefix="drop view ",qE.prototype.dropMaterializedViewPrefix="drop materialized view ",qE.prototype.alterViewPrefix="alter view ",qE.prototype.alterTable=FE("alter"),qE.prototype.createTable=FE("create"),qE.prototype.createTableIfNotExists=FE("createIfNot"),qE.prototype.createTableLike=FE("createLike"),qE.prototype.createView=UE("create"),qE.prototype.createViewOrReplace=UE("createOrReplace"),qE.prototype.createMaterializedView=UE("createMaterializedView"),qE.prototype.alterView=UE("alter"),qE.prototype.pushQuery=PE,qE.prototype.pushAdditional=ME,qE.prototype.unshiftQuery=LE,RE=qE;var zE=tb((function(e,t){jy(t,yg(t),e)})),HE={};const{isString:WE,isFunction:QE,isObject:JE}=vb;class GE{constructor(e,t,r,n,i){if(this.client=e,this._fn=i,this._method=t,this._schemaName=void 0,this._tableName=r,this._tableNameLike=n,this._statements=[],this._single={},!n&&!QE(this._fn))throw new TypeError("A callback function must be supplied to calls against `.createTable` and `.table`")}setSchema(e){this._schemaName=e}toSQL(){return"alter"===this._method&&zE(this,KE),this._fn&&this._fn.call(this,this),this.client.tableCompiler(this).toSQL()}timestamps(e,t,r){JE(e)&&({useTimestamps:e,defaultToNow:t,useCamelCase:r}=e);const n=!0===e?"timestamp":"datetime",i=this[n](r?"createdAt":"created_at"),s=this[n](r?"updatedAt":"updated_at");if(!0===t){const e=this.client.raw("CURRENT_TIMESTAMP");i.notNullable().defaultTo(e),s.notNullable().defaultTo(e)}}comment(e){if("string"!=typeof e)throw new TypeError("Table comment must be string");this._single.comment=e}foreign(e,t){const r={column:e,keyName:t};this._statements.push({grouping:"alterTable",method:"foreign",args:[r]});let n={references(e){let t;return WE(e)&&(t=e.split(".")),t&&1!==t.length?(r.inTable=t[0],r.references=t[1],n):(r.references=t?t[0]:e,{on(e){if("string"!=typeof e)throw new TypeError("Expected tableName to be a string, got: "+typeof e);return r.inTable=e,n},inTable(){return this.on.apply(this,arguments)}})},withKeyName:e=>(r.keyName=e,n),onUpdate:e=>(r.onUpdate=e,n),onDelete:e=>(r.onDelete=e,n),deferrable:e=>{if(-1!==["mysql","mssql","redshift","mysql2","oracledb"].indexOf(this.client.dialect))throw new Error(this.client.dialect+" does not support deferrable");return r.deferrable=e,n},_columnBuilder:e=>(zE(e,n),n=e,e)};return n}check(e,t,r){return this._statements.push({grouping:"checks",args:[e,t,r]}),this}}["index","primary","unique","dropPrimary","dropUnique","dropIndex","dropForeign"].forEach(e=>{GE.prototype[e]=function(){return this._statements.push({grouping:"alterTable",method:e,args:G_(arguments)}),this}}),Zb({mysql:["engine","charset","collate"],postgresql:["inherits"]},(function(e,t){e.forEach((function(e){GE.prototype[e]=function(r){if(this.client.dialect!==t)throw new Error(`Knex only supports ${e} statement with ${t}.`);if("alter"===this._method)throw new Error(`Knex does not support altering the ${e} outside of create table, please use knex.raw statement.`);this._single[e]=r}}))})),nw.addQueryContext(GE),["tinyint","smallint","mediumint","int","bigint","decimal","float","double","real","bit","boolean","serial","date","datetime","timestamp","time","year","geometry","geography","point","char","varchar","tinytext","tinyText","text","mediumtext","mediumText","longtext","longText","binary","varbinary","tinyblob","tinyBlob","mediumblob","mediumBlob","blob","longblob","longBlob","enum","set","bool","dateTime","increments","bigincrements","bigIncrements","integer","biginteger","bigInteger","string","json","jsonb","uuid","enu","specificType"].forEach(e=>{GE.prototype[e]=function(){const t=G_(arguments),r=this.client.columnBuilder(this,e,t);return this._statements.push({grouping:"columns",builder:r}),r}});const KE={renameColumn(e,t){return this._statements.push({grouping:"alterTable",method:"renameColumn",args:[e,t]}),this},dropTimestamps(){return this.dropColumns(!0===arguments[0]?["createdAt","updatedAt"]:["created_at","updated_at"])},setNullable(e){return this._statements.push({grouping:"alterTable",method:"setNullable",args:[e]}),this},check(e,t,r){this._statements.push({grouping:"alterTable",method:"check",args:[e,t,r]})},dropChecks(){this._statements.push({grouping:"alterTable",method:"dropChecks",args:G_(arguments)})},dropNullable(e){return this._statements.push({grouping:"alterTable",method:"dropNullable",args:[e]}),this}};KE.dropColumn=KE.dropColumns=function(){return this._statements.push({grouping:"alterTable",method:"dropColumn",args:G_(arguments)}),this},GE.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(GE.prototype,e))throw new Error(`Can't extend TableBuilder with existing method ('${e}').`);Qb(GE.prototype,{[e]:t})},HE=GE;var ZE=function(e){return e!=e},YE=function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var i=e.length,s=r+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,ZE,r)},XE=Math.max,eC=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:db(r);return i<0&&(i=XE(n+i,0)),YE(e,t,i)},tC={};const{pushAdditional:rC,pushQuery:nC,unshiftQuery:iC}=IE,{normalizeArr:sC}=nw;class oC{constructor(e,t){this.client=e,this.tableBuilder=t,this._commonBuilder=this.tableBuilder,this.method=t._method,this.schemaNameRaw=t._schemaName,this.tableNameRaw=t._tableName,this.tableNameLikeRaw=t._tableNameLike,this.single=t._single,this.grouped=aE(t._statements,"grouping"),this.formatter=e.formatter(t),this.bindings=[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.sequence=[],this._formatting=e.config&&e.config.formatting,this.checksCount=0}toSQL(){return this[this.method](),this.sequence}create(e,t){const r=this.getColumns().map(e=>e.toSQL()),n=this.getColumnTypes(r);this.createAlterTableMethods&&this.alterTableForCreate(n),this.createQuery(n,e,t),this.columnQueries(r),delete this.single.comment,this.alterTable()}createIfNot(){this.create(!0)}createLike(){this.create(!1,!0)}createLikeIfNot(){this.create(!0,!0)}alter(){const e=this.getColumns().map(e=>e.toSQL()),t=this.getColumns("alter"),r=t.map(e=>e.toSQL()),n=this.getColumnTypes(e),i=this.getColumnTypes(r);this.addColumns(n),this.alterColumns(i,t),this.columnQueries(e),this.columnQueries(r),this.alterTable()}foreign(e){if(e.inTable&&e.references){const t=e.keyName?this.formatter.wrap(e.keyName):this._indexCommand("foreign",this.tableNameRaw,e.column),r=this.formatter.columnize(e.column),n=this.formatter.columnize(e.references),i=this.formatter.wrap(e.inTable),s=e.onUpdate?(this.lowerCase?" on update ":" ON UPDATE ")+e.onUpdate:"",o=e.onDelete?(this.lowerCase?" on delete ":" ON DELETE ")+e.onDelete:"",a=e.deferrable?this.lowerCase?` deferrable initially ${e.deferrable.toLowerCase()} `:` DEFERRABLE INITIALLY ${e.deferrable.toUpperCase()} `:"";this.lowerCase?this.pushQuery((this.forCreate?"":`alter table ${this.tableName()} add `)+"constraint "+t+" foreign key ("+r+") references "+i+" ("+n+")"+s+o+a):this.pushQuery((this.forCreate?"":`ALTER TABLE ${this.tableName()} ADD `)+"CONSTRAINT "+t+" FOREIGN KEY ("+r+") REFERENCES "+i+" ("+n+")"+s+o+a)}}getColumnTypes(e){return e.reduce((function(e,t){const r=t[0];return e.sql.push(r.sql),e.bindings.concat(r.bindings),e}),{sql:[],bindings:[]})}columnQueries(e){const t=e.reduce((function(e,t){const r=P_(t);return Xb(r)?e:e.concat(r)}),[]);for(const r of t)this.pushQuery(r)}addColumns(e,t){if(t=t||this.addColumnsPrefix,e.sql.length>0){const r=e.sql.map(e=>t+e);this.pushQuery({sql:(this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+r.join(", "),bindings:e.bindings})}}alterColumns(e,t){e.sql.length>0&&this.addColumns(e,this.alterColumnsPrefix,t)}getColumns(e){const t=this.grouped.columns||[];e=e||"add";const r=this.tableBuilder.queryContext();return t.filter(t=>t.builder._method===e).map(e=>(void 0!==r&&void 0===e.builder.queryContext()&&e.builder.queryContext(r),this.client.columnCompiler(this,e.builder)))}tableName(){const e=this.schemaNameRaw?`${this.schemaNameRaw}.${this.tableNameRaw}`:this.tableNameRaw;return this.formatter.wrap(e)}tableNameLike(){const e=this.schemaNameRaw?`${this.schemaNameRaw}.${this.tableNameLikeRaw}`:this.tableNameLikeRaw;return this.formatter.wrap(e)}alterTable(){const e=this.grouped.alterTable||[];for(let t=0,r=e.length;t<r;t++){const r=e[t];this[r.method]?this[r.method].apply(this,r.args):this.client.logger.error(`Debug: ${r.method} does not exist`)}for(const t in this.single)"function"==typeof this[t]&&this[t](this.single[t])}alterTableForCreate(e){this.forCreate=!0;const t=this.sequence,r=this.grouped.alterTable||[];this.grouped.alterTable=[];for(let n=0,i=r.length;n<i;n++){const t=r[n];eC(this.createAlterTableMethods,t.method)<0?this.grouped.alterTable.push(t):this[t.method]?(this.sequence=[],this[t.method].apply(this,t.args),e.sql.push(this.sequence[0].sql)):this.client.logger.error(`Debug: ${t.method} does not exist`)}this.sequence=t,this.forCreate=!1}dropIndex(e){this.pushQuery("drop index"+e)}dropUnique(){throw new Error("Method implemented in the dialect driver")}dropForeign(){throw new Error("Method implemented in the dialect driver")}dropColumn(){const e=nw.normalizeArr.apply(null,arguments),t=(Array.isArray(e)?e:[e]).map(e=>this.dropColumnPrefix+this.formatter.wrap(e));this.pushQuery((this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+t.join(", "))}_setNullableState(e,t){const r=this.tableName(),n=this.formatter.columnize(e),i=this.alterColumnsPrefix;return this.pushQuery({sql:"SELECT 1",output:()=>this.client.queryBuilder().from(this.tableNameRaw).columnInfo(e).then(e=>{if(Xb(e))throw new Error(`.setNullable: Column ${n} does not exist in table ${r}.`);const s=t?"null":"not null",o=e.type+(e.maxLength?`(${e.maxLength})`:""),a=null!==e.defaultValue&&void 0!==e.defaultValue?`default '${e.defaultValue}'`:"",u=`alter table ${r} ${i} ${n} ${o} ${s} ${a}`;return this.client.raw(u)})})}setNullable(e){return this._setNullableState(e,!0)}dropNullable(e){return this._setNullableState(e,!1)}dropChecks(e){if(void 0===e)return"";e=sC(e);const t=`alter table ${this.tableName()} ${e.map(e=>"drop constraint "+e).join(", ")}`;this.pushQuery(t)}check(e,t,r){const n=this.tableName();let i=r;i||(this.checksCount++,i=n+"_"+this.checksCount);const s=`alter table ${n} add constraint ${i} check(${e})`;this.pushQuery(s)}_addChecks(){return this.grouped.checks?", "+this.grouped.checks.map(e=>`${e.args[2]?"constraint "+e.args[2]+" ":""}check (${this.client.raw(e.args[0],e.args[1])})`).join(", "):""}_indexCommand(e,t,r){Array.isArray(r)||(r=r?[r]:[]);const n=(t.replace(/\.|-/g,"_")+"_"+r.join("_")+"_"+e).toLowerCase();return this.formatter.wrap(n)}_getPrimaryKeys(){return(this.grouped.alterTable||[]).filter(e=>"primary"===e.method).flatMap(e=>e.args).flat()}_canBeAddPrimaryKey(e){return e.primaryKey&&0===this._getPrimaryKeys().length}_getIncrementsColumnNames(){return this.grouped.columns.filter(e=>"increments"===e.builder._type).map(e=>e.builder._args[0])}}oC.prototype.pushQuery=nC,oC.prototype.pushAdditional=rC,oC.prototype.unshiftQuery=iC,oC.prototype.lowerCase=!0,oC.prototype.createAlterTableMethods=null,oC.prototype.addColumnsPrefix="add column ",oC.prototype.alterColumnsPrefix="alter column ",oC.prototype.modifyColumnPrefix="modify column ",oC.prototype.dropColumnPrefix="drop column ",tC=oC;const{addQueryContext:aC}=nw;class uC{constructor(e,t,r,n){this.client=e,this._method="add",this._single={},this._modifiers={},this._statements=[],this._type=hC[r]||r,this._args=n,this._tableBuilder=t,"alter"===t._method&&zE(this,cC)}references(e){return this._tableBuilder.foreign.call(this._tableBuilder,this._args[0],void 0,this)._columnBuilder(this).references(e)}}const lC={default:"defaultTo",defaultsTo:"defaultTo"};["default","defaultsTo","defaultTo","unsigned","nullable","first","after","comment","collate","check","checkPositive","checkNegative","checkIn","checkNotIn","checkBetween","checkLength","checkRegex"].forEach((function(e){const t=lC[e]||e;uC.prototype[e]=function(){return this._modifiers[t]=G_(arguments),this}})),aC(uC),uC.prototype.notNull=uC.prototype.notNullable=function(){return this.nullable(!1)},["index","primary","unique"].forEach((function(e){uC.prototype[e]=function(){return-1===this._type.toLowerCase().indexOf("increments")&&this._tableBuilder[e].apply(this._tableBuilder,[this._args[0]].concat(G_(arguments))),this}})),uC.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(uC.prototype,e))throw new Error(`Can't extend ColumnBuilder with existing method ('${e}').`);Qb(uC.prototype,{[e]:t})};const cC={drop:function(){return this._single.drop=!0,this},alterType:function(e){return this._statements.push({grouping:"alterType",value:e}),this},alter:function({alterNullable:e=!0,alterType:t=!0}={}){return this._method="alter",this.alterNullable=e,this.alterType=t,this}},hC={float:"floating",enum:"enu",boolean:"bool",string:"varchar",bigint:"bigInteger"};var dC=uC,fC=function(e){return e&&e.length?e[0]:void 0},pC={};const{toNumber:mC}=nw,{formatDefault:yC}=jw,{operator:gC}=Uw;class vC{constructor(e,t,r){this.client=e,this.tableCompiler=t,this.columnBuilder=r,this._commonBuilder=this.columnBuilder,this.args=r._args,this.type=r._type.toLowerCase(),this.grouped=aE(r._statements,"grouping"),this.modified=r._modifiers,this.isIncrements=-1!==this.type.indexOf("increments"),this.formatter=e.formatter(r),this.bindings=[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.sequence=[],this.modifiers=[],this.checksCount=0}_addCheckModifiers(){this.modifiers.push("check","checkPositive","checkNegative","checkIn","checkNotIn","checkBetween","checkLength","checkRegex")}defaults(e){if(Object.prototype.hasOwnProperty.call(this._defaultMap,e))return this._defaultMap[e].bind(this)();throw new Error("There is no default for the specified identifier "+e)}toSQL(){return this.pushQuery(this.compileColumn()),this.sequence.additional&&(this.sequence=this.sequence.concat(this.sequence.additional)),this.sequence}compileColumn(){return this.formatter.wrap(this.getColumnName())+" "+this.getColumnType()+this.getModifiers()}getColumnName(){return fC(this.args)||this.defaults("columnName")}getColumnType(){if(!this._columnType){const e=this[this.type];this._columnType="function"==typeof e?e.apply(this,P_(this.args)):e}return this._columnType}getModifiers(){const e=[];for(let t=0,r=this.modifiers.length;t<r;t++){const r=this.modifiers[t];if((!this.isIncrements||this.isIncrements&&"comment"===r)&&cE(this.modified,r)){const t=this[r].apply(this,this.modified[r]);t&&e.push(t)}}return e.length>0?" "+e.join(" "):""}varchar(e){return`varchar(${mC(e,255)})`}floating(e,t){return`float(${mC(e,8)}, ${mC(t,2)})`}decimal(e,t){if(null===e)throw new Error("Specifying no precision on decimal columns is not supported for that SQL dialect.");return`decimal(${mC(e,8)}, ${mC(t,2)})`}specifictype(e){return e}nullable(e){return!1===e?"not null":"null"}notNullable(){return this.nullable(!1)}defaultTo(e){return"default "+yC(e,this.type,this.client)}increments(e={primaryKey:!0}){return"integer not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")+" autoincrement"}bigincrements(e={primaryKey:!0}){return this.increments(e)}_pushAlterCheckQuery(e,t){let r=t;r||(this.checksCount++,r=this.tableCompiler.tableNameRaw+"_"+this.getColumnName()+"_"+this.checksCount),this.pushAdditional((function(){this.pushQuery(`alter table ${this.tableCompiler.tableName()} add constraint ${r} check(${e})`)}))}_checkConstraintName(e){return e?`constraint ${e} `:""}_check(e,t){return"alter"===this.columnBuilder._method?(this._pushAlterCheckQuery(e,t),""):`${this._checkConstraintName(t)}check (${e})`}checkPositive(e){return this._check(`${this.formatter.wrap(this.getColumnName())} ${gC(">",this.columnBuilder,this.bindingsHolder)} 0`,e)}checkNegative(e){return this._check(`${this.formatter.wrap(this.getColumnName())} ${gC("<",this.columnBuilder,this.bindingsHolder)} 0`,e)}_checkIn(e,t,r){return this._check(`${this.formatter.wrap(this.getColumnName())} ${r?"not ":""}in (${e.map(e=>this.client._escapeBinding(e)).join(",")})`,t)}checkIn(e,t){return this._checkIn(e,t)}checkNotIn(e,t){return this._checkIn(e,t,!0)}checkBetween(e,t){2!==e.length||Array.isArray(e[0])||Array.isArray(e[1])||(e=[e]);const r=e.map(e=>`${this.formatter.wrap(this.getColumnName())} between ${this.client._escapeBinding(e[0])} and ${this.client._escapeBinding(e[1])}`).join(" or ");return this._check(r,t)}checkLength(e,t,r){return this._check(`length(${this.formatter.wrap(this.getColumnName())}) ${gC(e,this.columnBuilder,this.bindingsHolder)} ${mC(t)}`,r)}}vC.prototype.binary="blob",vC.prototype.bool="boolean",vC.prototype.date="date",vC.prototype.datetime="datetime",vC.prototype.time="time",vC.prototype.timestamp="timestamp",vC.prototype.geometry="geometry",vC.prototype.geography="geography",vC.prototype.point="point",vC.prototype.enu="varchar",vC.prototype.bit=vC.prototype.json="text",vC.prototype.uuid=({useBinaryUuid:e=!1}={})=>e?"binary(16)":"char(36)",vC.prototype.integer=vC.prototype.smallint=vC.prototype.mediumint="integer",vC.prototype.biginteger="bigint",vC.prototype.text="text",vC.prototype.tinyint="tinyint",vC.prototype.pushQuery=IE.pushQuery,vC.prototype.pushAdditional=IE.pushAdditional,vC.prototype.unshiftQuery=IE.unshiftQuery,vC.prototype._defaultMap={columnName:function(){if(!this.isIncrements)throw new Error(`You did not specify a column name for the ${this.type} column.`);return"id"}},pC=vC;var bC=class extends Hw{constructor(e,t){super(e),this.ref=t,this._schema=null,this._alias=null}withSchema(e){return this._schema=e,this}as(e){return this._alias=e,this}toSQL(){const e=this._schema?`${this._schema}.${this.ref}`:this.ref,t=this.client.formatter(this),r=t.columnize(e),n=this._alias?`${r} as ${t.wrap(this._alias)}`:r;return this.set(n,[]),super.toSQL(...arguments)}};const{columnize:_C,wrap:wC}=Uw;var EC=class{constructor(e,t){this.client=e,this.builder=t,this.bindings=[]}columnize(e){return _C(e,this.builder,this.client,this)}wrap(e,t){return wC(e,t,this.builder,this.client,this)}},CC={};(function(e){"use strict";Object.defineProperty(CC,"__esModule",{value:!0});var t=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}(require("tty"));const r=e.env||{},n=e.argv||[],i="NO_COLOR"in r||n.includes("--no-color"),s="FORCE_COLOR"in r||n.includes("--color"),o="win32"===e.platform,a=t&&t.isatty&&t.isatty(1)&&r.TERM&&"dumb"!==r.TERM,u=!i&&(s||o||a||"CI"in r&&("GITHUB_ACTIONS"in r||"GITLAB_CI"in r||"CIRCLECI"in r)),l=(e,t,r,n,i=t.substring(0,e)+n,s=t.substring(e+r.length),o=s.indexOf(r))=>i+(o<0?s:l(o,s,r,n)),c=(e,t,r)=>((e,t,r=e,n=e.length+1)=>i=>i||""!==i&&void 0!==i?((e,t,r,n,i)=>e<0?r+t+n:r+l(e,t,n,i)+n)((""+i).indexOf(t,n),i,e,t,r):"")(`\x1b[${e}m`,`\x1b[${t}m`,r),h={reset:c(0,0),bold:c(1,22,"\x1b[22m\x1b[1m"),dim:c(2,22,"\x1b[22m\x1b[2m"),italic:c(3,23),underline:c(4,24),inverse:c(7,27),hidden:c(8,28),strikethrough:c(9,29),black:c(30,39),red:c(31,39),green:c(32,39),yellow:c(33,39),blue:c(34,39),magenta:c(35,39),cyan:c(36,39),white:c(37,39),gray:c(90,39),bgBlack:c(40,49),bgRed:c(41,49),bgGreen:c(42,49),bgYellow:c(43,49),bgBlue:c(44,49),bgMagenta:c(45,49),bgCyan:c(46,49),bgWhite:c(47,49),blackBright:c(90,39),redBright:c(91,39),greenBright:c(92,39),yellowBright:c(93,39),blueBright:c(94,39),magentaBright:c(95,39),cyanBright:c(96,39),whiteBright:c(97,39),bgBlackBright:c(100,49),bgRedBright:c(101,49),bgGreenBright:c(102,49),bgYellowBright:c(103,49),bgBlueBright:c(104,49),bgMagentaBright:c(105,49),bgCyanBright:c(106,49),bgWhiteBright:c(107,49)},d=e=>e,f=({useColor:e=u}={})=>e?h:Object.keys(h).reduce((e,t)=>({...e,[t]:d}),{}),{reset:p,bold:m,dim:y,italic:g,underline:v,inverse:b,hidden:_,strikethrough:w,black:E,red:C,green:T,yellow:N,blue:k,magenta:O,cyan:S,white:x,gray:$,bgBlack:A,bgRed:j,bgGreen:I,bgYellow:R,bgBlue:P,bgMagenta:M,bgCyan:L,bgWhite:q,blackBright:D,redBright:F,greenBright:U,yellowBright:V,blueBright:B,magentaBright:z,cyanBright:H,whiteBright:W,bgBlackBright:Q,bgRedBright:J,bgGreenBright:G,bgYellowBright:K,bgBlueBright:Z,bgMagentaBright:Y,bgCyanBright:X,bgWhiteBright:ee}=f();CC.bgBlack=A,CC.bgBlackBright=Q,CC.bgBlue=P,CC.bgBlueBright=Z,CC.bgCyan=L,CC.bgCyanBright=X,CC.bgGreen=I,CC.bgGreenBright=G,CC.bgMagenta=M,CC.bgMagentaBright=Y,CC.bgRed=j,CC.bgRedBright=J,CC.bgWhite=q,CC.bgWhiteBright=ee,CC.bgYellow=R,CC.bgYellowBright=K,CC.black=E,CC.blackBright=D,CC.blue=k,CC.blueBright=B,CC.bold=m,CC.createColors=f,CC.cyan=S,CC.cyanBright=H,CC.dim=y,CC.gray=$,CC.green=T,CC.greenBright=U,CC.hidden=_,CC.inverse=b,CC.isColorSupported=u,CC.italic=g,CC.magenta=O,CC.magentaBright=z,CC.red=C,CC.redBright=F,CC.reset=p,CC.strikethrough=w,CC.underline=v,CC.white=x,CC.whiteBright=W,CC.yellow=N,CC.yellowBright=V}).call(this,require("_process"));var TC={};(function(e){const{inspect:t}=require("util"),{isString:r,isFunction:n}=vb;TC=class{constructor(t={}){const{log:{debug:r,warn:n,error:i,deprecate:s,inspectionDepth:o,enableColors:a}={}}=t;var u;this._inspectionDepth=o||5,this._enableColors=null!=(u=a)?u:!(!e||!e.stdout)&&e.stdout.isTTY,this._debug=r,this._warn=n,this._error=i,this._deprecate=s}_log(e,i,s){if(null!=i&&!n(i))throw new TypeError("Extensions to knex logger must be functions!");n(i)?i(e):(r(e)||(e=t(e,{depth:this._inspectionDepth,colors:this._enableColors})),console.log(s?s(e):e))}debug(e){this._log(e,this._debug)}warn(e){this._log(e,this._warn,CC.yellow)}error(e){this._log(e,this._error,CC.red)}deprecate(e,t){const r=`${e} is deprecated, please use ${t}`;this._log(r,this._deprecate,CC.yellow)}}}).call(this,require("_process"));var NC={};class kC{constructor(e,t,r,n){this.client=e,this._method=t,this._schemaName=void 0,this._columns=void 0,this._fn=n,this._viewName=r,this._statements=[],this._single={}}setSchema(e){this._schemaName=e}columns(e){this._columns=e}as(e){this._selectQuery=e}checkOption(){throw new Error("check option definition is not supported by this dialect.")}localCheckOption(){throw new Error("check option definition is not supported by this dialect.")}cascadedCheckOption(){throw new Error("check option definition is not supported by this dialect.")}toSQL(){return"alter"===this._method&&zE(this,OC),this._fn.call(this,this),this.client.viewCompiler(this).toSQL()}}const OC={column(e){const t=this;return{rename:function(r){return t._statements.push({grouping:"alterView",method:"renameColumn",args:[e,r]}),this},defaultTo:function(r){return t._statements.push({grouping:"alterView",method:"defaultTo",args:[e,r]}),this}}}};nw.addQueryContext(kC),kC.extend=(e,t)=>{if(Object.prototype.hasOwnProperty.call(kC.prototype,e))throw new Error(`Can't extend ViewBuilder with existing method ('${e}').`);Qb(kC.prototype,{[e]:t})},NC=kC;var SC={};const{pushQuery:xC}=IE,{columnize:$C}=Uw;class AC{constructor(e,t){this.client=e,this.viewBuilder=t,this._commonBuilder=this.viewBuilder,this.method=t._method,this.schemaNameRaw=t._schemaName,this.viewNameRaw=t._viewName,this.single=t._single,this.selectQuery=t._selectQuery,this.columns=t._columns,this.grouped=aE(t._statements,"grouping"),this.formatter=e.formatter(t),this.bindings=[],this.formatter.bindings=this.bindings,this.bindingsHolder=this,this.sequence=[]}toSQL(){return this[this.method](),this.sequence}create(){this.createQuery(this.columns,this.selectQuery)}createOrReplace(){throw new Error("replace views is not supported by this dialect.")}createMaterializedView(){throw new Error("materialized views are not supported by this dialect.")}createQuery(e,t,r,n){const i="create "+(r?"materialized ":"")+(n?"or replace ":"")+"view ",s=e?" ("+$C(e,this.viewBuilder,this.client,this.bindingsHolder)+")":"";let o=i+this.viewName()+s;switch(o+=" as ",o+=t.toString(),this.single.checkOption){case"default_option":o+=" with check option";break;case"local":o+=" with local check option";break;case"cascaded":o+=" with cascaded check option"}this.pushQuery({sql:o})}renameView(e,t){throw new Error("rename view is not supported by this dialect (instead drop, then create another view).")}refreshMaterializedView(){throw new Error("materialized views are not supported by this dialect.")}alter(){this.alterView()}alterView(){const e=this.grouped.alterView||[];for(let t=0,r=e.length;t<r;t++){const r=e[t];this[r.method]?this[r.method].apply(this,r.args):this.client.logger.error(`Debug: ${r.method} does not exist`)}for(const t in this.single)"function"==typeof this[t]&&this[t](this.single[t])}renameColumn(e,t){throw new Error("rename column of views is not supported by this dialect.")}defaultTo(e,t){throw new Error("change default values of views is not supported by this dialect.")}viewName(){const e=this.schemaNameRaw?`${this.schemaNameRaw}.${this.viewNameRaw}`:this.viewNameRaw;return this.formatter.wrap(e)}}AC.prototype.pushQuery=xC,SC=AC;var jC={};const{Pool:IC,TimeoutError:RC}=Mm,{EventEmitter:PC}=require("events"),{promisify:MC}=require("util"),{makeEscape:LC}=qm,{executeQuery:qC,enrichQueryObject:DC}=Hb,{KnexTimeoutError:FC}=$v,{outputQuery:UC,unwrapRaw:VC}=Uw,{compileCallback:BC}=jw,{POOL_CONFIG_OPTIONS:zC}=X_,HC=Fv("knex:client");class WC extends PC{constructor(e={}){if(super(),this.config=e,this.logger=new TC(e),this.dialect&&!this.config.client&&this.logger.warn("Using 'this.dialect' to identify the client is deprecated and support for it will be removed in the future. Please use configuration option 'client' instead."),!this.config.client&&!this.dialect)throw new Error("knex: Required configuration option 'client' is missing.");var t;e.version&&(this.version=e.version),e.connection&&e.connection instanceof Function?(this.connectionConfigProvider=e.connection,this.connectionConfigExpirationChecker=()=>!0):(this.connectionSettings=(t=e.connection||{},Hg(t,5)),this.connectionConfigExpirationChecker=null),this.driverName&&e.connection&&(this.initializeDriver(),(!e.pool||e.pool&&0!==e.pool.max)&&this.initializePool(e)),this.valueForUndefined=this.raw("DEFAULT"),e.useNullAsDefault&&(this.valueForUndefined=null)}formatter(e){return new EC(this,e)}queryBuilder(){return new Ow(this)}queryCompiler(e,t){return new kE(this,e,t)}schemaBuilder(){return new OE(this)}schemaCompiler(e){return new RE(this,e)}tableBuilder(e,t,r,n){return new HE(this,e,t,r,n)}viewBuilder(e,t,r){return new NC(this,e,t,r)}tableCompiler(e){return new tC(this,e)}viewCompiler(e){return new SC(this,e)}columnBuilder(e,t,r){return new dC(this,e,t,r)}columnCompiler(e,t){return new pC(this,e,t)}runner(e){return new Dv(this,e)}transaction(e,t,r){return new jb(this,e,t,r)}raw(){return new Hw(this).set(...arguments)}ref(){return new bC(this,...arguments)}query(e,t){const r=DC(e,t,this);return qC(e,r,this)}stream(e,t,r,n){const i=DC(e,t,this);return this._stream(e,i,r,n)}prepBindings(e){return e}positionBindings(e){return e}postProcessResponse(e,t){return this.config.postProcessResponse?this.config.postProcessResponse(e,t):e}wrapIdentifier(e,t){return this.customWrapIdentifier(e,this.wrapIdentifierImpl,t)}customWrapIdentifier(e,t,r){return this.config.wrapIdentifier?this.config.wrapIdentifier(e,t,r):t(e)}wrapIdentifierImpl(e){return"*"!==e?`"${e.replace(/"/g,'""')}"`:"*"}initializeDriver(){try{this.driver=this._driver()}catch(CT){const t=`Knex: run\n$ npm install ${this.driverName} --save`;throw this.logger.error(`${t}\n${CT.message}\n${CT.stack}`),new Error(`${t}\n${CT.message}`)}}poolDefaults(){return{min:2,max:10,propagateCreateError:!0}}getPoolSettings(e){e=Ev({},e,this.poolDefaults()),zC.forEach(t=>{t in e&&this.logger.warn([`Pool config option "${t}" is no longer supported.`,"See https://github.com/Vincit/tarn.js for possible pool config options."].join(" "))});const t=[this.config.acquireConnectionTimeout||6e4,e.acquireTimeoutMillis].filter(e=>void 0!==e);e.acquireTimeoutMillis=Math.min(...t);const r=async()=>{if(!this.connectionConfigProvider)return;if(!this.connectionConfigExpirationChecker||!this.connectionConfigExpirationChecker())return;const e=await this.connectionConfigProvider();e.expirationChecker?(this.connectionConfigExpirationChecker=e.expirationChecker,delete e.expirationChecker):this.connectionConfigExpirationChecker=null,this.connectionSettings=e};return Object.assign(e,{create:async()=>{await r();const t=await this.acquireRawConnection();return t.__knexUid=xv("__knexUid"),e.afterCreate&&await MC(e.afterCreate)(t),t},destroy:e=>{if(void 0!==e)return this.destroyRawConnection(e)},validate:e=>e.__knex__disposed?(this.logger.warn("Connection Error: "+e.__knex__disposed),!1):this.validateConnection(e)})}initializePool(e=this.config){if(this.pool)return void this.logger.warn("The pool has already been initialized");const t={...this.getPoolSettings(e.pool)};t.afterCreate&&delete t.afterCreate,this.pool=new IC(t)}validateConnection(e){return!0}async acquireConnection(){if(!this.pool)throw new Error("Unable to acquire a connection");try{const e=await this.pool.acquire().promise;return HC("acquired connection from pool: %s",e.__knexUid),e}catch(error){let t=error;throw error instanceof RC&&(t=new FC("Knex: Timeout acquiring a connection. The pool is probably full. Are you missing a .transacting(trx) call?")),t}}releaseConnection(e){return HC("releasing connection to pool: %s",e.__knexUid),this.pool.release(e)||HC("pool refused connection: %s",e.__knexUid),Promise.resolve()}async destroy(e){try{this.pool&&this.pool.destroy&&await this.pool.destroy(),this.pool=void 0,"function"==typeof e&&e()}catch(t){if("function"==typeof e)return e(t);throw t}}database(){return this.connectionSettings.database}toString(){return"[object KnexClient]"}assertCanCancelQuery(){if(!this.canCancelQuery)throw new Error("Query cancelling not supported for this dialect")}cancelQuery(){throw new Error("Query cancelling not supported for this dialect")}alias(e,t){return e+" as "+t}parameter(e,t,r){return"function"==typeof e?UC(BC(e,void 0,this,r),!0,t,this):VC(e,!0,t,this,r)||"?"}parameterize(e,t,r,n){if("function"==typeof e)return this.parameter(e,r,n);e=Array.isArray(e)?e:[e];let i="",s=-1;for(;++s<e.length;){s>0&&(i+=", ");let o=e[s];Yv(o)&&(o=JSON.stringify(o)),i+=this.parameter(void 0===o?t:o,r,n)}return i}values(e,t,r){return Array.isArray(e)?Array.isArray(e[0])?`(${e.map(e=>`(${this.parameterize(e,void 0,t,r)})`).join(", ")})`:`(${this.parameterize(e,void 0,t,r)})`:e&&e.isRawInstance?`(${this.parameter(e,t,r)})`:this.parameter(e,t,r)}processPassedConnection(e){}toPathForJson(e){return e}}Object.assign(WC.prototype,{_escapeBinding:LC({escapeString:e=>`'${e.replace(/'/g,"''")}'`}),canCancelQuery:!1}),jC=WC;var QC,JC=require("url"),GC=require("fs");function KC(e){if("/"===e.charAt(0))return{host:(r=e.split(" "))[0],database:r[1]};var t=JC.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)?encodeURI(e).replace(/\%25(\d\d)/g,"%$1"):e,!0),r=t.query;for(var n in r)Array.isArray(r[n])&&(r[n]=r[n][r[n].length-1]);var i=(t.auth||":").split(":");if(r.user=i[0],r.password=i.splice(1).join(":"),r.port=t.port,"socket:"==t.protocol)return r.host=decodeURI(t.pathname),r.database=t.query.db,r.client_encoding=t.query.encoding,r;r.host||(r.host=t.hostname);var s=t.pathname;if(!r.host&&s&&/^%2f/i.test(s)){var o=s.split("/");r.host=decodeURIComponent(o[0]),s=o.splice(1).join("/")}switch(s&&"/"===s.charAt(0)&&(s=s.slice(1)||null),r.database=s&&decodeURI(s),"true"!==r.ssl&&"1"!==r.ssl||(r.ssl=!0),"0"===r.ssl&&(r.ssl=!1),(r.sslcert||r.sslkey||r.sslrootcert||r.sslmode)&&(r.ssl={}),r.sslcert&&(r.ssl.cert=GC.readFileSync(r.sslcert).toString()),r.sslkey&&(r.ssl.key=GC.readFileSync(r.sslkey).toString()),r.sslrootcert&&(r.ssl.ca=GC.readFileSync(r.sslrootcert).toString()),r.sslmode){case"disable":r.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":r.ssl.rejectUnauthorized=!1}return r}QC=KC,KC.parse=KC;var ZC={};(function(e){const{parse:t}=QC,r=t,n=e&&e.platform&&"win32"===e.platform;function i(e){const t={};let r=e.pathname;if("/"===r[0]&&(r=r.slice(1)),t.database=r,e.hostname&&(0===e.protocol.indexOf("mssql")?t.server=e.hostname:t.host=e.hostname),e.port&&(t.port=e.port),(e.username||e.password)&&(t.user=decodeURIComponent(e.username)),e.password&&(t.password=decodeURIComponent(e.password)),e.searchParams)for(const[i,s]of e.searchParams.entries())if(["mysql:","mariadb:"].includes(e.protocol))try{t[i]=JSON.parse(s)}catch(n){t[i]=s}else t[i]=s;return t}ZC=function(e){const t=function(e){try{return new URL(e)}catch(CT){return null}}(e),s=n&&t&&2===t.protocol.length;if(!t||s)return{client:"sqlite3",connection:{filename:e}};let{protocol:o}=t;return":"===o.slice(-1)&&(o=o.slice(0,-1)),{client:o,connection:["postgresql","postgres"].includes(o)?r(e):i(t)}}}).call(this,require("_process"));var YC=class extends jb{begin(e){return this.isolationLevel&&this.client.logger.warn("sqlite3 only supports serializable transactions, ignoring the isolation level param"),this.query(e,"BEGIN;")}};const{isString:XC}=vb,{wrapString:eT,columnize:tT}=Uw,rT=pv("");var nT=class extends kE{constructor(e,t,r){super(e,t,r),this.forShare=rT,this.forKeyShare=rT,this.forUpdate=rT,this.forNoKeyUpdate=rT}insert(){const e=this.single.insert||[];let t=this.with()+`insert into ${this.tableName} `;if(Array.isArray(e)){if(0===e.length)return"";if(1===e.length&&e[0]&&Xb(e[0]))return{sql:t+this._emptyInsertValue}}else if("object"==typeof e&&Xb(e))return{sql:t+this._emptyInsertValue};const r=this._prepInsert(e);if(XC(r))return{sql:t+r};if(0===r.columns.length)return{sql:""};if(t+=`(${this.formatter.columnize(r.columns)})`,null!==this.client.valueForUndefined&&r.values.forEach(e=>{Zb(e,e=>{if(void 0===e)throw new TypeError("`sqlite` does not support inserting default values. Specify values explicitly or use the `useNullAsDefault` config flag. (see docs http://knexjs.org/#Builder-insert).")})}),1===r.values.length){t+=` values (${this.client.parameterize(r.values[0],this.client.valueForUndefined,this.builder,this.bindingsHolder)})`;const{onConflict:n,ignore:i,merge:s}=this.single;if(n&&i)t+=this._ignore(n);else if(n&&s){t+=this._merge(s.updates,n,e);const r=this.where();r&&(t+=" "+r)}const{returning:o}=this.single;return o&&(t+=this._returning(o)),{sql:t,returning:o}}const n=[];let i=-1;for(;++i<r.values.length;){let e=-1;const t=n[i]=[];let s=r.values[i];for(s=void 0===s?this.client.valueForUndefined:s;++e<r.columns.length;)t.push(this.client.alias(this.client.parameter(s[e],this.builder,this.bindingsHolder),this.formatter.wrap(r.columns[e])));n[i]=t.join(", ")}t+=" select "+n.join(" union all select ");const{onConflict:s,ignore:o,merge:a}=this.single;s&&o?t+=" where true"+this._ignore(s):s&&a&&(t+=" where true"+this._merge(a.updates,s,e));const{returning:u}=this.single;return u&&(t+=this._returning(u)),{sql:t,returning:u}}_ignore(e){return!0===e?" on conflict do nothing":` on conflict ${this._onConflictClause(e)} do nothing`}_merge(e,t,r){let n=` on conflict ${this._onConflictClause(t)} do update set `;if(e&&Array.isArray(e))return n+=e.map(e=>eT(e.split(".").pop(),this.formatter.builder,this.client,this.formatter)).map(e=>`${e} = excluded.${e}`).join(", "),n;if(e&&"object"==typeof e){const t=this._prepUpdate(e);return n+="string"==typeof t?t:t.join(","),n}{const e=this._prepInsert(r);if("string"==typeof e)throw new Error("If using merge with a raw insert query, then updates must be provided");return n+=e.columns.map(e=>eT(e.split(".").pop(),this.builder,this.client)).map(e=>`${e} = excluded.${e}`).join(", "),n}}_returning(e){return e?" returning "+this.formatter.columnize(e):""}truncate(){const{table:e}=this.single;return{sql:"delete from "+this.tableName,output(){return this.query({sql:`delete from sqlite_sequence where name = '${e}'`}).catch(Uv)}}}columnInfo(){const e=this.single.columnInfo;return{sql:`PRAGMA table_info(\`${this.client.customWrapIdentifier(this.single.table,hv)}\`)`,output(t){const r=/.*\((\d+)\)/,n=$w(t,(function(e,t){let{type:n}=t,i=n.match(r);return i&&(i=i[1]),n=i?n.split("(")[0]:n,e[t.name]={type:n.toLowerCase(),maxLength:i,nullable:!t.notnull,defaultValue:t.dflt_value},e}),{});return e&&n[e]||n}}}limit(){const e=!this.single.limit&&0!==this.single.limit;return e&&!this.single.offset?"":(this.single.limit=e?-1:this.single.limit,"limit "+this._getValueOrParameterFromAttribute("limit"))}jsonExtract(e){return this._jsonExtract("json_extract",e)}jsonSet(e){return this._jsonSet("json_set",e)}jsonInsert(e){return this._jsonSet("json_insert",e)}jsonRemove(e){const t=`json_remove(${tT(e.column,this.builder,this.client,this.bindingsHolder)},${this.client.parameter(e.path,this.builder,this.bindingsHolder)})`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){return this._whereJsonPath("json_extract",e)}whereJsonSupersetOf(e){throw new Error("Json superset where clause not actually supported by SQLite")}whereJsonSubsetOf(e){throw new Error("Json subset where clause not actually supported by SQLite")}onJsonPathEquals(e){return this._onJsonPathEquals("json_extract",e)}},iT=function(e,t){var r;return Kb(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r},sT=class extends RE{constructor(e,t){super(e,t)}hasTable(e){const t="select * from sqlite_master where type = 'table' and name = "+this.client.parameter(this.formatter.wrap(e).replace(/`/g,""),this.builder,this.bindingsHolder);this.pushQuery({sql:t,output:e=>e.length>0})}hasColumn(e,t){this.pushQuery({sql:`PRAGMA table_info(${this.formatter.wrap(e)})`,output(e){return function(e,t,r){var n=Dy(e)?n_:iT;return r&&bv(e,t,r)&&(t=void 0),n(e,I_(t))}(e,e=>this.client.wrapIdentifier(e.name.toLowerCase())===this.client.wrapIdentifier(t.toLowerCase()))}})}renameTable(e,t){this.pushQuery(`alter table ${this.formatter.wrap(e)} rename to ${this.formatter.wrap(t)}`)}async generateDdlCommands(){const e=this.builder._sequence;for(let r=0,n=e.length;r<n;r++){const t=e[r];this[t.method].apply(this,t.args)}const t=this.sequence;if(1===t.length&&t[0].statementsProducer)return t[0].statementsProducer();{const e=[];for(const r of t){const t=r.sql;Array.isArray(t)?e.push(...t):e.push(t)}return{pre:[],sql:e,check:null,post:[]}}}},oT={};class aT extends pC{constructor(){super(...arguments),this.modifiers=["nullable","defaultTo"],this._addCheckModifiers()}enu(e){return`text check (${this.formatter.wrap(this.args[0])} in ('${e.join("', '")}'))`}_pushAlterCheckQuery(e,t){throw new Error("Alter table with to add constraints is not permitted in SQLite")}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} REGEXP ${this.client._escapeBinding(e)}`,t)}}aT.prototype.json="json",aT.prototype.jsonb="json",aT.prototype.double=aT.prototype.decimal=aT.prototype.floating="float",aT.prototype.timestamp="datetime",aT.prototype.increments=aT.prototype.bigincrements="integer not null primary key autoincrement",oT=aT;var uT=function(e,t){return(Dy(e)?Cg:e_)(e,I_(t))};const{isObject:lT}=vb,{formatDefault:cT}=jw;var hT=class extends tC{constructor(){super(...arguments)}createQuery(e,t,r){let n=(t?"create table if not exists ":"create table ")+this.tableName();r&&this.tableNameLike()?n+=" as select * from "+this.tableNameLike()+" where 0=1":(n+=" ("+e.sql.join(", "),n+=this.foreignKeys()||"",n+=this.primaryKeys()||"",n+=this._addChecks(),n+=")"),this.pushQuery(n),r&&this.addColumns(e,this.addColumnsPrefix)}addColumns(e,t,r){if(t===this.alterColumnsPrefix){const e=this,t=r.map(e=>{const t=this.client.customWrapIdentifier(e.getColumnName(),hv,e.columnBuilder.queryContext()),r=e.getColumnType();return{name:t,type:r,defaultTo:e.modified.defaultTo?cT(e.modified.defaultTo[0],r,this.client):null,notNull:e.modified.nullable&&!1===e.modified.nullable[0]}});this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,statementsProducer:(r,n)=>e.client.ddl(e,r,n).alterColumn(t)})}else for(let n=0,i=e.sql.length;n<i;n++)this.pushQuery({sql:`alter table ${this.tableName()} add column ${e.sql[n]}`,bindings:e.bindings[n]})}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery("drop index "+t)}dropForeign(e,t){const r=this;e=(e=Array.isArray(e)?e:[e]).map(e=>this.client.customWrapIdentifier(e,hv)),t=this.client.customWrapIdentifier(t,hv),this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(n){return r.client.ddl(r,n,this.connection).dropForeign(e,t)}})}dropPrimary(e){const t=this;e=this.client.customWrapIdentifier(e,hv),this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(r){return t.client.ddl(t,r,this.connection).dropPrimary(e)}})}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery("drop index "+t)}unique(e,t){let r;lT(t)&&({indexName:t,deferrable:r}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`sqlite3: unique index \`${t}\` will not be deferrable ${r} because sqlite3 does not support deferred constraints.`),t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),e=this.formatter.columnize(e),this.pushQuery(`create unique index ${t} on ${this.tableName()} (${e})`)}index(e,t,r){let n;t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),e=this.formatter.columnize(e),lT(r)&&({predicate:n}=r);const i=n?" "+this.client.queryCompiler(n).where():"";this.pushQuery(`create index ${t} on ${this.tableName()} (${e})${i}`)}primary(e,t){const r=this;let n;e=(e=Array.isArray(e)?e:[e]).map(e=>this.client.customWrapIdentifier(e,hv)),lT(t)&&({constraintName:t,deferrable:n}=t),n&&"not deferrable"!==n&&this.client.logger.warn(`sqlite3: primary key constraint \`${t}\` will not be deferrable ${n} because sqlite3 does not support deferred constraints.`),t=this.client.customWrapIdentifier(t,hv),"create"!==this.method&&"createIfNot"!==this.method&&this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(n){return r.client.ddl(r,n,this.connection).primary(e,t)}})}foreign(e){const t=this;"create"!==this.method&&"createIfNot"!==this.method&&(e.column=Array.isArray(e.column)?e.column:[e.column],e.column=e.column.map(e=>this.client.customWrapIdentifier(e,hv)),e.inTable=this.client.customWrapIdentifier(e.inTable,hv),e.references=Array.isArray(e.references)?e.references:[e.references],e.references=e.references.map(e=>this.client.customWrapIdentifier(e,hv)),this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,statementsProducer:(r,n)=>t.client.ddl(t,r,n).foreign(e)}))}primaryKeys(){const e=uT(this.grouped.alterTable||[],{method:"primary"});if(e.length>0&&e[0].args.length>0){const t=e[0].args[0];let r=e[0].args[1]||"";return r&&(r=" constraint "+this.formatter.wrap(r)),`,${r} ${this.grouped.columns.filter(e=>"increments"===e.builder._type).length>0?"unique":"primary key"} (${this.formatter.columnize(t)})`}}foreignKeys(){let e="";const t=uT(this.grouped.alterTable||[],{method:"foreign"});for(let r=0,n=t.length;r<n;r++){const n=t[r].args[0],i=this.formatter.columnize(n.column),s=this.formatter.columnize(n.references),o=this.formatter.wrap(n.inTable);let a=n.keyName||"";a&&(a=" constraint "+this.formatter.wrap(a)),e+=`,${a} foreign key(${i}) references ${o}(${s})`,n.onDelete&&(e+=" on delete "+n.onDelete),n.onUpdate&&(e+=" on update "+n.onUpdate)}return e}createTableBlock(){return this.getColumns().concat().join(",")}renameColumn(e,t){this.pushQuery({sql:`alter table ${this.tableName()} rename ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`})}_setNullableState(e,t){const r=this;this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,statementsProducer:(n,i)=>r.client.ddl(r,n,i).setNullable(e,t)})}dropColumn(){const e=this,t=Q_(arguments).map(e=>this.client.customWrapIdentifier(e,hv));this.pushQuery({sql:`PRAGMA table_info(${this.tableName()})`,output(r){return e.client.ddl(e,r,this.connection).dropColumn(t)}})}};const{columnize:dT}=Uw;var fT=class extends SC{constructor(e,t){super(e,t)}createOrReplace(){const e=this.columns,t=this.selectQuery.toString(),r=this.viewName(),n="drop view if exists "+r,i=`create view ${r}${e?" ("+dT(e,this.viewBuilder,this.client,this.bindingsHolder)+")":""} as ${t}`;this.pushQuery({sql:n}),this.pushQuery({sql:i})}},pT={tokenize:function(e,t){const r=new RegExp(Object.entries(t).map(([e,t])=>`(?<${e}>${t.source})`).join("|"),"yi");let n=0;const i=[];for(;n<e.length;){r.lastIndex=n;const t=e.match(r);if(null===t)throw new Error(`No matching tokenizer rule found at: [${e.substring(n)}]`);{const[e,r]=Object.entries(t.groups).find(([e,t])=>void 0!==t);n+=r.length,e.startsWith("_")||i.push({type:e,text:r})}}return i}};const{tokenize:mT}=pT,{s:yT,a:gT,m:vT,o:bT,l:_T,n:wT,t:ET,e:CT,f:TT}={s:function(e,t=(e=>e)){return function({index:r=0,input:n}){let i=r;const s=[];for(const t of e){const e=t({index:i,input:n});if(!e.success)return e;i=e.index,s.push(e.ast)}return{success:!0,ast:t(s),index:i,input:n}}},a:function(e,t=(e=>e)){return function({index:r=0,input:n}){for(const i of e){const e=i({index:r,input:n});if(e.success)return{success:!0,ast:t(e.ast),index:e.index,input:n}}return{success:!1,ast:null,index:r,input:n}}},m:function(e,t=(e=>e)){return function({index:r=0,input:n}){let i={},s=r;const o=[];do{i=e({index:s,input:n}),i.success&&(s=i.index,o.push(i.ast))}while(i.success);return o.length>0?{success:!0,ast:t(o),index:s,input:n}:{success:!1,ast:null,index:s,input:n}}},o:function(e,t=(e=>e)){return function({index:r=0,input:n}){const i=e({index:r,input:n});return i.success?{success:!0,ast:t(i.ast),index:i.index,input:n}:{success:!0,ast:t(null),index:r,input:n}}},l:function(e,t=(e=>e)){return function({index:r=0,input:n}){const i=e.do({index:r,input:n});return i.success&&e.next({index:i.index,input:n}).success?{success:!0,ast:t(i.ast),index:i.index,input:n}:{success:!1,ast:null,index:r,input:n}}},n:function(e,t=(e=>e)){return function({index:r=0,input:n}){const i=e.do({index:r,input:n});return i.success&&!e.not({index:r,input:n}).success?{success:!0,ast:t(i.ast),index:i.index,input:n}:{success:!1,ast:null,index:r,input:n}}},t:function(e,t=(e=>e.text)){return function({index:r=0,input:n}){const i=n[r];return void 0===i||void 0!==e.type&&e.type!==i.type||void 0!==e.text&&e.text.toUpperCase()!==i.text.toUpperCase()?{success:!1,ast:null,index:r,input:n}:{success:!0,ast:t(i),index:r+1,input:n}}},e:function({index:e=0,input:t}){return{success:!0,ast:null,index:e,input:t}},f:function({index:e=0,input:t}){return{success:e===t.length,ast:null,index:e,input:t}}},NT={keyword:/(?:ABORT|ACTION|ADD|AFTER|ALL|ALTER|ALWAYS|ANALYZE|AND|AS|ASC|ATTACH|AUTOINCREMENT|BEFORE|BEGIN|BETWEEN|BY|CASCADE|CASE|CAST|CHECK|COLLATE|COLUMN|COMMIT|CONFLICT|CONSTRAINT|CREATE|CROSS|CURRENT|CURRENT_DATE|CURRENT_TIME|CURRENT_TIMESTAMP|DATABASE|DEFAULT|DEFERRED|DEFERRABLE|DELETE|DESC|DETACH|DISTINCT|DO|DROP|END|EACH|ELSE|ESCAPE|EXCEPT|EXCLUSIVE|EXCLUDE|EXISTS|EXPLAIN|FAIL|FILTER|FIRST|FOLLOWING|FOR|FOREIGN|FROM|FULL|GENERATED|GLOB|GROUP|GROUPS|HAVING|IF|IGNORE|IMMEDIATE|IN|INDEX|INDEXED|INITIALLY|INNER|INSERT|INSTEAD|INTERSECT|INTO|IS|ISNULL|JOIN|KEY|LAST|LEFT|LIKE|LIMIT|MATCH|MATERIALIZED|NATURAL|NO|NOT|NOTHING|NOTNULL|NULL|NULLS|OF|OFFSET|ON|OR|ORDER|OTHERS|OUTER|OVER|PARTITION|PLAN|PRAGMA|PRECEDING|PRIMARY|QUERY|RAISE|RANGE|RECURSIVE|REFERENCES|REGEXP|REINDEX|RELEASE|RENAME|REPLACE|RESTRICT|RETURNING|RIGHT|ROLLBACK|ROW|ROWS|SAVEPOINT|SELECT|SET|TABLE|TEMP|TEMPORARY|THEN|TIES|TO|TRANSACTION|TRIGGER|UNBOUNDED|UNION|UNIQUE|UPDATE|USING|VACUUM|VALUES|VIEW|VIRTUAL|WHEN|WHERE|WINDOW|WITH|WITHOUT)(?=\s+|-|\(|\)|;|\+|\*|\/|%|==|=|<=|<>|<<|<|>=|>>|>|!=|,|&|~|\|\||\||\.)/,id:/"[^"]*(?:""[^"]*)*"|`[^`]*(?:``[^`]*)*`|\[[^[\]]*\]|[a-z_][a-z0-9_$]*/,string:/'[^']*(?:''[^']*)*'/,blob:/x'(?:[0-9a-f][0-9a-f])+'/,numeric:/(?:\d+(?:\.\d*)?|\.\d+)(?:e(?:\+|-)?\d+)?|0x[0-9a-f]+/,variable:/\?\d*|[@$:][a-z0-9_$]+/,operator:/-|\(|\)|;|\+|\*|\/|%|==|=|<=|<>|<<|<|>=|>>|>|!=|,|&|~|\|\||\||\./,_ws:/\s+/};function kT(e){return gT([ET({text:"TEMP"}),ET({text:"TEMPORARY"}),CT],e=>({temporary:null!==e}))(e)}function OT(e){return bT(yT([ET({text:"WITHOUT"}),ET({text:"ROWID"})]),e=>({rowid:null!==e}))(e)}function ST(e){return gT([yT([xT,ET({text:","}),ST],e=>({columns:[e[0]].concat(e[2].columns)})),yT([xT],e=>({columns:[e[0]]}))])(e)}function xT(e){return yT([yT([gN],e=>({name:e[0]})),$T,AT],e=>Object.assign({},...e))(e)}function $T(e){return bT(yT([vT(ET({type:"id"})),gT([yT([ET({text:"("}),_N,ET({text:","}),_N,ET({text:")"})],e=>`(${e[1]}, ${e[3]})`),yT([ET({text:"("}),_N,ET({text:")"})],e=>`(${e[1]})`),CT])],e=>`${e[0].join(" ")}${e[1]||""}`),e=>({type:e}))(e)}function AT(e){return bT(vT(jT),e=>({constraints:Object.assign({primary:null,notnull:null,null:null,unique:null,check:null,default:null,collate:null,references:null,as:null},...e||[])}))(e)}function jT(e){return gT([IT,PT,MT,LT,qT,DT,FT,UT,VT])(e)}function IT(e){return yT([nN,ET({text:"PRIMARY"},e=>null),ET({text:"KEY"},e=>null),pN,QT,RT],e=>({primary:Object.assign({},...e.filter(e=>null!==e))}))(e)}function RT(e){return bT(ET({text:"AUTOINCREMENT"}),e=>({autoincrement:null!==e}))(e)}function PT(e){return yT([nN,ET({text:"NOT"},e=>null),ET({text:"NULL"},e=>null),QT],e=>({notnull:Object.assign({},...e.filter(e=>null!==e))}))(e)}function MT(e){return yT([nN,ET({text:"NULL"},e=>null),QT],e=>({null:Object.assign({},...e.filter(e=>null!==e))}))(e)}function LT(e){return yT([nN,ET({text:"UNIQUE"},e=>null),QT],e=>({unique:Object.assign({},...e.filter(e=>null!==e))}))(e)}function qT(e){return yT([nN,ET({text:"CHECK"},e=>null),ET({text:"("},e=>null),yT([yN],e=>({expression:e[0]})),ET({text:")"},e=>null)],e=>({check:Object.assign({},...e.filter(e=>null!==e))}))(e)}function DT(e){return yT([nN,ET({text:"DEFAULT"},e=>null),gT([yT([ET({text:"("}),yN,ET({text:")"})],e=>({value:e[1],expression:!0})),yT([bN],e=>({value:e[0],expression:!1})),yT([_N],e=>({value:e[0],expression:!1}))])],e=>({default:Object.assign({},...e.filter(e=>null!==e))}))(e)}function FT(e){return yT([nN,ET({text:"COLLATE"},e=>null),ET({type:"id"},e=>({collation:e.text}))],e=>({collate:Object.assign({},...e.filter(e=>null!==e))}))(e)}function UT(e){return yT([nN,yT([KT],e=>e[0].references)],e=>({references:Object.assign({},...e.filter(e=>null!==e))}))(e)}function VT(e){return yT([nN,bT(yT([ET({text:"GENERATED"}),ET({text:"ALWAYS"})]),e=>({generated:null!==e})),ET({text:"AS"},e=>null),ET({text:"("},e=>null),yT([yN],e=>({expression:e[0]})),ET({text:")"},e=>null),gT([ET({text:"STORED"}),ET({text:"VIRTUAL"}),CT],e=>({mode:e?e.toUpperCase():null}))],e=>({as:Object.assign({},...e.filter(e=>null!==e))}))(e)}function BT(e){return bT(vT(yT([ET({text:","}),zT],e=>e[1])),e=>({constraints:e||[]}))(e)}function zT(e){return gT([HT,WT,JT,GT])(e)}function HT(e){return yT([nN,ET({text:"PRIMARY"},e=>null),ET({text:"KEY"},e=>null),ET({text:"("},e=>null),cN,ET({text:")"},e=>null),QT],e=>Object.assign({type:"PRIMARY KEY"},...e.filter(e=>null!==e)))(e)}function WT(e){return yT([nN,ET({text:"UNIQUE"},e=>null),ET({text:"("},e=>null),cN,ET({text:")"},e=>null),QT],e=>Object.assign({type:"UNIQUE"},...e.filter(e=>null!==e)))(e)}function QT(e){return bT(yT([ET({text:"ON"}),ET({text:"CONFLICT"}),gT([ET({text:"ROLLBACK"}),ET({text:"ABORT"}),ET({text:"FAIL"}),ET({text:"IGNORE"}),ET({text:"REPLACE"})])],e=>e[2]),e=>({conflict:e?e.toUpperCase():null}))(e)}function JT(e){return yT([nN,ET({text:"CHECK"},e=>null),ET({text:"("},e=>null),yT([yN],e=>({expression:e[0]})),ET({text:")"},e=>null)],e=>Object.assign({type:"CHECK"},...e.filter(e=>null!==e)))(e)}function GT(e){return yT([nN,ET({text:"FOREIGN"},e=>null),ET({text:"KEY"},e=>null),ET({text:"("},e=>null),YT,ET({text:")"},e=>null),KT],e=>Object.assign({type:"FOREIGN KEY"},...e.filter(e=>null!==e)))(e)}function KT(e){return yT([ET({text:"REFERENCES"},e=>null),uN,ZT,bT(vT(gT([XT,eN,tN])),e=>Object.assign({delete:null,update:null,match:null},...e||[])),rN],e=>({references:Object.assign({},...e.filter(e=>null!==e))}))(e)}function ZT(e){return bT(yT([ET({text:"("}),YT,ET({text:")"})],e=>e[1]),e=>({columns:e?e.columns:[]}))(e)}function YT(e){return yT([bT(vT(yT([gN,ET({text:","})],e=>e[0])),e=>null!==e?e:[]),gN],e=>({columns:e[0].concat([e[1]])}))(e)}function XT(e){return yT([ET({text:"ON"}),ET({text:"DELETE"}),vN],e=>({delete:e[2]}))(e)}function eN(e){return yT([ET({text:"ON"}),ET({text:"UPDATE"}),vN],e=>({update:e[2]}))(e)}function tN(e){return yT([ET({text:"MATCH"}),gT([ET({type:"keyword"}),ET({type:"id"})])],e=>({match:e[1]}))(e)}function rN(e){return bT(yT([bT(ET({text:"NOT"})),ET({text:"DEFERRABLE"}),bT(yT([ET({text:"INITIALLY"}),gT([ET({text:"DEFERRED"}),ET({text:"IMMEDIATE"})])],e=>e[1].toUpperCase()))]),e=>({deferrable:e?{not:null!==e[0],initially:e[2]}:null}))(e)}function nN(e){return bT(yT([ET({text:"CONSTRAINT"}),gN],e=>e[1]),e=>({name:e}))(e)}function iN(e){return bT(ET({text:"UNIQUE"}),e=>({unique:null!==e}))(e)}function sN(e){return bT(yT([ET({text:"IF"}),ET({text:"NOT"}),ET({text:"EXISTS"})]),e=>({exists:null!==e}))(e)}function oN(e){return bT(yT([gN,ET({text:"."})],e=>e[0]),e=>({schema:e}))(e)}function aN(e){return yT([gN],e=>({index:e[0]}))(e)}function uN(e){return yT([gN],e=>({table:e[0]}))(e)}function lN(e){return bT(yT([ET({text:"WHERE"}),yN],e=>e[1]),e=>({where:e}))(e)}function cN(e){return gT([yT([hN,ET({text:","}),cN],e=>({columns:[e[0]].concat(e[2].columns)})),yT([dN,ET({text:","}),cN],e=>({columns:[e[0]].concat(e[2].columns)})),_T({do:hN,next:ET({text:")"})},e=>({columns:[e]})),_T({do:dN,next:ET({text:")"})},e=>({columns:[e]}))])(e)}function hN(e){return yT([yT([gN],e=>({name:e[0],expression:!1})),fN,pN],e=>Object.assign({},...e.filter(e=>null!==e)))(e)}function dN(e){return yT([yT([mN],e=>({name:e[0],expression:!0})),fN,pN],e=>Object.assign({},...e.filter(e=>null!==e)))(e)}function fN(e){return bT(yT([ET({text:"COLLATE"}),ET({type:"id"})],e=>e[1]),e=>({collation:e}))(e)}function pN(e){return gT([ET({text:"ASC"}),ET({text:"DESC"}),CT],e=>({order:e?e.toUpperCase():null}))(e)}function mN(e){return vT(gT([wT({do:ET({type:"keyword"}),not:gT([ET({text:"COLLATE"}),ET({text:"ASC"}),ET({text:"DESC"})])}),ET({type:"id"}),ET({type:"string"}),ET({type:"blob"}),ET({type:"numeric"}),ET({type:"variable"}),wT({do:ET({type:"operator"}),not:gT([ET({text:"("}),ET({text:")"}),ET({text:","})])}),yT([ET({text:"("}),bT(yN),ET({text:")"})],e=>e[1]||[])]))(e)}function yN(e){return vT(gT([ET({type:"keyword"}),ET({type:"id"}),ET({type:"string"}),ET({type:"blob"}),ET({type:"numeric"}),ET({type:"variable"}),wT({do:ET({type:"operator"}),not:gT([ET({text:"("}),ET({text:")"})])}),yT([ET({text:"("}),bT(yN),ET({text:")"})],e=>e[1]||[])]))(e)}function gN(e){return gT([ET({type:"id"}),ET({type:"string"})],e=>/^["`['][^]*["`\]']$/.test(e)?e.substring(1,e.length-1):e)(e)}function vN(e){return gT([yT([ET({text:"SET"}),ET({text:"NULL"})],e=>`${e[0]} ${e[1]}`),yT([ET({text:"SET"}),ET({text:"DEFAULT"})],e=>`${e[0]} ${e[1]}`),ET({text:"CASCADE"}),ET({text:"RESTRICT"}),yT([ET({text:"NO"}),ET({text:"ACTION"})],e=>`${e[0]} ${e[1]}`)],e=>e.toUpperCase())(e)}function bN(e){return gT([ET({type:"numeric"}),ET({type:"string"}),ET({type:"id"}),ET({type:"blob"}),ET({text:"NULL"}),ET({text:"TRUE"}),ET({text:"FALSE"}),ET({text:"CURRENT_TIME"}),ET({text:"CURRENT_DATE"}),ET({text:"CURRENT_TIMESTAMP"})])(e)}function _N(e){return yT([gT([ET({text:"+"}),ET({text:"-"}),CT]),ET({type:"numeric"})],e=>`${e[0]||""}${e[1]}`)(e)}var wN={parseCreateTable:function(e){const t=(r={input:mT(e,NT)},yT([ET({text:"CREATE"},e=>null),kT,ET({text:"TABLE"},e=>null),sN,oN,uN,ET({text:"("},e=>null),ST,BT,ET({text:")"},e=>null),OT,TT],e=>Object.assign({},...e.filter(e=>null!==e)))(r));var r;if(!t.success)throw new Error(`Parsing CREATE TABLE failed at [${t.input.slice(t.index).map(e=>e.text).join(" ")}] of "${e}"`);return t.ast},parseCreateIndex:function(e){const t=(r={input:mT(e,NT)},yT([ET({text:"CREATE"},e=>null),iN,ET({text:"INDEX"},e=>null),sN,oN,aN,ET({text:"ON"},e=>null),uN,ET({text:"("},e=>null),cN,ET({text:")"},e=>null),lN,TT],e=>Object.assign({},...e.filter(e=>null!==e)))(r));var r;if(!t.success)throw new Error(`Parsing CREATE INDEX failed at [${t.input.slice(t.index).map(e=>e.text).join(" ")}] of "${e}"`);return t.ast}};function EN(e,t){return null!==e.conflict?" ON CONFLICT "+e.conflict:""}function CN(e,t){return`REFERENCES ${SN(e,t)}${function(e,t){return e.columns.length>0?` (${TN(e,t)})`:""}(e,t)}${function(e,t){return`${function(e,t){return null!==e.delete?" ON DELETE "+e.delete:""}(e)}${function(e,t){return null!==e.update?" ON UPDATE "+e.update:""}(e)}${function(e,t){return null!==e.match?" MATCH "+e.match:""}(e)}`}(e)}${function(e,t){return null!==e?` ${e.not?"NOT ":""}DEFERRABLE${null!==e.initially?" INITIALLY "+e.initially:""}`:""}(e.deferrable)}`}function TN(e,t){return e.columns.map(e=>IN(e,t)).join(", ")}function NN(e,t){return null!==e.name?`CONSTRAINT ${IN(e.name,t)} `:""}function kN(e,t){return e.exists?" IF NOT EXISTS":""}function ON(e,t){return null!==e.schema?IN(e.schema,t)+".":""}function SN(e,t){return IN(e.table,t)}function xN(e,t){return e.columns.map(e=>e.expression?function(e,t){return`${function(e,t){return jN(e,t)}(e.name,t)}${$N(e,t)}${AN(e,t)}`}(e,t):function(e,t){return`${IN(e.name,t)}${$N(e,t)}${AN(e,t)}`}(e,t)).join(", ")}function $N(e,t){return null!==e.collation?" COLLATE "+e.collation:""}function AN(e,t){return null!==e.order?" "+e.order:""}function jN(e,t){return e.reduce((e,t)=>Array.isArray(t)?`${e}(${jN(t)})`:e?`${e} ${t}`:t,"")}function IN(e,t){return t(e)}var RN={compileCreateTable:function(e,t=(e=>e)){return function(e,t){return`CREATE${function(e,t){return e.temporary?" TEMP":""}(e)} TABLE${kN(e)} ${ON(e,t)}${SN(e,t)} (${function(e,t){return e.columns.map(e=>function(e,t){return`${IN(e.name,t)}${function(e,t){return null!==e.type?" "+e.type:""}(e)}${function(e,t){return`${function(e,t){return null!==e.primary?` ${NN(e.primary,t)}PRIMARY KEY${AN(e.primary)}${EN(e.primary)}${function(e,t){return e.autoincrement?" AUTOINCREMENT":""}(e.primary)}`:""}(e,t)}${function(e,t){return null!==e.notnull?` ${NN(e.notnull,t)}NOT NULL${EN(e.notnull)}`:""}(e,t)}${function(e,t){return null!==e.null?` ${NN(e.null,t)}NULL${EN(e.null)}`:""}(e,t)}${function(e,t){return null!==e.unique?` ${NN(e.unique,t)}UNIQUE${EN(e.unique)}`:""}(e,t)}${function(e,t){return null!==e.check?` ${NN(e.check,t)}CHECK (${jN(e.check.expression)})`:""}(e,t)}${function(e,t){return null!==e.default?` ${NN(e.default,t)}DEFAULT ${e.default.expression?`(${jN(e.default.value)})`:e.default.value}`:""}(e,t)}${function(e,t){return null!==e.collate?` ${NN(e.collate,t)}COLLATE ${e.collate.collation}`:""}(e,t)}${function(e,t){return null!==e.references?` ${NN(e.references,t)}${CN(e.references,t)}`:""}(e,t)}${function(e,t){return null!==e.as?` ${NN(e.as,t)}${e.as.generated?"GENERATED ALWAYS ":""}AS (${jN(e.as.expression)})${null!==e.as.mode?" "+e.as.mode:""}`:""}(e,t)}`}(e.constraints,t)}`}(e,t)).join(", ")}(e,t)}${function(e,t){return e.constraints.reduce((e,r)=>`${e}, ${function(e,t){switch(e.type){case"PRIMARY KEY":return function(e,t){return`${NN(e,t)}PRIMARY KEY (${xN(e,t)})${EN(e)}`}(e,t);case"UNIQUE":return function(e,t){return`${NN(e,t)}UNIQUE (${xN(e,t)})${EN(e)}`}(e,t);case"CHECK":return function(e,t){return`${NN(e,t)}CHECK (${jN(e.expression)})`}(e,t);case"FOREIGN KEY":return function(e,t){return`${NN(e,t)}FOREIGN KEY (${TN(e,t)}) ${CN(e.references,t)}`}(e,t)}}(r,t)}`,"")}(e,t)})${function(e,t){return e.rowid?" WITHOUT ROWID":""}(e)}`}(e,t)},compileCreateIndex:function(e,t=(e=>e)){return function(e,t){return`CREATE${function(e,t){return e.unique?" UNIQUE":""}(e)} INDEX${kN(e)} ${ON(e,t)}${function(e,t){return IN(e.index,t)}(e,t)} on ${SN(e,t)} (${xN(e,t)})${function(e,t){return null!==e.where?" where "+jN(e.where):""}(e)}`}(e,t)}};function PN(e,t){return e.toLowerCase()===t.toLowerCase()}var MN={isEqualId:PN,includesId:function(e,t){return e.some(e=>PN(e,t))}};const{nanonum:LN}=zw,{copyData:qN,dropOriginal:DN,renameTable:FN,getTableSql:UN,isForeignCheckEnabled:VN,setForeignCheck:BN,executeForeignCheck:zN}={copyData:function(e,t,r){return`INSERT INTO "${t}" SELECT ${void 0===r?"*":r.map(e=>`"${e}"`).join(", ")} FROM "${e}";`},dropOriginal:function(e){return`DROP TABLE "${e}"`},renameTable:function(e,t){return`ALTER TABLE "${e}" RENAME TO "${t}"`},getTableSql:function(e){return`SELECT type, sql FROM sqlite_master WHERE (type='table' OR (type='index' AND sql IS NOT NULL)) AND tbl_name='${e}'`},isForeignCheckEnabled:function(){return"PRAGMA foreign_keys"},setForeignCheck:function(e){return"PRAGMA foreign_keys = "+(e?"ON":"OFF")},executeForeignCheck:function(){return"PRAGMA foreign_key_check"}},{parseCreateTable:HN,parseCreateIndex:WN}=wN,{compileCreateTable:QN,compileCreateIndex:JN}=RN,{isEqualId:GN,includesId:KN}=MN;var ZN=class{constructor(e,t,r,n){this.client=e,this.tableCompiler=t,this.pragma=r,this.tableNameRaw=this.tableCompiler.tableNameRaw,this.alteredName="_knex_temp_alter"+LN(3),this.connection=n,this.formatter=e=>this.client.customWrapIdentifier(e,hv),this.wrap=e=>this.client.wrapIdentifierImpl(e)}tableName(){return this.formatter(this.tableNameRaw)}getTableSql(){const e=this.tableName();return this.client.transaction(async t=>{t.disableProcessing();const r=await t.raw(UN(e));return t.enableProcessing(),{createTable:r.filter(e=>"table"===e.type)[0].sql,createIndices:r.filter(e=>"index"===e.type).map(e=>e.sql)}},{connection:this.connection})}async isForeignCheckEnabled(){return 1===(await this.client.raw(VN()).connection(this.connection))[0].foreign_keys}async setForeignCheck(e){await this.client.raw(BN(e)).connection(this.connection)}renameTable(e){return e.raw(FN(this.alteredName,this.tableName()))}dropOriginal(e){return e.raw(DN(this.tableName()))}copyData(e,t){return e.raw(qN(this.tableName(),this.alteredName,t))}async alterColumn(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=HN(t);n.table=this.alteredName,n.columns=n.columns.map(t=>{const r=e.find(e=>GN(e.name,t.name));return r&&(t.type=r.type,t.constraints.default=null!==r.defaultTo?{name:null,value:r.defaultTo,expression:!1}:null,t.constraints.notnull=r.notNull?{name:null,conflict:null}:null,t.constraints.null=r.notNull?null:t.constraints.null),t});const i=QN(n,this.wrap);return this.generateAlterCommands(i,r)}async dropColumn(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=HN(t);if(n.table=this.alteredName,n.columns=n.columns.filter(t=>t.expression||!KN(e,t.name)),0===n.columns.length)throw new Error("Unable to drop last column from table");n.constraints=n.constraints.filter(t=>"PRIMARY KEY"===t.type||"UNIQUE"===t.type?t.columns.every(t=>t.expression||!KN(e,t.name)):"FOREIGN KEY"!==t.type||t.columns.every(t=>!KN(e,t))&&(t.references.table!==n.table||t.references.columns.every(t=>!KN(e,t))));const i=n.columns.map(e=>e.name),s=QN(n,this.wrap),o=[];for(const a of r){const t=WN(a);t.columns=t.columns.filter(t=>t.expression||!KN(e,t.name)),t.columns.length>0&&o.push(JN(t,this.wrap))}return this.alter(s,o,i)}async dropForeign(e,t){const{createTable:r,createIndices:n}=await this.getTableSql(),i=HN(r);i.table=this.alteredName,t||(i.columns=i.columns.map(t=>({...t,references:KN(e,t.name)?null:t.references}))),i.constraints=i.constraints.filter(r=>"FOREIGN KEY"!==r.type||(t?!r.name||!GN(r.name,t):r.columns.every(t=>!KN(e,t))));const s=QN(i,this.wrap);return this.alter(s,n)}async dropPrimary(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=HN(t);n.table=this.alteredName,n.columns=n.columns.map(e=>({...e,primary:null})),n.constraints=n.constraints.filter(t=>"PRIMARY KEY"!==t.type||!!e&&(!t.name||!GN(t.name,e)));const i=QN(n,this.wrap);return this.alter(i,r)}async primary(e,t){const{createTable:r,createIndices:n}=await this.getTableSql(),i=HN(r);i.table=this.alteredName,i.columns=i.columns.map(e=>({...e,primary:null})),i.constraints=i.constraints.filter(e=>"PRIMARY KEY"!==e.type),i.constraints.push({type:"PRIMARY KEY",name:t||null,columns:e.map(e=>({name:e,expression:!1,collation:null,order:null})),conflict:null});const s=QN(i,this.wrap);return this.alter(s,n)}async foreign(e){const{createTable:t,createIndices:r}=await this.getTableSql(),n=HN(t);n.table=this.alteredName,n.constraints.push({type:"FOREIGN KEY",name:e.keyName||null,columns:e.column,references:{table:e.inTable,columns:e.references,delete:e.onDelete||null,update:e.onUpdate||null,match:null,deferrable:null}});const i=QN(n,this.wrap);return this.generateAlterCommands(i,r)}async setNullable(e,t){const{createTable:r,createIndices:n}=await this.getTableSql(),i=HN(r);i.table=this.alteredName;const s=i.columns.find(t=>GN(e,t.name));if(!s)throw new Error(`.setNullable: Column ${e} does not exist in table ${this.tableName()}.`);s.constraints.notnull=t?null:{name:null,conflict:null},s.constraints.null=t?s.constraints.null:null;const o=QN(i,this.wrap);return this.generateAlterCommands(o,n)}async alter(e,t,r){const n=await this.isForeignCheckEnabled();n&&await this.setForeignCheck(!1);try{await this.client.transaction(async i=>{await i.raw(e),await this.copyData(i,r),await this.dropOriginal(i),await this.renameTable(i);for(const e of t)await i.raw(e);if(n&&(await i.raw(zN())).length>0)throw new Error("FOREIGN KEY constraint failed")},{connection:this.connection})}finally{n&&await this.setForeignCheck(!0)}}async generateAlterCommands(e,t,r){const n=[],i=[],s=[];let o=null;n.push(e),n.push(qN(this.tableName(),this.alteredName,r)),n.push(DN(this.tableName())),n.push(FN(this.alteredName,this.tableName()));for(const a of t)n.push(a);return await this.isForeignCheckEnabled()&&(i.push(BN(!1)),s.push(BN(!0)),o=zN()),{pre:i,sql:n,check:o,post:s}}},YN=class extends Ow{withMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!0)}withNotMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!1)}},XN=class extends jb{begin(e){return this.isolationLevel?this.query(e,`BEGIN ISOLATION LEVEL ${this.isolationLevel};`):this.query(e,"BEGIN;")}};const{wrapString:ek,columnize:tk,operator:rk,wrap:nk}=Uw;var ik=class extends kE{constructor(e,t,r){super(e,t,r),this._defaultInsertValue="default"}truncate(){return`truncate ${this.tableName} restart identity`}insert(){let e=super.insert();if(""===e)return e;const{returning:t,onConflict:r,ignore:n,merge:i,insert:s}=this.single;if(r&&n&&(e+=this._ignore(r)),r&&i){e+=this._merge(i.updates,r,s);const t=this.where();t&&(e+=" "+t)}return t&&(e+=this._returning(t)),{sql:e,returning:t}}update(){const e=this.with(),t=this._prepUpdate(this.single.update),r=this.where(),{returning:n}=this.single;return{sql:e+`update ${this.single.only?"only ":""}${this.tableName} set `+t.join(", ")+(r?" "+r:"")+this._returning(n),returning:n}}using(){const e=this.single.using;if(!e)return;let t="using ";return Array.isArray(e)?t+=e.map(e=>this.formatter.wrap(e)).join(","):t+=this.formatter.wrap(e),t}del(){const{tableName:e}=this,t=this.with();let r=this.where()||"",n=this.using()||"";const i=this.grouped.join,s=[];if(Array.isArray(i)){for(const e of i){s.push(nk(this._joinTable(e),void 0,this.builder,this.client,this.bindingsHolder));const t=[];for(const r of e.clauses)t.push(this.whereBasic({column:r.column,operator:"=",value:r.value,asColumn:!0}));t.length>0&&(r+=(r?" and ":"where ")+t.join(" and "))}s.length>0&&(n+=(n?",":"using ")+s.join(","))}const o=t+`delete from ${this.single.only?"only ":""}${e}`+(n?" "+n:"")+(r?" "+r:""),{returning:a}=this.single;return{sql:o+this._returning(a),returning:a}}aggregate(e){return this._aggregate(e,{distinctParentheses:!0})}_returning(e){return e?" returning "+this.formatter.columnize(e):""}_ignore(e){return!0===e?" on conflict do nothing":` on conflict ${this._onConflictClause(e)} do nothing`}_merge(e,t,r){let n=` on conflict ${this._onConflictClause(t)} do update set `;if(e&&Array.isArray(e))return n+=e.map(e=>ek(e.split(".").pop(),this.formatter.builder,this.client,this.formatter)).map(e=>`${e} = excluded.${e}`).join(", "),n;if(e&&"object"==typeof e){const t=this._prepUpdate(e);return n+="string"==typeof t?t:t.join(","),n}{const e=this._prepInsert(r);if("string"==typeof e)throw new Error("If using merge with a raw insert query, then updates must be provided");return n+=e.columns.map(e=>ek(e.split(".").pop(),this.builder,this.client)).map(e=>`${e} = excluded.${e}`).join(", "),n}}_tableNames(e){const t=this.single.schema,r=[];for(let n=0;n<e.length;n++){let i=e[n];i&&(t&&(i=`${t}.${i}`),r.push(this.formatter.wrap(i)))}return r.join(", ")}_lockingClause(e){const t=this.single.lockTables||[];return e+(t.length?" of "+this._tableNames(t):"")}_groupOrder(e,t){return super._groupOrderNulls(e,t)}forUpdate(){return this._lockingClause("for update")}forShare(){return this._lockingClause("for share")}forNoKeyUpdate(){return this._lockingClause("for no key update")}forKeyShare(){return this._lockingClause("for key share")}skipLocked(){return"skip locked"}noWait(){return"nowait"}columnInfo(){const e=this.single.columnInfo;let t=this.single.schema;const r=this.client.customWrapIdentifier(this.single.table,hv);t&&(t=this.client.customWrapIdentifier(t,hv));const n=[r];return this._buildColumnInfoQuery(t,"select * from information_schema.columns where table_name = ? and table_catalog = current_database()",n,e)}_buildColumnInfoQuery(e,t,r,n){return e?(t+=" and table_schema = ?",r.push(e)):t+=" and table_schema = current_schema()",{sql:t,bindings:r,output(e){const t=$w(e.rows,(function(e,t){return e[t.column_name]={type:t.data_type,maxLength:t.character_maximum_length,nullable:"YES"===t.is_nullable,defaultValue:t.column_default},e}),{});return n&&t[n]||t}}}distinctOn(e){return"distinct on ("+this.formatter.columnize(e)+") "}jsonExtract(e){return this._jsonExtract("jsonb_path_query",e)}jsonSet(e){return this._jsonSet("jsonb_set",Object.assign({},e,{path:this.client.toPathForJson(e.path)}))}jsonInsert(e){return this._jsonSet("jsonb_insert",Object.assign({},e,{path:this.client.toPathForJson(e.path)}))}jsonRemove(e){const t=`${tk(e.column,this.builder,this.client,this.bindingsHolder)} #- ${this.client.parameter(this.client.toPathForJson(e.path),this.builder,this.bindingsHolder)}`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){let t="";return t=!isNaN(e.value)&&parseInt(e.value)?"::int":!isNaN(e.value)&&parseFloat(e.value)?"::float":" #>> '{}'",`jsonb_path_query_first(${this._columnClause(e)}, ${this.client.parameter(e.jsonPath,this.builder,this.bindingsHolder)})${t} ${rk(e.operator,this.builder,this.client,this.bindingsHolder)} ${this._jsonValueClause(e)}`}whereJsonSupersetOf(e){return this._not(e,`${nk(e.column,void 0,this.builder,this.client,this.bindingsHolder)} @> ${this._jsonValueClause(e)}`)}whereJsonSubsetOf(e){return this._not(e,`${tk(e.column,this.builder,this.client,this.bindingsHolder)} <@ ${this._jsonValueClause(e)}`)}onJsonPathEquals(e){return this._onJsonPathEquals("jsonb_path_query_first",e)}},sk=class extends Ow{using(e){return this._single.using=e,this}withMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!0)}withNotMaterialized(e,t,r){return this._validateWithArgs(e,t,r,"with"),this.withWrapped(e,t,r,!1)}},ok={};const{isObject:ak}=vb,{toNumber:uk}=nw,lk=/(?<!')'(?!')/g;class ck extends pC{constructor(e,t,r){super(e,t,r),this.modifiers=["nullable","defaultTo","comment"],this._addCheckModifiers()}bit(e){return!1!==e.length?`bit(${e.length})`:"bit"}enu(e,t){const r=(t=t||{}).useNative&&t.existingType?void 0:e.join("', '");if(t.useNative){let e="";const n=t.schemaName||this.tableCompiler.schemaNameRaw;return n&&(e+=`"${n}".`),e+=`"${t.enumName}"`,t.existingType||this.tableCompiler.unshiftQuery(`create type ${e} as enum ('${r}')`),e}return`text check (${this.formatter.wrap(this.args[0])} in ('${r}'))`}decimal(e,t){return null===e?"decimal":`decimal(${uk(e,8)}, ${uk(t,2)})`}json(e){return e&&this.client.logger.deprecate("json(true)","jsonb()"),hk(this.client,e)}jsonb(){return hk(this.client,!0)}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} ~ ${this.client._escapeBinding(e)}`,t)}datetime(e=!1,t){let r;return ak(e)?({useTz:r,precision:t}=e):r=!e,r="boolean"!=typeof r||r,`${r?"timestamptz":"timestamp"}${t=null!=t?"("+t+")":""}`}timestamp(e=!1,t){return this.datetime(e,t)}comment(e){const t=this.args[0]||this.defaults("columnName"),r=e?`'${e.replace(lk,"''")}'`:"NULL";this.pushAdditional((function(){this.pushQuery(`comment on column ${this.tableCompiler.tableName()}.`+this.formatter.wrap(t)+" is "+r)}),e)}increments(e={primaryKey:!0}){return"serial"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}bigincrements(e={primaryKey:!0}){return"bigserial"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}}function hk(e,t){return!e.version||"cockroachdb"===e.config.client||parseFloat(e.version)>=9.2?t?"jsonb":"json":"text"}ck.prototype.bigint="bigint",ck.prototype.binary="bytea",ck.prototype.bool="boolean",ck.prototype.double="double precision",ck.prototype.floating="real",ck.prototype.smallint="smallint",ck.prototype.tinyint="smallint",ck.prototype.uuid="uuid",ok=ck;const{isObject:dk,isString:fk}=vb;var pk=class extends tC{constructor(e,t){super(e,t)}renameColumn(e,t){return this.pushQuery({sql:`alter table ${this.tableName()} rename ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`})}_setNullableState(e,t){const r=t?"drop not null":"set not null",n=`alter table ${this.tableName()} alter column ${this.formatter.wrap(e)} ${r}`;return this.pushQuery({sql:n})}compileAdd(e){const t=this.formatter.wrap(e),r=this.prefixArray("add column",this.getColumns(e));return this.pushQuery({sql:`alter table ${t} ${r.join(", ")}`})}createQuery(e,t,r){const n=t?"create table if not exists ":"create table ",i=" ("+e.sql.join(", ")+this._addChecks()+")";let s=n+this.tableName()+(r&&this.tableNameLike()?" (like "+this.tableNameLike()+" including all"+(e.sql.length?", "+e.sql.join(", "):"")+")":i);this.single.inherits&&(s+=` inherits (${this.formatter.wrap(this.single.inherits)})`),this.pushQuery({sql:s,bindings:e.bindings}),cE(this.single,"comment")&&this.comment(this.single.comment)}addColumns(e,t,r){if(t===this.alterColumnsPrefix)for(const n of r)this._addColumn(n);else super.addColumns(e,t)}_addColumn(e){const t=this.tableName(),r=e.getColumnType(),n=this.client.wrapIdentifier(e.getColumnName(),e.columnBuilder.queryContext()),i="enu"===e.type;this.pushQuery({sql:`alter table ${t} alter column ${n} drop default`,bindings:[]});const s=e.columnBuilder.alterNullable;s&&this.pushQuery({sql:`alter table ${t} alter column ${n} drop not null`,bindings:[]}),e.columnBuilder.alterType&&this.pushQuery({sql:`alter table ${t} alter column ${n} type ${r} using (${n}${i?"::text::":"::"}${r})`,bindings:[]});const o=e.modified.defaultTo;if(o){const r=e.defaultTo.apply(e,o);this.pushQuery({sql:`alter table ${t} alter column ${n} set ${r}`,bindings:[]})}if(s){const r=e.modified.nullable;r&&!1===r[0]&&this.pushQuery({sql:`alter table ${t} alter column ${n} set not null`,bindings:[]})}}comment(e){this.pushQuery(`comment on table ${this.tableName()} is '${this.single.comment}'`)}primary(e,t){let r;dk(t)&&({constraintName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} primary key (${this.formatter.columnize(e)})${r}`)}unique(e,t){let r;dk(t)&&({indexName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} unique (`+this.formatter.columnize(e)+")"+r)}index(e,t,r){let n,i;t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),fk(r)?i=r:dk(r)&&({indexType:i,predicate:n}=r);const s=n?" "+this.client.queryCompiler(n).where():"";this.pushQuery(`create index ${t} on ${this.tableName()}${i&&" using "+i||""} (`+this.formatter.columnize(e)+")"+s)}dropPrimary(e){e=e?this.formatter.wrap(e):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`alter table ${this.tableName()} drop constraint ${e}`)}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),t=this.schemaNameRaw?`${this.formatter.wrap(this.schemaNameRaw)}.${t}`:t,this.pushQuery("drop index "+t)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}},mk=class extends SC{constructor(e,t){super(e,t)}renameColumn(e,t){return this.pushQuery({sql:`alter view ${this.viewName()} rename ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`})}defaultTo(e,t){return this.pushQuery({sql:`alter view ${this.viewName()} alter ${this.formatter.wrap(e)} set default ${t}`})}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}createMaterializedView(){this.createQuery(this.columns,this.selectQuery,!0)}},yk=class extends NC{constructor(){super(...arguments)}checkOption(){this._single.checkOption="default_option"}localCheckOption(){this._single.checkOption="local"}cascadedCheckOption(){this._single.checkOption="cascaded"}},gk=class extends RE{constructor(e,t){super(e,t)}hasTable(e){let t="select * from information_schema.tables where table_name = ?";const r=[e];this.schema?(t+=" and table_schema = ?",r.push(this.schema)):t+=" and table_schema = current_schema()",this.pushQuery({sql:t,bindings:r,output:e=>e.rows.length>0})}hasColumn(e,t){let r="select * from information_schema.columns where table_name = ? and column_name = ?";const n=[e,t];this.schema?(r+=" and table_schema = ?",n.push(this.schema)):r+=" and table_schema = current_schema()",this.pushQuery({sql:r,bindings:n,output:e=>e.rows.length>0})}qualifiedTableName(e){const t=this.schema?`${this.schema}.${e}`:e;return this.formatter.wrap(t)}renameTable(e,t){this.pushQuery(`alter table ${this.qualifiedTableName(e)} rename to ${this.formatter.wrap(t)}`)}createSchema(e){this.pushQuery("create schema "+this.formatter.wrap(e))}createSchemaIfNotExists(e){this.pushQuery("create schema if not exists "+this.formatter.wrap(e))}dropSchema(e,t=!1){this.pushQuery(`drop schema ${this.formatter.wrap(e)}${t?" cascade":""}`)}dropSchemaIfExists(e,t=!1){this.pushQuery(`drop schema if exists ${this.formatter.wrap(e)}${t?" cascade":""}`)}dropExtension(e){this.pushQuery("drop extension "+this.formatter.wrap(e))}dropExtensionIfExists(e){this.pushQuery("drop extension if exists "+this.formatter.wrap(e))}createExtension(e){this.pushQuery("create extension "+this.formatter.wrap(e))}createExtensionIfNotExists(e){this.pushQuery("create extension if not exists "+this.formatter.wrap(e))}renameView(e,t){this.pushQuery(this.alterViewPrefix+`${this.formatter.wrap(e)} rename to ${this.formatter.wrap(t)}`)}refreshMaterializedView(e,t=!1){this.pushQuery({sql:`refresh materialized view${t?" concurrently":""} ${this.formatter.wrap(e)}`})}dropMaterializedView(e){this._dropView(e,!1,!0)}dropMaterializedViewIfExists(e){this._dropView(e,!0,!0)}};const{columnize:vk,wrap:bk,operator:_k}=Uw;var wk=class extends ik{truncate(){return"truncate "+this.tableName}upsert(){let e=this._upsert();if(""===e)return e;const{returning:t}=this.single;return t&&(e+=this._returning(t)),{sql:e,returning:t}}_upsert(){const e=this.single.upsert||[],t=this.with()+`upsert into ${this.tableName} `,r=this._insertBody(e);return""===r?"":t+r}_groupOrder(e,t){return this._basicGroupOrder(e,t)}whereJsonPath(e){let t="";return t=!isNaN(e.value)&&parseInt(e.value)?"::int":!isNaN(e.value)&&parseFloat(e.value)?"::float":" #>> '{}'",`json_extract_path(${this._columnClause(e)}, ${this.client.toArrayPathFromJsonPath(e.jsonPath,this.builder,this.bindingsHolder)})${t} ${_k(e.operator,this.builder,this.client,this.bindingsHolder)} ${this._jsonValueClause(e)}`}_jsonExtract(e,t){let r;return r=Array.isArray(t.column)?t.column:[t],r.map(e=>{const t=`json_extract_path(${vk(e.column||e[0],this.builder,this.client,this.bindingsHolder)}, ${this.client.toArrayPathFromJsonPath(e.path||e[1],this.builder,this.bindingsHolder)})`,r=e.alias||e[2];return r?this.client.alias(t,this.formatter.wrap(r)):t}).join(", ")}_onJsonPathEquals(e,t){return"json_extract_path("+bk(t.columnFirst,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.toArrayPathFromJsonPath(t.jsonPathFirst,this.builder,this.bindingsHolder)+") = json_extract_path("+bk(t.columnSecond,void 0,this.builder,this.client,this.bindingsHolder)+", "+this.client.toArrayPathFromJsonPath(t.jsonPathSecond,this.builder,this.bindingsHolder)+")"}},Ek=class extends pk{constructor(e,t){super(e,t)}addColumns(e,t,r){if(t===this.alterColumnsPrefix)for(const n of r)this.client.logger.warn("Experimental alter column in use, see issue: https://github.com/cockroachdb/cockroach/issues/49329"),this.pushQuery({sql:"SET enable_experimental_alter_column_type_general = true",bindings:[]}),super._addColumn(n);else super.addColumns(e,t)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`drop index ${this.tableName()}@${t} cascade `)}},Ck=class extends mk{renameColumn(e,t){throw new Error("rename column of views is not supported by this dialect.")}defaultTo(e,t){throw new Error("change default values of views is not supported by this dialect.")}},Tk=class extends Ow{upsert(e,t,r){return this._method="upsert",Xb(t)||this.returning(t,r),this._single.upsert=e,this}},Nk=function(e){return null==e},kk=class extends EC{columnizeWithPrefix(e,t){const r="string"==typeof t?[t]:t;let n="",i=-1;for(;++i<r.length;)i>0&&(n+=", "),n+=e+this.wrap(r[i]);return n}escapingStringDelimiters(e){return(e||"").replace(/'/g,"''")}};const Ok=Fv("knex:tx");var Sk=class extends jb{begin(e){return Ok("transaction::begin id=%s",this.txid),new Promise((t,r)=>{e.beginTransaction(e=>{if(e)return Ok("transaction::begin error id=%s message=%s",this.txid,e.message),r(e);t()},this.outerTx?this.txid:void 0,function(e){if(!e)return;e=e.toUpperCase().replace(" ","_");const t=xk[e];if(!t)throw new Error("Unknown Isolation level, was expecting one of: "+JSON.stringify($k));return t}(this.isolationLevel))}).then(this._resolver,this._rejecter)}savepoint(e){return Ok("transaction::savepoint id=%s",this.txid),new Promise((t,r)=>{e.saveTransaction(e=>{if(e)return Ok("transaction::savepoint id=%s message=%s",this.txid,e.message),r(e);this.trxClient.emit("query",{__knexUid:this.trxClient.__knexUid,__knexTxId:this.trxClient.__knexTxId,autogenerated:!0,sql:this.outerTx?`SAVE TRANSACTION [${this.txid}]`:"SAVE TRANSACTION"}),t()},this.outerTx?this.txid:void 0)})}commit(e,t){return Ok("transaction::commit id=%s",this.txid),new Promise((r,n)=>{e.commitTransaction(e=>{if(e)return Ok("transaction::commit error id=%s message=%s",this.txid,e.message),n(e);this._completed=!0,r(t)},this.outerTx?this.txid:void 0)}).then(()=>this._resolver(t),this._rejecter)}release(e,t){return this._resolver(t)}rollback(e,t){return this._completed=!0,Ok("transaction::rollback id=%s",this.txid),new Promise((r,n)=>e.inTransaction?"LoggedIn"!==e.state.name?n(new Error("Can't rollback transaction. There is a request in progress")):void e.rollbackTransaction(e=>{e&&Ok("transaction::rollback error id=%s message=%s",this.txid,e.message),n(e||t||new Error("Transaction rejected with non-error: undefined"))},this.outerTx?this.txid:void 0):n(t||new Error("Transaction rejected with non-error: undefined"))).catch(e=>{if(t||!this.doNotRejectOnRollback){if(t)try{e.originalError=t}catch(r){}this._rejecter(e)}else this._resolver()})}rollbackTo(e,t){return this.rollback(e,t).then(()=>{this.trxClient.emit("query",{__knexUid:this.trxClient.__knexUid,__knexTxId:this.trxClient.__knexTxId,autogenerated:!0,sql:"ROLLBACK TRANSACTION"})})}};const xk={READ_UNCOMMITTED:1,READ_COMMITTED:2,REPEATABLE_READ:3,SERIALIZABLE:4,SNAPSHOT:5},$k=Object.keys(xk).map(e=>e.toLowerCase().replace("_"," ")),{columnize:Ak}=Uw,jk=["columns","join","lock","where","union","group","having","order","limit","offset"];var Ik=class extends kE{constructor(e,t,r){super(e,t,r);const{onConflict:n}=this.single;if(n)throw new Error(".onConflict() is not supported for mssql.");this._emptyInsertValue="default values"}with(){const e=[];if(this.grouped.with)for(const r of this.grouped.with)r.recursive&&(e.push(r),r.recursive=!1);const t=super.with();for(const r of e)r.recursive=!0;return t}select(){const e=this.with(),t=jk.map(e=>this[e](this));return e+nE(t).join(" ")}insert(){return this.single.options&&this.single.options.includeTriggerModifications?this.insertWithTriggers():this.standardInsert()}insertWithTriggers(){const e=this.single.insert||[],{returning:t}=this.single;let r=this.with()+`${this._buildTempTable(t)}insert into ${this.tableName} `;const n=t?this._returning("insert",t,!0)+" ":"";if(Array.isArray(e)){if(0===e.length)return""}else if("object"==typeof e&&Xb(e))return{sql:r+n+this._emptyInsertValue+this._buildReturningSelect(t),returning:t};return r+=this._buildInsertData(e,n),t&&(r+=this._buildReturningSelect(t)),{sql:r,returning:t}}_buildInsertData(e,t){let r="";const n=this._prepInsert(e);if("string"==typeof n)r+=n;else if(n.columns.length)r+="("+this.formatter.columnize(n.columns),r+=`) ${t}values (`+this._buildInsertValues(n)+")";else{if(1!==e.length||!e[0])return"";r+=t+this._emptyInsertValue}return r}standardInsert(){const e=this.single.insert||[];let t=this.with()+`insert into ${this.tableName} `;const{returning:r}=this.single,n=r?this._returning("insert",r)+" ":"";if(Array.isArray(e)){if(0===e.length)return""}else if("object"==typeof e&&Xb(e))return{sql:t+n+this._emptyInsertValue,returning:r};return t+=this._buildInsertData(e,n),{sql:t,returning:r}}update(){return this.single.options&&this.single.options.includeTriggerModifications?this.updateWithTriggers():this.standardUpdate()}updateWithTriggers(){const e=this.top(),t=this.with(),r=this._prepUpdate(this.single.update),n=this.join(),i=this.where(),s=this.order(),{returning:o}=this.single;return{sql:t+this._buildTempTable(o)+`update ${e?e+" ":""}${this.tableName} set `+r.join(", ")+(o?" "+this._returning("update",o,!0):"")+(n?` from ${this.tableName} ${n}`:"")+(i?" "+i:"")+(s?" "+s:"")+(o?this._buildReturningSelect(o):this._returning("rowcount","@@rowcount")),returning:o||"@@rowcount"}}_formatGroupsItemValue(e,t){const r=super._formatGroupsItemValue(e);if(t&&!(e instanceof Hw)){const e=`IIF(${r} is null,`;if("first"===t)return e+"0,1)";if("last"===t)return e+"1,0)"}return r}standardUpdate(){const e=this.top(),t=this.with(),r=this._prepUpdate(this.single.update),n=this.join(),i=this.where(),s=this.order(),{returning:o}=this.single;return{sql:t+`update ${e?e+" ":""}${this.tableName} set `+r.join(", ")+(o?" "+this._returning("update",o):"")+(n?` from ${this.tableName} ${n}`:"")+(i?" "+i:"")+(s?" "+s:"")+(o?"":this._returning("rowcount","@@rowcount")),returning:o||"@@rowcount"}}del(){return this.single.options&&this.single.options.includeTriggerModifications?this.deleteWithTriggers():this.standardDelete()}deleteWithTriggers(){const e=this.with(),{tableName:t}=this,r=this.where(),n=this.join(),{returning:i}=this.single,s=i?" "+this._returning("del",i,!0):"",o=n?`${t}${s} `:"";return{sql:e+`${this._buildTempTable(i)}delete ${o}from ${t}`+(n?"":s)+(n?" "+n:"")+(r?" "+r:"")+(i?this._buildReturningSelect(i):this._returning("rowcount","@@rowcount")),returning:i||"@@rowcount"}}standardDelete(){const e=this.with(),{tableName:t}=this,r=this.where(),n=this.join(),{returning:i}=this.single,s=i?" "+this._returning("del",i):"";return{sql:e+`delete ${n?`${t}${s} `:""}from ${t}`+(n?"":s)+(n?" "+n:"")+(r?" "+r:"")+(i?"":this._returning("rowcount","@@rowcount")),returning:i||"@@rowcount"}}columns(){let e="";if(this.onlyUnions())return"";const t=this.top(),r=this._hintComments(),n=this.grouped.columns||[];let i=-1,s=[];if(n)for(;++i<n.length;){const t=n[i];t.distinct&&(e="distinct "),t.distinctOn?e=this.distinctOn(t.value):"aggregate"===t.type?s.push(...this.aggregate(t)):"aggregateRaw"===t.type?s.push(this.aggregateRaw(t)):"analytic"===t.type?s.push(this.analytic(t)):"json"===t.type?s.push(this.json(t)):t.value&&t.value.length>0&&s.push(this.formatter.columnize(t.value))}return 0===s.length&&(s=["*"]),`${this.onlyJson()?"":"select "}${r}${e}`+(t?t+" ":"")+s.join(", ")+(this.tableName?" from "+this.tableName:"")}_returning(e,t,r){switch(e){case"update":case"insert":return t?`output ${this.formatter.columnizeWithPrefix("inserted.",t)}${r?" into #out":""}`:"";case"del":return t?`output ${this.formatter.columnizeWithPrefix("deleted.",t)}${r?" into #out":""}`:"";case"rowcount":return t?";select @@rowcount":""}}_buildTempTable(e){if(e&&e.length>0){let t="";t=Array.isArray(e)?e.map(e=>"[t]."+this.formatter.columnize(e)).join(","):"[t]."+this.formatter.columnize(e);let r=`select top(0) ${t} into #out `;return r+=`from ${this.tableName} as t `,r+=`left join ${this.tableName} on 0=1;`,r}return""}_buildReturningSelect(e){if(e&&e.length>0){let t="";t=Array.isArray(e)?e.map(e=>""+this.formatter.columnize(e)).join(","):this.formatter.columnize(e);let r=`; select ${t} from #out; `;return r+="drop table #out;",r}return""}truncate(){return"truncate table "+this.tableName}forUpdate(){return"with (UPDLOCK)"}forShare(){return"with (HOLDLOCK)"}columnInfo(){const e=this.single.columnInfo;let t=this.single.schema;const r=this.client.customWrapIdentifier(this.single.table,hv);t&&(t=this.client.customWrapIdentifier(t,hv));let n="select [COLUMN_NAME], [COLUMN_DEFAULT], [DATA_TYPE], [CHARACTER_MAXIMUM_LENGTH], [IS_NULLABLE] from INFORMATION_SCHEMA.COLUMNS where table_name = ? and table_catalog = ?";const i=[r,this.client.database()];return t?(n+=" and table_schema = ?",i.push(t)):n+=" and table_schema = 'dbo'",{sql:n,bindings:i,output(t){const r=t.reduce((e,t)=>(e[t[0].value]={defaultValue:t[1].value,type:t[2].value,maxLength:t[3].value,nullable:"YES"===t[4].value},e),{});return e&&r[e]||r}}}top(){const e=!this.single.limit&&0!==this.single.limit,t=!this.single.offset;return e||!t?"":`top (${this._getValueOrParameterFromAttribute("limit")})`}limit(){return""}offset(){const e=!this.single.limit&&0!==this.single.limit,t=!this.single.offset;if(t)return"";let r=`offset ${t?"0":this._getValueOrParameterFromAttribute("offset")} rows`;return e||(r+=` fetch next ${this._getValueOrParameterFromAttribute("limit")} rows only`),r}whereLike(e){return`${this._columnClause(e)} collate SQL_Latin1_General_CP1_CS_AS ${this._not(e,"like ")}${this._valueClause(e)}`}whereILike(e){return`${this._columnClause(e)} collate SQL_Latin1_General_CP1_CI_AS ${this._not(e,"like ")}${this._valueClause(e)}`}jsonExtract(e){return this._jsonExtract(e.singleValue?"JSON_VALUE":"JSON_QUERY",e)}jsonSet(e){return this._jsonSet("JSON_MODIFY",e)}jsonInsert(e){return this._jsonSet("JSON_MODIFY",e)}jsonRemove(e){const t=`JSON_MODIFY(${Ak(e.column,this.builder,this.client,this.bindingsHolder)},${this.client.parameter(e.path,this.builder,this.bindingsHolder)}, NULL)`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){return this._whereJsonPath("JSON_VALUE",e)}whereJsonSupersetOf(e){throw new Error("Json superset where clause not actually supported by MSSQL")}whereJsonSubsetOf(e){throw new Error("Json subset where clause not actually supported by MSSQL")}_getExtracts(e,t){const r=Ak(e.column,this.builder,this.client,this.bindingsHolder);return(Array.isArray(e.values)?e.values:[e.values]).map((function(e){return"JSON_VALUE("+r+","+this.client.parameter(e,this.builder,this.bindingsHolder)+")"}),this).join(t)}onJsonPathEquals(e){return this._onJsonPathEquals("JSON_VALUE",e)}},Rk={};class Pk extends RE{constructor(e,t){super(e,t)}dropTableIfExists(e){const t=this.formatter.wrap(Mk(this.schema,e));this.pushQuery(`if object_id('${t}', 'U') is not null DROP TABLE ${t}`)}dropViewIfExists(e){const t=this.formatter.wrap(Mk(this.schema,e));this.pushQuery(`if object_id('${t}', 'V') is not null DROP VIEW ${t}`)}renameTable(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(Mk(this.schema,e),this.builder,this.bindingsHolder)}, ${this.client.parameter(t,this.builder,this.bindingsHolder)}`)}renameView(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(Mk(this.schema,e),this.builder,this.bindingsHolder)}, ${this.client.parameter(t,this.builder,this.bindingsHolder)}`)}hasTable(e){const t=[e];let r="SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = "+this.client.parameter(Mk(this.schema,e),this.builder,this.bindingsHolder);this.schema&&(r+=" AND TABLE_SCHEMA = ?",t.push(this.schema)),this.pushQuery({sql:r,bindings:t,output:e=>e.length>0})}hasColumn(e,t){const r=`select object_id from sys.columns where name = ${this.client.parameter(t,this.builder,this.bindingsHolder)} and object_id = object_id(${this.client.parameter(this.formatter.wrap(Mk(this.schema,e)),this.builder,this.bindingsHolder)})`;this.pushQuery({sql:r,output:e=>e.length>0})}}function Mk(e,t){return e?`${e}.${t}`:t}Pk.prototype.dropTablePrefix="DROP TABLE ",Rk=Pk;var Lk={};const{isObject:qk}=vb;class Dk extends tC{constructor(e,t){super(e,t)}createQuery(e,t,r){let n=t?`if object_id('${this.tableName()}', 'U') is null `:"";n+=r?`SELECT * INTO ${this.tableName()} FROM ${this.tableNameLike()} WHERE 0=1`:"CREATE TABLE "+this.tableName()+(this._formatting?" (\n    ":" (")+e.sql.join(this._formatting?",\n    ":", ")+this._addChecks()+")",this.pushQuery(n),this.single.comment&&this.comment(this.single.comment),r&&this.addColumns(e,this.addColumnsPrefix)}comment(e){if(!e)return;e.length>3750&&this.client.logger.warn("Your comment might be longer than the max comment length for MSSQL of 7,500 bytes.");const t=this.formatter.escapingStringDelimiters(e),r=this.formatter.escapingStringDelimiters(this.schemaNameRaw||"dbo"),n=this.formatter.escapingStringDelimiters(this.tableNameRaw),i=`N'MS_Description', N'${t}', N'Schema', N'${r}', N'Table', N'${n}'`,s=`EXISTS(SELECT * FROM sys.fn_listextendedproperty(N'MS_Description', N'Schema', N'${r}', N'Table', N'${n}', NULL, NULL))`;this.pushQuery(`IF ${s}\n  EXEC sys.sp_updateextendedproperty ${i}\nELSE\n  EXEC sys.sp_addextendedproperty ${i}`)}addColumns(e,t){t=t||this.addColumnsPrefix,e.sql.length>0&&this.pushQuery({sql:(this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+t+e.sql.join(", "),bindings:e.bindings})}alterColumns(e,t){for(let r=0,n=t.length;r<n;r++){const e=t[r];if(e.modified.defaultTo){const t=`\n              DECLARE @constraint varchar(100) = (SELECT default_constraints.name\n                                                  FROM sys.all_columns\n                                                  INNER JOIN sys.tables\n                                                    ON all_columns.object_id = tables.object_id\n                                                  INNER JOIN sys.schemas\n                                                    ON tables.schema_id = schemas.schema_id\n                                                  INNER JOIN sys.default_constraints\n                                                    ON all_columns.default_object_id = default_constraints.object_id\n                                                  WHERE schemas.name = '${this.schemaNameRaw||"dbo"}'\n                                                  AND tables.name = '${this.tableNameRaw}'\n                                                  AND all_columns.name = '${e.getColumnName()}')\n\n              IF @constraint IS NOT NULL EXEC('ALTER TABLE ${this.tableNameRaw} DROP CONSTRAINT ' + @constraint)`;this.pushQuery(t)}}e.sql.forEach(t=>{this.pushQuery({sql:(this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+(this.lowerCase?this.alterColumnPrefix.toLowerCase():this.alterColumnPrefix)+t,bindings:e.bindings})})}dropColumn(){const e=this,t=nw.normalizeArr.apply(null,arguments),r=(Array.isArray(t)?t:[t]).map(t=>e.formatter.wrap(t)),n=this.schemaNameRaw||"dbo";for(const i of t){const e=`\n              DECLARE @constraint varchar(100) = (SELECT default_constraints.name\n                                                  FROM sys.all_columns\n                                                  INNER JOIN sys.tables\n                                                    ON all_columns.object_id = tables.object_id\n                                                  INNER JOIN sys.schemas\n                                                    ON tables.schema_id = schemas.schema_id\n                                                  INNER JOIN sys.default_constraints\n                                                    ON all_columns.default_object_id = default_constraints.object_id\n                                                  WHERE schemas.name = '${n}'\n                                                  AND tables.name = '${this.tableNameRaw}'\n                                                  AND all_columns.name = '${i}')\n\n              IF @constraint IS NOT NULL EXEC('ALTER TABLE ${this.tableNameRaw} DROP CONSTRAINT ' + @constraint)`;this.pushQuery(e)}this.pushQuery((this.lowerCase?"alter table ":"ALTER TABLE ")+this.tableName()+" "+this.dropColumnPrefix+r.join(", "))}changeType(){}renameColumn(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(this.tableName()+"."+e,this.tableBuilder,this.bindingsHolder)}, ${this.client.parameter(t,this.tableBuilder,this.bindingsHolder)}, 'COLUMN'`)}dropFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.CONSTRAINT_NAME),i=r.wrap(t.TABLE_NAME);return e.query({sql:`ALTER TABLE ${i} DROP CONSTRAINT ${n}`})})))}createFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.TABLE_NAME),i=r.wrap(t.CONSTRAINT_NAME),s=r.columnize(t.COLUMN_NAME),o=r.columnize(t.REFERENCED_COLUMN_NAME),a=r.wrap(t.REFERENCED_TABLE_NAME),u=" ON UPDATE "+t.UPDATE_RULE,l=" ON DELETE "+t.DELETE_RULE;return e.query({sql:`ALTER TABLE ${n} ADD CONSTRAINT ${i} FOREIGN KEY (`+s+") REFERENCES "+a+" ("+o+")"+u+l})})))}index(e,t,r){let n;t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),qk(r)&&({predicate:n}=r);const i=n?" "+this.client.queryCompiler(n).where():"";this.pushQuery(`CREATE INDEX ${t} ON ${this.tableName()} (${this.formatter.columnize(e)})${i}`)}primary(e,t){let r;qk(t)&&({constraintName:t,deferrable:r}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`mssql: primary key constraint [${t}] will not be deferrable ${r} because mssql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.forCreate?this.pushQuery(`CONSTRAINT ${t} PRIMARY KEY (${this.formatter.columnize(e)})`):this.pushQuery(`ALTER TABLE ${this.tableName()} ADD CONSTRAINT ${t} PRIMARY KEY (${this.formatter.columnize(e)})`)}unique(e,t){let r,n=!1;qk(t)&&({indexName:t,deferrable:r,useConstraint:n}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`mssql: unique index [${t}] will not be deferrable ${r} because mssql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),Array.isArray(e)||(e=[e]);const i=e.map(e=>this.formatter.columnize(e)+" IS NOT NULL").join(" AND ");n?this.pushQuery(`ALTER TABLE ${this.tableName()} ADD CONSTRAINT ${t} UNIQUE (${this.formatter.columnize(e)})`):this.pushQuery(`CREATE UNIQUE INDEX ${t} ON ${this.tableName()} (${this.formatter.columnize(e)}) WHERE ${i}`)}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery(`DROP INDEX ${t} ON ${this.tableName()}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`ALTER TABLE ${this.tableName()} DROP CONSTRAINT ${t}`)}dropPrimary(e){e=e?this.formatter.wrap(e):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`ALTER TABLE ${this.tableName()} DROP CONSTRAINT ${e}`)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`DROP INDEX ${t} ON ${this.tableName()}`)}}Dk.prototype.createAlterTableMethods=["foreign","primary"],Dk.prototype.lowerCase=!1,Dk.prototype.addColumnsPrefix="ADD ",Dk.prototype.dropColumnPrefix="DROP COLUMN ",Dk.prototype.alterColumnPrefix="ALTER COLUMN ",Lk=Dk;const{columnize:Fk}=Uw;var Uk=class extends SC{constructor(e,t){super(e,t)}createQuery(e,t,r,n){let i="CREATE "+(n?"OR ALTER ":"")+"VIEW "+this.viewName();i+=e?" ("+Fk(e,this.viewBuilder,this.client,this.bindingsHolder)+")":"",i+=" AS ",i+=t.toString(),this.pushQuery({sql:i})}renameColumn(e,t){this.pushQuery(`exec sp_rename ${this.client.parameter(this.viewName()+"."+e,this.viewBuilder,this.bindingsHolder)}, ${this.client.parameter(t,this.viewBuilder,this.bindingsHolder)}, 'COLUMN'`)}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}},Vk={};const{toNumber:Bk}=nw,{formatDefault:zk}=jw,{operator:Hk}=Uw;class Wk extends pC{constructor(e,t,r){super(e,t,r),this.modifiers=["nullable","defaultTo","first","after","comment"],this._addCheckModifiers()}double(e,t){return"float"}floating(e,t){return"float"}integer(){return"int"}tinyint(){return"tinyint"}varchar(e){return`nvarchar(${Bk(e,255)})`}timestamp({useTz:e=!1}={}){return e?"datetimeoffset":"datetime2"}bit(e){return e>1&&this.client.logger.warn("Bit field is exactly 1 bit length for MSSQL"),"bit"}binary(e){return e?`varbinary(${Bk(e)})`:"varbinary(max)"}first(){return this.client.logger.warn("Column first modifier not available for MSSQL"),""}after(e){return this.client.logger.warn("Column after modifier not available for MSSQL"),""}defaultTo(e,{constraintName:t}={}){const r=zk(e,this.type,this.client);return t=void 0!==t?t:`${this.tableCompiler.tableNameRaw}_${this.getColumnName()}_default`.toLowerCase(),"alter"===this.columnBuilder._method?(this.pushAdditional((function(){this.pushQuery(`ALTER TABLE ${this.tableCompiler.tableName()} ADD CONSTRAINT ${this.formatter.wrap(t)} DEFAULT ${r} FOR ${this.formatter.wrap(this.getColumnName())}`)})),""):t?`CONSTRAINT ${this.formatter.wrap(t)} DEFAULT ${r}`:"DEFAULT "+r}comment(e){if(!e)return;e&&e.length>3750&&this.client.logger.warn("Your comment might be longer than the max comment length for MSSQL of 7,500 bytes.");const t=this.formatter.escapingStringDelimiters(e),r=this.tableCompiler.schemaNameRaw||"dbo",n=this.formatter.escapingStringDelimiters(this.tableCompiler.tableNameRaw),i=this.formatter.escapingStringDelimiters(this.args[0]||this.defaults("columnName")),s=`N'MS_Description', N'${t}', N'Schema', N'${r}', N'Table', N'${n}', N'Column', N'${i}'`;return this.pushAdditional((function(){const e=`EXISTS(SELECT * FROM sys.fn_listextendedproperty(N'MS_Description', N'Schema', N'${r}', N'Table', N'${n}', N'Column', N'${i}'))`;this.pushQuery(`IF ${e}\n  EXEC sys.sp_updateextendedproperty ${s}\nELSE\n  EXEC sys.sp_addextendedproperty ${s}`)})),""}checkLength(e,t,r){return this._check(`LEN(${this.formatter.wrap(this.getColumnName())}) ${Hk(e,this.columnBuilder,this.bindingsHolder)} ${Bk(t)}`,r)}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} LIKE ${this.client._escapeBinding("%"+e+"%")}`,t)}increments(e={primaryKey:!0}){return"int identity(1,1) not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}bigincrements(e={primaryKey:!0}){return"bigint identity(1,1) not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}}Wk.prototype.bigint="bigint",Wk.prototype.mediumint="int",Wk.prototype.smallint="smallint",Wk.prototype.text="nvarchar(max)",Wk.prototype.mediumtext="nvarchar(max)",Wk.prototype.longtext="nvarchar(max)",Wk.prototype.json=Wk.prototype.jsonb="nvarchar(max)",Wk.prototype.enu="nvarchar(100)",Wk.prototype.uuid=({useBinaryUuid:e=!1}={})=>e?"binary(16)":"uniqueidentifier",Wk.prototype.datetime="datetime2",Wk.prototype.bool="bit",Vk=Wk;var Qk=vv((function(e,t){return function(e,t,r){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,r)}),t)}(e,1,t)}));const Jk=Fv("knex:tx");var Gk=class extends jb{query(e,t,r,n){const i=this,s=this.trxClient.query(e,t).catch(e=>{1305!==e.errno?(r=2,n=e,i._completed=!0,Jk("%s error running transaction query",i.txid)):this.trxClient.logger.warn("Transaction was implicitly committed, do not mix transactions and DDL with MySQL (#805)")}).then((function(e){if(1===r&&i._resolver(n),2===r){if(void 0===n){if(i.doNotRejectOnRollback&&/^ROLLBACK\b/i.test(t))return void i._resolver();n=new Error("Transaction rejected with non-error: "+n)}i._rejecter(n)}return e}));return 1!==r&&2!==r||(i._completed=!0),s}};const{wrapAsIdentifier:Kk}=jw,{columnize:Zk,wrap:Yk}=Uw;var Xk=class extends kE{constructor(e,t,r){super(e,t,r);const{returning:n}=this.single;n&&this.client.logger.warn(".returning() is not supported by mysql and will not have any effect."),this._emptyInsertValue="() values ()"}insert(){let e=super.insert();if(""===e)return e;const{ignore:t,merge:r,insert:n}=this.single;if(t&&(e=e.replace("insert into","insert ignore into")),r&&(e+=this._merge(r.updates,n),this.where()))throw new Error(".onConflict().merge().where() is not supported for mysql");return e}_merge(e,t){const r=" on duplicate key update ";if(e&&Array.isArray(e))return r+e.map(e=>Kk(e,this.formatter.builder,this.client)).map(e=>`${e} = values(${e})`).join(", ");if(e&&"object"==typeof e)return r+this._prepUpdate(e).join(",");{const e=this._prepInsert(t);if("string"==typeof e)throw new Error("If using merge with a raw insert query, then updates must be provided");return r+e.columns.map(e=>Kk(e,this.builder,this.client)).map(e=>`${e} = values(${e})`).join(", ")}}update(){const e=this.with(),t=this.join(),r=this._prepUpdate(this.single.update),n=this.where(),i=this.order(),s=this.limit();return e+"update "+this.tableName+(t?" "+t:"")+" set "+r.join(", ")+(n?" "+n:"")+(i?" "+i:"")+(s?" "+s:"")}forUpdate(){return"for update"}forShare(){return"lock in share mode"}skipLocked(){return"skip locked"}noWait(){return"nowait"}columnInfo(){const e=this.single.columnInfo;return{sql:"select * from information_schema.columns where table_name = ? and table_schema = ?",bindings:[this.client.customWrapIdentifier(this.single.table,hv),this.client.database()],output(t){const r=t.reduce((function(e,t){return e[t.COLUMN_NAME]={defaultValue:"NULL"===t.COLUMN_DEFAULT?null:t.COLUMN_DEFAULT,type:t.DATA_TYPE,maxLength:t.CHARACTER_MAXIMUM_LENGTH,nullable:"YES"===t.IS_NULLABLE},e}),{});return e&&r[e]||r}}}limit(){const e=!this.single.limit&&0!==this.single.limit;return e&&!this.single.offset?"":"limit "+(this.single.offset&&e?"18446744073709551615":this._getValueOrParameterFromAttribute("limit"))}whereLike(e){return`${this._columnClause(e)} ${this._not(e,"like ")}${this._valueClause(e)} COLLATE utf8_bin`}whereILike(e){return`${this._columnClause(e)} ${this._not(e,"like ")}${this._valueClause(e)}`}jsonExtract(e){return this._jsonExtract(["json_extract","json_unquote"],e)}jsonSet(e){return this._jsonSet("json_set",e)}jsonInsert(e){return this._jsonSet("json_insert",e)}jsonRemove(e){const t=`json_remove(${Zk(e.column,this.builder,this.client,this.bindingsHolder)},${this.client.parameter(e.path,this.builder,this.bindingsHolder)})`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonObject(e){return this._not(e,`json_contains(${this._columnClause(e)}, ${this._jsonValueClause(e)})`)}whereJsonPath(e){return this._whereJsonPath("json_extract",e)}whereJsonSupersetOf(e){return this._not(e,`json_contains(${Yk(e.column,void 0,this.builder,this.client,this.bindingsHolder)},${this._jsonValueClause(e)})`)}whereJsonSubsetOf(e){return this._not(e,`json_contains(${this._jsonValueClause(e)},${Yk(e.column,void 0,this.builder,this.client,this.bindingsHolder)})`)}onJsonPathEquals(e){return this._onJsonPathEquals("json_extract",e)}},eO=class extends RE{constructor(e,t){super(e,t)}renameTable(e,t){this.pushQuery(`rename table ${this.formatter.wrap(e)} to ${this.formatter.wrap(t)}`)}renameView(e,t){this.renameTable(e,t)}hasTable(e){let t="select * from information_schema.tables where table_name = ?";const r=[e];this.schema?(t+=" and table_schema = ?",r.push(this.schema)):t+=" and table_schema = database()",this.pushQuery({sql:t,bindings:r,output:function(e){return e.length>0}})}hasColumn(e,t){this.pushQuery({sql:"show columns from "+this.formatter.wrap(e),output(e){return e.some(e=>this.client.wrapIdentifier(e.Field.toLowerCase())===this.client.wrapIdentifier(t.toLowerCase()))}})}},tO={};const{isObject:rO,isString:nO}=vb;class iO extends tC{constructor(e,t){super(e,t)}createQuery(e,t,r){const n=t?"create table if not exists ":"create table ",{client:i}=this;let s={},o=" ("+e.sql.join(", ");o+=this.primaryKeys()||"",o+=this._addChecks(),o+=")";let a=n+this.tableName()+(r&&this.tableNameLike()?" like "+this.tableNameLike():o);i.connectionSettings&&(s=i.connectionSettings);const u=this.single.charset||s.charset||"",l=this.single.collate||s.collate||"",c=this.single.engine||"";if(u&&!r&&(a+=" default character set "+u),l&&(a+=" collate "+l),c&&(a+=" engine = "+c),this.single.comment){const e=this.single.comment||"",t=1024;e.length>t&&this.client.logger.warn(`The max length for a table comment is ${t} characters`),a+=` comment = '${e}'`}this.pushQuery(a),r&&this.addColumns(e,this.addColumnsPrefix)}comment(e){this.pushQuery(`alter table ${this.tableName()} comment = '${e}'`)}changeType(){}renameColumn(e,t){const r=this,n=this.tableName(),i=this.formatter.wrap(e)+" "+this.formatter.wrap(t);this.pushQuery({sql:`show full fields from ${n} where field = `+this.client.parameter(e,this.tableBuilder,this.bindingsHolder),output(s){const o=s[0],a=this;return r.getFKRefs(a).then(([s])=>new Promise((e,t)=>{try{s.length||e(),e(r.dropFKRefs(a,s))}catch(CT){t(CT)}}).then((function(){let e=`alter table ${n} change ${i} ${o.Type}`;return"YES"!==String(o.Null).toUpperCase()?e+=" NOT NULL":e+=" NULL",void 0!==o.Default&&null!==o.Default&&(e+=` DEFAULT '${o.Default}'`),void 0!==o.Collation&&null!==o.Collation&&(e+=` COLLATE '${o.Collation}'`),"auto_increment"==o.Extra&&(e+=" AUTO_INCREMENT"),a.query({sql:e})})).then((function(){if(s.length)return r.createFKRefs(a,s.map((function(r){return r.REFERENCED_COLUMN_NAME===e&&(r.REFERENCED_COLUMN_NAME=t),r.COLUMN_NAME===e&&(r.COLUMN_NAME=t),r})))})))}})}primaryKeys(){const e=(this.grouped.alterTable||[]).filter(e=>"primary"===e.method);if(e.length>0&&e[0].args.length>0){const t=e[0].args[0];let r=e[0].args[1]||"";if(r&&(r=" constraint "+this.formatter.wrap(r)),this.grouped.columns){const e=this._getIncrementsColumnNames();e.length&&e.forEach(e=>{t.includes(e)||t.unshift(e)})}return`,${r} primary key (${this.formatter.columnize(t)})`}}getFKRefs(e){const t={bindings:[]},r="SELECT KCU.CONSTRAINT_NAME, KCU.TABLE_NAME, KCU.COLUMN_NAME,        KCU.REFERENCED_TABLE_NAME, KCU.REFERENCED_COLUMN_NAME,        RC.UPDATE_RULE, RC.DELETE_RULE FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KCU JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS RC        USING(CONSTRAINT_NAME)WHERE KCU.REFERENCED_TABLE_NAME = "+this.client.parameter(this.tableNameRaw,this.tableBuilder,t)+"   AND KCU.CONSTRAINT_SCHEMA = "+this.client.parameter(this.client.database(),this.tableBuilder,t)+"   AND RC.CONSTRAINT_SCHEMA = "+this.client.parameter(this.client.database(),this.tableBuilder,t);return e.query({sql:r,bindings:t.bindings})}dropFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.CONSTRAINT_NAME),i=r.wrap(t.TABLE_NAME);return e.query({sql:`alter table ${i} drop foreign key ${n}`})})))}createFKRefs(e,t){const r=this.client.formatter(this.tableBuilder);return Promise.all(t.map((function(t){const n=r.wrap(t.TABLE_NAME),i=r.wrap(t.CONSTRAINT_NAME),s=r.columnize(t.COLUMN_NAME),o=r.columnize(t.REFERENCED_COLUMN_NAME),a=r.wrap(t.REFERENCED_TABLE_NAME),u=" ON UPDATE "+t.UPDATE_RULE,l=" ON DELETE "+t.DELETE_RULE;return e.query({sql:`alter table ${n} add constraint ${i} foreign key (`+s+") references "+a+" ("+o+")"+u+l})})))}index(e,t,r){let n,i;nO(r)?i=r:rO(r)&&({indexType:i,storageEngineIndexType:n}=r),t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),n=n?" using "+n:"",this.pushQuery(`alter table ${this.tableName()} add${i?" "+i:""} index ${t}(${this.formatter.columnize(e)})${n}`)}primary(e,t){let r;rO(t)&&({constraintName:t,deferrable:r}=t),r&&"not deferrable"!==r&&this.client.logger.warn(`mysql: primary key constraint \`${t}\` will not be deferrable ${r} because mysql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey");const n=e;let i=[];this.grouped.columns&&(i=this._getIncrementsColumnNames(),i&&i.forEach(e=>{n.includes(e)||n.unshift(e)})),"create"!==this.method&&"createIfNot"!==this.method&&this.pushQuery(`alter table ${this.tableName()} add primary key ${t}(${this.formatter.columnize(n)})`),i.length&&this.pushQuery(`alter table ${this.tableName()} modify column ${this.formatter.columnize(i)} int unsigned not null auto_increment`)}unique(e,t){let r,n;rO(t)&&({indexName:t,deferrable:n,storageEngineIndexType:r}=t),n&&"not deferrable"!==n&&this.client.logger.warn(`mysql: unique index \`${t}\` will not be deferrable ${n} because mysql does not support deferred constraints.`),t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),r=r?" using "+r:"",this.pushQuery(`alter table ${this.tableName()} add unique ${t}(${this.formatter.columnize(e)})${r}`)}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop index ${t}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop foreign key ${t}`)}dropPrimary(){this.pushQuery(`alter table ${this.tableName()} drop primary key`)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop index ${t}`)}}iO.prototype.addColumnsPrefix="add ",iO.prototype.alterColumnsPrefix="modify ",iO.prototype.dropColumnPrefix="drop ",tO=iO;var sO={};const{isObject:oO}=vb,{toNumber:aO}=nw,uO=/(?<!\\)'/g;class lO extends pC{constructor(e,t,r){super(e,t,r),this.modifiers=["unsigned","nullable","defaultTo","comment","collate","first","after"],this._addCheckModifiers()}double(e,t){return e?`double(${aO(e,8)}, ${aO(t,2)})`:"double"}integer(e){return"int"+(e=e?`(${aO(e,11)})`:"")}tinyint(e){return"tinyint"+(e=e?`(${aO(e,1)})`:"")}text(e){switch(e){case"medium":case"mediumtext":return"mediumtext";case"long":case"longtext":return"longtext";default:return"text"}}mediumtext(){return this.text("medium")}longtext(){return this.text("long")}enu(e){return`enum('${e.join("', '")}')`}datetime(e){return oO(e)&&({precision:e}=e),"number"==typeof e?`datetime(${e})`:"datetime"}timestamp(e){return oO(e)&&({precision:e}=e),"number"==typeof e?`timestamp(${e})`:"timestamp"}time(e){return oO(e)&&({precision:e}=e),"number"==typeof e?`time(${e})`:"time"}bit(e){return e?`bit(${aO(e)})`:"bit"}binary(e){return e?`varbinary(${aO(e)})`:"blob"}json(){return"json"}jsonb(){return"json"}defaultTo(e){if(null==e)return;if(("json"===this.type||"jsonb"===this.type)&&oO(e))return`default ('${JSON.stringify(e)}')`;const t=super.defaultTo.apply(this,arguments);return"blob"!==this.type&&-1===this.type.indexOf("text")?t:""}unsigned(){return"unsigned"}comment(e){return e&&e.length>255&&this.client.logger.warn("Your comment is longer than the max comment length for MySQL"),e&&`comment '${e.replace(uO,"\\'")}'`}first(){return"first"}after(e){return"after "+this.formatter.wrap(e)}collate(e){return e&&`collate '${e}'`}checkRegex(e,t){return this._check(`${this.formatter.wrap(this.getColumnName())} REGEXP ${this.client._escapeBinding(e)}`,t)}increments(e={primaryKey:!0}){return"int unsigned not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" auto_increment primary key":"")}bigincrements(e={primaryKey:!0}){return"bigint unsigned not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" auto_increment primary key":"")}}lO.prototype.bigint="bigint",lO.prototype.mediumint="mediumint",lO.prototype.smallint="smallint",sO=lO;var cO=class extends SC{constructor(e,t){super(e,t)}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}},hO=class extends NC{constructor(){super(...arguments)}checkOption(){this._single.checkOption="default_option"}localCheckOption(){this._single.checkOption="local"}cascadedCheckOption(){this._single.checkOption="cascaded"}};const dO=Fv("knex:tx");var fO=class extends jb{query(e,t,r,n){const i=this,s=this.trxClient.query(e,t).catch(e=>{"ER_SP_DOES_NOT_EXIST"!==e.code?(r=2,n=e,i._completed=!0,dO("%s error running transaction query",i.txid)):this.trxClient.logger.warn("Transaction was implicitly committed, do not mix transactions and DDL with MySQL (#805)")}).then((function(e){if(1===r&&i._resolver(n),2===r){if(void 0===n){if(i.doNotRejectOnRollback&&/^ROLLBACK\b/i.test(t))return void i._resolver();n=new Error("Transaction rejected with non-error: "+n)}return i._rejecter(n),e}}));return 1!==r&&2!==r||(i._completed=!0),s}},pO={};function mO(e){this.columnName=e}mO.prototype.toString=function(){return`[object ReturningHelper:${this.columnName}]`},pO={generateCombinedName:function(e,t,r,n){const i=require("crypto");Array.isArray(n)||(n=n?[n]:[]);const s=r.replace(/\.|-/g,"_"),o=n.join("_");let a=`${s}_${o.length?o+"_":""}${t}`.toLowerCase();return a.length>30&&(e.warn(`Automatically generated name "${a}" exceeds 30 character limit for Oracle. Using base64 encoded sha1 of that name instead.`),a=i.createHash("sha1").update(a).digest("base64").replace("=","")),a},isConnectionError:function(e){return["DPI-1010","DPI-1080","ORA-03114","ORA-03113","ORA-03135","ORA-12514","ORA-00022","ORA-00028","ORA-00031","ORA-00045","ORA-00378","ORA-00602","ORA-00603","ORA-00609","ORA-01012","ORA-01041","ORA-01043","ORA-01089","ORA-01092","ORA-02396","ORA-03122","ORA-12153","ORA-12537","ORA-12547","ORA-12570","ORA-12583","ORA-27146","ORA-28511","ORA-56600","NJS-024","NJS-003"].some((function(t){return 0===e.message.indexOf(t)}))},wrapSqlWithCatch:function(e,t){return`begin execute immediate '${e.replace(/'/g,"''")}'; exception when others then if sqlcode != ${t} then raise; end if; end;`},ReturningHelper:mO};var yO={renameColumnTrigger:function(e,t,r,n){const i=pO.generateCombinedName(e,"autoinc_trg",t);return`DECLARE PK_NAME VARCHAR(200); IS_AUTOINC NUMBER := 0; BEGIN  EXECUTE IMMEDIATE ('ALTER TABLE "${t}" RENAME COLUMN "${r}" TO "${n}"');  SELECT COUNT(*) INTO IS_AUTOINC from "USER_TRIGGERS" where trigger_name = '${i}';  IF (IS_AUTOINC > 0) THEN    SELECT cols.column_name INTO PK_NAME    FROM all_constraints cons, all_cons_columns cols    WHERE cons.constraint_type = 'P'    AND cons.constraint_name = cols.constraint_name    AND cons.owner = cols.owner    AND cols.table_name = '${t}';    IF ('${n}' = PK_NAME) THEN      EXECUTE IMMEDIATE ('DROP TRIGGER "${i}"');      EXECUTE IMMEDIATE ('create or replace trigger "${i}"      BEFORE INSERT on "${t}" for each row        declare        checking number := 1;        begin          if (:new."${n}" is null) then            while checking >= 1 loop              select "${pO.generateCombinedName(e,"seq",t)}".nextval into :new."${n}" from dual;              select count("${n}") into checking from "${t}"              where "${n}" = :new."${n}";            end loop;          end if;        end;');    end if;  end if;END;`},createAutoIncrementTrigger:function(e,t,r){const n=`"${t}"`,i=t,s=r?`"${r}".`:"",o=r?`'${r}'`:"cols.owner",a=pO.generateCombinedName(e,"autoinc_trg",t),u=`"${pO.generateCombinedName(e,"seq",t)}"`;return`DECLARE PK_NAME VARCHAR(200); BEGIN  EXECUTE IMMEDIATE ('CREATE SEQUENCE ${s}${u}');  SELECT cols.column_name INTO PK_NAME  FROM all_constraints cons, all_cons_columns cols  WHERE cons.constraint_type = 'P'  AND cons.constraint_name = cols.constraint_name  AND cons.owner = ${o}  AND cols.table_name = '${i}';  execute immediate ('create or replace trigger ${s}"${a}"  BEFORE INSERT on ${s}${n}  for each row  declare  checking number := 1;  begin    if (:new."' || PK_NAME || '" is null) then      while checking >= 1 loop        select ${s}${u}.nextval into :new."' || PK_NAME || '" from dual;        select count("' || PK_NAME || '") into checking from ${s}${n}        where "' || PK_NAME || '" = :new."' || PK_NAME || '";      end loop;    end if;  end;'); END;`},renameTableAndAutoIncrementTrigger:function(e,t,r){const n=pO.generateCombinedName(e,"autoinc_trg",t),i=pO.generateCombinedName(e,"seq",t),s=pO.generateCombinedName(e,"autoinc_trg",r),o=pO.generateCombinedName(e,"seq",r);return`DECLARE PK_NAME VARCHAR(200); IS_AUTOINC NUMBER := 0; BEGIN  EXECUTE IMMEDIATE ('RENAME "${t}" TO "${r}"');  SELECT COUNT(*) INTO IS_AUTOINC from "USER_TRIGGERS" where trigger_name = '${n}';  IF (IS_AUTOINC > 0) THEN    EXECUTE IMMEDIATE ('DROP TRIGGER "${n}"');    EXECUTE IMMEDIATE ('RENAME "${i}" TO "${o}"');    SELECT cols.column_name INTO PK_NAME    FROM all_constraints cons, all_cons_columns cols    WHERE cons.constraint_type = 'P'    AND cons.constraint_name = cols.constraint_name    AND cons.owner = cols.owner    AND cols.table_name = '${r}';    EXECUTE IMMEDIATE ('create or replace trigger "${s}"    BEFORE INSERT on "${r}" for each row      declare      checking number := 1;      begin        if (:new."' || PK_NAME || '" is null) then          while checking >= 1 loop            select "${o}".nextval into :new."' || PK_NAME || '" from dual;            select count("' || PK_NAME || '") into checking from "${r}"            where "' || PK_NAME || '" = :new."' || PK_NAME || '";          end loop;        end if;      end;');  end if;END;`}},gO=class extends RE{constructor(){super(...arguments)}renameTable(e,t){const r=yO.renameTableAndAutoIncrementTrigger(this.client.logger,e,t);this.pushQuery(r)}hasTable(e){this.pushQuery({sql:"select TABLE_NAME from USER_TABLES where TABLE_NAME = "+this.client.parameter(e,this.builder,this.bindingsHolder),output:e=>e.length>0})}hasColumn(e,t){const r=`select COLUMN_NAME from ALL_TAB_COLUMNS where TABLE_NAME = ${this.client.parameter(e,this.builder,this.bindingsHolder)} and COLUMN_NAME = ${this.client.parameter(t,this.builder,this.bindingsHolder)}`;this.pushQuery({sql:r,output:e=>e.length>0})}dropSequenceIfExists(e){const t=this.schema?`"${this.schema}".`:"";this.pushQuery(pO.wrapSqlWithCatch(`drop sequence ${t}${this.formatter.wrap(e)}`,-2289))}_dropRelatedSequenceIfExists(e){const t=pO.generateCombinedName(this.client.logger,"seq",e);this.dropSequenceIfExists(t)}dropTable(e){const t=this.schema?`"${this.schema}".`:"";this.pushQuery(`drop table ${t}${this.formatter.wrap(e)}`),this._dropRelatedSequenceIfExists(e)}dropTableIfExists(e){this.dropObject(e,"table")}dropViewIfExists(e){this.dropObject(e,"view")}dropObject(e,t){const r=this.schema?`"${this.schema}".`:"";let n=-942;"materialized view"===t&&(n=-12003),this.pushQuery(pO.wrapSqlWithCatch(`drop ${t} ${r}${this.formatter.wrap(e)}`,n)),this._dropRelatedSequenceIfExists(e)}refreshMaterializedView(e){return this.pushQuery({sql:`BEGIN DBMS_MVIEW.REFRESH('${this.schemaNameRaw?this.schemaNameRaw+".":""}${e}'); END;`})}dropMaterializedView(e){this._dropView(e,!1,!0)}dropMaterializedViewIfExists(e){this.dropObject(e,"materialized view")}},vO=class extends dC{constructor(){super(...arguments)}checkIn(){return this._modifiers.checkIn=G_(arguments),this}},bO=function(e,t){return!(null==e||!e.length)&&YE(e,t,0)>-1},_O=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},wO=Mg&&1/a_(new Mg([,-0]))[1]==1/0?function(e){return new Mg(e)}:function(){},EO=function(e){return e&&e.length?function(e,t,r){var n=-1,i=bO,s=e.length,o=!0,a=[],u=a;if(r)o=!1,i=_O;else if(s>=200){var l=t?null:wO(e);if(l)return a_(l);o=!1,i=i_,u=new t_}else u=t?[]:a;e:for(;++n<s;){var c=e[n],h=t?t(c):c;if(c=r||0!==c?c:0,o&&h==h){for(var d=u.length;d--;)if(u[d]===h)continue e;t&&u.push(h),a.push(c)}else i(u,h,r)||(u!==a&&u.push(h),a.push(c))}return a}(e):[]},CO={createAutoIncrementTriggerAndSequence:function(e){e.pushAdditional((function(){const e=this.tableCompiler.tableNameRaw,t=this.tableCompiler.schemaNameRaw,r=yO.createAutoIncrementTrigger(this.client.logger,e,t);this.pushQuery(r)}))}},TO={};const{createAutoIncrementTriggerAndSequence:NO}=CO,{toNumber:kO}=nw;class OO extends pC{constructor(){super(...arguments),this.modifiers=["defaultTo","checkIn","nullable","comment"]}increments(e={primaryKey:!0}){return NO(this),"integer not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}bigincrements(e={primaryKey:!0}){return NO(this),"number(20, 0) not null"+(this.tableCompiler._canBeAddPrimaryKey(e)?" primary key":"")}floating(e){const t=kO(e,0);return"float"+(t?`(${t})`:"")}double(e,t){return`number(${kO(e,8)}, ${kO(t,2)})`}decimal(e,t){return null===e?"decimal":`decimal(${kO(e,8)}, ${kO(t,2)})`}integer(e){return e?`number(${kO(e,11)})`:"integer"}enu(e){const t=((e=EO(e))||[]).reduce((e,t)=>Math.max(e,String(t).length),1);return this.columnBuilder._modifiers.checkIn=[e],`varchar2(${t})`}datetime(e){return e?"timestamp":"timestamp with time zone"}timestamp(e){return e?"timestamp":"timestamp with time zone"}bool(){return this.columnBuilder._modifiers.checkIn=[[0,1]],"number(1, 0)"}varchar(e){return`varchar2(${kO(e,255)})`}comment(e){const t=this.args[0]||this.defaults("columnName");this.pushAdditional((function(){this.pushQuery(`comment on column ${this.tableCompiler.tableName()}.`+this.formatter.wrap(t)+" is '"+(e||"")+"'")}),e)}checkIn(e){return void 0===e?"":(e=e instanceof Hw?e.toQuery():Array.isArray(e)?e.map(e=>`'${e}'`).join(", "):`'${e}'`,`check (${this.formatter.wrap(this.args[0])} in (${e}))`)}}OO.prototype.tinyint="smallint",OO.prototype.smallint="smallint",OO.prototype.mediumint="integer",OO.prototype.biginteger="number(20, 0)",OO.prototype.text="clob",OO.prototype.time="timestamp with time zone",OO.prototype.bit="clob",OO.prototype.json="clob",TO=OO;var SO={};const{isObject:xO}=vb;class $O extends tC{constructor(){super(...arguments)}addColumns(e,t){if(e.sql.length>0){t=t||this.addColumnsPrefix;const r=e.sql;let n=`${this.lowerCase?"alter table ":"ALTER TABLE "}${this.tableName()} ${t}`;e.sql.length>1?n+=`(${r.join(", ")})`:n+=r.join(", "),this.pushQuery({sql:n,bindings:e.bindings})}}renameColumn(e,t){const r=this.tableName().slice(1,-1);return this.pushQuery(yO.renameColumnTrigger(this.client.logger,r,e,t))}compileAdd(e){const t=this.formatter.wrap(e),r=this.prefixArray("add column",this.getColumns(e));return this.pushQuery({sql:`alter table ${t} ${r.join(", ")}`})}createQuery(e,t,r){const n=r&&this.tableNameLike()?" as (select * from "+this.tableNameLike()+" where 0=1)":" ("+e.sql.join(", ")+this._addChecks()+")",i=`create table ${this.tableName()}${n}`;this.pushQuery({sql:t?pO.wrapSqlWithCatch(i,-955):i,bindings:e.bindings}),this.single.comment&&this.comment(this.single.comment),r&&this.addColumns(e,this.addColumnsPrefix)}comment(e){this.pushQuery(`comment on table ${this.tableName()} is '${e}'`)}dropColumn(){const e=nw.normalizeArr.apply(null,arguments);this.pushQuery(`alter table ${this.tableName()} drop (${this.formatter.columnize(e)})`)}_indexCommand(e,t,r){return this.formatter.wrap(pO.generateCombinedName(this.client.logger,e,t,r))}primary(e,t){let r;xO(t)&&({constraintName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey");const n=e;let i=[];this.grouped.columns&&(i=this._getIncrementsColumnNames(),i&&i.forEach(e=>{n.includes(e)||n.unshift(e)})),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} primary key (${this.formatter.columnize(n)})${r}`)}dropPrimary(e){e=e?this.formatter.wrap(e):this.formatter.wrap(this.tableNameRaw+"_pkey"),this.pushQuery(`alter table ${this.tableName()} drop constraint ${e}`)}index(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery(`create index ${t} on ${this.tableName()} (`+this.formatter.columnize(e)+")")}dropIndex(e,t){t=t?this.formatter.wrap(t):this._indexCommand("index",this.tableNameRaw,e),this.pushQuery("drop index "+t)}unique(e,t){let r;xO(t)&&({indexName:t,deferrable:r}=t),r=r?" deferrable initially "+r:"",t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} add constraint ${t} unique (`+this.formatter.columnize(e)+")"+r)}dropUnique(e,t){t=t?this.formatter.wrap(t):this._indexCommand("unique",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}dropForeign(e,t){t=t?this.formatter.wrap(t):this._indexCommand("foreign",this.tableNameRaw,e),this.pushQuery(`alter table ${this.tableName()} drop constraint ${t}`)}}$O.prototype.addColumnsPrefix="add ",$O.prototype.alterColumnsPrefix="modify ",SO=$O;const{ReturningHelper:AO}=pO,{isString:jO}=vb,IO=["columns","join","where","union","group","having","order","lock"];var RO=class extends kE{constructor(e,t,r){super(e,t,r);const{onConflict:n}=this.single;if(n)throw new Error(".onConflict() is not supported for oracledb.");this.first=this.select}insert(){let e=this.single.insert||[],{returning:t}=this.single;if(!Array.isArray(e)&&Yv(this.single.insert)&&(e=[this.single.insert]),t&&!Array.isArray(t)&&(t=[t]),Array.isArray(e)&&1===e.length&&Xb(e[0]))return this._addReturningToSqlAndConvert(`insert into ${this.tableName} (${this.formatter.wrap(this.single.returning)}) values (default)`,t,this.tableName);if(Xb(this.single.insert)&&"function"!=typeof this.single.insert)return"";const r=this._prepInsert(e),n={};if(jO(r))return this._addReturningToSqlAndConvert(`insert into ${this.tableName} ${r}`,t);if(1===r.values.length)return this._addReturningToSqlAndConvert(`insert into ${this.tableName} (${this.formatter.columnize(r.columns)}) values (${this.client.parameterize(r.values[0],void 0,this.builder,this.bindingsHolder)})`,t,this.tableName);const i=0===r.columns.length;return n.sql="begin "+r.values.map(e=>{let s;const o=i?"":this.client.parameterize(e,this.client.valueForUndefined,this.builder,this.bindingsHolder),a=Array.isArray(t)?t:[t];let u=`insert into ${this.tableName} `;t&&(s=new AO(a.join(":")),n.outParams=(n.outParams||[]).concat(s)),u+=i?`(${this.formatter.wrap(this.single.returning)}) values (default)`:`(${this.formatter.columnize(r.columns)}) values (${o})`,u+=t?" returning ROWID into "+this.client.parameter(s,this.builder,this.bindingsHolder):"",u=this.formatter.client.positionBindings(u);const l=o.replace("DEFAULT, ","").replace(", DEFAULT","");return"execute immediate '"+u.replace(/'/g,"''")+(l||t?"' using ":"")+l+(l&&t?", ":"")+(t?"out ?":"")+";"}).join(" ")+"end;",t&&(n.returning=t,n.returningSql=`select ${this.formatter.columnize(t)} from `+this.tableName+" where ROWID in ("+n.outParams.map((e,t)=>":"+(t+1)).join(", ")+") order by case ROWID "+n.outParams.map((e,t)=>`when CHARTOROWID(:${t+1}) then ${t}`).join(" ")+" end"),n}update(){const e=this._prepUpdate(this.single.update),t=this.where();let{returning:r}=this.single;const n=`update ${this.tableName} set `+e.join(", ")+(t?" "+t:"");return r?(Array.isArray(r)||(r=[r]),this._addReturningToSqlAndConvert(n,r,this.tableName)):n}truncate(){return"truncate table "+this.tableName}forUpdate(){return"for update"}forShare(){return this.client.logger.warn("lock for share is not supported by oracle dialect"),""}columnInfo(){const e=this.single.columnInfo;return{sql:`select * from xmltable( '/ROWSET/ROW'\n      passing dbms_xmlgen.getXMLType('\n      select char_col_decl_length, column_name, data_type, data_default, nullable\n      from all_tab_columns where table_name = ''${this.client.customWrapIdentifier(this.single.table,hv)}'' ')\n      columns\n      CHAR_COL_DECL_LENGTH number, COLUMN_NAME varchar2(200), DATA_TYPE varchar2(106),\n      DATA_DEFAULT clob, NULLABLE varchar2(1))`,output(t){const r=$w(t,(function(e,t){return e[t.COLUMN_NAME]={type:t.DATA_TYPE,defaultValue:t.DATA_DEFAULT,maxLength:t.CHAR_COL_DECL_LENGTH,nullable:"Y"===t.NULLABLE},e}),{});return e&&r[e]||r}}}select(){let e=this.with();const t=IO.map(e=>this[e]());return e+=nE(t).join(" "),this._surroundQueryWithLimitAndOffset(e)}aggregate(e){return this._aggregate(e,{aliasSeparator:" "})}_addReturningToSqlAndConvert(e,t,r){const n={sql:e};if(!t)return n;const i=Array.isArray(t)?t:[t],s=new AO(i.join(":"));return n.sql=e+" returning ROWID into "+this.client.parameter(s,this.builder,this.bindingsHolder),n.returningSql=`select ${this.formatter.columnize(t)} from ${r} where ROWID = :1`,n.outParams=[s],n.returning=t,n}_surroundQueryWithLimitAndOffset(e){let{limit:t}=this.single;const{offset:r}=this.single,n=t||0===t||"0"===t;if(t=+t,!n&&!r)return e;if(e=e||"",n&&!r)return`select * from (${e}) where rownum <= ${this._getValueOrParameterFromAttribute("limit",t)}`;const i=+r+(n?t:1e13);return"select * from (select row_.*, ROWNUM rownum_ from ("+e+") row_ where rownum <= "+(this.single.skipBinding.offset?i:this.client.parameter(i,this.builder,this.bindingsHolder))+") where rownum_ > "+this._getValueOrParameterFromAttribute("offset",r)}},PO={};(function(e){const{promisify:t}=require("util"),r=require("stream");function n(e,t){this.columnName=e,this.value=t,this.returning=!1}n.prototype.toString=function(){return"[object BlobHelper:"+this.columnName+"]"};const i=function(t){const r=d({});let n;if(t.type)t.type===r.BLOB?n="buffer":t.type===r.CLOB&&(n="string");else{if(!t.iLob)throw new Error("Unrecognized oracledb lob stream type");t.iLob.type===r.CLOB?n="string":t.iLob.type===r.BLOB&&(n="buffer")}return"string"===n&&t.setEncoding("utf-8"),function(t,r){return new Promise((n,i)=>{let s="string"===r?"":e.alloc(0);t.on("error",(function(e){i(e)})),t.on("data",(function(t){"string"===r?s+=t:s=e.concat([s,t])})),t.on("end",(function(){n(s)}))})}(t,n)};pO.BlobHelper=n,pO.monkeyPatchConnection=function(e,n){if(e.executeAsync)return;e.commitAsync=function(){return new Promise((e,t)=>{this.commit((function(r){if(r)return t(r);e()}))})},e.rollbackAsync=function(){return new Promise((e,t)=>{this.rollback((function(r){if(r)return t(r);e()}))})};const s=t((function(t,r,i,s){if((i=i||{}).outFormat=n.driver.OUT_FORMAT_OBJECT||n.driver.OBJECT,!i.outFormat)throw new Error("not found oracledb.outFormat constants");i.resultSet?e.execute(t,r||[],i,(function(t,r){if(t)return pO.isConnectionError(t)&&(e.close().catch((function(e){})),e.__knex__disposed=t),s(t);const n={rows:[],resultSet:r.resultSet},i=function(e,t,r){t.getRows(r,(function(o,a){if(o)pO.isConnectionError(o)&&(e.close().catch((function(e){})),e.__knex__disposed=o),t.close((function(){return s(o)}));else{if(0===a.length)return s(null,n);if(a.length>0){if(a.length!==r)return n.rows=n.rows.concat(a),s(null,n);n.rows=n.rows.concat(a),i(e,t,r)}}}))};i(e,r.resultSet,100)})):e.execute(t,r||[],i,(function(t,r){return t?(pO.isConnectionError(t)&&(e.close().catch((function(e){})),e.__knex__disposed=t),s(t)):s(null,r)}))}));e.executeAsync=function(e,n,o){return s(e,n,o).then(async e=>{const n=()=>e.resultSet?t(e.resultSet.close).call(e.resultSet):Promise.resolve(),s=[];if(e.rows&&Array.isArray(e.rows))for(let t=0;t<e.rows.length;t++){const n=e.rows[t];for(const e in n)n[e]instanceof r.Readable&&s.push({index:t,key:e,stream:n[e]})}try{for(const t of s)e.rows[t.index][t.key]=await i(t.stream)}catch(CT){throw await n().catch(()=>{}),CT}return await n(),e})}},PO=pO}).call(this,require("buffer").Buffer);var MO={};(function(e){const t=PO.ReturningHelper,r=PO.BlobHelper,{isString:n}=vb,{columnize:i}=Uw;MO=class extends RO{insert(){const e=this,i=this._prepOutbindings(this.single.insert,this.single.returning),s=i.outBinding,o=i.returning,a=i.values;if(Array.isArray(a)&&1===a.length&&Xb(a[0])){const e=this.single.returning?" ("+this.formatter.wrap(this.single.returning)+")":"";return this._addReturningToSqlAndConvert("insert into "+this.tableName+e+" values (default)",s[0],this.tableName,o)}if(Xb(this.single.insert)&&"function"!=typeof this.single.insert)return"";const u=this._prepInsert(a),l={};if(n(u))return this._addReturningToSqlAndConvert("insert into "+this.tableName+" "+u,s[0],this.tableName,o);if(1===u.values.length)return this._addReturningToSqlAndConvert("insert into "+this.tableName+" ("+this.formatter.columnize(u.columns)+") values ("+this.client.parameterize(u.values[0],void 0,this.builder,this.bindingsHolder)+")",s[0],this.tableName,o);const c=0===u.columns.length;return l.returning=o,l.sql="begin "+u.values.map((function(n,i){const o=c?"":e.client.parameterize(n,e.client.valueForUndefined,e.builder,e.bindingsHolder);let a="insert into "+e.tableName;a+=c?" ("+e.formatter.wrap(e.single.returning)+") values (default)":" ("+e.formatter.columnize(u.columns)+") values ("+o+")";let l="",h="",d="",f="";Zb(n,(function(e){e instanceof r||(d+=" ?,")})),d=d.slice(0,-1),s[i].forEach((function(n){const i=n.columnName||n;if(l+=e.formatter.wrap(i)+",",h+=" ?,",f+=" out ?,",n instanceof r)return e.formatter.bindings.push(n);e.formatter.bindings.push(new t(i))})),l=l.slice(0,-1),h=h.slice(0,-1),f=f.slice(0,-1),l&&h&&(a+=" returning "+l+" into"+h),a=e.formatter.client.positionBindings(a);const p=o.replace(/DEFAULT, /g,"").replace(/, DEFAULT/g,"").replace("EMPTY_BLOB(), ","").replace(", EMPTY_BLOB()","");return"execute immediate '"+a.replace(/'/g,"''")+(p||n?"' using ":"")+p+(p&&f?",":"")+f+";"})).join(" ")+"end;",l.outBinding=s,"*"===o[0]&&(l.returningSql=function(){return"select * from "+e.tableName+" where ROWID in ("+this.outBinding.map((function(e,t){return":"+(t+1)})).join(", ")+") order by case ROWID "+this.outBinding.map((function(e,t){return"when CHARTOROWID(:"+(t+1)+") then "+t})).join(" ")+" end"}),l}with(){const e=[];if(this.grouped.with)for(const r of this.grouped.with)r.recursive&&(e.push(r),r.recursive=!1);const t=super.with();for(const r of e)r.recursive=!0;return t}_addReturningToSqlAndConvert(e,n,i,s){const o=this,a={sql:e};if(!n)return a;const u=Array.isArray(n)?n:[n];let l="",c="";return u.forEach((function(e){const n=e.columnName||e;if(l+=o.formatter.wrap(n)+",",c+="?,",e instanceof r)return o.formatter.bindings.push(e);o.formatter.bindings.push(new t(n))})),a.sql=e,l=l.slice(0,-1),c=c.slice(0,-1),l&&c&&(a.sql+=" returning "+l+" into "+c),a.outBinding=[n],"*"===s[0]&&(a.returningSql=function(){return"select * from "+o.tableName+" where ROWID = :1"}),a.returning=s,a}_prepOutbindings(t,n){const i={};let s=t||[],o=n||[];!Array.isArray(s)&&Yv(t)&&(s=[s]),o&&!Array.isArray(o)&&(o=[o]);const a=[];return Zb(s,(function(t,n){"*"===o[0]?a[n]=["ROWID"]:a[n]=Jb(o),Zb(t,(function(i,o){if(i instanceof e){t[o]=new r(o,i);const e=a[n].indexOf(o);e>=0&&(a[n].splice(e,1),t[o].returning=!0),a[n].push(t[o])}void 0===i&&delete s[n][o]}))})),i.returning=o,i.outBinding=a,i.values=s,i}_groupOrder(e,t){return super._groupOrderNulls(e,t)}update(){const e=this,n={},i=this._prepOutbindings(this.single.update||this.single.counter,this.single.returning),s=i.outBinding,o=i.returning,a=this._prepUpdate(this.single.update),u=this.where();let l="",c="";return Xb(a)&&"function"!=typeof this.single.update?"":(s.forEach((function(n){n.forEach((function(n){const i=n.columnName||n;if(l+=e.formatter.wrap(i)+",",c+=" ?,",n instanceof r)return e.formatter.bindings.push(n);e.formatter.bindings.push(new t(i))}))})),l=l.slice(0,-1),c=c.slice(0,-1),n.outBinding=s,n.returning=o,n.sql="update "+this.tableName+" set "+a.join(", ")+(u?" "+u:""),s.length&&!Xb(s[0])&&(n.sql+=" returning "+l+" into"+c),"*"===o[0]&&(n.returningSql=function(){let t="select * from "+e.tableName;const r=this.rowsAffected.length||this.rowsAffected;let n=" where ROWID in (",i=") order by case ROWID ";for(let e=0;e<r;e++)"*"===this.returning[0]&&(n+=":"+(e+1)+", ",i+="when CHARTOROWID(:"+(e+1)+") then "+e+" ");return"*"===this.returning[0]&&(this.returning=this.returning.slice(0,-1),n=n.slice(0,-2),i=i.slice(0,-1)),t+(n+i+" end")}),n)}_jsonPathWrap(e){return`'${e.path||e[1]}'`}jsonExtract(e){return this._jsonExtract(e.singleValue?"json_value":"json_query",e)}jsonSet(e){return`json_transform(${i(e.column,this.builder,this.client,this.bindingsHolder)}, set ${this.client.parameter(e.path,this.builder,this.bindingsHolder)} = ${this.client.parameter(e.value,this.builder,this.bindingsHolder)})`}jsonInsert(e){return`json_transform(${i(e.column,this.builder,this.client,this.bindingsHolder)}, insert ${this.client.parameter(e.path,this.builder,this.bindingsHolder)} = ${this.client.parameter(e.value,this.builder,this.bindingsHolder)})`}jsonRemove(e){const t=`json_transform(${i(e.column,this.builder,this.client,this.bindingsHolder)}, remove ${this.client.parameter(e.path,this.builder,this.bindingsHolder)})`;return e.alias?this.client.alias(t,this.formatter.wrap(e.alias)):t}whereJsonPath(e){return this._whereJsonPath("json_value",e)}whereJsonSupersetOf(e){throw new Error("Json superset where clause not actually supported by Oracle")}whereJsonSubsetOf(e){throw new Error("Json subset where clause not actually supported by Oracle")}onJsonPathEquals(e){return this._onJsonPathEquals("json_value",e)}}}).call(this,require("buffer").Buffer);var LO=class extends SO{constructor(e,t){super(e,t)}_setNullableState(e,t){const r=t?"NULL":"NOT NULL",n=`alter table ${this.tableName()} modify (${this.formatter.wrap(e)} ${r})`;return this.pushQuery({sql:n})}},qO={};const{isObject:DO}=vb;class FO extends TO{constructor(){super(...arguments),this.modifiers=["defaultTo","nullable","comment"],this._addCheckModifiers()}datetime(e){let t;return DO(e)?({useTz:t}=e):t=!e,t?"timestamp with local time zone":"timestamp"}timestamp(e){let t;return DO(e)?({useTz:t}=e):t=!e,t?"timestamp with local time zone":"timestamp"}checkRegex(e,t){return this._check(`REGEXP_LIKE(${this.formatter.wrap(this.getColumnName())},${this.client._escapeBinding(e)})`,t)}json(){return`varchar2(4000) check (${this.formatter.columnize(this.getColumnName())} is json)`}jsonb(){return this.json()}}FO.prototype.time="timestamp with local time zone",FO.prototype.uuid=({useBinaryUuid:e=!1}={})=>e?"raw(16)":"char(36)",qO=FO;var UO=class extends SC{constructor(e,t){super(e,t)}createOrReplace(){this.createQuery(this.columns,this.selectQuery,!1,!0)}createMaterializedView(){this.createQuery(this.columns,this.selectQuery,!0)}},VO=class extends NC{constructor(){super(...arguments)}checkOption(){this._single.checkOption="default_option"}};const{timeout:BO,KnexTimeoutError:zO}=$v,HO=Fv("knex:tx");var WO=class extends jb{begin(e){return this.isolationLevel&&this.client.logger.warn("Transaction isolation is not currently supported for Oracle"),Promise.resolve()}async commit(e,t){this._completed=!0;try{await e.commitAsync(),this._resolver(t)}catch(r){this._rejecter(r)}}release(e,t){return this._resolver(t)}rollback(e,t){return this._completed=!0,HO("%s: rolling back",this.txid),BO(e.rollbackAsync(),5e3).catch(e=>{if(!(e instanceof zO))return Promise.reject(e);this._rejecter(e)}).then(()=>{if(void 0===t){if(this.doNotRejectOnRollback)return void this._resolver();t=new Error("Transaction rejected with non-error: "+t)}this._rejecter(t)})}savepoint(e){return this.query(e,"SAVEPOINT "+this.txid)}async acquireConnection(e,t){const r=e&&e.connection,n=r||await this.client.acquireConnection();try{return n.__knexTxId=this.txid,n.isTransaction=!0,await t(n)}finally{HO("%s: releasing connection",this.txid),n.isTransaction=!1;try{await n.commitAsync()}catch(i){this._rejecter(i)}finally{r?HO("%s: not releasing external connection",this.txid):await this.client.releaseConnection(n)}}}},QO=class extends jb{begin(e){return this.isolationLevel?this.query(e,`BEGIN ISOLATION LEVEL ${this.isolationLevel};`):this.query(e,"BEGIN;")}savepoint(e){return this.trxClient.logger("Redshift does not support savepoints."),Promise.resolve()}release(e,t){return this.trxClient.logger("Redshift does not support savepoints."),Promise.resolve()}rollbackTo(e,t){return this.trxClient.logger("Redshift does not support savepoints."),Promise.resolve()}};const{columnize:JO}=Uw;var GO=class extends ik{truncate(){return"truncate "+this.tableName.toLowerCase()}insert(){const e=kE.prototype.insert.apply(this,arguments);return""===e?e:(this._slightReturn(),{sql:e})}update(){const e=kE.prototype.update.apply(this,arguments);return this._slightReturn(),{sql:e}}del(){const e=kE.prototype.del.apply(this,arguments);return this._slightReturn(),{sql:e}}_slightReturn(){this.single.isReturning&&this.client.logger.warn("insert/update/delete returning is not supported by redshift dialect")}forUpdate(){return this.client.logger.warn("table lock is not supported by redshift dialect"),""}forShare(){return this.client.logger.warn("lock for share is not supported by redshift dialect"),""}forNoKeyUpdate(){return this.client.logger.warn("table lock is not supported by redshift dialect"),""}forKeyShare(){return this.client.logger.warn("lock for share is not supported by redshift dialect"),""}columnInfo(){const e=this.single.columnInfo;let t=this.single.schema;const r=this.client.customWrapIdentifier(this.single.table,hv);t&&(t=this.client.customWrapIdentifier(t,hv));const n=[r.toLowerCase(),this.client.database().toLowerCase()];return this._buildColumnInfoQuery(t,"select * from information_schema.columns where table_name = ? and table_catalog = ?",n,e)}jsonExtract(e){let t;return t=Array.isArray(e.column)?e.column:[e],t.map(t=>{const r=`json_extract_path_text(${JO(t.column||t[0],this.builder,this.client,this.bindingsHolder)}, ${this.client.toPathForJson(e.path||t[1],this.builder,this.bindingsHolder)})`,n=t.alias||t[2];return n?this.client.alias(r,this.formatter.wrap(n)):r}).join(", ")}jsonSet(e){throw new Error("Json set is not supported by Redshift")}jsonInsert(e){throw new Error("Json insert is not supported by Redshift")}jsonRemove(e){throw new Error("Json remove is not supported by Redshift")}whereJsonPath(e){return this._whereJsonPath("json_extract_path_text",Object.assign({},e,{path:this.client.toPathForJson(e.path)}))}whereJsonSupersetOf(e){throw new Error("Json superset is not supported by Redshift")}whereJsonSubsetOf(e){throw new Error("Json subset is not supported by Redshift")}onJsonPathEquals(e){return this._onJsonPathEquals("json_extract_path_text",e)}},KO=class extends dC{constructor(){super(...arguments)}primary(){return this.notNullable(),super.primary(...arguments)}index(){return this.client.logger.warn("Redshift does not support the creation of indexes."),this}},ZO={};class YO extends ok{constructor(){super(...arguments)}bit(e){return!1!==e.length?`char(${e.length})`:"char(1)"}datetime(e){return e?"timestamp":"timestamptz"}timestamp(e){return e?"timestamp":"timestamptz"}comment(e){this.pushAdditional((function(){this.pushQuery(`comment on column ${this.tableCompiler.tableName()}.`+this.formatter.wrap(this.args[0])+" is "+(e?`'${e}'`:"NULL"))}),e)}}YO.prototype.increments=({primaryKey:e=!0}={})=>"integer identity(1,1)"+(e?" primary key":"")+" not null",YO.prototype.bigincrements=({primaryKey:e=!0}={})=>"bigint identity(1,1)"+(e?" primary key":"")+" not null",YO.prototype.binary="varchar(max)",YO.prototype.blob="varchar(max)",YO.prototype.enu="varchar(255)",YO.prototype.enum="varchar(255)",YO.prototype.json="varchar(max)",YO.prototype.jsonb="varchar(max)",YO.prototype.longblob="varchar(max)",YO.prototype.mediumblob="varchar(16777218)",YO.prototype.set="text",YO.prototype.text="varchar(max)",YO.prototype.tinyblob="varchar(256)",YO.prototype.uuid=pC.prototype.uuid,YO.prototype.varbinary="varchar(max)",YO.prototype.bigint="bigint",YO.prototype.bool="boolean",YO.prototype.double="double precision",YO.prototype.floating="real",YO.prototype.smallint="smallint",YO.prototype.tinyint="smallint",ZO=YO;var XO=class extends pk{constructor(){super(...arguments)}index(e,t,r){this.client.logger.warn("Redshift does not support the creation of indexes.")}dropIndex(e,t){this.client.logger.warn("Redshift does not support the deletion of indexes.")}createQuery(e,t,r){const n=t?"create table if not exists ":"create table ",i=" ("+e.sql.join(", ")+this._addChecks()+")";let s=n+this.tableName()+(r&&this.tableNameLike()?" (like "+this.tableNameLike()+")":i);this.single.inherits&&(s+=` like (${this.formatter.wrap(this.single.inherits)})`),this.pushQuery({sql:s,bindings:e.bindings}),cE(this.single,"comment")&&this.comment(this.single.comment),r&&this.addColumns(e,this.addColumnsPrefix)}primary(e,t){t=t?this.formatter.wrap(t):this.formatter.wrap(this.tableNameRaw+"_pkey"),e.constructor!==Array&&(e=[e]);const r=this.grouped.columns;if(r)for(let n=0;n<e.length;n++){let t=r.find(t=>"columns"===t.grouping&&t.builder&&"add"===t.builder._method&&t.builder._args&&t.builder._args.indexOf(e[n])>-1);if(t&&(t=t.builder),!(t&&t._modifiers&&t._modifiers.nullable&&!1===t._modifiers.nullable[0]))return t?this.client.logger.warn("Redshift does not allow primary keys to contain nullable columns."):this.client.logger.warn("Redshift does not allow primary keys to contain nonexistent columns.")}return this.pushQuery(`alter table ${this.tableName()} add constraint ${t} primary key (${this.formatter.columnize(e)})`)}addColumns(e,t,r){if(t===this.alterColumnsPrefix)super.addColumns(e,t,r);else{t=t||this.addColumnsPrefix,r=r||this.getColumns();for(const e of r){const r=this.tableName(),n=e.compileColumn();this.pushQuery({sql:`alter table ${r} ${t}${n}`,bindings:[]})}}}},eS=class extends gk{constructor(){super(...arguments)}},tS=class extends mk{constructor(e,t){super(e,t)}},rS={};Object.defineProperty(rS,"__esModule",{value:!0}),rS.getDialectByNameOrAlias=void 0;const{resolveClientNameWithAliases:nS}=nw,iS=Object.freeze({"better-sqlite3":()=>c({}),cockroachdb:()=>u({}),mssql:()=>a({}),mysql:()=>o({}),mysql2:()=>s({}),oracle:()=>i({}),oracledb:()=>n({}),pgnative:()=>r({}),postgres:()=>l({}),redshift:()=>t({}),sqlite3:()=>h({})});rS.getDialectByNameOrAlias=function(e){const t=nS(e),r=iS[t];if(!r)throw new Error("Invalid clientName given: "+e);return r()};const{SUPPORTED_CLIENTS:sS}=X_,{getDialectByNameOrAlias:oS}=rS;var aS={resolveConfig:function(e){let t,r;const n="string"==typeof e?Object.assign(ZC(e),arguments[2]):e;if(0===arguments.length||!n.client&&!n.dialect)t=jC;else if("function"==typeof n.client)t=n.client;else{const e=n.client||n.dialect;if(!sS.includes(e))throw new Error(`knex: Unknown configuration option 'client' value ${e}. Note that it is case-sensitive, check documentation for supported values.`);t=oS(e)}return r="string"==typeof n.connection?Object.assign({},n,{connection:ZC(n.connection).connection}):Object.assign({},n),{resolvedConfig:r,Dialect:t}}};const{KnexTimeoutError:uS}=$v,{resolveConfig:lS}=aS;function cS(e){const{resolvedConfig:t,Dialect:r}=lS(...arguments),n=$b(new r(t));return t.userParams&&(n.userParams=t.userParams),n}cS.Client=jC,cS.KnexTimeoutError=uS,cS.QueryBuilder={extend:function(e,t){Ow.extend(e,t),zv.push(e)}},cS.SchemaBuilder={extend:function(e,t){OE.extend(e,t)}},cS.ViewBuilder={extend:function(e,t){NC.extend(e,t)}},cS.ColumnBuilder={extend:function(e,t){dC.extend(e,t)}},cS.TableBuilder={extend:function(e,t){HE.extend(e,t)}};var hS=cS,dS={};hS.knex=hS,hS.default=hS,dS=hS;for(var fS=function(e){return e.then(e=>[null,e]).catch(e=>[e])},pS=[],mS={},yS=0;yS<256;yS++)pS[yS]=(yS+256).toString(16).substr(1),mS[pS[yS]]=yS;var gS=function(e,t,r){var n=t&&r||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,(function(e){i<16&&(t[n+i++]=mS[e])}));i<16;)t[n+i++]=0;return t},vS=function(e,t){var r=t||0,n=pS;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]},bS={};let _S;Object.defineProperty(bS,"__esModule",{value:!0}),bS.default=function(){if(!_S&&(_S="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!_S))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _S(wS)};const wS=new Uint8Array(16);var ES={};Object.defineProperty(ES,"__esModule",{value:!0}),ES.default=void 0,ES.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var CS={};Object.defineProperty(CS,"__esModule",{value:!0}),CS.default=void 0;var TS,NS=(TS=ES)&&TS.__esModule?TS:{default:TS};CS.default=function(e){return"string"==typeof e&&NS.default.test(e)};var kS={};Object.defineProperty(kS,"__esModule",{value:!0}),kS.default=void 0;var OS,SS=(OS=CS)&&OS.__esModule?OS:{default:OS};const xS=[];for(let Dx=0;Dx<256;++Dx)xS.push((Dx+256).toString(16).substr(1));kS.default=function(e,t=0){const r=(xS[e[t+0]]+xS[e[t+1]]+xS[e[t+2]]+xS[e[t+3]]+"-"+xS[e[t+4]]+xS[e[t+5]]+"-"+xS[e[t+6]]+xS[e[t+7]]+"-"+xS[e[t+8]]+xS[e[t+9]]+"-"+xS[e[t+10]]+xS[e[t+11]]+xS[e[t+12]]+xS[e[t+13]]+xS[e[t+14]]+xS[e[t+15]]).toLowerCase();if(!(0,SS.default)(r))throw TypeError("Stringified UUID is invalid");return r};var $S={};Object.defineProperty($S,"__esModule",{value:!0}),$S.default=void 0;var AS=IS(bS),jS=IS(kS);function IS(e){return e&&e.__esModule?e:{default:e}}let RS,PS,MS=0,LS=0;$S.default=function(e,t,r){let n=t&&r||0;const i=t||new Array(16);let s=(e=e||{}).node||RS,o=void 0!==e.clockseq?e.clockseq:PS;if(null==s||null==o){const t=e.random||(e.rng||AS.default)();null==s&&(s=RS=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==o&&(o=PS=16383&(t[6]<<8|t[7]))}let a=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:LS+1;const l=a-MS+(u-LS)/1e4;if(l<0&&void 0===e.clockseq&&(o=o+1&16383),(l<0||a>MS)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");MS=a,LS=u,PS=o,a+=122192928e5;const c=(1e4*(268435455&a)+u)%4294967296;i[n++]=c>>>24&255,i[n++]=c>>>16&255,i[n++]=c>>>8&255,i[n++]=255&c;const h=a/4294967296*1e4&268435455;i[n++]=h>>>8&255,i[n++]=255&h,i[n++]=h>>>24&15|16,i[n++]=h>>>16&255,i[n++]=o>>>8|128,i[n++]=255&o;for(let d=0;d<6;++d)i[n+d]=s[d];return t||(0,jS.default)(i)};var qS={};Object.defineProperty(qS,"__esModule",{value:!0}),qS.default=void 0;var DS,FS=(DS=CS)&&DS.__esModule?DS:{default:DS};qS.default=function(e){if(!(0,FS.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};var US={};Object.defineProperty(US,"__esModule",{value:!0}),US.default=function(e,t,r){function n(e,n,i,s){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,BS.default)(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(n),o.set(e,n.length),o=r(o),o[6]=15&o[6]|t,o[8]=63&o[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=o[e];return i}return(0,VS.default)(o)}try{n.name=e}catch(i){}return n.DNS=HS,n.URL=WS,n},US.URL=US.DNS=void 0;var VS=zS(kS),BS=zS(qS);function zS(e){return e&&e.__esModule?e:{default:e}}const HS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";US.DNS=HS;const WS="6ba7b811-9dad-11d1-80b4-00c04fd430c8";US.URL=WS;var QS={};function JS(e){return 14+(e+64>>>9<<4)+1}function GS(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function KS(e,t,r,n,i,s){return GS((o=GS(GS(t,e),GS(n,s)))<<(a=i)|o>>>32-a,r);var o,a}function ZS(e,t,r,n,i,s,o){return KS(t&r|~t&n,e,t,i,s,o)}function YS(e,t,r,n,i,s,o){return KS(t&n|r&~n,e,t,i,s,o)}function XS(e,t,r,n,i,s,o){return KS(t^r^n,e,t,i,s,o)}function ex(e,t,r,n,i,s,o){return KS(r^(t|~n),e,t,i,s,o)}Object.defineProperty(QS,"__esModule",{value:!0}),QS.default=void 0;QS.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length;for(let n=0;n<r;n+=8){const r=e[n>>5]>>>n%32&255,i=parseInt("0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[JS(t)-1]=t;let r=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let o=0;o<e.length;o+=16){const t=r,a=n,u=i,l=s;r=ZS(r,n,i,s,e[o],7,-680876936),s=ZS(s,r,n,i,e[o+1],12,-389564586),i=ZS(i,s,r,n,e[o+2],17,606105819),n=ZS(n,i,s,r,e[o+3],22,-1044525330),r=ZS(r,n,i,s,e[o+4],7,-176418897),s=ZS(s,r,n,i,e[o+5],12,1200080426),i=ZS(i,s,r,n,e[o+6],17,-1473231341),n=ZS(n,i,s,r,e[o+7],22,-45705983),r=ZS(r,n,i,s,e[o+8],7,1770035416),s=ZS(s,r,n,i,e[o+9],12,-1958414417),i=ZS(i,s,r,n,e[o+10],17,-42063),n=ZS(n,i,s,r,e[o+11],22,-1990404162),r=ZS(r,n,i,s,e[o+12],7,1804603682),s=ZS(s,r,n,i,e[o+13],12,-40341101),i=ZS(i,s,r,n,e[o+14],17,-1502002290),n=ZS(n,i,s,r,e[o+15],22,1236535329),r=YS(r,n,i,s,e[o+1],5,-165796510),s=YS(s,r,n,i,e[o+6],9,-1069501632),i=YS(i,s,r,n,e[o+11],14,643717713),n=YS(n,i,s,r,e[o],20,-373897302),r=YS(r,n,i,s,e[o+5],5,-701558691),s=YS(s,r,n,i,e[o+10],9,38016083),i=YS(i,s,r,n,e[o+15],14,-660478335),n=YS(n,i,s,r,e[o+4],20,-405537848),r=YS(r,n,i,s,e[o+9],5,568446438),s=YS(s,r,n,i,e[o+14],9,-1019803690),i=YS(i,s,r,n,e[o+3],14,-187363961),n=YS(n,i,s,r,e[o+8],20,1163531501),r=YS(r,n,i,s,e[o+13],5,-1444681467),s=YS(s,r,n,i,e[o+2],9,-51403784),i=YS(i,s,r,n,e[o+7],14,1735328473),n=YS(n,i,s,r,e[o+12],20,-1926607734),r=XS(r,n,i,s,e[o+5],4,-378558),s=XS(s,r,n,i,e[o+8],11,-2022574463),i=XS(i,s,r,n,e[o+11],16,1839030562),n=XS(n,i,s,r,e[o+14],23,-35309556),r=XS(r,n,i,s,e[o+1],4,-1530992060),s=XS(s,r,n,i,e[o+4],11,1272893353),i=XS(i,s,r,n,e[o+7],16,-155497632),n=XS(n,i,s,r,e[o+10],23,-1094730640),r=XS(r,n,i,s,e[o+13],4,681279174),s=XS(s,r,n,i,e[o],11,-358537222),i=XS(i,s,r,n,e[o+3],16,-722521979),n=XS(n,i,s,r,e[o+6],23,76029189),r=XS(r,n,i,s,e[o+9],4,-640364487),s=XS(s,r,n,i,e[o+12],11,-421815835),i=XS(i,s,r,n,e[o+15],16,530742520),n=XS(n,i,s,r,e[o+2],23,-995338651),r=ex(r,n,i,s,e[o],6,-198630844),s=ex(s,r,n,i,e[o+7],10,1126891415),i=ex(i,s,r,n,e[o+14],15,-1416354905),n=ex(n,i,s,r,e[o+5],21,-57434055),r=ex(r,n,i,s,e[o+12],6,1700485571),s=ex(s,r,n,i,e[o+3],10,-1894986606),i=ex(i,s,r,n,e[o+10],15,-1051523),n=ex(n,i,s,r,e[o+1],21,-2054922799),r=ex(r,n,i,s,e[o+8],6,1873313359),s=ex(s,r,n,i,e[o+15],10,-30611744),i=ex(i,s,r,n,e[o+6],15,-1560198380),n=ex(n,i,s,r,e[o+13],21,1309151649),r=ex(r,n,i,s,e[o+4],6,-145523070),s=ex(s,r,n,i,e[o+11],10,-1120210379),i=ex(i,s,r,n,e[o+2],15,718787259),n=ex(n,i,s,r,e[o+9],21,-343485551),r=GS(r,t),n=GS(n,a),i=GS(i,u),s=GS(s,l)}return[r,n,i,s]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(JS(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};var tx={};Object.defineProperty(tx,"__esModule",{value:!0}),tx.default=void 0;var rx=ix(US),nx=ix(QS);function ix(e){return e&&e.__esModule?e:{default:e}}var sx=(0,rx.default)("v3",48,nx.default);tx.default=sx;var ox={};Object.defineProperty(ox,"__esModule",{value:!0}),ox.default=void 0;var ax=lx(bS),ux=lx(kS);function lx(e){return e&&e.__esModule?e:{default:e}}ox.default=function(e,t,r){const n=(e=e||{}).random||(e.rng||ax.default)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return(0,ux.default)(n)};var cx={};function hx(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function dx(e,t){return e<<t|e>>>32-t}Object.defineProperty(cx,"__esModule",{value:!0}),cx.default=void 0;cx.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const n=e.length/4+2,i=Math.ceil(n/16),s=new Array(i);for(let o=0;o<i;++o){const t=new Uint32Array(16);for(let r=0;r<16;++r)t[r]=e[64*o+4*r]<<24|e[64*o+4*r+1]<<16|e[64*o+4*r+2]<<8|e[64*o+4*r+3];s[o]=t}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;for(let o=0;o<i;++o){const e=new Uint32Array(80);for(let t=0;t<16;++t)e[t]=s[o][t];for(let t=16;t<80;++t)e[t]=dx(e[t-3]^e[t-8]^e[t-14]^e[t-16],1);let n=r[0],i=r[1],a=r[2],u=r[3],l=r[4];for(let r=0;r<80;++r){const s=Math.floor(r/20),o=dx(n,5)+hx(s,i,a,u)+l+t[s]+e[r]>>>0;l=u,u=a,a=dx(i,30)>>>0,i=n,n=o}r[0]=r[0]+n>>>0,r[1]=r[1]+i>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+l>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};var fx={};Object.defineProperty(fx,"__esModule",{value:!0}),fx.default=void 0;var px=yx(US),mx=yx(cx);function yx(e){return e&&e.__esModule?e:{default:e}}var gx=(0,px.default)("v5",80,mx.default);fx.default=gx;var vx={};Object.defineProperty(vx,"__esModule",{value:!0}),vx.default=void 0,vx.default="00000000-0000-0000-0000-000000000000";var bx={};Object.defineProperty(bx,"__esModule",{value:!0}),bx.default=void 0;var _x,wx=(_x=CS)&&_x.__esModule?_x:{default:_x};bx.default=function(e){if(!(0,wx.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)};var Ex={};Object.defineProperty(Ex,"__esModule",{value:!0}),Object.defineProperty(Ex,"v1",{enumerable:!0,get:function(){return Cx.default}}),Object.defineProperty(Ex,"v3",{enumerable:!0,get:function(){return Tx.default}}),Object.defineProperty(Ex,"v4",{enumerable:!0,get:function(){return Nx.default}}),Object.defineProperty(Ex,"v5",{enumerable:!0,get:function(){return kx.default}}),Object.defineProperty(Ex,"NIL",{enumerable:!0,get:function(){return Ox.default}}),Object.defineProperty(Ex,"version",{enumerable:!0,get:function(){return Sx.default}}),Object.defineProperty(Ex,"validate",{enumerable:!0,get:function(){return xx.default}}),Object.defineProperty(Ex,"stringify",{enumerable:!0,get:function(){return $x.default}}),Object.defineProperty(Ex,"parse",{enumerable:!0,get:function(){return Ax.default}});var Cx=jx($S),Tx=jx(tx),Nx=jx(ox),kx=jx(fx),Ox=jx(vx),Sx=jx(bx),xx=jx(CS),$x=jx(kS),Ax=jx(qS);function jx(e){return e&&e.__esModule?e:{default:e}}var Ix={};(function(e){const{v4:t}=Ex;Ix={v4:()=>t(),toBuffer:t=>e.from(gS(t)),fromBuffer:e=>vS(e)}}).call(this,require("buffer").Buffer);const Rx=require("events"),Px=require("path");class Mx{constructor(e){this.identity=e.identity,this.store=e.store,Cm.forEach(e=>{this[e.name]||(this[e.name]={}),this[e.name][e.method]=async function(...t){return await this.store[e.name][e.method](this.identity,...t)}.bind(this)})}async disconnect(){await this.store.disconnect()}}var Lx={Store:class extends Rx{constructor(e,t){super(),Cm.forEach(e=>{this[e.name]||(this[e.name]={}),this[e.name][e.method]=async function(t,...r){var n;return null==this||null===(n=this.policy)||void 0===n||n.enforce(this.toolbox,t,e.name,e.method,r),await e.module(this.toolbox,t,...r)}.bind(this)}),this.url=e,this.options=t,this.policy=null==t?void 0:t.policy,this.toolbox={store:this,crypto:Em,trycatch:fS,uuid:Ix}}async connect(e,t){var r,n;e||(e=this.url),t||(t=this.options);const i=new URL(e),s={client:i.protocol.replace(":",""),connection:{host:i.hostname,port:i.port,user:i.username,password:i.password,filename:i.pathname,database:Px.parse(i.pathname).base}};if("sqlite3"===s.client&&(s.useNullAsDefault=!0,"memory"===s.connection.filename&&(s.connection.filename=":memory:")),null===(r=t)||void 0===r||!r.hook(s))return this.knex=dS(s),this.toolbox={...this.toolbox,knex:this.knex},await async function(e,t){await e.schema.hasTable("AccountDatabases").then(r=>{if(!r)return e.schema.createTable("AccountDatabases",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("idDB",16).notNullable(),e.binary("idAccount",16).notNullable(),e.string("type",45).notNullable(),e.primary(["idDB","idAccount"])})}),await e.schema.hasTable("Accounts").then(r=>{if(!r)return e.schema.createTable("Accounts",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("id",16).notNullable().primary(),e.string("username",321).notNullable().unique(),e.text("name").notNullable(),e.string("password",300).notNullable(),e.string("key",500).notNullable(),e.tinyint("isActive",4).notNullable(),e.tinyint("isRoot",4).notNullable()})}),await e.schema.hasTable("Annotations").then(r=>{if(!r)return e.schema.createTable("Annotations",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("ns",16).notNullable(),e.binary("stream",16).notNullable(),e.json("annotation").notNullable(),e.primary(["db","ns","stream"])})}),await e.schema.hasTable("Databases").then(r=>{if(!r)return e.schema.createTable("Databases",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("id",16).notNullable().primary(),e.string("name",100).notNullable().unique()})}),await e.schema.hasTable("Documents").then(r=>{if(!r)return e.schema.createTable("Documents",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.string("collection",100).notNullable(),e.binary("id",16).notNullable(),e.json("data").notNullable(),e.primary(["db","collection","id"])})}),await e.schema.hasTable("Events").then(r=>{if(!r)return e.schema.createTable("Events",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("ns",16).notNullable(),e.binary("stream",16).notNullable(),e.binary("id",16).notNullable(),e.integer("version",10),e.timestamp("ts",{precision:6}).notNullable(),e.json("meta").notNullable(),e.json("data").notNullable(),e.string("type",100).notNullable(),e.primary(["db","ns","stream","id"])})}),await e.schema.hasTable("Namespaces").then(r=>{if(!r)return e.schema.createTable("Namespaces",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("id",16).notNullable().primary(),e.string("name",100).notNullable(),e.unique(["name","db"])})}),await e.schema.hasTable("Objects").then(r=>{if(!r)return e.schema.createTable("Objects",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.string("id",100).notNullable(),e.json("data").notNullable(),e.primary(["db","id"])})}),await e.schema.hasTable("Streams").then(r=>{if(!r)return e.schema.createTable("Streams",e=>{"mysql"===t&&e.charset("utf8mb4"),e.binary("db",16).notNullable(),e.binary("domain",16).notNullable(),e.binary("stream",16).notNullable(),e.json("meta").notNullable(),e.json("annotation").notNullable(),e.primary(["db","domain","stream"])})})}(this.knex,s.client),new Mx({store:this,identity:null===(n=t)||void 0===n?void 0:n.identity})}async disconnect(){this.toolbox={...this.toolbox,knex:void 0},this.knex&&(await this.knex.destroy(),this.knex=void 0)}}},qx={};(function(e){const t=class{constructor({credentials:e}){e&&(this.username=e.username,this.password=e.password)}get username(){return localStorage.getItem("username")}set username(e){localStorage.setItem("username",e)}async authenticate(e,{username:t,password:r}){localStorage.setItem("username",t),this.password=r,await e.details()}forget(){localStorage.removeItem("authorization"),localStorage.removeItem("username")}get credentials(){if(this.username||this.password)return{username:this.username,password:this.password}}async authorization(){const e=localStorage.getItem("authorization");return e||(this.credentials&&this.credentials.apikey?"Apikey "+this.credentials.apikey:this.credentials&&this.credentials.username&&this.credentials.password?"Basic "+(t=`${this.credentials.username}:${this.credentials.password}`,btoa(unescape(encodeURIComponent(t)))):void 0);var t}async authorized(e){localStorage.setItem("authorization",e)}async revoked(e){localStorage.removeItem("authorization")}},{Store:r}=Lx;class n{constructor(){}async connect(e,t){if(e||t||(e="sqlite3:memory"),void 0===t&&"[object String]"!==Object.prototype.toString.call(e)&&(t=e,e={}),"[object String]"!==Object.prototype.toString.call(e)){const t=new URL(e);e={protocol:t.protocol.replace(":",""),hostname:t.hostname,port:t.port,username:t.username,password:t.password,database:t.pathname}}t||"persistr"===e.protocol||(t=new r(e));const n=new class{constructor(e){this.store=e}async close(){await this.store.disconnect()}accounts(){return new class{constructor(e){this.connection=e}get store(){return this.connection.store}async each(e){const t=this.store.accounts.find();for(const r of t)await e(r)}async all(){return this.store.accounts.find()}}(this)}account(e){return new mo(this,e)}}(await t.connect());return"persistr"===e.protocol&&(e.authorization||e.authorized||(e.authorization=()=>n.authorization,e.authorized=e=>n.authorization=e)),n}}qx={Persistr:n,persistr:new n,Identity:t},"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)&&(e.persistr=qx.persistr)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();